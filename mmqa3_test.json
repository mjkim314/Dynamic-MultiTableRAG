[
  {
    "id": 601,
    "db_id": "customers_and_addresses",
    "question": "What are the names of customers who had cancelled orders with a quantity of 9 or more for product ID 2?",
    "sql": "SELECT Customers.customer_name FROM Customers INNER JOIN Customer_Orders ON Customers.customer_id = Customer_Orders.customer_id INNER JOIN Order_Items ON Customer_Orders.order_id = Order_Items.order_id WHERE Customer_Orders.order_status = 'Cancelled' AND Order_Items.product_id = 2 AND Order_Items.order_quantity >= '9';",
    "table_names": [
      "Customers",
      "Customer_Orders",
      "Order_Items"
    ]
  },
  {
    "id": 476,
    "db_id": "store_product",
    "question": "Which district has stores with the highest average ranking?",
    "sql": "SELECT d.District_name, AVG(s.Ranking) AS Average_Ranking FROM store s JOIN store_district sd ON s.Store_ID = sd.Store_ID JOIN district d ON sd.District_ID = d.District_ID GROUP BY d.District_name ORDER BY Average_Ranking ASC LIMIT 1;",
    "table_names": [
      "store",
      "district",
      "store_district"
    ]
  },
  {
    "id": 640,
    "db_id": "activity_1",
    "question": "List the first and last name along with the rank of all professors who participate in the Canoeing activity.",
    "sql": "SELECT Faculty.Fname, Faculty.Lname, Faculty.Rank FROM Faculty JOIN Faculty_Participates_in ON Faculty.FacID = Faculty_Participates_in.FacID JOIN Activity ON Faculty_Participates_in.actid = Activity.actid WHERE Activity.activity_name = 'Canoeing' AND Faculty.Rank = 'Professor';",
    "table_names": [
      "Activity",
      "Faculty_Participates_in",
      "Faculty"
    ]
  },
  {
    "id": 436,
    "db_id": "company_office",
    "question": "In which city is General Electric's earliest office location situated?",
    "sql": "SELECT b.City FROM buildings b JOIN Office_locations ol ON b.id = ol.building_id JOIN Companies c ON ol.company_id = c.id WHERE c.name = 'General Electric' AND ol.move_in_year = (SELECT MIN(move_in_year) FROM Office_locations WHERE company_id = c.id);",
    "table_names": [
      "buildings",
      "Companies",
      "Office_locations"
    ]
  },
  {
    "id": 691,
    "db_id": "flight_2",
    "question": "Which airlines operate flights originating from Anchorage?",
    "sql": "SELECT DISTINCT a.Airline FROM airlines a JOIN flights f ON a.uid = f.Airline JOIN airports ap ON ap.AirportCode = f.SourceAirport WHERE ap.City = 'Anchorage';",
    "table_names": [
      "airlines",
      "airports",
      "flights"
    ]
  },
  {
    "id": 509,
    "db_id": "products_gen_characteristics",
    "question": "Which product(s) have a high purity characteristic?",
    "sql": "SELECT P.product_name FROM Products P INNER JOIN Product_Characteristics PC ON P.product_id = PC.product_id INNER JOIN Characteristics C ON PC.characteristic_id = C.characteristic_id WHERE C.characteristic_type_code = 'Purity' AND PC.product_characteristic_value = 'high';",
    "table_names": [
      "Characteristics",
      "Products",
      "Product_Characteristics"
    ]
  },
  {
    "id": 511,
    "db_id": "products_gen_characteristics",
    "question": "Which products in the category 'Seeds' have a 'Grade' characteristic with the value 'high'?",
    "sql": "SELECT DISTINCT P.product_name FROM Products P JOIN Product_Characteristics PC ON P.product_id = PC.product_id JOIN Characteristics C ON PC.characteristic_id = C.characteristic_id WHERE P.product_category_code = 'Seeds' AND C.characteristic_type_code = 'Grade' AND PC.product_characteristic_value = 'high';",
    "table_names": [
      "Characteristics",
      "Products",
      "Product_Characteristics"
    ]
  },
  {
    "id": 118,
    "db_id": "small_bank_1",
    "question": "Which customers have balances below the average checking account balance and also have savings balances below the average savings balance?",
    "sql": "SELECT a.name FROM ACCOUNTS AS a JOIN CHECKING AS c ON a.custid = c.custid WHERE c.balance < (SELECT AVG(balance) FROM CHECKING) AND a.custid IN (SELECT custid FROM SAVINGS WHERE balance < (SELECT AVG(balance) FROM SAVINGS));",
    "table_names": [
      "ACCOUNTS",
      "SAVINGS",
      "CHECKING"
    ]
  },
  {
    "id": 450,
    "db_id": "college_3",
    "question": "What is the average grade point of students who come from the city with the code 'BAL'?",
    "sql": "SELECT AVG(G.gradepoint) FROM Enrolled_in E INNER JOIN Gradeconversion G ON E.Grade = G.lettergrade INNER JOIN Student S ON E.StuID = S.StuID WHERE S.city_code = 'BAL';",
    "table_names": [
      "Student",
      "Enrolled_in",
      "Gradeconversion"
    ]
  },
  {
    "id": 343,
    "db_id": "hospital_1",
    "question": "What are the names of physicians who prescribed medications from the brand 'Foo Labs'?",
    "sql": "SELECT DISTINCT Physician.Name FROM Physician JOIN Prescribes ON Physician.EmployeeID = Prescribes.Physician JOIN Medication ON Prescribes.Medication = Medication.Code WHERE Medication.Brand = 'Foo Labs';",
    "table_names": [
      "Physician",
      "Medication",
      "Prescribes"
    ]
  },
  {
    "id": 625,
    "db_id": "scientist_1",
    "question": "What are the names of scientists working on the project with the highest number of hours?",
    "sql": "SELECT Name FROM Scientists WHERE SSN IN (SELECT Scientist FROM AssignedTo WHERE Project IN (SELECT Code FROM Projects WHERE Hours = (SELECT MAX(Hours) FROM Projects)))",
    "table_names": [
      "Scientists",
      "Projects",
      "AssignedTo"
    ]
  },
  {
    "id": 70,
    "db_id": "college_2",
    "question": "What is the average salary of instructors from departments advising students with total credits greater than 120?",
    "sql": "SELECT AVG(salary) FROM instructor WHERE dept_name IN (SELECT dept_name FROM instructor WHERE ID IN (SELECT i_ID FROM advisor WHERE s_ID IN (SELECT ID FROM student WHERE tot_cred > 120)))",
    "table_names": [
      "instructor",
      "student",
      "advisor"
    ]
  },
  {
    "id": 694,
    "db_id": "course_teach",
    "question": "Which course is assigned to Anne Walker for grade 7?",
    "sql": "SELECT Course FROM course WHERE Course_ID IN (SELECT Course_ID FROM course_arrange WHERE Teacher_ID = (SELECT Teacher_ID FROM teacher WHERE Name = 'Anne Walker') AND Grade = 7);",
    "table_names": [
      "course",
      "teacher",
      "course_arrange"
    ]
  },
  {
    "id": 33,
    "db_id": "store_1",
    "question": "What are the tracks that Dean Peeters bought?",
    "sql": "SELECT T1.name FROM tracks AS T1 JOIN invoice_lines AS T2 ON T1.id = T2.track_id JOIN invoices AS T3 ON T3.id = T2.invoice_id JOIN customers AS T4 ON T4.id = T3.customer_id WHERE T4.first_name = \"Daan\" AND T4.last_name = \"Peeters\";",
    "table_names": [
      "customers",
      "invoices",
      "tracks",
      "invoice_lines"
    ]
  },
  {
    "id": 593,
    "db_id": "customers_and_addresses",
    "question": "What is the city of the billing address of customers who use Credit Card as their payment method?",
    "sql": "SELECT addr.city FROM Customers c JOIN Customer_Addresses ca ON c.customer_id = ca.customer_id JOIN Addresses addr ON ca.address_id = addr.address_id WHERE c.payment_method='Credit Card' AND ca.address_type='Billing';",
    "table_names": [
      "Addresses",
      "Customers",
      "Customer_Addresses"
    ]
  },
  {
    "id": 247,
    "db_id": "icfp_1",
    "question": "What paper has Stephanie Weirich authored as the first author?",
    "sql": "SELECT p.title FROM Papers p JOIN Authorship a ON p.paperID = a.paperID JOIN Authors au ON au.authID = a.authID WHERE au.fname = 'Stephanie' AND a.authOrder = 1;",
    "table_names": [
      "Authors",
      "Papers",
      "Authorship"
    ]
  },
  {
    "id": 592,
    "db_id": "customers_and_addresses",
    "question": "What are the names and payment methods of customers who have residential addresses in Colorado?",
    "sql": "SELECT c.customer_name, c.payment_method FROM Customers c JOIN Customer_Addresses ca ON c.customer_id = ca.customer_id JOIN Addresses a ON ca.address_id = a.address_id WHERE a.state_province_county = 'Colorado' AND ca.address_type = 'Residential';",
    "table_names": [
      "Addresses",
      "Customers",
      "Customer_Addresses"
    ]
  },
  {
    "id": 322,
    "db_id": "hr_1",
    "question": "What is the city location and the average salary of employees working in the same department as employee named Alexander Hunold?",
    "sql": "SELECT e.FIRST_NAME, e.LAST_NAME, l.CITY, AVG(e2.SALARY) as avg_dept_salary FROM employees e JOIN departments d ON e.DEPARTMENT_ID = d.DEPARTMENT_ID JOIN locations l ON d.LOCATION_ID = l.LOCATION_ID JOIN employees e2 ON d.DEPARTMENT_ID = e2.DEPARTMENT_ID WHERE e.FIRST_NAME = 'Alexander' AND e.LAST_NAME = 'Hunold' GROUP BY e.FIRST_NAME, e.LAST_NAME, l.CITY;",
    "table_names": [
      "departments",
      "employees",
      "locations"
    ]
  },
  {
    "id": 558,
    "db_id": "dorm_1",
    "question": "Which dorms have a kitchen in every room and have a student capacity greater than the average capacity of all dorms?",
    "sql": "SELECT dorm_name FROM Dorm WHERE dormid IN (SELECT dormid FROM Has_amenity WHERE amenid = (SELECT amenid FROM Dorm_amenity WHERE amenity_name = 'Kitchen in Every Room')) AND student_capacity > (SELECT AVG(student_capacity) FROM Dorm)",
    "table_names": [
      "Dorm",
      "Dorm_amenity",
      "Has_amenity"
    ]
  },
  {
    "id": 23,
    "db_id": "allergy_1",
    "question": "List the first and last names of students from NYC who have animal-related allergies.",
    "sql": "SELECT DISTINCT s.Fname, s.LName FROM Student s JOIN Has_Allergy ha ON s.StuID = ha.StuID JOIN Allergy_Type at ON ha.Allergy = at.Allergy WHERE at.AllergyType = 'animal' AND s.city_code = 'NYC';",
    "table_names": [
      "Allergy_Type",
      "Has_Allergy",
      "Student"
    ]
  },
  {
    "id": 491,
    "db_id": "device",
    "question": "What is the total quantity of Android devices stocked in shops opened before the year 2010?",
    "sql": "SELECT SUM(s.Quantity) FROM stock s JOIN device d ON s.Device_ID = d.Device_ID JOIN shop sh ON s.Shop_ID = sh.Shop_ID WHERE d.Software_Platform = 'Android' AND sh.Open_Year < 2010;",
    "table_names": [
      "device",
      "shop",
      "stock"
    ]
  },
  {
    "id": 184,
    "db_id": "party_host",
    "question": "Which party themes were hosted by main hosts from Hungary?",
    "sql": "SELECT p.Party_Theme FROM party p INNER JOIN party_host ph ON p.Party_ID = ph.Party_ID INNER JOIN host h ON ph.Host_ID = h.Host_ID WHERE h.Nationality = 'Hungary' AND ph.Is_Main_in_Charge = 'T';",
    "table_names": [
      "party",
      "host",
      "party_host"
    ]
  },
  {
    "id": 188,
    "db_id": "party_host",
    "question": "Who were the main hosts responsible for parties held at the Heineken Music Hall Amsterdam?",
    "sql": "SELECT h.Name FROM host h JOIN party_host ph ON h.Host_ID = ph.Host_ID JOIN party p ON ph.Party_ID = p.Party_ID WHERE p.Location = 'Heineken Music Hall Amsterdam' AND ph.Is_Main_in_Charge = 'T';",
    "table_names": [
      "party",
      "host",
      "party_host"
    ]
  },
  {
    "id": 620,
    "db_id": "e_government",
    "question": "Which organization was the first to have contact with Daniella Rogahn, and what was the start date of that contact?",
    "sql": "SELECT o.organization_name, i.individual_first_name, i.individual_last_name, oci.date_contact_from FROM Organizations o JOIN Organization_Contact_Individuals oci ON o.organization_id = oci.organization_id JOIN Individuals i ON i.individual_id = oci.individual_id WHERE i.individual_first_name = 'Daniella' AND i.individual_last_name = 'Rogahn' ORDER BY oci.date_contact_from ASC LIMIT 1;",
    "table_names": [
      "Individuals",
      "Organizations",
      "Organization_Contact_Individuals"
    ]
  },
  {
    "id": 553,
    "db_id": "dorm_1",
    "question": "What is the name of the largest gender-neutral dormitory that provides air conditioning?",
    "sql": "SELECT d.dorm_name FROM Dorm d JOIN Has_amenity ha ON d.dormid = ha.dormid JOIN Dorm_amenity da ON ha.amenid = da.amenid WHERE da.amenity_name = 'Air Conditioning' AND d.gender = 'X' ORDER BY d.student_capacity DESC LIMIT 1;",
    "table_names": [
      "Dorm",
      "Dorm_amenity",
      "Has_amenity"
    ]
  },
  {
    "id": 336,
    "db_id": "hospital_1",
    "question": "What medication was prescribed to patient Dennis Doe with a dosage of 10?",
    "sql": "SELECT Medication.Name FROM Medication INNER JOIN Prescribes ON Medication.Code = Prescribes.Medication INNER JOIN Patient ON Prescribes.Patient = Patient.SSN WHERE Patient.Name = 'Dennis Doe' AND Prescribes.Dose = '10';",
    "table_names": [
      "Patient",
      "Medication",
      "Prescribes",
      "Room",
      "Stay"
    ]
  },
  {
    "id": 294,
    "db_id": "college_1",
    "question": "What is William Bowser's enrollment grade in the course QM-261?",
    "sql": "SELECT E.ENROLL_GRADE FROM STUDENT S JOIN ENROLL E ON S.STU_NUM = E.STU_NUM JOIN CLASS C ON E.CLASS_CODE = C.CLASS_CODE WHERE S.STU_LNAME = 'Bowser' AND C.CRS_CODE = 'QM-261';",
    "table_names": [
      "CLASS",
      "ENROLL",
      "STUDENT"
    ]
  },
  {
    "id": 51,
    "db_id": "medicine_enzyme_interaction",
    "question": "List the names of FDA-approved medicines that inhibit enzymes located in the mitochondrion.",
    "sql": "SELECT m.name FROM medicine m JOIN medicine_enzyme_interaction mei ON m.id = mei.medicine_id JOIN enzyme e ON mei.enzyme_id = e.id WHERE e.Location='Mitochondrion' AND mei.interaction_type='inhibitor' AND m.FDA_approved='Yes';",
    "table_names": [
      "medicine",
      "enzyme",
      "medicine_enzyme_interaction"
    ]
  },
  {
    "id": 437,
    "db_id": "company_office",
    "question": "Which buildings under construction have companies headquartered in France planned to move in from 2022 onwards?",
    "sql": "SELECT b.name FROM buildings AS b JOIN Office_locations AS o ON b.id = o.building_id JOIN Companies AS c ON o.company_id = c.id WHERE c.Headquarters = 'France' AND b.Status = 'under construction' AND o.move_in_year >= 2022;",
    "table_names": [
      "buildings",
      "Companies",
      "Office_locations"
    ]
  },
  {
    "id": 459,
    "db_id": "department_store",
    "question": "What is the name and phone number of the supplier who had an address located in the area with ZIP code OH 95195?",
    "sql": "SELECT supplier_name, supplier_phone FROM Suppliers WHERE supplier_id = (SELECT supplier_id FROM Supplier_Addresses WHERE address_id = (SELECT address_id FROM Addresses WHERE address_details LIKE '%OH 95195%'));",
    "table_names": [
      "Addresses",
      "Suppliers",
      "Supplier_Addresses"
    ]
  },
  {
    "id": 531,
    "db_id": "swimming",
    "question": "Which stadium hosted events where the swimmer with ID 1 had a loss?",
    "sql": "SELECT stadium.name FROM stadium JOIN event ON stadium.ID = event.Stadium_ID JOIN record ON event.ID = record.Event_ID WHERE record.Result = 'Loss' AND record.Swimmer_ID = 1;",
    "table_names": [
      "stadium",
      "event",
      "record"
    ]
  },
  {
    "id": 198,
    "db_id": "storm_record",
    "question": "What is the name of the region with the highest number of cities affected by storms which had a maximum speed of 980 or less?",
    "sql": "SELECT r.Region_name FROM region r JOIN affected_region ar ON r.Region_id = ar.Region_id JOIN storm s ON ar.Storm_ID = s.Storm_ID WHERE s.Max_speed <= 980 AND ar.Number_city_affected > 10 ORDER BY ar.Number_city_affected DESC LIMIT 1;",
    "table_names": [
      "storm",
      "region",
      "affected_region"
    ]
  },
  {
    "id": 203,
    "db_id": "restaurant_1",
    "question": "What is the name and rating of the restaurant that serves Stir-fry?",
    "sql": "SELECT ResName, Rating FROM Restaurant WHERE ResID IN (SELECT ResID FROM Type_Of_Restaurant WHERE ResTypeID = (SELECT ResTypeID FROM Restaurant_Type WHERE ResTypeName = 'Stir-fry'));",
    "table_names": [
      "Restaurant",
      "Type_Of_Restaurant",
      "Restaurant_Type"
    ]
  },
  {
    "id": 498,
    "db_id": "shop_membership",
    "question": "What are the names of the members registered at branches in Oxford whose Level is greater than 5?",
    "sql": "SELECT m.Name FROM member m JOIN membership_register_branch mb ON m.Member_ID = mb.Member_ID JOIN branch b ON mb.Branch_ID = b.Branch_ID WHERE b.City = 'Oxford' AND m.Level > 5;",
    "table_names": [
      "member",
      "branch",
      "membership_register_branch"
    ]
  },
  {
    "id": 131,
    "db_id": "products_for_hire",
    "question": "Which product has the highest total booked count among bookings that were returned damaged?",
    "sql": "SELECT pfh.product_name, SUM(pb.booked_count) AS total_booked_count FROM Products_Booked pb JOIN Products_for_Hire pfh ON pb.product_id = pfh.product_id JOIN Bookings b ON pb.booking_id = b.booking_id WHERE b.returned_damaged_yn = '1' GROUP BY pfh.product_name ORDER BY total_booked_count DESC LIMIT 1;",
    "table_names": [
      "Bookings",
      "Products_for_Hire",
      "Products_Booked"
    ]
  },
  {
    "id": 353,
    "db_id": "hospital_1",
    "question": "List the names of physicians whose training certifications expire on '2008-12-31' and who are trained in performing procedures costing more than $4000.",
    "sql": "SELECT p.Name FROM Physician p JOIN Trained_In t ON p.EmployeeID = t.Physician JOIN Procedures pr ON t.Treatment = pr.Code WHERE pr.Cost > 4000 AND t.CertificationExpires = '2008-12-31';",
    "table_names": [
      "Physician",
      "Procedures",
      "Trained_In"
    ]
  },
  {
    "id": 674,
    "db_id": "car_1",
    "question": "What is the average MPG for cars made by maker with id 4 from the year 1980 onwards?",
    "sql": "SELECT AVG(CAST(c.MPG AS FLOAT)) FROM cars_data c JOIN car_names cn ON c.Id = cn.MakeId JOIN model_list ml ON cn.Model = ml.Model WHERE ml.Maker = 4 AND c.Year >= 1980;",
    "table_names": [
      "model_list",
      "car_names",
      "cars_data"
    ]
  },
  {
    "id": 269,
    "db_id": "college_1",
    "question": "What time are the classes offered by the Computer Info. Systems department that have 4.0 credits?",
    "sql": "SELECT CLASS.CLASS_TIME FROM CLASS JOIN COURSE ON CLASS.CRS_CODE = COURSE.CRS_CODE JOIN DEPARTMENT ON COURSE.DEPT_CODE = DEPARTMENT.DEPT_CODE WHERE DEPARTMENT.DEPT_NAME = 'Computer Info. Systems' AND COURSE.CRS_CREDIT = 4.0;",
    "table_names": [
      "CLASS",
      "COURSE",
      "DEPARTMENT"
    ]
  },
  {
    "id": 282,
    "db_id": "college_1",
    "question": "Who teaches courses scheduled on Tuesday and Thursday in room KLR200, and what department do they belong to?",
    "sql": "SELECT E.EMP_LNAME, E.EMP_FNAME, D.DEPT_NAME, C.CLASS_TIME FROM EMPLOYEE E JOIN CLASS C ON E.EMP_NUM = C.PROF_NUM JOIN DEPARTMENT D ON D.DEPT_CODE = SUBSTR(C.CRS_CODE, 1, INSTR(C.CRS_CODE,'-') - 1) WHERE C.CLASS_ROOM='KLR200' AND C.CLASS_TIME LIKE 'TTh%';",
    "table_names": [
      "CLASS",
      "DEPARTMENT",
      "EMPLOYEE",
      "PROFESSOR"
    ]
  },
  {
    "id": 549,
    "db_id": "dorm_1",
    "question": "What is the name of the dormitory where Arthur Pang lives?",
    "sql": "SELECT Dorm.dorm_name FROM Student JOIN Lives_in ON Student.StuID = Lives_in.stuid JOIN Dorm ON Lives_in.dormid = Dorm.dormid WHERE Student.LName = 'Pang' AND Student.Fname = 'Arthur';",
    "table_names": [
      "Student",
      "Dorm",
      "Lives_in"
    ]
  },
  {
    "id": 618,
    "db_id": "e_government",
    "question": "Which organizations were in contact with Daniella Rogahn after March 1st, 2018, and what are their corresponding UK VAT numbers?",
    "sql": "SELECT o.organization_name, o.uk_vat_number FROM Organizations o JOIN Organization_Contact_Individuals oci ON o.organization_id = oci.organization_id JOIN Individuals i ON oci.individual_id = i.individual_id WHERE i.individual_first_name = 'Daniella' AND i.individual_last_name = 'Rogahn' AND oci.date_contact_to > '2018-03-01';",
    "table_names": [
      "Individuals",
      "Organizations",
      "Organization_Contact_Individuals"
    ]
  },
  {
    "id": 679,
    "db_id": "car_1",
    "question": "How many distinct car models are manufactured by car makers from countries located in continent 3?",
    "sql": "SELECT COUNT(DISTINCT ml.Model) FROM model_list ml JOIN car_makers cm ON ml.Maker = cm.Id JOIN countries c ON cm.Country = c.CountryId WHERE c.Continent = 3;",
    "table_names": [
      "countries",
      "car_makers",
      "model_list"
    ]
  },
  {
    "id": 216,
    "db_id": "icfp_1",
    "question": "Which institutions are affiliated with the author whose last name is Hinze?",
    "sql": "SELECT DISTINCT i.name FROM Inst AS i JOIN Authorship AS au ON i.instID = au.instID JOIN Authors AS a ON au.authID = a.authID WHERE a.lname = 'Hinze';",
    "table_names": [
      "Inst",
      "Authors",
      "Authorship"
    ]
  },
  {
    "id": 265,
    "db_id": "assets_maintenance",
    "question": "List the first name and last name of engineers who had engineer visits with status 'Fixed' and who were contacted by male staff members.",
    "sql": "SELECT me.first_name, me.last_name FROM Maintenance_Engineers me JOIN Engineer_Visits ev ON me.engineer_id = ev.engineer_id JOIN Staff s ON ev.contact_staff_id = s.staff_id WHERE s.gender = '0' AND ev.fault_status = 'Fixed';",
    "table_names": [
      "Staff",
      "Maintenance_Engineers",
      "Engineer_Visits"
    ]
  },
  {
    "id": 166,
    "db_id": "machine_repair",
    "question": "Which technicians have been assigned repairs on machines produced between 1995 and 1997 that have a quality rank worse than 5?",
    "sql": "SELECT t.Name FROM technician AS t JOIN repair_assignment AS r ON t.technician_id = r.technician_id JOIN machine AS m ON r.Machine_ID = m.Machine_ID WHERE m.quality_rank > 5 AND m.Making_Year BETWEEN 1995 AND 1997;",
    "table_names": [
      "machine",
      "technician",
      "repair_assignment"
    ]
  },
  {
    "id": 289,
    "db_id": "college_1",
    "question": "List the course descriptions and their credits for the classes where student number 321452 received a grade of 'C'.",
    "sql": "SELECT CRS_DESCRIPTION, CRS_CREDIT FROM COURSE WHERE CRS_CODE IN (SELECT CRS_CODE FROM CLASS WHERE CLASS_CODE IN (SELECT CLASS_CODE FROM ENROLL WHERE STU_NUM = 321452 AND ENROLL_GRADE = 'C'));",
    "table_names": [
      "CLASS",
      "COURSE",
      "ENROLL",
      "STUDENT"
    ]
  },
  {
    "id": 89,
    "db_id": "tracking_orders",
    "question": "What is the total amount spent by customer with customer_id '5' on all their orders?",
    "sql": "SELECT SUM(oi.product_quantity * p.unit_price) FROM Orders o JOIN Order_Items oi ON o.order_id = oi.order_id JOIN Products p ON oi.product_id = p.product_id WHERE o.customer_id = 5;",
    "table_names": [
      "Orders",
      "Products",
      "Order_Items"
    ]
  },
  {
    "id": 394,
    "db_id": "club_1",
    "question": "What is the name of the student who lives in HOU city and has a position in the Bootup Baltimore club?",
    "sql": "SELECT s.Fname, s.LName FROM Student s JOIN Member_of_club mc ON s.StuID = mc.StuID JOIN Club c ON mc.ClubID = c.ClubID WHERE c.ClubName = 'Bootup Baltimore' AND s.city_code = 'HOU';",
    "table_names": [
      "Student",
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 335,
    "db_id": "hospital_1",
    "question": "Which physicians have prescribed medication to patients whose primary care physician (PCP) is Elliot Reid?",
    "sql": "SELECT DISTINCT p.Name FROM Physician p JOIN Prescribes pr ON p.EmployeeID = pr.Physician JOIN Patient pat ON pat.SSN = pr.Patient WHERE pat.PCP = 2;",
    "table_names": [
      "Physician",
      "Patient",
      "Prescribes"
    ]
  },
  {
    "id": 709,
    "db_id": "world_1",
    "question": "What is the name of the city with the largest population among the countries whose official or spoken language is Portuguese?",
    "sql": "SELECT c.Name, MAX(c.Population) AS MaxPopulation FROM city AS c JOIN countrylanguage AS cl ON c.CountryCode = cl.CountryCode WHERE cl.Language = 'Portuguese' GROUP BY c.Name ORDER BY MaxPopulation DESC LIMIT 1;",
    "table_names": [
      "city",
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 217,
    "db_id": "icfp_1",
    "question": "What institution does the author named Hinze have a first-author paper affiliation with?",
    "sql": "SELECT I.name FROM Inst I JOIN Authorship AU ON AU.instID = I.instID JOIN Authors A ON A.authID = AU.authID WHERE A.lname = 'Hinze' AND AU.authOrder = 1;",
    "table_names": [
      "Inst",
      "Authors",
      "Authorship"
    ]
  },
  {
    "id": 524,
    "db_id": "products_gen_characteristics",
    "question": "What are the product names, color descriptions, category descriptions, and typical selling prices for products having color red and belonging to the category Seeds?",
    "sql": "SELECT p.product_name, rc.color_description, pc.product_category_description, p.typical_selling_price FROM Products p JOIN Ref_Colors rc ON p.color_code = rc.color_code JOIN Ref_Product_Categories pc ON p.product_category_code = pc.product_category_code WHERE rc.color_description = 'red' AND pc.product_category_description = 'Seeds';",
    "table_names": [
      "Ref_Colors",
      "Ref_Product_Categories",
      "Products"
    ]
  },
  {
    "id": 642,
    "db_id": "activity_1",
    "question": "Who is the faculty member involved in the greatest number of adventure activities from among 'Mountain Climbing', 'Kayaking', and 'Spelunking', and what is the count of these activities?",
    "sql": "SELECT F.Fname, F.Lname, COUNT(DISTINCT FP.actid) AS activity_count FROM Faculty F JOIN Faculty_Participates_in FP ON F.FacID = FP.FacID JOIN Activity A ON FP.actid = A.actid WHERE A.activity_name IN ('Mountain Climbing', 'Kayaking', 'Spelunking') GROUP BY F.FacID ORDER BY activity_count DESC LIMIT 1;",
    "table_names": [
      "Activity",
      "Faculty_Participates_in",
      "Faculty"
    ]
  },
  {
    "id": 233,
    "db_id": "icfp_1",
    "question": "Who is the second author of the paper titled 'Functional Pearl: Modular Rollback through Control Logging'?",
    "sql": "SELECT a.fname, a.lname FROM Authors a JOIN Authorship au ON a.authID = au.authID JOIN Papers p ON au.paperID = p.paperID WHERE p.title = 'Functional Pearl: Modular Rollback through Control Logging' AND au.authOrder = 2",
    "table_names": [
      "Authors",
      "Papers",
      "Authorship"
    ]
  },
  {
    "id": 341,
    "db_id": "hospital_1",
    "question": "Who prescribed medication from 'Foo Labs' with a dose of 10?",
    "sql": "SELECT p.Name FROM Physician p JOIN Prescribes pr ON p.EmployeeID = pr.Physician JOIN Medication m ON pr.Medication = m.Code WHERE m.Brand = 'Foo Labs' AND pr.Dose = '10';",
    "table_names": [
      "Physician",
      "Medication",
      "Prescribes"
    ]
  },
  {
    "id": 541,
    "db_id": "dorm_1",
    "question": "Which dormitory does the student named Sarah Smith live in?",
    "sql": "SELECT D.dorm_name FROM Student AS S JOIN Lives_in AS L ON S.StuID = L.stuid JOIN Dorm AS D ON L.dormid = D.dormid WHERE S.Fname = 'Sarah' AND S.LName = 'Smith';",
    "table_names": [
      "Student",
      "Dorm",
      "Lives_in"
    ]
  },
  {
    "id": 555,
    "db_id": "dorm_1",
    "question": "Which gender-neutral dormitory with the highest student capacity offers air conditioning?",
    "sql": "SELECT Dorm.dorm_name FROM Dorm JOIN Has_amenity ON Dorm.dormid = Has_amenity.dormid JOIN Dorm_amenity ON Has_amenity.amenid = Dorm_amenity.amenid WHERE Dorm.gender = 'X' AND Dorm_amenity.amenity_name = 'Air Conditioning' AND Dorm.student_capacity = (SELECT MAX(student_capacity) FROM Dorm WHERE gender = 'X');",
    "table_names": [
      "Dorm",
      "Dorm_amenity",
      "Has_amenity"
    ]
  },
  {
    "id": 359,
    "db_id": "hospital_1",
    "question": "What is the total cost of procedures for which physician Christopher Turk possesses certification, and for how many procedures is he certified?",
    "sql": "SELECT SUM(p.Cost) AS TotalCost, COUNT(*) AS ProcedureCount FROM Procedures p JOIN Trained_In t ON p.Code = t.Treatment JOIN Physician ph ON t.Physician = ph.EmployeeID WHERE ph.Name = 'Christopher Turk';",
    "table_names": [
      "Physician",
      "Procedures",
      "Trained_In"
    ]
  },
  {
    "id": 339,
    "db_id": "hospital_1",
    "question": "List the names of patients who had stays in rooms located on the first floor, along with the total number of those stays, only including patients with at least one such stay.",
    "sql": "SELECT Patient.Name, COUNT(*) AS NumOfStays FROM Patient JOIN Stay ON Patient.SSN = Stay.Patient JOIN Room ON Stay.Room = Room.RoomNumber WHERE Room.BlockFloor = 1 GROUP BY Patient.Name HAVING COUNT(*) >= 1;",
    "table_names": [
      "Patient",
      "Room",
      "Stay"
    ]
  },
  {
    "id": 398,
    "db_id": "club_1",
    "question": "Who are the students from the city with city code 'HOU' that are members of clubs located at 'AKW'?",
    "sql": "SELECT s.Fname, s.LName FROM Student s JOIN Member_of_club mc ON s.StuID = mc.StuID JOIN Club c ON mc.ClubID = c.ClubID WHERE c.ClubLocation = 'AKW' AND s.city_code = 'HOU';",
    "table_names": [
      "Student",
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 690,
    "db_id": "flight_2",
    "question": "Can you list the airlines operating flights from Albuquerque to Annette Island?",
    "sql": "SELECT DISTINCT al.Airline FROM airlines AS al JOIN flights AS f ON al.uid = f.Airline JOIN airports AS ap_src ON f.SourceAirport = ap_src.AirportCode JOIN airports AS ap_dest ON f.DestAirport = ap_dest.AirportCode WHERE ap_src.City = 'Albuquerque ' AND ap_dest.City = 'Annette Island '",
    "table_names": [
      "airlines",
      "airports",
      "flights"
    ]
  },
  {
    "id": 319,
    "db_id": "hr_1",
    "question": "Which employee earns the highest salary in the Sales department and in which city are they based?",
    "sql": "SELECT e.FIRST_NAME, e.LAST_NAME, d.DEPARTMENT_NAME, l.CITY FROM employees e JOIN departments d ON e.DEPARTMENT_ID = d.DEPARTMENT_ID JOIN locations l ON d.LOCATION_ID = l.LOCATION_ID WHERE e.SALARY = (SELECT MAX(SALARY) FROM employees WHERE DEPARTMENT_ID = (SELECT DEPARTMENT_ID FROM departments WHERE DEPARTMENT_NAME = 'Sales'));",
    "table_names": [
      "departments",
      "employees",
      "locations"
    ]
  },
  {
    "id": 429,
    "db_id": "tracking_grants_for_research",
    "question": "What is the total amount of grant funding associated with documents described as 'Initial Application', sent between years 2000 and 2010 inclusive?",
    "sql": "SELECT SUM(g.grant_amount) FROM Grants g JOIN Documents d ON g.grant_id = d.grant_id JOIN Document_Types dt ON d.document_type_code = dt.document_type_code WHERE dt.document_description = 'Initial Application' AND YEAR(d.sent_date) BETWEEN 2000 AND 2010;",
    "table_names": [
      "Document_Types",
      "Documents",
      "Grants"
    ]
  },
  {
    "id": 657,
    "db_id": "culture_company",
    "question": "Find the movie titles associated with companies linked to books that won awards and grossed less than 1 million worldwide.",
    "sql": "SELECT m.Title FROM movie m JOIN culture_company cc ON m.movie_id = cc.movie_id JOIN book_club bc ON bc.book_club_id = cc.book_club_id WHERE bc.Result LIKE 'Won%' AND m.Gross_worldwide < 1000000;",
    "table_names": [
      "book_club",
      "movie",
      "culture_company"
    ]
  },
  {
    "id": 321,
    "db_id": "hr_1",
    "question": "What are the names of employees who work in the IT department, located in countries within region ID 3?",
    "sql": "SELECT e.FIRST_NAME, e.LAST_NAME FROM employees e JOIN departments d ON e.DEPARTMENT_ID = d.DEPARTMENT_ID JOIN countries c ON c.REGION_ID = 3 WHERE d.DEPARTMENT_NAME = 'IT';",
    "table_names": [
      "countries",
      "departments",
      "employees",
      "locations"
    ]
  },
  {
    "id": 141,
    "db_id": "party_people",
    "question": "In which region did the 'Election Meeting' event occur under the administration of Minister Dr. Kwame Nkrumah (MP)?",
    "sql": "SELECT r.Region_name FROM region r JOIN party p ON r.Region_ID = p.Region_ID JOIN party_events pe ON p.Party_ID = pe.Party_ID WHERE pe.Event_Name = 'Election Meeting' AND p.Minister = 'Dr. Kwame Nkrumah (MP)'",
    "table_names": [
      "region",
      "party",
      "party_events"
    ]
  },
  {
    "id": 345,
    "db_id": "hospital_1",
    "question": "How many procedures did Dennis Doe undergo while staying in room 112 between May 1, 2008, and May 14, 2008?",
    "sql": "SELECT COUNT(*) FROM Undergoes JOIN Stay ON Undergoes.Stay = Stay.StayID JOIN Patient ON Undergoes.Patient = Patient.SSN WHERE Patient.Name = 'Dennis Doe' AND Stay.Room = 112 AND Undergoes.DateUndergoes BETWEEN '2008-05-01' AND '2008-05-14';",
    "table_names": [
      "Patient",
      "Stay",
      "Undergoes"
    ]
  },
  {
    "id": 561,
    "db_id": "dorm_1",
    "question": "Which dormitories with air conditioning have a student capacity greater than the average student capacity of all dorms?",
    "sql": "SELECT dorm_name FROM Dorm WHERE dormid IN (SELECT dormid FROM Has_amenity WHERE amenid IN (SELECT amenid FROM Dorm_amenity WHERE amenity_name = 'Air Conditioning')) AND student_capacity > (SELECT AVG(student_capacity) FROM Dorm);",
    "table_names": [
      "Dorm",
      "Dorm_amenity",
      "Has_amenity"
    ]
  },
  {
    "id": 458,
    "db_id": "department_store",
    "question": "What was the address of the supplier Tesco on January 1st, 2010?",
    "sql": "SELECT s.supplier_name, a.address_details FROM Suppliers s JOIN Supplier_Addresses sa ON s.supplier_id = sa.supplier_id JOIN Addresses a ON sa.address_id = a.address_id WHERE s.supplier_name = 'Tesco' AND sa.date_from <= '2010-01-01' AND sa.date_to >= '2010-01-01';",
    "table_names": [
      "Addresses",
      "Suppliers",
      "Supplier_Addresses"
    ]
  },
  {
    "id": 401,
    "db_id": "club_1",
    "question": "What are the first and last names of students from Baltimore ('BAL') who are members of clubs located in AKW?",
    "sql": "SELECT s.Fname, s.LName FROM Student s JOIN Member_of_club mc ON s.StuID = mc.StuID JOIN Club c ON mc.ClubID = c.ClubID WHERE s.city_code = 'BAL' AND c.ClubLocation = 'AKW';",
    "table_names": [
      "Student",
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 605,
    "db_id": "customers_and_addresses",
    "question": "What is the total quantity of items ordered in cancelled orders by customers who used a credit card for payment?",
    "sql": "SELECT SUM(CAST(oi.order_quantity AS INTEGER)) FROM Customers c JOIN Customer_Orders co ON c.customer_id = co.customer_id JOIN Order_Items oi ON co.order_id = oi.order_id WHERE c.payment_method = 'Credit Card' AND co.order_status = 'Cancelled';",
    "table_names": [
      "Customers",
      "Customer_Orders",
      "Order_Items"
    ]
  },
  {
    "id": 28,
    "db_id": "store_1",
    "question": "List the name of tracks belongs to genre Rock and whose media type is MPEG audio file.",
    "sql": "SELECT T2.name FROM genres AS T1 JOIN tracks AS T2 ON T1.id = T2.genre_id JOIN media_types AS T3 ON T3.id = T2.media_type_id WHERE T1.name = \"Rock\" AND T3.name = \"MPEG audio file\";",
    "table_names": [
      "genres",
      "media_types",
      "tracks"
    ]
  },
  {
    "id": 483,
    "db_id": "store_product",
    "question": "Which City Mall stores have scanners capable of scanning more than 20 color pages per minute?",
    "sql": "SELECT store.Store_Name FROM store JOIN store_product ON store.Store_ID = store_product.Store_ID JOIN product ON store_product.Product_ID = product.product_id WHERE product.pages_per_minute_color > 20 AND store.Type = 'City Mall';",
    "table_names": [
      "product",
      "store",
      "store_product"
    ]
  },
  {
    "id": 551,
    "db_id": "dorm_1",
    "question": "Which dorm and room is Sarah Schmidt allocated to?",
    "sql": "SELECT d.dorm_name FROM Dorm d JOIN Lives_in l ON d.dormid = l.dormid JOIN Student s ON l.stuid = s.StuID WHERE s.Fname = 'Sarah' AND s.LName = 'Schmidt';",
    "table_names": [
      "Student",
      "Dorm",
      "Lives_in"
    ]
  },
  {
    "id": 17,
    "db_id": "flight_1",
    "question": "List the names of the employees who are certified to fly aircraft capable of traveling more than 8000 miles and who have a salary greater than $200,000?",
    "sql": "SELECT e.ename FROM employee e INNER JOIN certificate c ON e.eid = c.eid INNER JOIN aircraft a ON c.aid = a.aid WHERE a.distance > 8000 AND e.salary > 200000;",
    "table_names": [
      "aircraft",
      "employee",
      "certificate"
    ]
  },
  {
    "id": 122,
    "db_id": "browser_web",
    "question": "List the names and market shares of browsers compatible with web client accelerators that support the Mac operating system and were compatible before the year 2005.",
    "sql": "SELECT b.name AS browser_name, b.market_share FROM Web_client_accelerator AS w JOIN accelerator_compatible_browser AS ac ON w.id = ac.accelerator_id JOIN browser AS b ON ac.browser_id = b.id WHERE w.Operating_system LIKE '%Mac%' AND ac.compatible_since_year < 2005;",
    "table_names": [
      "Web_client_accelerator",
      "browser",
      "accelerator_compatible_browser"
    ]
  },
  {
    "id": 513,
    "db_id": "products_gen_characteristics",
    "question": "Which herb products have a high 'Purity' characteristic value?",
    "sql": "SELECT p.product_name FROM Products p JOIN Product_Characteristics pc ON p.product_id = pc.product_id JOIN Characteristics c ON pc.characteristic_id = c.characteristic_id WHERE c.characteristic_type_code = 'Purity' AND pc.product_characteristic_value = 'high' AND p.product_category_code = 'Herbs';",
    "table_names": [
      "Characteristics",
      "Products",
      "Product_Characteristics"
    ]
  },
  {
    "id": 501,
    "db_id": "products_gen_characteristics",
    "question": "What are the names and colors of seed category products with high characteristic value?",
    "sql": "SELECT p.product_name, c.color_description FROM Products p JOIN Ref_Colors c ON p.color_code = c.color_code JOIN Product_Characteristics pc ON p.product_id = pc.product_id WHERE pc.product_characteristic_value = 'high' AND p.product_category_code = 'Seeds';",
    "table_names": [
      "Ref_Colors",
      "Products",
      "Product_Characteristics"
    ]
  },
  {
    "id": 197,
    "db_id": "storm_record",
    "question": "Which regions were affected by the storm with the lowest maximum wind speed?",
    "sql": "SELECT r.Region_name FROM region r JOIN affected_region ar ON r.Region_id = ar.Region_id JOIN storm s ON ar.Storm_ID = s.Storm_ID WHERE s.Max_speed = (SELECT MIN(Max_speed) FROM storm WHERE Storm_ID IN (SELECT Storm_ID FROM affected_region))",
    "table_names": [
      "storm",
      "region",
      "affected_region"
    ]
  },
  {
    "id": 214,
    "db_id": "icfp_1",
    "question": "What is the country of the institution with which author Tim Sheard is affiliated?",
    "sql": "SELECT DISTINCT inst.country FROM Inst inst JOIN Authorship a ON inst.instID = a.instID JOIN Authors auth ON a.authID = auth.authID WHERE auth.lname = 'Sheard' AND auth.fname = 'Tim';",
    "table_names": [
      "Inst",
      "Authors",
      "Authorship"
    ]
  },
  {
    "id": 382,
    "db_id": "club_1",
    "question": "What is the name of the club that has a member from the city with city code 'HOU'?",
    "sql": "SELECT Club.ClubName FROM Club JOIN Member_of_club ON Club.ClubID = Member_of_club.ClubID JOIN Student ON Member_of_club.StuID = Student.StuID WHERE Student.city_code = 'HOU';",
    "table_names": [
      "Student",
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 210,
    "db_id": "icfp_1",
    "question": "Who is the primary author of the paper titled 'Functional Pearl: Modular Rollback through Control Logging'?",
    "sql": "SELECT a.fname, a.lname FROM Authors a JOIN Authorship au ON a.authID = au.authID JOIN Papers p ON p.paperID = au.paperID WHERE p.title = 'Functional Pearl: Modular Rollback through Control Logging' AND au.authOrder = 1;",
    "table_names": [
      "Authors",
      "Papers",
      "Authorship"
    ]
  },
  {
    "id": 540,
    "db_id": "dorm_1",
    "question": "Which dormitory does Sarah Schmidt live in?",
    "sql": "SELECT Dorm.dorm_name FROM Dorm JOIN Lives_in ON Dorm.dormid = Lives_in.dormid JOIN Student ON Lives_in.stuid = Student.StuID WHERE Student.LName = 'Schmidt' AND Student.Fname = 'Sarah';",
    "table_names": [
      "Student",
      "Dorm",
      "Lives_in"
    ]
  },
  {
    "id": 163,
    "db_id": "machine_repair",
    "question": "How many distinct machine series have been repaired by technicians from the team 'NYY'?",
    "sql": "SELECT COUNT(DISTINCT m.Machine_series) FROM machine m JOIN repair_assignment ra ON m.Machine_ID = ra.Machine_ID JOIN technician t ON ra.technician_id = t.technician_id WHERE t.Team = 'NYY';",
    "table_names": [
      "machine",
      "technician",
      "repair_assignment"
    ]
  },
  {
    "id": 439,
    "db_id": "company_office",
    "question": "Which banking companies plan to move into buildings located in Mexico City on or after 2025?",
    "sql": "SELECT c.name FROM Companies c JOIN Office_locations o ON c.id = o.company_id JOIN buildings b ON b.id = o.building_id WHERE b.City = 'Mexico City' AND o.move_in_year >= 2025 AND c.Industry = 'Banking';",
    "table_names": [
      "buildings",
      "Companies",
      "Office_locations"
    ]
  },
  {
    "id": 284,
    "db_id": "college_1",
    "question": "What are the names of departments within the School of 'A&SCI' that have professors whose highest degree is MA?",
    "sql": "SELECT DEPT_NAME FROM DEPARTMENT WHERE DEPT_CODE IN (SELECT DEPT_CODE FROM PROFESSOR WHERE PROF_HIGH_DEGREE='MA') AND SCHOOL_CODE='A&SCI';",
    "table_names": [
      "DEPARTMENT",
      "EMPLOYEE",
      "PROFESSOR"
    ]
  },
  {
    "id": 703,
    "db_id": "student_transcripts_tracking",
    "question": "List the first and last names of students enrolled in a PHD degree program.",
    "sql": "SELECT s.first_name, s.last_name FROM Students s JOIN Student_Enrolment se ON s.student_id = se.student_id JOIN Degree_Programs dp ON se.degree_program_id = dp.degree_program_id WHERE dp.degree_summary_name = 'PHD';",
    "table_names": [
      "Degree_Programs",
      "Students",
      "Student_Enrolment"
    ]
  },
  {
    "id": 270,
    "db_id": "college_1",
    "question": "What is the section number and the extension number of the department office for the class with class code '10020'?",
    "sql": "SELECT CLASS.CLASS_SECTION, DEPARTMENT.DEPT_EXTENSION FROM CLASS JOIN COURSE ON CLASS.CRS_CODE = COURSE.CRS_CODE JOIN DEPARTMENT ON COURSE.DEPT_CODE = DEPARTMENT.DEPT_CODE WHERE CLASS.CLASS_CODE = '10020';",
    "table_names": [
      "CLASS",
      "COURSE",
      "DEPARTMENT"
    ]
  },
  {
    "id": 328,
    "db_id": "mountain_photos",
    "question": "Which mountains have Black/White photos taken using Sigma camera lenses?",
    "sql": "SELECT m.name FROM mountain m WHERE m.id IN (SELECT p.mountain_id FROM photos p JOIN camera_lens cl ON p.camera_lens_id = cl.id WHERE cl.brand = 'Sigma' AND p.color = 'Black/White');",
    "table_names": [
      "mountain",
      "camera_lens",
      "photos"
    ]
  },
  {
    "id": 622,
    "db_id": "school_bus",
    "question": "Which drivers have been working for more than 5 years driving buses for schools located in Honolulu, Hawaii?",
    "sql": "SELECT driver.Name FROM driver JOIN school_bus ON driver.Driver_ID = school_bus.Driver_ID JOIN school ON school_bus.School_ID = school.School_ID WHERE school.Location = 'Honolulu, Hawaii' AND school_bus.Years_Working > 5;",
    "table_names": [
      "driver",
      "school",
      "school_bus"
    ]
  },
  {
    "id": 708,
    "db_id": "world_1",
    "question": "What are the five most populated cities in countries located in Southeast Asia with a life expectancy greater than 72 years?",
    "sql": "SELECT Name FROM city WHERE CountryCode IN (SELECT Code FROM country WHERE Region = 'Southeast Asia' AND LifeExpectancy > 72) ORDER BY Population DESC LIMIT 5;",
    "table_names": [
      "city",
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 542,
    "db_id": "dorm_1",
    "question": "In which dorm does student Linda Smith stay?",
    "sql": "SELECT d.dorm_name FROM Dorm d JOIN Lives_in li ON d.dormid = li.dormid JOIN Student s ON s.StuID = li.stuid WHERE s.LName = 'Smith' AND s.Fname = 'Linda';",
    "table_names": [
      "Student",
      "Dorm",
      "Lives_in"
    ]
  },
  {
    "id": 173,
    "db_id": "movie_1",
    "question": "What is the average rating for movies directed by James Cameron?",
    "sql": "SELECT AVG(Rating.stars) FROM Rating JOIN Movie ON Rating.mID = Movie.mID WHERE Movie.director = 'James Cameron';",
    "table_names": [
      "Movie",
      "Reviewer",
      "Rating"
    ]
  },
  {
    "id": 566,
    "db_id": "dorm_1",
    "question": "How many students who are at least 18 years old are from either Baltimore (BAL) or Pittsburgh (PIT)?",
    "sql": "SELECT COUNT(*) FROM Student WHERE city_code IN ('BAL', 'PIT') AND Age >= 18;",
    "table_names": [
      "Student",
      "Dorm",
      "Dorm_amenity",
      "Has_amenity",
      "Lives_in"
    ]
  },
  {
    "id": 296,
    "db_id": "college_1",
    "question": "What is the name of the department that has multiple professors sharing the same office extension number?",
    "sql": "SELECT DEPT_NAME FROM DEPARTMENT WHERE DEPT_CODE IN (SELECT DEPT_CODE FROM PROFESSOR WHERE PROF_EXTENSION = (SELECT PROF_EXTENSION FROM PROFESSOR GROUP BY PROF_EXTENSION HAVING COUNT(*) > 1 LIMIT 1));",
    "table_names": [
      "DEPARTMENT",
      "EMPLOYEE",
      "PROFESSOR"
    ]
  },
  {
    "id": 448,
    "db_id": "college_3",
    "question": "What is the average grade point of all students advised by advisor 1121?",
    "sql": "SELECT AVG(G.gradepoint) FROM Enrolled_in E JOIN Gradeconversion G ON E.Grade = G.lettergrade WHERE E.StuID IN (SELECT StuID FROM Student WHERE Advisor = 1121)",
    "table_names": [
      "Student",
      "Enrolled_in",
      "Gradeconversion"
    ]
  },
  {
    "id": 142,
    "db_id": "party_people",
    "question": "What is the catalogue number and record format of the release in the region where the party named 'Sinefine Party' held office?",
    "sql": "SELECT region.Catalogue, region.Format FROM region JOIN party ON region.Region_ID = party.Region_ID WHERE party.Party_name = 'Sinefine Party';",
    "table_names": [
      "region",
      "party",
      "party_events"
    ]
  },
  {
    "id": 181,
    "db_id": "movie_1",
    "question": "Which movie rated by Chris Jackson has the highest average star rating and what is that rating?",
    "sql": "SELECT Movie.title, AVG(Rating.stars) as average_rating FROM Movie JOIN Rating ON Movie.mID = Rating.mID JOIN Reviewer ON Reviewer.rID = Rating.rID WHERE Reviewer.name = 'Chris Jackson' GROUP BY Movie.title ORDER BY average_rating DESC LIMIT 1;",
    "table_names": [
      "Movie",
      "Reviewer",
      "Rating"
    ]
  },
  {
    "id": 275,
    "db_id": "college_1",
    "question": "Which courses did the student with the last name 'Smithson' take and get a grade of 'B'?",
    "sql": "SELECT CLASS.CRS_CODE FROM CLASS JOIN ENROLL ON CLASS.CLASS_CODE = ENROLL.CLASS_CODE JOIN STUDENT ON ENROLL.STU_NUM = STUDENT.STU_NUM WHERE STUDENT.STU_LNAME = 'Smithson' AND ENROLL.ENROLL_GRADE = 'B';",
    "table_names": [
      "CLASS",
      "ENROLL",
      "STUDENT"
    ]
  },
  {
    "id": 393,
    "db_id": "club_1",
    "question": "Find the first names and last names of students who are members of clubs located at 'AKW' and major in '600'.",
    "sql": "SELECT s.Fname, s.LName FROM Student s JOIN Member_of_club m ON s.StuID = m.StuID JOIN Club c ON m.ClubID = c.ClubID WHERE c.ClubLocation = 'AKW' AND s.Major = 600;",
    "table_names": [
      "Student",
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 227,
    "db_id": "icfp_1",
    "question": "List all paper titles authored by individuals from institutions in Japan.",
    "sql": "SELECT DISTINCT p.title FROM Papers p JOIN Authorship a ON p.paperID = a.paperID JOIN Inst i ON a.instID = i.instID WHERE i.country = 'Japan';",
    "table_names": [
      "Inst",
      "Papers",
      "Authorship"
    ]
  },
  {
    "id": 334,
    "db_id": "hospital_1",
    "question": "Which patient(s) were prescribed medication by physicians holding the position of Attending Psychiatrist between April 25, 2008 and May 1, 2008?",
    "sql": "SELECT Patient.Name FROM Patient JOIN Prescribes ON Patient.SSN = Prescribes.Patient JOIN Physician ON Prescribes.Physician = Physician.EmployeeID WHERE Physician.Position = 'Attending Psychiatrist' AND Prescribes.Date BETWEEN '2008-04-25' AND '2008-05-01';",
    "table_names": [
      "Physician",
      "Patient",
      "Prescribes"
    ]
  },
  {
    "id": 100,
    "db_id": "small_bank_1",
    "question": "List the names of customers who have more than 50,000 in their savings account and more than 5,000 in their checking account.",
    "sql": "SELECT A.name FROM ACCOUNTS A INNER JOIN SAVINGS S ON A.custid = S.custid INNER JOIN CHECKING C ON A.custid = C.custid WHERE S.balance > 50000 AND C.balance > 5000",
    "table_names": [
      "ACCOUNTS",
      "SAVINGS",
      "CHECKING"
    ]
  },
  {
    "id": 463,
    "db_id": "department_store",
    "question": "Which supplier has the highest total value of purchased Hardware products?",
    "sql": "SELECT s.supplier_name, SUM(ps.total_value_purchased) AS total_value FROM Suppliers s JOIN Product_Suppliers ps ON s.supplier_id = ps.supplier_id JOIN Products p ON ps.product_id = p.product_id WHERE p.product_type_code = 'Hardware' GROUP BY s.supplier_name ORDER BY total_value DESC LIMIT 1;",
    "table_names": [
      "Suppliers",
      "Products",
      "Product_Suppliers"
    ]
  },
  {
    "id": 178,
    "db_id": "movie_1",
    "question": "What is the average rating given in January 2011 by reviewers who rated movies they directed?",
    "sql": "SELECT AVG(R.stars) FROM Rating R JOIN Movie M ON R.mID = M.mID JOIN Reviewer V ON R.rID = V.rID WHERE R.ratingDate BETWEEN '2011-01-01' AND '2011-01-31' AND M.director = V.name;",
    "table_names": [
      "Movie",
      "Reviewer",
      "Rating"
    ]
  },
  {
    "id": 532,
    "db_id": "customers_and_products_contacts",
    "question": "Which customers have lived in addresses located in Virginia before January 1, 2012?",
    "sql": "SELECT c.customer_name FROM Customers c JOIN Customer_Address_History cah ON c.customer_id = cah.customer_id JOIN Addresses a ON cah.address_id = a.address_id WHERE a.state_province_county = 'Virginia' AND cah.date_from < '2012-01-01';",
    "table_names": [
      "Addresses",
      "Customers",
      "Customer_Address_History"
    ]
  },
  {
    "id": 9,
    "db_id": "flight_1",
    "question": "Who are the employees with salary above 200,000 certified to operate aircrafts having distance greater than 6000 miles?",
    "sql": "SELECT e.ename FROM employee e JOIN certificate c ON e.eid = c.eid JOIN aircraft a ON c.aid = a.aid WHERE a.distance > 6000 AND e.salary > 200000;",
    "table_names": [
      "aircraft",
      "employee",
      "certificate"
    ]
  },
  {
    "id": 672,
    "db_id": "car_1",
    "question": "How many distinct car makes have models produced by car makers from country id '2'?",
    "sql": "SELECT COUNT(DISTINCT cn.Make) FROM car_names cn INNER JOIN model_list ml ON cn.Model = ml.Model INNER JOIN car_makers cm ON ml.Maker = cm.Id WHERE cm.Country = '2';",
    "table_names": [
      "car_makers",
      "model_list",
      "car_names",
      "cars_data"
    ]
  },
  {
    "id": 279,
    "db_id": "college_1",
    "question": "What is the total number of credits for all classes conducted by the 'Computer Info. Systems' department in room 'KLR209'?",
    "sql": "SELECT SUM(c.CRS_CREDIT) FROM CLASS cl JOIN COURSE c ON cl.CRS_CODE = c.CRS_CODE JOIN DEPARTMENT d ON c.DEPT_CODE = d.DEPT_CODE WHERE d.DEPT_NAME = 'Computer Info. Systems' AND cl.CLASS_ROOM = 'KLR209';",
    "table_names": [
      "CLASS",
      "COURSE",
      "DEPARTMENT",
      "ENROLL"
    ]
  },
  {
    "id": 488,
    "db_id": "soccer_2",
    "question": "List the names and enrollments of colleges that rejected players who have received a yellow card?",
    "sql": "SELECT College.cName, College.enr FROM College INNER JOIN Tryout ON College.cName = Tryout.cName INNER JOIN Player ON Tryout.pID = Player.pID WHERE Player.yCard = 'yes' AND Tryout.decision = 'no';",
    "table_names": [
      "College",
      "Player",
      "Tryout"
    ]
  },
  {
    "id": 174,
    "db_id": "movie_1",
    "question": "What is the average star rating given by reviewers to the movies they themselves directed?",
    "sql": "SELECT AVG(R.stars) FROM Rating R JOIN Movie M ON R.mID = M.mID JOIN Reviewer V ON R.rID = V.rID WHERE M.director = V.name;",
    "table_names": [
      "Movie",
      "Reviewer",
      "Rating"
    ]
  },
  {
    "id": 323,
    "db_id": "hr_1",
    "question": "What is the first name, last name, and city location of the employee with the highest salary in the Sales department?",
    "sql": "SELECT e.FIRST_NAME, e.LAST_NAME, l.CITY FROM employees e JOIN departments d ON e.DEPARTMENT_ID = d.DEPARTMENT_ID JOIN locations l ON d.LOCATION_ID = l.LOCATION_ID WHERE e.SALARY = (SELECT MAX(SALARY) FROM employees WHERE DEPARTMENT_ID = (SELECT DEPARTMENT_ID FROM departments WHERE DEPARTMENT_NAME = 'Sales'));",
    "table_names": [
      "departments",
      "employees",
      "locations"
    ]
  },
  {
    "id": 424,
    "db_id": "tracking_grants_for_research",
    "question": "List all distinct organisation IDs that have at least one project resulting in a patent.",
    "sql": "SELECT DISTINCT pr.organisation_id FROM Projects pr INNER JOIN Project_Outcomes po ON pr.project_id = po.project_id WHERE po.outcome_code = 'Patent';",
    "table_names": [
      "Project_Outcomes",
      "Projects",
      "Research_Outcomes"
    ]
  },
  {
    "id": 648,
    "db_id": "tracking_orders",
    "question": "Which orders currently on road contain phone products that have already been finished?",
    "sql": "SELECT DISTINCT o.order_id FROM Orders o JOIN Order_Items oi ON o.order_id = oi.order_id JOIN Products p ON oi.product_id = p.product_id WHERE p.product_name = 'phone' AND o.order_status = 'On Road' AND oi.order_item_status = 'Finish';",
    "table_names": [
      "Orders",
      "Products",
      "Order_Items"
    ]
  },
  {
    "id": 14,
    "db_id": "flight_1",
    "question": "Which employee is certified to operate aircrafts having the largest combined flight distance?",
    "sql": "SELECT e.ename, SUM(a.distance) AS total_distance FROM employee e JOIN certificate c ON e.eid = c.eid JOIN aircraft a ON c.aid = a.aid GROUP BY e.eid, e.ename ORDER BY total_distance DESC LIMIT 1",
    "table_names": [
      "aircraft",
      "employee",
      "certificate"
    ]
  },
  {
    "id": 580,
    "db_id": "cre_Theme_park",
    "question": "List the names of tourist attractions visited by the tourist named Marisol.",
    "sql": "SELECT Name FROM Tourist_Attractions WHERE Tourist_Attraction_ID IN (SELECT Tourist_Attraction_ID FROM Visits WHERE Tourist_ID = (SELECT Tourist_ID FROM Visitors WHERE Tourist_Details = 'Marisol'));",
    "table_names": [
      "Visitors",
      "Tourist_Attractions",
      "Visits"
    ]
  },
  {
    "id": 426,
    "db_id": "tracking_grants_for_research",
    "question": "How many distinct staff members have served as project leaders on projects that resulted in a patent?",
    "sql": "SELECT COUNT(DISTINCT ps.staff_id) FROM Project_Staff ps JOIN Project_Outcomes po ON ps.project_id = po.project_id WHERE po.outcome_code = 'Patent' AND ps.role_code = 'leader';",
    "table_names": [
      "Project_Outcomes",
      "Project_Staff",
      "Staff_Roles"
    ]
  },
  {
    "id": 447,
    "db_id": "entertainment_awards",
    "question": "What is the name of the festival and the chairperson associated with the winning artwork of type 'Program Music/Variety Show' in the year 2006?",
    "sql": "SELECT fd.Festival_Name, fd.Chair_Name FROM festival_detail fd JOIN nomination n ON fd.Festival_ID = n.Festival_ID JOIN artwork a ON n.Artwork_ID = a.Artwork_ID WHERE a.Type = 'Program Music/Variety Show' AND fd.Year = 2006 AND n.Result = 'Won';",
    "table_names": [
      "festival_detail",
      "artwork",
      "nomination"
    ]
  },
  {
    "id": 619,
    "db_id": "e_government",
    "question": "How many organizations has the individual with email 'delpha81@example.com' been associated with?",
    "sql": "SELECT i.individual_first_name, i.individual_last_name, COUNT(DISTINCT oci.organization_id) AS total_organizations FROM Individuals i JOIN Organization_Contact_Individuals oci ON i.individual_id = oci.individual_id WHERE i.individual_email = 'delpha81@example.com' GROUP BY i.individual_first_name, i.individual_last_name;",
    "table_names": [
      "Individuals",
      "Organizations",
      "Organization_Contact_Individuals"
    ]
  },
  {
    "id": 293,
    "db_id": "college_1",
    "question": "Find the first names and last names of students who received a 'C' grade in the course QM-261.",
    "sql": "SELECT S.STU_FNAME, S.STU_LNAME FROM STUDENT S JOIN ENROLL E ON S.STU_NUM = E.STU_NUM JOIN CLASS C ON E.CLASS_CODE = C.CLASS_CODE WHERE C.CRS_CODE = 'QM-261' AND E.ENROLL_GRADE = 'C'",
    "table_names": [
      "CLASS",
      "ENROLL",
      "STUDENT"
    ]
  },
  {
    "id": 397,
    "db_id": "club_1",
    "question": "Which student lives in HOU and holds a position in a club located in AKW?",
    "sql": "SELECT s.Fname, s.LName FROM Student s JOIN Member_of_club m ON s.StuID = m.StuID JOIN Club c ON m.ClubID = c.ClubID WHERE c.ClubLocation = 'AKW' AND s.city_code = 'HOU';",
    "table_names": [
      "Student",
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 626,
    "db_id": "scientist_1",
    "question": "What is the total number of hours for all the projects assigned to Carol Smith, David Smith, and Joe Stevens combined?",
    "sql": "SELECT SUM(P.Hours) FROM Projects P INNER JOIN AssignedTo A ON P.Code = A.Project INNER JOIN Scientists S ON A.Scientist = S.SSN WHERE S.Name IN ('Carol Smith', 'David Smith', 'Joe Stevens');",
    "table_names": [
      "Scientists",
      "Projects",
      "AssignedTo"
    ]
  },
  {
    "id": 194,
    "db_id": "storm_record",
    "question": "Which region was affected by the storm leading to the highest number of deaths?",
    "sql": "SELECT r.Region_name FROM storm s JOIN affected_region ar ON s.Storm_ID = ar.Storm_ID JOIN region r ON ar.Region_id = r.Region_id WHERE s.Number_Deaths = (SELECT MAX(Number_Deaths) FROM storm);",
    "table_names": [
      "storm",
      "region",
      "affected_region"
    ]
  },
  {
    "id": 230,
    "db_id": "icfp_1",
    "question": "What institutions have authors who contributed to papers with titles containing the phrase 'CPS Translation'?",
    "sql": "SELECT DISTINCT Inst.name FROM Inst JOIN Authorship ON Inst.instID = Authorship.instID JOIN Papers ON Authorship.paperID = Papers.paperID WHERE Papers.title LIKE '%CPS Translation%';",
    "table_names": [
      "Inst",
      "Papers",
      "Authorship"
    ]
  },
  {
    "id": 581,
    "db_id": "cre_Theme_park",
    "question": "Which tourist visited shuttle-accessible tourist attractions the most number of times?",
    "sql": "SELECT V.Tourist_ID, COUNT(*) AS Visit_Count FROM Visits V JOIN Tourist_Attractions TA ON V.Tourist_Attraction_ID = TA.Tourist_Attraction_ID WHERE TA.How_to_Get_There = 'shuttle' GROUP BY V.Tourist_ID ORDER BY Visit_Count DESC LIMIT 1;",
    "table_names": [
      "Visitors",
      "Tourist_Attractions",
      "Visits"
    ]
  },
  {
    "id": 349,
    "db_id": "hospital_1",
    "question": "Which physicians have an active certification in 2008 for procedures that cost more than $5000?",
    "sql": "SELECT p.Name FROM Physician p JOIN Trained_In t ON p.EmployeeID = t.Physician JOIN Procedures pr ON t.Treatment = pr.Code WHERE pr.Cost > 5000 AND t.CertificationExpires >= '2008-01-01' AND t.CertificationExpires <= '2008-12-31';",
    "table_names": [
      "Physician",
      "Procedures",
      "Trained_In"
    ]
  },
  {
    "id": 594,
    "db_id": "customers_and_addresses",
    "question": "What is the state_province_county of the residence address for the customer who uses Cheque as a payment method and became a customer most recently?",
    "sql": "SELECT A.state_province_county FROM Addresses A JOIN Customer_Addresses CA ON A.address_id = CA.address_id JOIN Customers C ON CA.customer_id = C.customer_id WHERE C.payment_method = 'Cheque' AND CA.address_type = 'Residential' ORDER BY C.date_became_customer DESC LIMIT 1;",
    "table_names": [
      "Addresses",
      "Customers",
      "Customer_Addresses"
    ]
  },
  {
    "id": 128,
    "db_id": "school_finance",
    "question": "What is the average endowment amount for schools that have had budgets invested at more than 100 percent after the year 2002?",
    "sql": "SELECT AVG(e.amount) FROM endowment e WHERE e.School_id IN (SELECT s.School_id FROM School s JOIN budget b ON s.School_id = b.School_id WHERE b.Year > 2002 AND b.Budget_invested_percent > 100);",
    "table_names": [
      "School",
      "budget",
      "endowment"
    ]
  },
  {
    "id": 670,
    "db_id": "pets_1",
    "question": "What is the average age of pets owned by students who are from the city with code 'HKG'?",
    "sql": "SELECT AVG(Pets.pet_age) FROM Student JOIN Has_Pet ON Student.StuID = Has_Pet.StuID JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE Student.city_code = 'HKG';",
    "table_names": [
      "Student",
      "Has_Pet",
      "Pets"
    ]
  },
  {
    "id": 205,
    "db_id": "restaurant_1",
    "question": "What is the major and the last name of the student who visited restaurant 'Honeygrow', and how much did they spend?",
    "sql": "SELECT Student.Major, Student.LName, Visits_Restaurant.Spent FROM Student JOIN Visits_Restaurant ON Student.StuID = Visits_Restaurant.StuID JOIN Restaurant ON Visits_Restaurant.ResID = Restaurant.ResID WHERE Restaurant.ResName = 'Honeygrow';",
    "table_names": [
      "Student",
      "Restaurant",
      "Visits_Restaurant"
    ]
  },
  {
    "id": 570,
    "db_id": "customer_complaints",
    "question": "What is the last name and phone number of the staff member who handled the most complaints about the product named 'Chocolate'?",
    "sql": "SELECT s.last_name, s.phone_number FROM Staff s JOIN Complaints c ON s.staff_id = c.staff_id JOIN Products p ON c.product_id = p.product_id WHERE p.product_name = 'Chocolate' GROUP BY s.staff_id ORDER BY COUNT(c.complaint_id) DESC LIMIT 1;",
    "table_names": [
      "Staff",
      "Products",
      "Complaints"
    ]
  },
  {
    "id": 114,
    "db_id": "small_bank_1",
    "question": "Which account holders have savings balance greater than 50000 but checking account balance less than 5000?",
    "sql": "SELECT a.name FROM ACCOUNTS a JOIN SAVINGS s ON a.custid = s.custid JOIN CHECKING c ON a.custid = c.custid WHERE s.balance > 50000 AND c.balance < 5000;",
    "table_names": [
      "ACCOUNTS",
      "SAVINGS",
      "CHECKING"
    ]
  },
  {
    "id": 125,
    "db_id": "browser_web",
    "question": "Which browsers are compatible with web accelerators that support Mac operating systems, where the compatibility was established from the year 2008 or later?",
    "sql": "SELECT browser.name FROM browser JOIN accelerator_compatible_browser ON browser.id = accelerator_compatible_browser.browser_id JOIN Web_client_accelerator ON accelerator_compatible_browser.accelerator_id = Web_client_accelerator.id WHERE Web_client_accelerator.Operating_system LIKE '%Mac%' AND accelerator_compatible_browser.compatible_since_year >= 2008;",
    "table_names": [
      "Web_client_accelerator",
      "browser",
      "accelerator_compatible_browser"
    ]
  },
  {
    "id": 268,
    "db_id": "college_1",
    "question": "Who is the earliest hired professor in the School of Business, and what is the highest degree they hold?",
    "sql": "SELECT E.EMP_FNAME, E.EMP_LNAME, E.EMP_HIREDATE, P.PROF_HIGH_DEGREE FROM EMPLOYEE E INNER JOIN PROFESSOR P ON E.EMP_NUM = P.EMP_NUM INNER JOIN DEPARTMENT D ON P.DEPT_CODE = D.DEPT_CODE WHERE D.SCHOOL_CODE = 'BUS' AND EMP_JOBCODE = 'PROF' ORDER BY E.EMP_HIREDATE ASC LIMIT 1",
    "table_names": [
      "DEPARTMENT",
      "EMPLOYEE",
      "PROFESSOR"
    ]
  },
  {
    "id": 595,
    "db_id": "customers_and_addresses",
    "question": "Which customers paying with a credit card have an address located in Colorado?",
    "sql": "SELECT Customers.customer_name FROM Customers JOIN Customer_Addresses ON Customers.customer_id = Customer_Addresses.customer_id JOIN Addresses ON Customer_Addresses.address_id = Addresses.address_id WHERE Addresses.state_province_county = 'Colorado' AND customers.payment_method = 'Credit Card';",
    "table_names": [
      "Addresses",
      "Customers",
      "Customer_Addresses"
    ]
  },
  {
    "id": 221,
    "db_id": "icfp_1",
    "question": "What is the name of the institution associated with the author Matthias Blume?",
    "sql": "SELECT name FROM Inst WHERE instID = (SELECT instID FROM Authorship WHERE authID = (SELECT authID FROM Authors WHERE fname = 'Matthias' AND lname = 'Blume'));",
    "table_names": [
      "Inst",
      "Authors",
      "Authorship"
    ]
  },
  {
    "id": 521,
    "db_id": "products_gen_characteristics",
    "question": "What is the average selling price of products associated with the characteristic 'fast', grouped by color description?",
    "sql": "SELECT rc.color_description, AVG(CAST(p.typical_selling_price AS FLOAT)) AS AvgSellingPrice FROM Products p JOIN Ref_Colors rc ON p.color_code = rc.color_code JOIN Characteristics c ON p.product_description = c.characteristic_data_type WHERE c.characteristic_name='fast' GROUP BY rc.color_description",
    "table_names": [
      "Ref_Colors",
      "Characteristics",
      "Products",
      "Product_Characteristics"
    ]
  },
  {
    "id": 692,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "Which template type description has the document with the highest version number?",
    "sql": "SELECT rt.Template_Type_Description, MAX(t.Version_Number) FROM Ref_Template_Types rt JOIN Templates t ON rt.Template_Type_Code = t.Template_Type_Code JOIN Documents d ON t.Template_ID = d.Template_ID GROUP BY rt.Template_Type_Description ORDER BY MAX(t.Version_Number) DESC LIMIT 1;",
    "table_names": [
      "Ref_Template_Types",
      "Templates",
      "Documents"
    ]
  },
  {
    "id": 162,
    "db_id": "machine_repair",
    "question": "Which machine team has the highest average value points among machines serviced by technicians older than 40 years?",
    "sql": "SELECT m.Team, AVG(m.value_points) AS Average_Value_Points FROM machine m JOIN repair_assignment r ON m.Machine_ID = r.Machine_ID JOIN technician t ON r.technician_id = t.technician_id WHERE t.Age > 40 GROUP BY m.Team ORDER BY Average_Value_Points DESC LIMIT 1;",
    "table_names": [
      "machine",
      "technician",
      "repair_assignment"
    ]
  },
  {
    "id": 330,
    "db_id": "insurance_policies",
    "question": "What is the total amount settled in claims made by customers who have a 'Travel' type policy?",
    "sql": "SELECT SUM(c.Amount_Settled) FROM Claims c JOIN Customer_Policies cp ON c.Policy_ID = cp.Policy_ID WHERE cp.Policy_Type_Code = 'Travel';",
    "table_names": [
      "Customers",
      "Customer_Policies",
      "Claims"
    ]
  },
  {
    "id": 536,
    "db_id": "dorm_1",
    "question": "Which dorms have 'Air Conditioning' and a student capacity greater than the average capacity of all dormitories?",
    "sql": "SELECT dorm_name FROM Dorm WHERE dormid IN (SELECT dormid FROM Has_amenity WHERE amenid = (SELECT amenid FROM Dorm_amenity WHERE amenity_name = 'Air Conditioning')) AND student_capacity > (SELECT AVG(student_capacity) FROM Dorm);",
    "table_names": [
      "Dorm",
      "Dorm_amenity",
      "Has_amenity"
    ]
  },
  {
    "id": 664,
    "db_id": "pets_1",
    "question": "What is the average age of pets owned by students living in the city coded 'HKG'?",
    "sql": "SELECT AVG(p.pet_age) FROM Student s JOIN Has_Pet hp ON s.StuID = hp.StuID JOIN Pets p ON hp.PetID = p.PetID WHERE s.city_code = 'HKG';",
    "table_names": [
      "Student",
      "Has_Pet",
      "Pets"
    ]
  },
  {
    "id": 103,
    "db_id": "small_bank_1",
    "question": "Which customer(s) have savings account balance greater than 50000 and checking account balance of at least 10000?",
    "sql": "SELECT a.name FROM ACCOUNTS a JOIN SAVINGS s ON a.custid = s.custid JOIN CHECKING c ON a.custid = c.custid WHERE s.balance > 50000 AND c.balance >= 10000",
    "table_names": [
      "ACCOUNTS",
      "SAVINGS",
      "CHECKING"
    ]
  },
  {
    "id": 12,
    "db_id": "flight_1",
    "question": "Which employee has certificates for aircraft with the highest average flight distance, and what is this average distance?",
    "sql": "SELECT e.ename, AVG(a.distance) as avg_distance FROM employee e JOIN certificate c ON e.eid = c.eid JOIN aircraft a ON c.aid = a.aid GROUP BY e.eid, e.ename ORDER BY avg_distance DESC LIMIT 1;",
    "table_names": [
      "aircraft",
      "employee",
      "certificate"
    ]
  },
  {
    "id": 237,
    "db_id": "icfp_1",
    "question": "What is the title of the paper authored by 'Stephanie Weirich', and what is the country of the institution named 'University of Pennsylvania'?",
    "sql": "SELECT P.title, I.country FROM Papers P, Authors A, Inst I WHERE A.fname = 'Stephanie' AND A.lname = 'Weirich' AND I.name = 'University of Pennsylvania';",
    "table_names": [
      "Inst",
      "Authors",
      "Papers",
      "Authorship"
    ]
  },
  {
    "id": 102,
    "db_id": "small_bank_1",
    "question": "Which customers have more than $100,000 in their savings accounts and at least $5,000 in their checking accounts?",
    "sql": "SELECT A.name FROM ACCOUNTS A JOIN SAVINGS S ON A.custid = S.custid JOIN CHECKING C ON A.custid = C.custid WHERE S.balance > 100000 AND C.balance >= 5000;",
    "table_names": [
      "ACCOUNTS",
      "SAVINGS",
      "CHECKING"
    ]
  },
  {
    "id": 95,
    "db_id": "riding_club",
    "question": "Which players are coached by the top-ranked coach?",
    "sql": "SELECT Player_name FROM player WHERE Player_ID IN (SELECT Player_ID FROM player_coach WHERE Coach_ID IN (SELECT Coach_ID FROM coach WHERE Rank = 1));",
    "table_names": [
      "player",
      "coach",
      "player_coach"
    ]
  },
  {
    "id": 76,
    "db_id": "college_2",
    "question": "Find the name of students who didn't take any course from Biology department.",
    "sql": "SELECT name FROM student WHERE id NOT IN (SELECT T1.id FROM takes AS T1 JOIN course AS T2 ON T1.course_id  =  T2.course_id WHERE T2.dept_name  =  'Biology')",
    "table_names": [
      "course",
      "student",
      "takes"
    ]
  },
  {
    "id": 710,
    "db_id": "world_1",
    "question": "Return the different names of cities that are in Asia and for which Chinese is the official language.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "city",
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 490,
    "db_id": "device",
    "question": "What is the total quantity in stock of devices running Android software platform in shops opened from year 2010 onwards?",
    "sql": "SELECT SUM(s.Quantity) FROM stock s JOIN device d ON s.Device_ID = d.Device_ID JOIN shop sh ON s.Shop_ID = sh.Shop_ID WHERE d.Software_Platform = 'Android' AND sh.Open_Year >= 2010;",
    "table_names": [
      "device",
      "shop",
      "stock"
    ]
  },
  {
    "id": 315,
    "db_id": "hr_1",
    "question": "Which employees working in departments located in the United States of America earn a salary higher than 10,000?",
    "sql": "SELECT e.FIRST_NAME, e.LAST_NAME, e.SALARY FROM employees e JOIN departments d ON e.DEPARTMENT_ID = d.DEPARTMENT_ID JOIN countries c ON d.LOCATION_ID = c.REGION_ID WHERE c.COUNTRY_NAME = 'United States of America' AND e.SALARY > 10000;",
    "table_names": [
      "countries",
      "departments",
      "employees",
      "locations"
    ]
  },
  {
    "id": 253,
    "db_id": "sakila_1",
    "question": "Return the title and inventory id of the film that is rented most often.",
    "sql": "SELECT T1.title ,  T2.inventory_id FROM film AS T1 JOIN inventory AS T2 ON T1.film_id  =  T2.film_id JOIN rental AS T3 ON T2.inventory_id  =  T3.inventory_id GROUP BY T2.inventory_id ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "film",
      "inventory",
      "rental"
    ]
  },
  {
    "id": 60,
    "db_id": "performance_attendance",
    "question": "Who are the members who performed in the performance with the highest audience attendance?",
    "sql": "SELECT m.Name FROM member m JOIN member_attendance ma ON m.Member_ID = ma.Member_ID JOIN performance p ON ma.Performance_ID = p.Performance_ID WHERE p.Attendance = (SELECT MAX(Attendance) FROM performance);",
    "table_names": [
      "member",
      "performance",
      "member_attendance"
    ]
  },
  {
    "id": 510,
    "db_id": "products_gen_characteristics",
    "question": "How many distinct products from the category 'Seeds' have a characteristic type 'Grade' with a characteristic value of 'high'?",
    "sql": "SELECT COUNT(DISTINCT pc.product_id) FROM Product_Characteristics pc JOIN Characteristics c ON pc.characteristic_id = c.characteristic_id JOIN Products p ON pc.product_id = p.product_id WHERE c.characteristic_type_code = 'Grade' AND pc.product_characteristic_value = 'high' AND p.product_category_code = 'Seeds';",
    "table_names": [
      "Characteristics",
      "Products",
      "Product_Characteristics"
    ]
  },
  {
    "id": 469,
    "db_id": "aircraft",
    "question": "Which airport having more than 10 million passengers annually operates the helicopter with the highest maximum disk loading, and what is the helicopter's name and its maximum disk loading?",
    "sql": "SELECT airport.Airport_Name, aircraft.Aircraft, aircraft.Max_disk_Loading FROM airport JOIN airport_aircraft ON airport.Airport_ID = airport_aircraft.Airport_ID JOIN aircraft ON aircraft.Aircraft_ID = airport_aircraft.Aircraft_ID WHERE airport.Total_Passengers > 10000000 ORDER BY aircraft.Max_disk_Loading DESC LIMIT 1;",
    "table_names": [
      "aircraft",
      "airport",
      "airport_aircraft"
    ]
  },
  {
    "id": 209,
    "db_id": "icfp_1",
    "question": "List the titles of papers authored or co-authored by Ralf Hinze.",
    "sql": "SELECT title FROM Papers WHERE paperID IN (SELECT paperID FROM Authorship WHERE authID = (SELECT authID FROM Authors WHERE fname = 'Ralf' AND lname = 'Hinze'))",
    "table_names": [
      "Authors",
      "Papers",
      "Authorship"
    ]
  },
  {
    "id": 433,
    "db_id": "document_management",
    "question": "What is the most accessed book document that belongs to the 'Acknowledgement' functional area?",
    "sql": "SELECT D.document_name FROM Documents D JOIN Document_Functional_Areas DFA ON D.document_code = DFA.document_code JOIN Functional_Areas FA ON DFA.functional_area_code = FA.functional_area_code WHERE FA.functional_area_description = 'Acknowledgement' AND D.document_type_code = 'Book' ORDER BY D.access_count DESC LIMIT 1;",
    "table_names": [
      "Functional_Areas",
      "Documents",
      "Document_Functional_Areas"
    ]
  },
  {
    "id": 212,
    "db_id": "icfp_1",
    "question": "Who are the authors of the paper titled 'Functional Pearl: Modular Rollback through Control Logging'?",
    "sql": "SELECT fname, lname FROM Authors WHERE authID IN (SELECT authID FROM Authorship WHERE paperID IN (SELECT paperID FROM Papers WHERE title = 'Functional Pearl: Modular Rollback through Control Logging'));",
    "table_names": [
      "Authors",
      "Papers",
      "Authorship"
    ]
  },
  {
    "id": 183,
    "db_id": "party_host",
    "question": "What is the average age of main hosts who have hosted parties located at Heineken Music Hall Amsterdam?",
    "sql": "SELECT AVG(h.Age) FROM host h JOIN party_host ph ON h.Host_ID = ph.Host_ID JOIN party p ON ph.Party_ID = p.Party_ID WHERE p.Location LIKE '%Heineken Music Hall Amsterdam%' AND ph.Is_Main_in_Charge = 'T';",
    "table_names": [
      "party",
      "host",
      "party_host"
    ]
  },
  {
    "id": 563,
    "db_id": "dorm_1",
    "question": "How many different amenities are available in dorms that allow pets?",
    "sql": "SELECT COUNT(DISTINCT amenid) FROM Has_amenity WHERE dormid IN (SELECT dormid FROM Has_amenity WHERE amenid = (SELECT amenid FROM Dorm_amenity WHERE amenity_name = 'Allows Pets'));",
    "table_names": [
      "Student",
      "Dorm_amenity",
      "Has_amenity",
      "Lives_in"
    ]
  },
  {
    "id": 565,
    "db_id": "dorm_1",
    "question": "How many students under 20 years old are assigned to dorms that offer a kitchen in every room?",
    "sql": "SELECT COUNT(DISTINCT s.StuID) FROM Student s JOIN Has_amenity ha ON s.StuID = ha.dormid JOIN Dorm_amenity da ON ha.amenid = da.amenid WHERE da.amenity_name = 'Kitchen in Every Room' AND s.Age < 20;",
    "table_names": [
      "Student",
      "Dorm_amenity",
      "Has_amenity",
      "Lives_in"
    ]
  },
  {
    "id": 539,
    "db_id": "dorm_1",
    "question": "Which dorms have both 'Study Room' and 'Ethernet Ports' amenities, and among those, what is the maximum student capacity?",
    "sql": "SELECT MAX(D.student_capacity) FROM Dorm D JOIN Has_amenity HA1 ON D.dormid = HA1.dormid JOIN Dorm_amenity DA1 ON HA1.amenid = DA1.amenid JOIN Has_amenity HA2 ON D.dormid = HA2.dormid JOIN Dorm_amenity DA2 ON HA2.amenid = DA2.amenid WHERE DA1.amenity_name = 'Study Room' AND DA2.amenity_name = 'Ethernet Ports';",
    "table_names": [
      "Dorm",
      "Dorm_amenity",
      "Has_amenity"
    ]
  },
  {
    "id": 87,
    "db_id": "insurance_and_eClaims",
    "question": "What is the Claim Header ID of the settled 'Overtime Meal Subsidy' claim for the customer named Buddy Marquardt?",
    "sql": "SELECT ch.Claim_Header_ID FROM Customers c JOIN Policies p ON c.Customer_ID = p.Customer_ID JOIN Claim_Headers ch ON p.Policy_ID = ch.Policy_ID WHERE c.Customer_Details = 'Buddy Marquardt' AND ch.Claim_Status_Code = 'Settled' AND ch.Claim_Type_Code = 'Overtime Meal Subsidy';",
    "table_names": [
      "Customers",
      "Policies",
      "Claim_Headers"
    ]
  },
  {
    "id": 472,
    "db_id": "aircraft",
    "question": "Which airport has an aircraft associated with it that has the maximum gross weight among all aircraft?",
    "sql": "SELECT a.Airport_Name FROM airport AS a JOIN airport_aircraft AS aa ON a.Airport_ID = aa.Airport_ID JOIN aircraft AS ac ON aa.Aircraft_ID = ac.Aircraft_ID WHERE ac.Max_Gross_Weight = (SELECT MAX(Max_Gross_Weight) FROM aircraft);",
    "table_names": [
      "aircraft",
      "airport",
      "airport_aircraft"
    ]
  },
  {
    "id": 428,
    "db_id": "tracking_grants_for_research",
    "question": "How many distinct grants have documents classified as 'Initial Application' and have a grant amount greater than 1000?",
    "sql": "SELECT COUNT(DISTINCT Documents.grant_id) FROM Documents INNER JOIN Document_Types ON Documents.document_type_code = Document_Types.document_type_code INNER JOIN Grants ON Documents.grant_id = Grants.grant_id WHERE Document_Types.document_description = 'Initial Application' AND Grants.grant_amount > 1000;",
    "table_names": [
      "Document_Types",
      "Documents",
      "Grants"
    ]
  },
  {
    "id": 395,
    "db_id": "club_1",
    "question": "Which students who are younger than 18 are members of the club 'Bootup Baltimore'?",
    "sql": "SELECT s.Fname, s.LName FROM Student s JOIN Member_of_club mc ON s.StuID = mc.StuID JOIN Club c ON mc.ClubID = c.ClubID WHERE c.ClubName = 'Bootup Baltimore' AND s.Age < 18;",
    "table_names": [
      "Student",
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 18,
    "db_id": "allergy_1",
    "question": "How many distinct students older than 18 have allergies classified as animal-related?",
    "sql": "SELECT COUNT(DISTINCT ha.StuID) FROM Has_Allergy ha JOIN Allergy_Type at ON ha.Allergy = at.Allergy JOIN Student s ON ha.StuID = s.StuID WHERE at.AllergyType = 'animal' AND s.Age > 18;",
    "table_names": [
      "Allergy_Type",
      "Has_Allergy",
      "Student"
    ]
  },
  {
    "id": 308,
    "db_id": "college_1",
    "question": "Who teaches the class of CIS-220 section 2, and also leads a department?",
    "sql": "SELECT E.EMP_FNAME, E.EMP_LNAME FROM EMPLOYEE E JOIN CLASS C ON E.EMP_NUM = C.PROF_NUM JOIN DEPARTMENT D ON D.EMP_NUM = E.EMP_NUM WHERE C.CLASS_SECTION = '2' AND C.CRS_CODE = 'CIS-220';",
    "table_names": [
      "CLASS",
      "DEPARTMENT",
      "EMPLOYEE",
      "PROFESSOR"
    ]
  },
  {
    "id": 88,
    "db_id": "insurance_and_eClaims",
    "question": "What is the total amount paid for 'Child Birth' claims associated with the customer named 'Buddy Marquardt'?",
    "sql": "SELECT SUM(CH.Amount_Piad) FROM Claim_Headers CH JOIN Policies P ON CH.Policy_ID = P.Policy_ID JOIN Customers C ON P.Customer_ID = C.Customer_ID WHERE C.Customer_Details = 'Buddy Marquardt' AND CH.Claim_Type_Code = 'Child Birth';",
    "table_names": [
      "Customers",
      "Policies",
      "Claim_Headers"
    ]
  },
  {
    "id": 507,
    "db_id": "products_gen_characteristics",
    "question": "Which herbs have a high purity characteristic?",
    "sql": "SELECT P.product_name FROM Products P JOIN Product_Characteristics PC ON P.product_id = PC.product_id JOIN Characteristics C ON PC.characteristic_id = C.characteristic_id WHERE C.characteristic_type_code = 'Purity' AND PC.product_characteristic_value = 'high' AND P.product_category_code = 'Herbs';",
    "table_names": [
      "Characteristics",
      "Products",
      "Product_Characteristics"
    ]
  },
  {
    "id": 667,
    "db_id": "pets_1",
    "question": "Which student's pet has the greatest weight, and what type of pet is it?",
    "sql": "SELECT S.Fname, S.LName, P.PetType FROM Student S JOIN Has_Pet HP ON S.StuID = HP.StuID JOIN Pets P ON HP.PetID = P.PetID ORDER BY P.weight DESC LIMIT 1;",
    "table_names": [
      "Student",
      "Has_Pet",
      "Pets"
    ]
  },
  {
    "id": 386,
    "db_id": "club_1",
    "question": "What are the first and last names of students who live in city 'BAL' and the names of the clubs they are members of?",
    "sql": "SELECT Student.Fname, Student.LName, Club.ClubName FROM Student JOIN Member_of_club ON Student.StuID = Member_of_club.StuID JOIN Club ON Member_of_club.ClubID = Club.ClubID WHERE Student.city_code = 'BAL';",
    "table_names": [
      "Student",
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 316,
    "db_id": "hr_1",
    "question": "Who is the highest paid employee in the Sales department located in the UK?",
    "sql": "SELECT employees.FIRST_NAME, employees.LAST_NAME FROM employees JOIN departments ON employees.DEPARTMENT_ID = departments.DEPARTMENT_ID JOIN locations ON departments.LOCATION_ID = locations.LOCATION_ID WHERE departments.DEPARTMENT_NAME = 'Sales' AND locations.COUNTRY_ID = 'UK' AND employees.SALARY = (SELECT MAX(employees.SALARY) FROM employees JOIN departments ON employees.DEPARTMENT_ID = departments.DEPARTMENT_ID JOIN locations ON departments.LOCATION_ID = locations.LOCATION_ID WHERE departments.DEPARTMENT_NAME = 'Sales' AND locations.COUNTRY_ID = 'UK');",
    "table_names": [
      "departments",
      "employees",
      "locations"
    ]
  },
  {
    "id": 244,
    "db_id": "icfp_1",
    "question": "In which country is the institution located whose author is the first author of the paper 'Functional Pearl: Modular Rollback through Control Logging'?",
    "sql": "SELECT Inst.country FROM Inst JOIN Authorship ON Inst.instID = Authorship.instID JOIN Papers ON Authorship.paperID = Papers.paperID WHERE Papers.title='Functional Pearl: Modular Rollback through Control Logging' AND Authorship.authOrder=1;",
    "table_names": [
      "Inst",
      "Papers",
      "Authorship"
    ]
  },
  {
    "id": 311,
    "db_id": "college_1",
    "question": "At what time is the 'QM-261' class attended by student with the last name 'Bowser' scheduled?",
    "sql": "SELECT CLASS.CLASS_TIME FROM CLASS JOIN ENROLL ON CLASS.CLASS_CODE = ENROLL.CLASS_CODE JOIN STUDENT ON ENROLL.STU_NUM = STUDENT.STU_NUM WHERE STUDENT.STU_LNAME = 'Bowser' AND CLASS.CRS_CODE = 'QM-261';",
    "table_names": [
      "CLASS",
      "ENROLL",
      "STUDENT"
    ]
  },
  {
    "id": 673,
    "db_id": "car_1",
    "question": "What is the full name of the car maker for the car model 'honda civic cvcc'?",
    "sql": "SELECT DISTINCT cm.FullName FROM car_makers cm JOIN model_list ml ON cm.Id = ml.Maker JOIN car_names cn ON ml.Model = cn.Model WHERE cn.Make = 'honda civic cvcc';",
    "table_names": [
      "car_makers",
      "model_list",
      "car_names",
      "cars_data"
    ]
  },
  {
    "id": 94,
    "db_id": "riding_club",
    "question": "Which female player from Winnipeg started training with the highest-ranked coach and what is her occupation?",
    "sql": "SELECT p.Player_name, p.Occupation FROM player p JOIN player_coach pc ON p.Player_ID = pc.Player_ID JOIN coach c ON pc.Coach_ID = c.Coach_ID WHERE p.Gender = 'F' AND p.Residence = 'Winnipeg' ORDER BY c.Rank ASC LIMIT 1;",
    "table_names": [
      "player",
      "coach",
      "player_coach"
    ]
  },
  {
    "id": 146,
    "db_id": "local_govt_in_alabama",
    "question": "Which type of service experienced the most failed events?",
    "sql": "SELECT s.Service_Type_Code, COUNT(e.Event_ID) AS Total_Failures FROM Services s JOIN Events e ON s.Service_ID = e.Service_ID WHERE e.Event_Details = 'Fail' GROUP BY s.Service_Type_Code ORDER BY Total_Failures DESC LIMIT 1;",
    "table_names": [
      "Services",
      "Participants",
      "Events",
      "Participants_in_Events"
    ]
  },
  {
    "id": 74,
    "db_id": "college_2",
    "question": "What are the titles of the courses along with building names and room numbers for courses held in Fall 2005 in classrooms with a capacity greater than 50?",
    "sql": "SELECT cr.title, cl.building, cl.room_number FROM course AS cr JOIN section AS se ON cr.course_id = se.course_id JOIN classroom AS cl ON se.building = cl.building AND se.room_number = cl.room_number WHERE se.semester = 'Fall' AND se.year = 2005 AND cl.capacity > 50;",
    "table_names": [
      "classroom",
      "course",
      "section"
    ]
  },
  {
    "id": 196,
    "db_id": "storm_record",
    "question": "Which regions have been affected by storms with a maximum speed below 980 and had more than 20 cities affected?",
    "sql": "SELECT r.Region_name FROM region r JOIN affected_region ar ON r.Region_id = ar.Region_id JOIN storm s ON ar.Storm_ID = s.Storm_ID WHERE s.Max_speed < 980 AND ar.Number_city_affected > 20;",
    "table_names": [
      "storm",
      "region",
      "affected_region"
    ]
  },
  {
    "id": 571,
    "db_id": "customer_complaints",
    "question": "Which staff member handled the highest number of complaints related to food products and how many complaints did they handle?",
    "sql": "SELECT s.first_name, s.last_name, COUNT(c.complaint_id) as total_complaints FROM Staff s JOIN Complaints c ON s.staff_id = c.staff_id JOIN Products p ON c.product_id = p.product_id WHERE p.product_category_code = 'Food' GROUP BY s.staff_id ORDER BY total_complaints DESC LIMIT 1;",
    "table_names": [
      "Staff",
      "Products",
      "Complaints"
    ]
  },
  {
    "id": 22,
    "db_id": "allergy_1",
    "question": "How many students under 20 years old have allergies categorized as 'animal'?",
    "sql": "SELECT COUNT(DISTINCT s.StuID) FROM Student s JOIN Has_Allergy ha ON s.StuID = ha.StuID JOIN Allergy_Type at ON ha.Allergy = at.Allergy WHERE s.Age < 20 AND at.AllergyType = 'animal';",
    "table_names": [
      "Allergy_Type",
      "Has_Allergy",
      "Student"
    ]
  },
  {
    "id": 638,
    "db_id": "activity_1",
    "question": "How many distinct faculty members in the NEB building participate in Canasta?",
    "sql": "SELECT COUNT(DISTINCT fp.FacID) FROM Faculty_Participates_in fp JOIN Faculty f ON fp.FacID = f.FacID JOIN Activity a ON fp.actid = a.actid WHERE f.Building = 'NEB' AND a.activity_name = 'Canasta';",
    "table_names": [
      "Activity",
      "Faculty_Participates_in",
      "Faculty"
    ]
  },
  {
    "id": 504,
    "db_id": "products_gen_characteristics",
    "question": "What are the names of products having a high level of 'Purity' characteristic?",
    "sql": "SELECT p.product_name FROM Products p JOIN Product_Characteristics pc ON p.product_id = pc.product_id JOIN Characteristics c ON pc.characteristic_id = c.characteristic_id WHERE c.characteristic_type_code = 'Purity' AND pc.product_characteristic_value = 'high';",
    "table_names": [
      "Characteristics",
      "Products",
      "Product_Characteristics"
    ]
  },
  {
    "id": 368,
    "db_id": "company_employee",
    "question": "Which company with the highest market value employs individuals who graduated from Northeastern?",
    "sql": "SELECT company.Name FROM company JOIN employment ON company.Company_ID = employment.Company_ID JOIN people ON employment.People_ID = people.People_ID WHERE people.Graduation_College = 'Northeastern' ORDER BY company.Market_Value_in_Billion DESC LIMIT 1;",
    "table_names": [
      "people",
      "company",
      "employment"
    ]
  },
  {
    "id": 569,
    "db_id": "customer_complaints",
    "question": "What are the email addresses of the customers who have an open complaint about a hardware product?",
    "sql": "SELECT c.email_address FROM Customers c JOIN Complaints co ON c.customer_id = co.customer_id JOIN Products p ON co.product_id = p.product_id WHERE p.product_category_code = 'Hardware' AND co.complaint_status_code = 'Open';",
    "table_names": [
      "Customers",
      "Products",
      "Complaints"
    ]
  },
  {
    "id": 26,
    "db_id": "allergy_1",
    "question": "How many students from PIT city have food-related allergies?",
    "sql": "SELECT COUNT(DISTINCT HA.StuID) FROM Has_Allergy HA JOIN Allergy_Type AT ON HA.Allergy = AT.Allergy JOIN Student S ON HA.StuID = S.StuID WHERE AT.AllergyType = 'food' AND S.city_code = 'PIT';",
    "table_names": [
      "Allergy_Type",
      "Has_Allergy",
      "Student"
    ]
  },
  {
    "id": 583,
    "db_id": "cre_Theme_park",
    "question": "Which visitor visited the highest number of distinct tourist attractions reachable by bus, and how many attractions did they visit?",
    "sql": "SELECT Visitors.Tourist_Details, COUNT(DISTINCT Visits.Tourist_Attraction_ID) AS Num_Distinct_Attractions FROM Visitors JOIN Visits ON Visitors.Tourist_ID = Visits.Tourist_ID JOIN Tourist_Attractions ON Visits.Tourist_Attraction_ID = Tourist_Attractions.Tourist_Attraction_ID WHERE Tourist_Attractions.How_to_Get_There = 'bus' GROUP BY Visitors.Tourist_Details ORDER BY Num_Distinct_Attractions DESC LIMIT 1;",
    "table_names": [
      "Visitors",
      "Tourist_Attractions",
      "Visits"
    ]
  },
  {
    "id": 675,
    "db_id": "car_1",
    "question": "How many distinct makers produced cars with models having an MPG greater than 30 in the year 1982?",
    "sql": "SELECT COUNT(DISTINCT ml.Maker) FROM model_list ml INNER JOIN car_names cn ON ml.Model = cn.Model INNER JOIN cars_data cd ON cn.MakeId = cd.Id WHERE cd.Year = 1982 AND cd.MPG > 30;",
    "table_names": [
      "model_list",
      "car_names",
      "cars_data"
    ]
  },
  {
    "id": 286,
    "db_id": "college_1",
    "question": "List the first name, last name, and highest academic degree of professors working in departments affiliated with the 'A&SCI' school who were hired before January 1, 1985.",
    "sql": "SELECT E.EMP_FNAME, E.EMP_LNAME, P.PROF_HIGH_DEGREE FROM EMPLOYEE E JOIN PROFESSOR P ON E.EMP_NUM = P.EMP_NUM JOIN DEPARTMENT D ON P.DEPT_CODE = D.DEPT_CODE WHERE D.SCHOOL_CODE = 'A&SCI' AND E.EMP_HIREDATE < '1985-01-01';",
    "table_names": [
      "DEPARTMENT",
      "EMPLOYEE",
      "PROFESSOR"
    ]
  },
  {
    "id": 564,
    "db_id": "dorm_1",
    "question": "Which students with major 600 coming from cities 'PIT' or 'BAL' could potentially reside in a dormitory which has more than 8 amenities, including a kitchen in every room?",
    "sql": "SELECT DISTINCT s.LName, s.Fname FROM Student s WHERE s.city_code IN ('PIT', 'BAL') AND s.Major = 600 AND s.StuID IN (SELECT DISTINCT StuID FROM Student WHERE city_code IN ('PIT', 'BAL') AND Major = 600) AND EXISTS (SELECT * FROM Has_amenity ha JOIN Dorm_amenity da ON ha.amenid = da.amenid WHERE ha.dormid IN (SELECT dormid FROM Has_amenity GROUP BY dormid HAVING COUNT(*) > 8) AND da.amenity_name = 'Kitchen in Every Room');",
    "table_names": [
      "Student",
      "Dorm_amenity",
      "Has_amenity",
      "Lives_in"
    ]
  },
  {
    "id": 357,
    "db_id": "hospital_1",
    "question": "List the names of physicians along with procedure names and their costs, for which they hold valid certifications expiring on December 31, 2008, and each procedure costs more than $4000.",
    "sql": "SELECT Physician.Name, Procedures.Name, Procedures.Cost FROM Physician JOIN Trained_In ON Physician.EmployeeID = Trained_In.Physician JOIN Procedures ON Procedures.Code = Trained_In.Treatment WHERE Procedures.Cost > 4000 AND Trained_In.CertificationExpires = '2008-12-31';",
    "table_names": [
      "Physician",
      "Procedures",
      "Trained_In"
    ]
  },
  {
    "id": 627,
    "db_id": "scientist_1",
    "question": "What is the total number of project hours assigned to the scientists Michael Rogers and Eric Goldsmith?",
    "sql": "SELECT SUM(P.Hours) FROM Scientists S JOIN AssignedTo A ON S.SSN = A.Scientist JOIN Projects P ON A.Project = P.Code WHERE S.Name = 'Michael Rogers' OR S.Name = 'Eric Goldsmith';",
    "table_names": [
      "Scientists",
      "Projects",
      "AssignedTo"
    ]
  },
  {
    "id": 677,
    "db_id": "car_1",
    "question": "How many car makers are based in Asian countries?",
    "sql": "SELECT COUNT(*) FROM car_makers WHERE Country IN (SELECT CountryId FROM countries WHERE Continent = (SELECT ContId FROM continents WHERE Continent = 'asia'));",
    "table_names": [
      "continents",
      "countries",
      "car_makers"
    ]
  },
  {
    "id": 119,
    "db_id": "small_bank_1",
    "question": "Which customers have more than $50,000 in savings and more than $8,000 in checking accounts?",
    "sql": "SELECT A.name FROM ACCOUNTS A INNER JOIN SAVINGS S ON A.custid = S.custid INNER JOIN CHECKING C ON A.custid = C.custid WHERE S.balance > 50000 AND C.balance > 8000;",
    "table_names": [
      "ACCOUNTS",
      "SAVINGS",
      "CHECKING"
    ]
  },
  {
    "id": 342,
    "db_id": "hospital_1",
    "question": "What are the names of physicians who prescribed medications manufactured by Foo Labs?",
    "sql": "SELECT DISTINCT ph.Name FROM Physician ph JOIN Prescribes pr ON ph.EmployeeID = pr.Physician JOIN Medication m ON pr.Medication = m.Code WHERE m.Brand = 'Foo Labs';",
    "table_names": [
      "Physician",
      "Medication",
      "Prescribes"
    ]
  },
  {
    "id": 170,
    "db_id": "movie_1",
    "question": "What is the average star rating of movies rated by reviewers who also directed those movies?",
    "sql": "SELECT AVG(r.stars) FROM Rating r JOIN Movie m ON r.mID = m.mID JOIN Reviewer rev ON r.rID = rev.rID WHERE m.director = rev.name;",
    "table_names": [
      "Movie",
      "Reviewer",
      "Rating"
    ]
  },
  {
    "id": 165,
    "db_id": "machine_repair",
    "question": "What are the names of technicians who performed repairs on machines manufactured between 1991 and 1995 having a quality rank of 3 or better?",
    "sql": "SELECT DISTINCT t.Name FROM technician t JOIN repair_assignment ra ON t.technician_id = ra.technician_id JOIN machine m ON ra.Machine_ID = m.Machine_ID WHERE m.Making_Year BETWEEN 1991 AND 1995 AND m.quality_rank <= 3;",
    "table_names": [
      "machine",
      "technician",
      "repair_assignment"
    ]
  },
  {
    "id": 577,
    "db_id": "cre_Theme_park",
    "question": "List the names of visitors who visited tourist attractions located at location ID 417 since the year 1990?",
    "sql": "SELECT Visitors.Tourist_Details FROM Visitors WHERE Tourist_ID IN (SELECT DISTINCT Visits.Tourist_ID FROM Visits JOIN Tourist_Attractions ON Visits.Tourist_Attraction_ID = Tourist_Attractions.Tourist_Attraction_ID WHERE Tourist_Attractions.Location_ID = 417 AND Visits.Visit_Date >= '1990-01-01');",
    "table_names": [
      "Visitors",
      "Tourist_Attractions",
      "Visits"
    ]
  },
  {
    "id": 384,
    "db_id": "club_1",
    "question": "How many students from the city code 'BAL' are members of clubs located at 'AKW'?",
    "sql": "SELECT COUNT(DISTINCT Student.StuID) FROM Student INNER JOIN Member_of_club ON Student.StuID = Member_of_club.StuID INNER JOIN Club ON Member_of_club.ClubID = Club.ClubID WHERE Student.city_code='BAL' AND Club.ClubLocation='AKW';",
    "table_names": [
      "Student",
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 62,
    "db_id": "performance_attendance",
    "question": "List the names of violinists and the total pieces they played in performances with attendance greater than 1800.",
    "sql": "SELECT m.Name, SUM(ma.Num_of_Pieces) AS total_pieces FROM member m JOIN member_attendance ma ON m.Member_ID = ma.Member_ID JOIN performance p ON ma.Performance_ID = p.Performance_ID WHERE m.Role = 'Violin' AND p.Attendance > 1800 GROUP BY m.Name;",
    "table_names": [
      "member",
      "performance",
      "member_attendance"
    ]
  },
  {
    "id": 590,
    "db_id": "customers_and_addresses",
    "question": "What is the state of the residential address associated with customer Mozell Morissette?",
    "sql": "SELECT Addresses.state_province_county FROM Customers JOIN Customer_Addresses ON Customers.customer_id = Customer_Addresses.customer_id JOIN Addresses ON Customer_Addresses.address_id = Addresses.address_id WHERE Customers.customer_name = 'Mozell Morissette' AND Customer_Addresses.address_type = 'Residential';",
    "table_names": [
      "Addresses",
      "Customers",
      "Customer_Addresses"
    ]
  },
  {
    "id": 468,
    "db_id": "aircraft",
    "question": "Which airport uses the aircraft with the maximum gross weight, and what are the name, description of this aircraft, and total passengers of the airport?",
    "sql": "SELECT airport.Airport_Name, aircraft.Aircraft, aircraft.Description, airport.Total_Passengers FROM airport JOIN airport_aircraft ON airport.Airport_ID = airport_aircraft.Airport_ID JOIN aircraft ON airport_aircraft.Aircraft_ID = aircraft.Aircraft_ID WHERE aircraft.Max_Gross_Weight = (SELECT MAX(Max_Gross_Weight) FROM aircraft);",
    "table_names": [
      "aircraft",
      "airport",
      "airport_aircraft"
    ]
  },
  {
    "id": 78,
    "db_id": "college_2",
    "question": "What are the names of instructors working in the same building as the department of student Chaudhuri?",
    "sql": "SELECT instructor.name FROM instructor JOIN department ON instructor.dept_name = department.dept_name WHERE department.building = (SELECT building FROM department WHERE dept_name = (SELECT dept_name FROM student WHERE name = 'Chaudhuri'))",
    "table_names": [
      "department",
      "instructor",
      "student"
    ]
  },
  {
    "id": 61,
    "db_id": "performance_attendance",
    "question": "On which date(s) did the member with the role 'Prime Violin' perform?",
    "sql": "SELECT p.Date FROM performance p JOIN member_attendance ma ON p.Performance_ID = ma.Performance_ID JOIN member m ON ma.Member_ID = m.Member_ID WHERE m.Role = 'Prime Violin';",
    "table_names": [
      "member",
      "performance",
      "member_attendance"
    ]
  },
  {
    "id": 372,
    "db_id": "cre_Doc_Tracking_DB",
    "question": "Which documents of type 'BK' have been located in 'Xiamen'?",
    "sql": "SELECT AD.Document_Name FROM All_Documents AS AD JOIN Document_Locations AS DL ON AD.Document_ID = DL.Document_ID JOIN Ref_Locations AS RL ON DL.Location_Code = RL.Location_Code WHERE AD.Document_Type_Code = 'BK' AND RL.Location_Name = 'Xiamen';",
    "table_names": [
      "Ref_Locations",
      "All_Documents",
      "Document_Locations"
    ]
  },
  {
    "id": 413,
    "db_id": "club_1",
    "question": "Find the names of students who are from city BAL and are members of clubs located at AKW.",
    "sql": "SELECT s.Fname, s.LName FROM Student s JOIN Member_of_club mc ON s.StuID = mc.StuID JOIN Club c ON mc.ClubID = c.ClubID WHERE s.city_code = 'BAL' AND c.ClubLocation = 'AKW';",
    "table_names": [
      "Student",
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 312,
    "db_id": "college_1",
    "question": "What is the class time for the CIS-220 class in which student Bowser is enrolled?",
    "sql": "SELECT CLASS.CLASS_TIME FROM CLASS INNER JOIN ENROLL ON CLASS.CLASS_CODE = ENROLL.CLASS_CODE INNER JOIN STUDENT ON ENROLL.STU_NUM = STUDENT.STU_NUM WHERE STUDENT.STU_LNAME = 'Bowser' AND CLASS.CRS_CODE = 'CIS-220';",
    "table_names": [
      "CLASS",
      "ENROLL",
      "STUDENT"
    ]
  },
  {
    "id": 374,
    "db_id": "club_1",
    "question": "What is the name of the club for which the president is a student living in city code 'BAL'?",
    "sql": "SELECT Club.ClubName FROM Student INNER JOIN Member_of_club ON Student.StuID = Member_of_club.StuID INNER JOIN Club ON Member_of_club.ClubID = Club.ClubID WHERE Student.city_code = 'BAL' AND Member_of_club.Position = 'President';",
    "table_names": [
      "Student",
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 460,
    "db_id": "customers_and_addresses",
    "question": "What is the name of the customer who completed an order and what is the highest priced product available along with its price?",
    "sql": "SELECT c.customer_name, p.product_name, p.product_price FROM Customers c JOIN Customer_Orders o ON c.customer_id = o.customer_id JOIN Products p ON p.product_price = (SELECT MAX(product_price) FROM Products) WHERE o.order_status_code = 'Completed';",
    "table_names": [
      "Customers",
      "Products",
      "Customer_Orders",
      "Order_Items"
    ]
  },
  {
    "id": 711,
    "db_id": "network_1",
    "question": "Which high school students have friends who like Kris?",
    "sql": "SELECT h1.name FROM Highschooler h1 JOIN Friend f1 ON h1.ID = f1.student_id JOIN Likes l1 ON f1.friend_id = l1.student_id JOIN Highschooler h2 ON l1.liked_id = h2.ID WHERE h2.name = 'Kris';",
    "table_names": [
      "Highschooler",
      "Friend",
      "Likes"
    ]
  },
  {
    "id": 153,
    "db_id": "formula_1",
    "question": "What are the first and last names of all drivers who participated in the Australian Grand Prix but not the Chinese Grand Prix?",
    "sql": "SELECT T3.forename ,  T3.surname FROM races AS T1 JOIN results AS T2 ON T1.raceid = T2.raceid JOIN drivers AS T3 ON T2.driverid = T3.driverid WHERE T1.name = \"Australian Grand Prix\" EXCEPT SELECT T3.forename ,  T3.surname FROM races AS T1 JOIN results AS T2 ON T1.raceid = T2.raceid JOIN drivers AS T3 ON T2.driverid = T3.driverid WHERE T1.name = \"Chinese Grand Prix\"",
    "table_names": [
      "races",
      "drivers",
      "results"
    ]
  },
  {
    "id": 346,
    "db_id": "hospital_1",
    "question": "Who is the attending physician whose primary departmental affiliation is General Medicine?",
    "sql": "SELECT Physician.Name FROM Physician JOIN Affiliated_With ON Physician.EmployeeID = Affiliated_With.Physician JOIN Department ON Affiliated_With.Department = Department.DepartmentID WHERE Department.Name = 'General Medicine' AND Affiliated_With.PrimaryAffiliation = 1 AND Physician.Position = 'Attending Physician';",
    "table_names": [
      "Physician",
      "Department",
      "Affiliated_With"
    ]
  },
  {
    "id": 180,
    "db_id": "movie_1",
    "question": "What is the average rating provided by the reviewers for movies directed by Steven Spielberg?",
    "sql": "SELECT AVG(r.stars) FROM Rating AS r JOIN Movie AS m ON r.mID = m.mID WHERE m.director = 'Steven Spielberg';",
    "table_names": [
      "Movie",
      "Reviewer",
      "Rating"
    ]
  },
  {
    "id": 307,
    "db_id": "college_1",
    "question": "What is the full name and hire date of the professor teaching 'CIS-220', Section '1', and which department do they belong to?",
    "sql": "SELECT EMP.EMP_FNAME, EMP.EMP_LNAME, EMP.EMP_HIREDATE, DEPT.DEPT_NAME FROM CLASS JOIN EMPLOYEE EMP ON CLASS.PROF_NUM = EMP.EMP_NUM JOIN DEPARTMENT DEPT ON DEPT.DEPT_CODE = LEFT(CLASS.CRS_CODE, LOCATE('-', CLASS.CRS_CODE)-1) WHERE CLASS.CRS_CODE = 'CIS-220' AND CLASS.CLASS_SECTION = '1';",
    "table_names": [
      "CLASS",
      "DEPARTMENT",
      "EMPLOYEE",
      "PROFESSOR"
    ]
  },
  {
    "id": 639,
    "db_id": "activity_1",
    "question": "List the first and last names of professors who participate in Mountain Climbing.",
    "sql": "SELECT F.Fname, F.Lname FROM Faculty F JOIN Faculty_Participates_in FP ON F.FacID = FP.FacID JOIN Activity A ON FP.actid = A.actid WHERE A.activity_name = 'Mountain Climbing' AND F.Rank = 'Professor';",
    "table_names": [
      "Activity",
      "Faculty_Participates_in",
      "Faculty"
    ]
  },
  {
    "id": 656,
    "db_id": "culture_company",
    "question": "Who is the author or editor of the book associated with the company linked to the highest grossing movie?",
    "sql": "SELECT bc.Author_or_Editor FROM book_club bc JOIN culture_company cc ON bc.book_club_id = cc.book_club_id JOIN movie m ON cc.movie_id = m.movie_id WHERE m.Gross_worldwide = (SELECT MAX(Gross_worldwide) FROM movie);",
    "table_names": [
      "book_club",
      "movie",
      "culture_company"
    ]
  },
  {
    "id": 171,
    "db_id": "movie_1",
    "question": "Which reviewer gave the highest average star rating to movies directed by Steven Spielberg, and what was the average rating?",
    "sql": "SELECT Reviewer.name, AVG(Rating.stars) AS AverageRating FROM Reviewer JOIN Rating ON Reviewer.rID = Rating.rID JOIN Movie ON Movie.mID = Rating.mID WHERE Movie.director = 'Steven Spielberg' GROUP BY Reviewer.name ORDER BY AverageRating DESC LIMIT 1;",
    "table_names": [
      "Movie",
      "Reviewer",
      "Rating"
    ]
  },
  {
    "id": 215,
    "db_id": "icfp_1",
    "question": "Which country is the institution affiliated with the author Stephanie Weirich located in?",
    "sql": "SELECT Inst.country FROM Inst JOIN Authorship ON Inst.instID = Authorship.instID JOIN Authors ON Authorship.authID = Authors.authID WHERE Authors.lname = 'Weirich' AND Authors.fname = 'Stephanie';",
    "table_names": [
      "Inst",
      "Authors",
      "Authorship"
    ]
  },
  {
    "id": 137,
    "db_id": "gas_company",
    "question": "List the names of companies that operated gas stations opened before the year 2000 and which had a station rank of 5 or higher?",
    "sql": "SELECT c.Company FROM company c JOIN station_company sc ON c.Company_ID = sc.Company_ID JOIN gas_station gs ON sc.Station_ID = gs.Station_ID WHERE gs.Open_Year < 2000 AND sc.Rank_of_the_Year <= 5;",
    "table_names": [
      "company",
      "gas_station",
      "station_company"
    ]
  },
  {
    "id": 444,
    "db_id": "entertainment_awards",
    "question": "What is the most recent festival at which a 'Program Music/Variety Show' artwork won?",
    "sql": "SELECT fd.Festival_Name FROM festival_detail fd JOIN nomination n ON fd.Festival_ID = n.Festival_ID JOIN artwork aw ON aw.Artwork_ID = n.Artwork_ID WHERE aw.Type = 'Program Music/Variety Show' AND n.Result = 'Won' ORDER BY fd.Year DESC LIMIT 1;",
    "table_names": [
      "festival_detail",
      "artwork",
      "nomination"
    ]
  },
  {
    "id": 204,
    "db_id": "restaurant_1",
    "question": "What is the average age of students who visited the restaurant named Subway?",
    "sql": "SELECT AVG(S.Age) FROM Student S INNER JOIN Visits_Restaurant V ON S.StuID = V.StuID INNER JOIN Restaurant R ON V.ResID = R.ResID WHERE R.ResName = 'Subway';",
    "table_names": [
      "Student",
      "Restaurant",
      "Visits_Restaurant"
    ]
  },
  {
    "id": 416,
    "db_id": "tracking_grants_for_research",
    "question": "What is the total grant amount given to sponsor-type organisations for grants that started in or after the year 2000?",
    "sql": "SELECT SUM(g.grant_amount) FROM Grants AS g JOIN Organisations AS o ON g.organisation_id = o.organisation_id WHERE o.organisation_type = 'SPON' AND g.grant_start_date >= '2000-01-01'",
    "table_names": [
      "Grants",
      "Organisation_Types",
      "Organisations"
    ]
  },
  {
    "id": 494,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "Which performer(s) share(s) a city with a VIP customer located in Florida, and what is their name, email, and city?",
    "sql": "SELECT p.Customer_Name, p.Customer_Email_Address, a.City_Town FROM Performers p JOIN Addresses a ON p.Address_ID = a.Address_ID JOIN Customers c ON c.Address_ID = a.Address_ID WHERE c.Other_Details = 'VIP' AND a.State_County = 'Florida';",
    "table_names": [
      "Addresses",
      "Performers",
      "Customers"
    ]
  },
  {
    "id": 287,
    "db_id": "college_1",
    "question": "List the course code, class section, and room for all classes in which William Bowser is enrolled.",
    "sql": "SELECT CRS_CODE, CLASS_SECTION, CLASS_ROOM FROM CLASS WHERE CLASS_CODE IN (SELECT CLASS_CODE FROM ENROLL WHERE STU_NUM = (SELECT STU_NUM FROM STUDENT WHERE STU_FNAME = 'William' AND STU_LNAME = 'Bowser'))",
    "table_names": [
      "CLASS",
      "ENROLL",
      "STUDENT"
    ]
  },
  {
    "id": 487,
    "db_id": "soccer_2",
    "question": "How many unique players with a high school (HS) score of at least 1000 successfully got accepted through tryouts into colleges with enrollment less than 19000?",
    "sql": "SELECT COUNT(DISTINCT T.pID) FROM Tryout T JOIN Player P ON T.pID = P.pID JOIN College C ON T.cName = C.cName WHERE T.decision = 'yes' AND C.enr < 19000 AND P.HS >= 1000;",
    "table_names": [
      "College",
      "Player",
      "Tryout"
    ]
  },
  {
    "id": 304,
    "db_id": "college_1",
    "question": "What are the names of all CIS department courses in which student number 324257 received a grade of 'B'?",
    "sql": "SELECT COURSE.CRS_DESCRIPTION FROM COURSE JOIN CLASS ON COURSE.CRS_CODE = CLASS.CRS_CODE JOIN ENROLL ON CLASS.CLASS_CODE = ENROLL.CLASS_CODE WHERE ENROLL.STU_NUM = 324257 AND COURSE.DEPT_CODE = 'CIS' AND ENROLL.ENROLL_GRADE = 'B';",
    "table_names": [
      "CLASS",
      "COURSE",
      "ENROLL",
      "STUDENT"
    ]
  },
  {
    "id": 410,
    "db_id": "club_1",
    "question": "What is the name of a student who lives in the same city as the CTO of the 'Hopkins Student Enterprises', excluding the CTO themself?",
    "sql": "SELECT Student.Fname, Student.LName FROM Student WHERE city_code = (SELECT city_code FROM Student WHERE StuID = (SELECT StuID FROM Member_of_club WHERE ClubID = (SELECT ClubID FROM Club WHERE ClubName = 'Hopkins Student Enterprises')) AND StuID <> 1008 LIMIT 1);",
    "table_names": [
      "Student",
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 59,
    "db_id": "game_injury",
    "question": "Which stadium had games resulting in the highest number of player injuries?",
    "sql": "SELECT s.name FROM stadium s JOIN game g ON s.id = g.stadium_id JOIN injury_accident ia ON g.id = ia.game_id GROUP BY s.name ORDER BY COUNT(ia.id) DESC LIMIT 1;",
    "table_names": [
      "stadium",
      "game",
      "injury_accident"
    ]
  },
  {
    "id": 317,
    "db_id": "hr_1",
    "question": "In which city does the employee with the last name 'Hunold' work?",
    "sql": "SELECT L.CITY FROM employees E JOIN departments D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID JOIN locations L ON D.LOCATION_ID = L.LOCATION_ID WHERE E.LAST_NAME = 'Hunold';",
    "table_names": [
      "departments",
      "employees",
      "locations"
    ]
  },
  {
    "id": 351,
    "db_id": "hospital_1",
    "question": "What is the average cost of procedures for which surgical attending physicians have certifications valid until at least the end of the year 2008?",
    "sql": "SELECT AVG(P.Cost) FROM Procedures P INNER JOIN Trained_In T ON P.Code = T.Treatment INNER JOIN Physician Ph ON T.Physician = Ph.EmployeeID WHERE Ph.Position LIKE '%Surgical Attending%' AND T.CertificationExpires >= '2008-12-31';",
    "table_names": [
      "Physician",
      "Procedures",
      "Trained_In"
    ]
  },
  {
    "id": 683,
    "db_id": "car_1",
    "question": "How many distinct car models are produced by car makers from country 2?",
    "sql": "SELECT COUNT(DISTINCT CN.Make) FROM car_names CN JOIN model_list ML ON CN.Model = ML.Model JOIN car_makers CM ON ML.Maker = CM.Id WHERE CM.Country = '2';",
    "table_names": [
      "car_makers",
      "model_list",
      "car_names",
      "cars_data"
    ]
  },
  {
    "id": 4,
    "db_id": "student_assessment",
    "question": "What is the name and qualification of the candidate who was the earliest to receive a 'Pass' assessment outcome, and what is the assessment date?",
    "sql": "SELECT p.first_name, p.last_name, ca.qualification, ca.assessment_date FROM People p JOIN Candidates c ON p.person_id = c.candidate_id JOIN Candidate_Assessments ca ON c.candidate_id = ca.candidate_id WHERE ca.asessment_outcome_code = 'Pass' AND ca.assessment_date = (SELECT MIN(assessment_date) FROM Candidate_Assessments WHERE asessment_outcome_code = 'Pass');",
    "table_names": [
      "People",
      "Candidates",
      "Candidate_Assessments"
    ]
  },
  {
    "id": 45,
    "db_id": "insurance_fnol",
    "question": "What is the name of the customer who has used the 'Upgrade a policy' service and what is the corresponding FNOL_ID?",
    "sql": "SELECT Customers.Customer_name, First_Notification_of_Loss.FNOL_ID FROM Customers JOIN First_Notification_of_Loss ON Customers.Customer_ID = First_Notification_of_Loss.Customer_ID JOIN Services ON First_Notification_of_Loss.Service_ID = Services.Service_ID WHERE Services.Service_name = 'Upgrade a policy';",
    "table_names": [
      "Customers",
      "Services",
      "First_Notification_of_Loss"
    ]
  },
  {
    "id": 425,
    "db_id": "tracking_grants_for_research",
    "question": "How many distinct projects have a 'Patent' outcome for the organisation that has a project with the details described as 'sed'?",
    "sql": "SELECT COUNT(DISTINCT po.project_id) FROM Project_Outcomes po JOIN Projects p ON po.project_id = p.project_id WHERE po.outcome_code = 'Patent' AND p.organisation_id IN (SELECT organisation_id FROM Projects WHERE project_details = 'sed')",
    "table_names": [
      "Project_Outcomes",
      "Projects",
      "Research_Outcomes"
    ]
  },
  {
    "id": 557,
    "db_id": "dorm_1",
    "question": "What is the dorm name and student capacity of dorms that allow pets and what is the average age of female students enrolled in major 600?",
    "sql": "SELECT d.dorm_name, d.student_capacity, (SELECT AVG(Age) FROM Student WHERE Sex='F' AND Major=600) AS avg_female_age FROM Dorm d JOIN Dorm_amenity da ON da.amenity_name = 'Allows Pets';",
    "table_names": [
      "Student",
      "Dorm",
      "Dorm_amenity",
      "Has_amenity",
      "Lives_in"
    ]
  },
  {
    "id": 179,
    "db_id": "movie_1",
    "question": "What is the title of the most recent movie directed by James Cameron, and what is the average rating given to this movie?",
    "sql": "SELECT Movie.title, AVG(Rating.stars) FROM Movie JOIN Rating ON Movie.mID = Rating.mID WHERE Movie.director = 'James Cameron' AND Movie.year = (SELECT MAX(year) FROM Movie WHERE director = 'James Cameron') GROUP BY Movie.title;",
    "table_names": [
      "Movie",
      "Reviewer",
      "Rating"
    ]
  },
  {
    "id": 529,
    "db_id": "products_gen_characteristics",
    "question": "Which Seeds category products have a 'high' rating for the characteristic 'fast'?",
    "sql": "SELECT p.product_name FROM Products p JOIN Product_Characteristics pc ON p.product_id = pc.product_id JOIN Characteristics c ON pc.characteristic_id = c.characteristic_id WHERE c.characteristic_name = 'fast' AND pc.product_characteristic_value = 'high' AND p.product_category_code = 'Seeds';",
    "table_names": [
      "Characteristics",
      "Products",
      "Product_Characteristics"
    ]
  },
  {
    "id": 376,
    "db_id": "club_1",
    "question": "Which students from Baltimore are members of clubs located in AKW, and what positions do they hold?",
    "sql": "SELECT Student.Fname, Student.LName, Club.ClubName, Member_of_club.Position FROM Student JOIN Member_of_club ON Student.StuID = Member_of_club.StuID JOIN Club ON Member_of_club.ClubID = Club.ClubID WHERE Student.city_code = 'BAL' AND Club.ClubLocation = 'AKW';",
    "table_names": [
      "Student",
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 661,
    "db_id": "pets_1",
    "question": "What is the average weight of pets owned by students who are from the city with the code 'HKG'?",
    "sql": "SELECT AVG(p.weight) FROM Student s JOIN Has_Pet hp ON s.StuID = hp.StuID JOIN Pets p ON hp.PetID = p.PetID WHERE s.city_code = 'HKG';",
    "table_names": [
      "Student",
      "Has_Pet",
      "Pets"
    ]
  },
  {
    "id": 228,
    "db_id": "icfp_1",
    "question": "Which country has the institution with the highest number of distinct published papers?",
    "sql": "SELECT country FROM Inst WHERE instID = (SELECT instID FROM Authorship GROUP BY instID ORDER BY COUNT(DISTINCT paperID) DESC LIMIT 1);",
    "table_names": [
      "Inst",
      "Papers",
      "Authorship"
    ]
  },
  {
    "id": 479,
    "db_id": "store_product",
    "question": "List all district names that have stores with an area size greater than 25 located in cities with a population exceeding 200,000.",
    "sql": "SELECT d.District_name FROM district d JOIN store_district sd ON d.District_ID = sd.District_ID JOIN store s ON sd.Store_ID = s.Store_ID WHERE s.Area_size > 25 AND d.City_Population > 200000;",
    "table_names": [
      "store",
      "district",
      "store_district"
    ]
  },
  {
    "id": 134,
    "db_id": "phone_market",
    "question": "Which districts have more than 1000 units in stock for the IPhone X?",
    "sql": "SELECT market.District FROM market INNER JOIN phone_market ON market.Market_ID = phone_market.Market_ID INNER JOIN phone ON phone.Phone_ID = phone_market.Phone_ID WHERE phone.Name = 'IPhone X' AND phone_market.Num_of_stock > 1000;",
    "table_names": [
      "phone",
      "market",
      "phone_market"
    ]
  },
  {
    "id": 456,
    "db_id": "college_3",
    "question": "What is the average grade point of students who are from the city with city code 'BAL'?",
    "sql": "SELECT AVG(G.gradepoint) FROM Enrolled_in E JOIN Gradeconversion G ON E.Grade = G.lettergrade WHERE E.StuID IN (SELECT StuID FROM Student WHERE city_code = 'BAL');",
    "table_names": [
      "Student",
      "Enrolled_in",
      "Gradeconversion"
    ]
  },
  {
    "id": 399,
    "db_id": "club_1",
    "question": "What are the first and last names of the students from the city with the code 'BAL' who are members of the club 'Bootup Baltimore'?",
    "sql": "SELECT Student.Fname, Student.LName FROM Student JOIN Member_of_club ON Student.StuID = Member_of_club.StuID JOIN Club ON Member_of_club.ClubID = Club.ClubID WHERE Club.ClubName = 'Bootup Baltimore' AND Student.city_code = 'BAL';",
    "table_names": [
      "Student",
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 375,
    "db_id": "club_1",
    "question": "What are the first and last names of the student who lives in city code 'HOU' and holds a position in a club located at 'AKW'?",
    "sql": "SELECT s.Fname, s.LName FROM Student s JOIN Member_of_club m ON s.StuID = m.StuID JOIN Club c ON m.ClubID = c.ClubID WHERE c.ClubLocation = 'AKW' AND s.city_code = 'HOU';",
    "table_names": [
      "Student",
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 718,
    "db_id": "dog_kennels",
    "question": "Which dog owner spent the most on 'EXAM' treatments for their dog(s) and how much did they spend?",
    "sql": "SELECT O.first_name, O.last_name, SUM(T.cost_of_treatment) AS total_cost FROM Owners O JOIN Dogs D ON O.owner_id = D.owner_id JOIN Treatments T ON D.dog_id = T.dog_id WHERE T.treatment_type_code = 'EXAM' GROUP BY O.owner_id ORDER BY total_cost DESC LIMIT 1;",
    "table_names": [
      "Owners",
      "Dogs",
      "Treatments"
    ]
  },
  {
    "id": 145,
    "db_id": "pilot_record",
    "question": "How many distinct aircraft, ordered after 1996, have been piloted by pilots in the 'Center Team' position?",
    "sql": "SELECT COUNT(DISTINCT pr.Aircraft_ID) FROM pilot_record pr JOIN pilot p ON pr.Pilot_ID = p.Pilot_ID JOIN aircraft a ON pr.Aircraft_ID = a.Aircraft_ID WHERE p.Position = 'Center Team' AND a.Order_Year > 1996;",
    "table_names": [
      "aircraft",
      "pilot",
      "pilot_record"
    ]
  },
  {
    "id": 614,
    "db_id": "city_record",
    "question": "Which cities have hosted matches and have an average July temperature greater than 29 degrees?",
    "sql": "SELECT DISTINCT city.City FROM city JOIN hosting_city ON city.City_ID = CAST(hosting_city.Host_City AS INTEGER) JOIN temperature ON city.City_ID = temperature.City_ID WHERE temperature.Jul > 29;",
    "table_names": [
      "city",
      "temperature",
      "hosting_city"
    ]
  },
  {
    "id": 295,
    "db_id": "college_1",
    "question": "What are the names of professors with a Ph.D. in departments that belong to the School of Business? Provide their departments as well.",
    "sql": "SELECT D.DEPT_NAME, E.EMP_FNAME, E.EMP_LNAME FROM DEPARTMENT D JOIN PROFESSOR P ON D.DEPT_CODE = P.DEPT_CODE JOIN EMPLOYEE E ON P.EMP_NUM = E.EMP_NUM WHERE D.SCHOOL_CODE = 'BUS' AND P.PROF_HIGH_DEGREE = 'Ph.D.';",
    "table_names": [
      "DEPARTMENT",
      "EMPLOYEE",
      "PROFESSOR"
    ]
  },
  {
    "id": 318,
    "db_id": "hr_1",
    "question": "What is the average salary of employees who earn more than 5000 and work in departments located in the US?",
    "sql": "SELECT AVG(e.SALARY) FROM employees e JOIN departments d ON e.DEPARTMENT_ID = d.DEPARTMENT_ID JOIN locations l ON d.LOCATION_ID = l.LOCATION_ID WHERE l.COUNTRY_ID = 'US' AND e.SALARY > 5000;",
    "table_names": [
      "departments",
      "employees",
      "locations"
    ]
  },
  {
    "id": 331,
    "db_id": "insurance_policies",
    "question": "What are the names of customers who had a Travel type policy and had claims with Amount_Claimed greater than 75000?",
    "sql": "SELECT DISTINCT Customers.Customer_Details FROM Customers JOIN Customer_Policies ON Customers.Customer_ID = Customer_Policies.Customer_ID JOIN Claims ON Customer_Policies.Policy_ID = Claims.Policy_ID WHERE Customer_Policies.Policy_Type_Code = 'Travel' AND Claims.Amount_Claimed > 75000;",
    "table_names": [
      "Customers",
      "Customer_Policies",
      "Claims"
    ]
  },
  {
    "id": 369,
    "db_id": "company_employee",
    "question": "What is the name of the person from the United States who is employed at a company with more than 200 billion dollars in sales?",
    "sql": "SELECT p.Name FROM people p JOIN employment e ON p.People_ID = e.People_ID JOIN company c ON e.Company_ID = c.Company_ID WHERE c.Sales_in_Billion > 200 AND p.Nationality = 'United States';",
    "table_names": [
      "people",
      "company",
      "employment"
    ]
  },
  {
    "id": 681,
    "db_id": "car_1",
    "question": "How many distinct car makers are from Asian countries?",
    "sql": "SELECT COUNT(DISTINCT car_makers.Maker) FROM car_makers JOIN countries ON car_makers.Country = countries.CountryId JOIN continents ON countries.Continent = continents.ContId WHERE continents.Continent = 'asia';",
    "table_names": [
      "continents",
      "countries",
      "car_makers"
    ]
  },
  {
    "id": 508,
    "db_id": "products_gen_characteristics",
    "question": "What is the average typical selling price of products that have a high purity characteristic?",
    "sql": "SELECT AVG(CAST(p.typical_selling_price AS FLOAT)) FROM Products p JOIN Product_Characteristics pc ON p.product_id = pc.product_id JOIN Characteristics c ON pc.characteristic_id = c.characteristic_id WHERE c.characteristic_type_code = 'Purity' AND pc.product_characteristic_value = 'high';",
    "table_names": [
      "Characteristics",
      "Products",
      "Product_Characteristics"
    ]
  },
  {
    "id": 350,
    "db_id": "hospital_1",
    "question": "Which physicians have valid certifications as of December 31, 2008 for procedures that cost over $5000?",
    "sql": "SELECT Physician.Name FROM Physician JOIN Trained_In ON Physician.EmployeeID = Trained_In.Physician JOIN Procedures ON Trained_In.Treatment = Procedures.Code WHERE Procedures.Cost > 5000.0 AND Trained_In.CertificationExpires >= '2008-12-31' GROUP BY Physician.Name;",
    "table_names": [
      "Physician",
      "Procedures",
      "Trained_In"
    ]
  },
  {
    "id": 20,
    "db_id": "allergy_1",
    "question": "List the names of students located in 'PIT' who have an animal-related allergy.",
    "sql": "SELECT DISTINCT s.Fname, s.LName FROM Student s JOIN Has_Allergy ha ON s.StuID = ha.StuID JOIN Allergy_Type at ON ha.Allergy = at.Allergy WHERE s.city_code = 'PIT' AND at.AllergyType = 'animal';",
    "table_names": [
      "Allergy_Type",
      "Has_Allergy",
      "Student"
    ]
  },
  {
    "id": 663,
    "db_id": "pets_1",
    "question": "What is the average weight of pets belonging to students from the city having city_code 'HKG'?",
    "sql": "SELECT AVG(Pets.weight) FROM Student JOIN Has_Pet ON Student.StuID = Has_Pet.StuID JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE Student.city_code = 'HKG';",
    "table_names": [
      "Student",
      "Has_Pet",
      "Pets"
    ]
  },
  {
    "id": 659,
    "db_id": "concert_singer",
    "question": "What are the names of concerts held in 2014 that featured singers from France?",
    "sql": "SELECT c.concert_Name FROM concert c JOIN singer_in_concert sc ON c.concert_ID = sc.concert_ID JOIN singer s ON sc.Singer_ID = s.Singer_ID WHERE s.Country='France' AND c.Year='2014';",
    "table_names": [
      "singer",
      "concert",
      "singer_in_concert"
    ]
  },
  {
    "id": 138,
    "db_id": "gas_company",
    "question": "Which company with the highest rank was associated with a gas station managed by Colin Denman?",
    "sql": "SELECT c.Company FROM company AS c JOIN station_company AS sc ON c.Company_ID = sc.Company_ID JOIN gas_station AS gs ON sc.Station_ID = gs.Station_ID WHERE gs.Manager_Name = 'Colin Denman' ORDER BY sc.Rank_of_the_Year ASC LIMIT 1;",
    "table_names": [
      "company",
      "gas_station",
      "station_company"
    ]
  },
  {
    "id": 320,
    "db_id": "hr_1",
    "question": "What are the first and last names of employees who work in departments located in the region of Japan and have salaries greater than 8500?",
    "sql": "SELECT e.FIRST_NAME, e.LAST_NAME FROM employees e JOIN departments d ON e.DEPARTMENT_ID = d.DEPARTMENT_ID JOIN countries c ON d.LOCATION_ID = c.REGION_ID WHERE c.COUNTRY_NAME = 'Japan' AND e.SALARY > 8500;",
    "table_names": [
      "countries",
      "departments",
      "employees",
      "locations"
    ]
  },
  {
    "id": 69,
    "db_id": "college_2",
    "question": "What is the average salary of instructors in the Statistics department who advise students from the Physics department?",
    "sql": "SELECT AVG(i.salary) FROM advisor AS a JOIN instructor AS i ON a.i_ID = i.ID JOIN student AS s ON a.s_ID = s.ID WHERE s.dept_name = 'Physics' AND i.dept_name = 'Statistics';",
    "table_names": [
      "instructor",
      "student",
      "advisor"
    ]
  },
  {
    "id": 526,
    "db_id": "products_gen_characteristics",
    "question": "What are the names of products in the 'Seeds' category that have a 'high' characteristic value labeled as 'fast'?",
    "sql": "SELECT p.product_name FROM Products p JOIN Product_Characteristics pc ON p.product_id = pc.product_id JOIN Characteristics c ON pc.characteristic_id = c.characteristic_id WHERE p.product_category_code='Seeds' AND c.characteristic_name='fast' AND pc.product_characteristic_value='high';",
    "table_names": [
      "Characteristics",
      "Products",
      "Product_Characteristics"
    ]
  },
  {
    "id": 132,
    "db_id": "phone_market",
    "question": "What is the price of the phone model that has the largest stock number in the 'British Columbia' market?",
    "sql": "SELECT Price FROM phone WHERE Phone_ID = (SELECT Phone_ID FROM phone_market WHERE Market_ID = (SELECT Market_ID FROM market WHERE District = 'British Columbia') ORDER BY Num_of_stock DESC LIMIT 1);",
    "table_names": [
      "phone",
      "market",
      "phone_market"
    ]
  },
  {
    "id": 378,
    "db_id": "club_1",
    "question": "What are the full names and ages of students who are members of clubs located at 'AKW'?",
    "sql": "SELECT s.Fname, s.LName, s.Age FROM Student AS s JOIN Member_of_club AS mc ON s.StuID = mc.StuID JOIN Club AS c ON mc.ClubID = c.ClubID WHERE c.ClubLocation = 'AKW';",
    "table_names": [
      "Student",
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 42,
    "db_id": "insurance_fnol",
    "question": "What are the names of customers who had a 'Mortgage Insurance' policy opened during the year 2017?",
    "sql": "SELECT DISTINCT c.Customer_name FROM Customers c JOIN Customers_Policies cp ON c.Customer_ID = cp.Customer_ID JOIN Available_Policies ap ON cp.Policy_ID = ap.Policy_ID WHERE ap.policy_type_code = 'Mortgage Insurance' AND cp.Date_Opened BETWEEN '2017-01-01' AND '2017-12-31';",
    "table_names": [
      "Customers",
      "Available_Policies",
      "Customers_Policies"
    ]
  },
  {
    "id": 337,
    "db_id": "hospital_1",
    "question": "Which medication was prescribed to 'Dennis Doe' at a dose of 10 units?",
    "sql": "SELECT Medication.Name FROM Medication JOIN Prescribes ON Medication.Code = Prescribes.Medication JOIN Patient ON Patient.SSN = Prescribes.Patient WHERE Patient.Name = 'Dennis Doe' AND Prescribes.Dose = '10';",
    "table_names": [
      "Patient",
      "Medication",
      "Prescribes",
      "Room",
      "Stay"
    ]
  },
  {
    "id": 43,
    "db_id": "insurance_fnol",
    "question": "What are the dates when Jay Chou opened and closed his Mortgage Insurance policies?",
    "sql": "SELECT cp.Date_Opened, cp.Date_Closed FROM Customers_Policies cp JOIN Available_Policies ap ON cp.Policy_ID = ap.Policy_ID JOIN Customers c ON cp.Customer_ID = c.Customer_ID WHERE c.Customer_name = 'Jay Chou' AND ap.policy_type_code = 'Mortgage Insurance';",
    "table_names": [
      "Customers",
      "Available_Policies",
      "Customers_Policies"
    ]
  },
  {
    "id": 156,
    "db_id": "formula_1",
    "question": "Find the id, forename and number of races of all drivers who have at least participated in two races?",
    "sql": "SELECT T1.driverid ,  T1.forename ,  count(*) FROM drivers AS T1 JOIN results AS T2 ON T1.driverid = T2.driverid JOIN races AS T3 ON T2.raceid = T3.raceid GROUP BY T1.driverid HAVING count(*)  >=  2",
    "table_names": [
      "races",
      "drivers",
      "results"
    ]
  },
  {
    "id": 49,
    "db_id": "medicine_enzyme_interaction",
    "question": "Which FDA-approved medicine acts as an activator for the enzyme located on chromosome 1p34?",
    "sql": "SELECT m.name FROM medicine m JOIN medicine_enzyme_interaction mei ON m.id = mei.medicine_id JOIN enzyme e ON mei.enzyme_id = e.id WHERE mei.interaction_type = 'activitor' AND e.Chromosome = '1p34' AND m.FDA_approved = 'Yes';",
    "table_names": [
      "medicine",
      "enzyme",
      "medicine_enzyme_interaction"
    ]
  },
  {
    "id": 288,
    "db_id": "college_1",
    "question": "What is the full name of the student who received an 'A' grade in course 'CIS-220'?",
    "sql": "SELECT STUDENT.STU_FNAME, STUDENT.STU_LNAME FROM STUDENT JOIN ENROLL ON STUDENT.STU_NUM = ENROLL.STU_NUM JOIN CLASS ON ENROLL.CLASS_CODE = CLASS.CLASS_CODE WHERE CLASS.CRS_CODE = 'CIS-220' AND ENROLL.ENROLL_GRADE = 'A';",
    "table_names": [
      "CLASS",
      "ENROLL",
      "STUDENT"
    ]
  },
  {
    "id": 455,
    "db_id": "college_3",
    "question": "What is the average GPA of all students from the city coded as 'PIT'?",
    "sql": "SELECT AVG(gc.gradepoint) FROM Enrolled_in ei JOIN Gradeconversion gc ON ei.Grade = gc.lettergrade JOIN Student s ON ei.StuID = s.StuID WHERE s.city_code = 'PIT';",
    "table_names": [
      "Student",
      "Enrolled_in",
      "Gradeconversion"
    ]
  },
  {
    "id": 588,
    "db_id": "customers_and_addresses",
    "question": "What is the total number of customers using 'Credit Card' payment method who have billing addresses located in 'Texas'?",
    "sql": "SELECT COUNT(DISTINCT c.customer_id) FROM Customers c JOIN Customer_Addresses ca ON c.customer_id = ca.customer_id JOIN Addresses a ON ca.address_id = a.address_id WHERE c.payment_method = 'Credit Card' AND ca.address_type = 'Billing' AND a.state_province_county = 'Texas';",
    "table_names": [
      "Addresses",
      "Customers",
      "Customer_Addresses"
    ]
  },
  {
    "id": 676,
    "db_id": "car_1",
    "question": "List all distinct continents that have countries which are the origin of car makers whose full names start with 'F'.",
    "sql": "SELECT DISTINCT ct.Continent FROM continents AS ct JOIN countries AS cn ON ct.ContId = cn.Continent JOIN car_makers AS cm ON cn.CountryId = cm.Country WHERE cm.FullName LIKE 'F%';",
    "table_names": [
      "continents",
      "countries",
      "car_makers"
    ]
  },
  {
    "id": 698,
    "db_id": "course_teach",
    "question": "Who is teaching the Math course for grade 3?",
    "sql": "SELECT teacher.Name FROM teacher INNER JOIN course_arrange ON teacher.Teacher_ID = course_arrange.Teacher_ID INNER JOIN course ON course.Course_ID = course_arrange.Course_ID WHERE course.Course = 'Math' AND course_arrange.Grade = 3;",
    "table_names": [
      "course",
      "teacher",
      "course_arrange"
    ]
  },
  {
    "id": 272,
    "db_id": "college_1",
    "question": "List the descriptions of courses in the Computer Info. Systems department that have classes scheduled at more than one distinct time.",
    "sql": "SELECT CRS_DESCRIPTION FROM COURSE WHERE CRS_CODE IN (SELECT CRS_CODE FROM CLASS GROUP BY CRS_CODE HAVING COUNT(DISTINCT CLASS_TIME) > 1) AND DEPT_CODE = (SELECT DEPT_CODE FROM DEPARTMENT WHERE DEPT_NAME = 'Computer Info. Systems');",
    "table_names": [
      "CLASS",
      "COURSE",
      "DEPARTMENT"
    ]
  },
  {
    "id": 332,
    "db_id": "hospital_1",
    "question": "Which physicians have primary affiliations with two or more departments?",
    "sql": "SELECT p.Name FROM Physician p JOIN Affiliated_With a ON p.EmployeeID = a.Physician WHERE a.PrimaryAffiliation = 1 GROUP BY p.EmployeeID HAVING COUNT(a.Department) >= 2",
    "table_names": [
      "Physician",
      "Department",
      "Affiliated_With"
    ]
  },
  {
    "id": 500,
    "db_id": "products_gen_characteristics",
    "question": "What blue colored products have a characteristic with id 10 valued as 'high'?",
    "sql": "SELECT p.product_name FROM Products p JOIN Ref_Colors c ON p.color_code = c.color_code JOIN Product_Characteristics pc ON p.product_id = pc.product_id WHERE c.color_description = 'blue' AND pc.characteristic_id = 10 AND pc.product_characteristic_value = 'high';",
    "table_names": [
      "Ref_Colors",
      "Products",
      "Product_Characteristics"
    ]
  },
  {
    "id": 80,
    "db_id": "college_2",
    "question": "Find the name of students who took some course offered by Statistics department.",
    "sql": "SELECT T3.name FROM course AS T1 JOIN takes AS T2 ON T1.course_id  =  T2.course_id JOIN student AS T3 ON T2.id  =  T3.id WHERE T1.dept_name  =  'Statistics'",
    "table_names": [
      "course",
      "student",
      "takes"
    ]
  },
  {
    "id": 186,
    "db_id": "party_host",
    "question": "Who are the main hosts in charge of parties hosted at Heineken Music Hall Amsterdam, and what are their nationalities?",
    "sql": "SELECT h.Name, h.Nationality FROM host h JOIN party_host ph ON h.Host_ID = ph.Host_ID JOIN party p ON p.Party_ID = ph.Party_ID WHERE p.Location = 'Heineken Music Hall Amsterdam' AND ph.Is_Main_in_Charge = 'T';",
    "table_names": [
      "party",
      "host",
      "party_host"
    ]
  },
  {
    "id": 572,
    "db_id": "tracking_share_transactions",
    "question": "What is the total amount of transactions (sum of amount_of_transaction) for all 'PUR' type transactions associated with lots having 'd' as lot_details?",
    "sql": "SELECT SUM(t.amount_of_transaction) FROM Transactions t JOIN Transactions_Lots tl ON t.transaction_id = tl.transaction_id JOIN Lots l ON tl.lot_id = l.lot_id WHERE t.transaction_type_code = 'PUR' AND l.lot_details = 'd';",
    "table_names": [
      "Lots",
      "Transactions",
      "Transactions_Lots"
    ]
  },
  {
    "id": 527,
    "db_id": "products_gen_characteristics",
    "question": "What is the name of the herb product with high purity?",
    "sql": "SELECT p.product_name FROM Products p JOIN Product_Characteristics pc ON p.product_id = pc.product_id JOIN Characteristics c ON pc.characteristic_id = c.characteristic_id WHERE c.characteristic_type_code = 'Purity' AND pc.product_characteristic_value = 'high' AND p.product_category_code = 'Herbs';",
    "table_names": [
      "Characteristics",
      "Products",
      "Product_Characteristics"
    ]
  },
  {
    "id": 306,
    "db_id": "college_1",
    "question": "Who is the department employee listed as being responsible for the department that offers the class held on Wednesdays from 6:00 to 8:40 p.m.?",
    "sql": "SELECT EMP_FNAME, EMP_LNAME FROM EMPLOYEE WHERE EMP_NUM = (SELECT EMP_NUM FROM DEPARTMENT WHERE DEPT_CODE = (SELECT SUBSTR(CRS_CODE, 1, INSTR(CRS_CODE, '-') - 1) FROM CLASS WHERE CLASS_TIME = 'W 6:00-8:40 p.m.'))",
    "table_names": [
      "CLASS",
      "DEPARTMENT",
      "EMPLOYEE",
      "PROFESSOR"
    ]
  },
  {
    "id": 409,
    "db_id": "club_1",
    "question": "What is the full name of the student who serves as Teaching Coordinator in the Bootup Baltimore club?",
    "sql": "SELECT Student.Fname, Student.LName FROM Student JOIN Member_of_club ON Student.StuID = Member_of_club.StuID JOIN Club ON Member_of_club.ClubID = Club.ClubID WHERE Club.ClubName = 'Bootup Baltimore' AND Member_of_club.Position = 'Teaching Coordinator';",
    "table_names": [
      "Student",
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 693,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "What documents are based on templates with the type 'Paper' that became effective between the years 2000 and 2010?",
    "sql": "SELECT D.Document_Name FROM Documents D JOIN Templates T ON D.Template_ID = T.Template_ID JOIN Ref_Template_Types R ON T.Template_Type_Code = R.Template_Type_Code WHERE R.Template_Type_Description = 'Paper' AND T.Date_Effective_From BETWEEN '2000-01-01' AND '2010-12-31';",
    "table_names": [
      "Ref_Template_Types",
      "Templates",
      "Documents"
    ]
  },
  {
    "id": 35,
    "db_id": "journal_committee",
    "question": "What is the name of the editor who contributed to the journal entry with the highest sales?",
    "sql": "SELECT e.Name FROM editor e JOIN journal_committee jc ON e.Editor_ID = jc.Editor_ID JOIN journal j ON jc.Journal_ID = j.Journal_ID WHERE j.Sales = (SELECT MAX(Sales) FROM journal);",
    "table_names": [
      "journal",
      "editor",
      "journal_committee"
    ]
  },
  {
    "id": 123,
    "db_id": "browser_web",
    "question": "List the names of web client accelerators that became compatible before the year 2000 with browsers having more than 10% market share.",
    "sql": "SELECT wc.name FROM Web_client_accelerator wc JOIN accelerator_compatible_browser acb ON wc.id = acb.accelerator_id JOIN browser b ON acb.browser_id = b.id WHERE b.market_share > 10 AND acb.compatible_since_year < 2000;",
    "table_names": [
      "Web_client_accelerator",
      "browser",
      "accelerator_compatible_browser"
    ]
  },
  {
    "id": 177,
    "db_id": "movie_1",
    "question": "What is the average star rating given by reviewers who rated the movie directed by themselves?",
    "sql": "SELECT AVG(RT.stars) FROM Rating RT JOIN Movie M ON RT.mID = M.mID JOIN Reviewer RV ON RT.rID = RV.rID WHERE M.director = RV.name;",
    "table_names": [
      "Movie",
      "Reviewer",
      "Rating"
    ]
  },
  {
    "id": 518,
    "db_id": "products_gen_characteristics",
    "question": "Which seed products have a high characteristic value associated with the characteristic 'fast'?",
    "sql": "SELECT P.product_name FROM Products P JOIN Product_Characteristics PC ON P.product_id = PC.product_id JOIN Characteristics C ON PC.characteristic_id = C.characteristic_id WHERE C.characteristic_name = 'fast' AND PC.product_characteristic_value = 'high' AND P.product_category_code = 'Seeds';",
    "table_names": [
      "Characteristics",
      "Products",
      "Product_Characteristics"
    ]
  },
  {
    "id": 91,
    "db_id": "wedding",
    "question": "Find the names of couples and the churches where the marriage took place, for all weddings held at churches organized in or before 1835. Also give the opening date of these churches.",
    "sql": "SELECT p1.Name AS Groom, p2.Name AS Bride, c.Name AS Church_Name, c.Open_Date FROM wedding w JOIN people p1 ON w.Male_ID = p1.People_ID JOIN people p2 ON w.Female_ID = p2.People_ID JOIN church c ON w.Church_ID = c.Church_ID WHERE c.Open_Date <= 1835;",
    "table_names": [
      "people",
      "church",
      "wedding"
    ]
  },
  {
    "id": 277,
    "db_id": "college_1",
    "question": "Which department offers the highest total course credits for classes scheduled on Tuesday and Thursday (TTh)?",
    "sql": "SELECT D.DEPT_NAME, SUM(C.CRS_CREDIT) AS TOTAL_CREDITS FROM CLASS CL JOIN COURSE C ON CL.CRS_CODE = C.CRS_CODE JOIN DEPARTMENT D ON C.DEPT_CODE = D.DEPT_CODE WHERE CL.CLASS_TIME LIKE '%TTh%' GROUP BY D.DEPT_NAME ORDER BY TOTAL_CREDITS DESC LIMIT 1;",
    "table_names": [
      "CLASS",
      "COURSE",
      "DEPARTMENT",
      "ENROLL"
    ]
  },
  {
    "id": 714,
    "db_id": "dog_kennels",
    "question": "How many dogs of breed 'BUL' are owned by individuals residing in North Dakota or Arizona?",
    "sql": "SELECT COUNT(*) FROM Dogs AS d JOIN Owners AS o ON d.owner_id = o.owner_id WHERE d.breed_code = 'BUL' AND o.state IN ('NorthDakota','Arizona');",
    "table_names": [
      "Owners",
      "Dogs",
      "Professionals"
    ]
  },
  {
    "id": 160,
    "db_id": "formula_1",
    "question": "Find the id and surname of the driver who participated the most number of races?",
    "sql": "SELECT T1.driverid ,  T1.surname FROM drivers AS T1 JOIN results AS T2 ON T1.driverid = T2.driverid JOIN races AS T3 ON T2.raceid = T3.raceid GROUP BY T1.driverid ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "races",
      "drivers",
      "results"
    ]
  },
  {
    "id": 688,
    "db_id": "car_1",
    "question": "Which countries produce car models 'mercedes', 'renault', and 'fiat'?",
    "sql": "SELECT DISTINCT c.CountryName FROM countries c JOIN car_makers cm ON c.CountryId = cm.Country JOIN model_list m ON cm.Id = m.Maker WHERE m.Model IN ('mercedes', 'renault', 'fiat');",
    "table_names": [
      "countries",
      "car_makers",
      "model_list"
    ]
  },
  {
    "id": 477,
    "db_id": "store_product",
    "question": "Which store has the largest area size among the stores that are located in districts with a city population higher than 200,000?",
    "sql": "SELECT s.Store_Name, s.Area_size FROM store s JOIN store_district sd ON s.Store_ID = sd.Store_ID JOIN district d ON sd.District_ID = d.District_ID WHERE d.City_Population > 200000 ORDER BY s.Area_size DESC LIMIT 1;",
    "table_names": [
      "store",
      "district",
      "store_district"
    ]
  },
  {
    "id": 407,
    "db_id": "club_1",
    "question": "How many students live in cities that have at least one member in the 'Bootup Baltimore' club?",
    "sql": "SELECT COUNT(*) FROM Student WHERE city_code IN (SELECT DISTINCT city_code FROM Student JOIN Member_of_club ON Student.StuID = Member_of_club.StuID JOIN Club ON Member_of_club.ClubID = Club.ClubID WHERE Club.ClubName = 'Bootup Baltimore');",
    "table_names": [
      "Student",
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 389,
    "db_id": "club_1",
    "question": "What is the name of the club that the youngest student from BAL city is a member of?",
    "sql": "SELECT C.ClubName FROM Club C JOIN Member_of_club M ON C.ClubID = M.ClubID JOIN Student S ON M.StuID = S.StuID WHERE S.city_code = 'BAL' AND S.Age = (SELECT MIN(Age) FROM Student WHERE city_code = 'BAL');",
    "table_names": [
      "Student",
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 514,
    "db_id": "products_gen_characteristics",
    "question": "What is the color_description of the Herbs category product which has the name 'catnip' and what is the characteristic_data_type for the characteristic_name 'slow' under the characteristic_type_code 'Purity'?",
    "sql": "SELECT rc.color_description, c.characteristic_data_type FROM Products p JOIN Ref_Colors rc ON p.color_code = rc.color_code JOIN Characteristics c ON c.characteristic_name = 'slow' AND c.characteristic_type_code = 'Purity' WHERE p.product_name = 'catnip';",
    "table_names": [
      "Ref_Colors",
      "Characteristics",
      "Products",
      "Product_Characteristics"
    ]
  },
  {
    "id": 712,
    "db_id": "network_1",
    "question": "Which 9th grade students have friends who like Jessica?",
    "sql": "SELECT h1.name FROM Highschooler h1 INNER JOIN Friend f ON h1.ID = f.student_id INNER JOIN Highschooler h2 ON f.friend_id = h2.ID INNER JOIN Likes l ON h2.ID = l.student_id INNER JOIN Highschooler h3 ON l.liked_id = h3.ID WHERE h3.name = 'Jessica' AND h1.grade = 9;",
    "table_names": [
      "Highschooler",
      "Friend",
      "Likes"
    ]
  },
  {
    "id": 260,
    "db_id": "assets_maintenance",
    "question": "How many distinct companies with a company address mentioning 'Apt.' have active maintenance contracts ending in March 2018, and also have registered maintenance engineers?",
    "sql": "SELECT COUNT(DISTINCT Third_Party_Companies.company_id) FROM Third_Party_Companies JOIN Maintenance_Contracts ON Third_Party_Companies.company_id = Maintenance_Contracts.maintenance_contract_company_id JOIN Maintenance_Engineers ON Maintenance_Engineers.company_id = Third_Party_Companies.company_id WHERE Maintenance_Contracts.contract_end_date >= '2018-03-01 00:00:00' AND Third_Party_Companies.company_address LIKE '%Apt.%';",
    "table_names": [
      "Third_Party_Companies",
      "Maintenance_Contracts",
      "Maintenance_Engineers"
    ]
  },
  {
    "id": 615,
    "db_id": "city_record",
    "question": "Which city hosted the match in 2011 and what was its GDP?",
    "sql": "SELECT city.City, city.GDP FROM city JOIN hosting_city ON city.City_ID = hosting_city.Host_City WHERE hosting_city.Year = 2011",
    "table_names": [
      "city",
      "temperature",
      "hosting_city"
    ]
  },
  {
    "id": 434,
    "db_id": "document_management",
    "question": "How many distinct books contain a section with the image having ID 14?",
    "sql": "SELECT COUNT(DISTINCT d.document_code) FROM Documents d JOIN Document_Sections ds ON d.document_code = ds.document_code JOIN Document_Sections_Images dsi ON ds.section_id = dsi.section_id WHERE d.document_type_code = 'Book' AND dsi.image_id = 14;",
    "table_names": [
      "Documents",
      "Document_Sections",
      "Document_Sections_Images"
    ]
  },
  {
    "id": 548,
    "db_id": "dorm_1",
    "question": "List the names of dorms with gender type either mixed 'X' or male 'M', occupied by students originating from city code 'PIT'.",
    "sql": "SELECT d.dorm_name FROM Dorm d INNER JOIN Lives_in li ON d.dormid = li.dormid INNER JOIN Student s ON li.stuid = s.StuID WHERE s.city_code = 'PIT' AND d.gender IN ('X', 'M');",
    "table_names": [
      "Student",
      "Dorm",
      "Lives_in"
    ]
  },
  {
    "id": 225,
    "db_id": "icfp_1",
    "question": "What is the country location of the institution associated with authors of the paper titled 'Functional Pearl: Modular Rollback through Control Logging'?",
    "sql": "SELECT DISTINCT Inst.country FROM Inst JOIN Authorship ON Inst.instID = Authorship.instID JOIN Papers ON Authorship.paperID = Papers.paperID WHERE Papers.title = 'Functional Pearl: Modular Rollback through Control Logging';",
    "table_names": [
      "Inst",
      "Papers",
      "Authorship"
    ]
  },
  {
    "id": 1,
    "db_id": "department_management",
    "question": "Which department(s) currently have temporary acting heads who were born in California?",
    "sql": "SELECT department.Department_Name FROM department INNER JOIN management ON department.Department_ID = management.Department_ID INNER JOIN head ON management.head_ID = head.head_ID WHERE head.born_state = 'California' AND management.temporary_acting='Yes';",
    "table_names": [
      "department",
      "head",
      "management"
    ]
  },
  {
    "id": 220,
    "db_id": "icfp_1",
    "question": "List the institutions that have authors who published more than one distinct paper.",
    "sql": "SELECT name FROM Inst WHERE instID IN (SELECT instID FROM Authorship GROUP BY instID HAVING COUNT(DISTINCT paperID) > 1);",
    "table_names": [
      "Inst",
      "Authors",
      "Authorship"
    ]
  },
  {
    "id": 96,
    "db_id": "riding_club",
    "question": "What is the name and sponsor of the player who started working with the highest-ranked female coach, and in which year did they start?",
    "sql": "SELECT p.Player_name, p.Sponsor_name, pc.Starting_year FROM player p JOIN player_coach pc ON p.Player_ID = pc.Player_ID JOIN coach c ON pc.Coach_ID = c.Coach_ID WHERE c.Gender = 'F' ORDER BY c.Rank ASC LIMIT 1;",
    "table_names": [
      "player",
      "coach",
      "player_coach"
    ]
  },
  {
    "id": 157,
    "db_id": "formula_1",
    "question": "What is the id, forename, and number of races for all drivers that have participated in at least 2 races?",
    "sql": "SELECT T1.driverid ,  T1.forename ,  count(*) FROM drivers AS T1 JOIN results AS T2 ON T1.driverid = T2.driverid JOIN races AS T3 ON T2.raceid = T3.raceid GROUP BY T1.driverid HAVING count(*)  >=  2",
    "table_names": [
      "races",
      "drivers",
      "results"
    ]
  },
  {
    "id": 575,
    "db_id": "cre_Theme_park",
    "question": "List names of visitors who visited a tourist attraction located at location id 417 and got there by shuttle.",
    "sql": "SELECT Tourist_Details FROM Visitors WHERE Tourist_ID IN (SELECT Tourist_ID FROM Visits WHERE Tourist_Attraction_ID IN (SELECT Tourist_Attraction_ID FROM Tourist_Attractions WHERE Location_ID = 417 AND How_to_Get_There = 'shuttle'));",
    "table_names": [
      "Visitors",
      "Tourist_Attractions",
      "Visits"
    ]
  },
  {
    "id": 534,
    "db_id": "dorm_1",
    "question": "Which dormitories that have both 'Air Conditioning' and 'Working Fireplaces' have a student capacity greater than 200?",
    "sql": "SELECT d.dorm_name FROM Dorm d JOIN Has_amenity ha ON d.dormid = ha.dormid JOIN Dorm_amenity da ON ha.amenid = da.amenid WHERE da.amenity_name IN ('Air Conditioning', 'Working Fireplaces') AND d.student_capacity > 200 GROUP BY d.dorm_name HAVING COUNT(DISTINCT da.amenity_name) = 2;",
    "table_names": [
      "Dorm",
      "Dorm_amenity",
      "Has_amenity"
    ]
  },
  {
    "id": 121,
    "db_id": "small_bank_1",
    "question": "Which customers have savings account balances greater than 50,000 and checking account balances above 5,000?",
    "sql": "SELECT A.name FROM ACCOUNTS A JOIN SAVINGS S ON A.custid = S.custid JOIN CHECKING C ON A.custid = C.custid WHERE S.balance > 50000 AND C.balance > 5000;",
    "table_names": [
      "ACCOUNTS",
      "SAVINGS",
      "CHECKING"
    ]
  },
  {
    "id": 589,
    "db_id": "customers_and_addresses",
    "question": "Find the names of customers who use Credit Card payments and have addresses located in Colorado, along with the cities of those addresses.",
    "sql": "SELECT cu.customer_name, a.city FROM Customers cu JOIN Customer_Addresses ca ON cu.customer_id = ca.customer_id JOIN Addresses a ON ca.address_id = a.address_id WHERE cu.payment_method = 'Credit Card' AND a.state_province_county = 'Colorado';",
    "table_names": [
      "Addresses",
      "Customers",
      "Customer_Addresses"
    ]
  },
  {
    "id": 546,
    "db_id": "dorm_1",
    "question": "List the first and last names of students older than 18 who reside in Smith Hall.",
    "sql": "SELECT s.Fname, s.LName FROM Student s JOIN Lives_in l ON s.StuID = l.stuid JOIN Dorm d ON l.dormid = d.dormid WHERE d.dorm_name = 'Smith Hall' AND s.Age > 18;",
    "table_names": [
      "Student",
      "Dorm",
      "Lives_in"
    ]
  },
  {
    "id": 234,
    "db_id": "icfp_1",
    "question": "Who has co-authored papers with Ralf Hinze?",
    "sql": "SELECT au.lname, au.fname FROM Authors au JOIN Authorship aship ON au.authID = aship.authID JOIN Papers p ON aship.paperID = p.paperID WHERE p.paperID IN (SELECT paperID FROM Authorship WHERE authID = (SELECT authID FROM Authors WHERE lname = 'Hinze' AND fname = 'Ralf')) AND au.lname != 'Hinze';",
    "table_names": [
      "Authors",
      "Papers",
      "Authorship"
    ]
  },
  {
    "id": 97,
    "db_id": "riding_club",
    "question": "Who is the coach of the player named Judy Wasylycia-Leis?",
    "sql": "SELECT c.Coach_name FROM coach c JOIN player_coach pc ON c.Coach_ID = pc.Coach_ID JOIN player p ON pc.Player_ID = p.Player_ID WHERE p.Player_name = 'Judy Wasylycia-Leis';",
    "table_names": [
      "player",
      "coach",
      "player_coach"
    ]
  },
  {
    "id": 133,
    "db_id": "phone_market",
    "question": "Which phone with a memory of at least 64 GB is available in the market located in the district 'British Columbia', and what is its carrier and stock count?",
    "sql": "SELECT p.Name, p.Carrier, pm.Num_of_stock FROM phone p JOIN phone_market pm ON p.Phone_ID = CAST(pm.Phone_ID AS INTEGER) JOIN market m ON pm.Market_ID = m.Market_ID WHERE p.Memory_in_G >= 64 AND m.District = 'British Columbia';",
    "table_names": [
      "phone",
      "market",
      "phone_market"
    ]
  },
  {
    "id": 467,
    "db_id": "customers_and_addresses",
    "question": "How many unique products were ordered by customers paying with a credit card whose orders have a pending status?",
    "sql": "SELECT COUNT(DISTINCT oi.product_id) FROM Customers c JOIN Customer_Orders co ON c.customer_id = co.customer_id JOIN Order_Items oi ON co.order_id = oi.order_id WHERE c.payment_method_code = 'Credit Card' AND co.order_status_code = 'Pending';",
    "table_names": [
      "Customers",
      "Customer_Orders",
      "Order_Items"
    ]
  },
  {
    "id": 418,
    "db_id": "tracking_grants_for_research",
    "question": "How many unique documents are associated with grants provided by organisations that have awarded grants with amounts exceeding 1,000,000?",
    "sql": "SELECT COUNT(DISTINCT d.document_id) FROM Documents d JOIN Grants g ON d.grant_id = g.grant_id WHERE g.organisation_id IN (SELECT DISTINCT organisation_id FROM Grants WHERE grant_amount > 1000000);",
    "table_names": [
      "Documents",
      "Grants",
      "Organisation_Types",
      "Organisations"
    ]
  },
  {
    "id": 55,
    "db_id": "game_injury",
    "question": "How many distinct players suffered injuries causing them to miss at least 3 matches in games held at New Meadowlands Stadium?",
    "sql": "SELECT COUNT(DISTINCT injury_accident.Player) FROM injury_accident JOIN game ON injury_accident.game_id = game.id JOIN stadium ON game.stadium_id = stadium.id WHERE stadium.name = 'New Meadowlands Stadium' AND injury_accident.Number_of_matches >= 3;",
    "table_names": [
      "stadium",
      "game",
      "injury_accident"
    ]
  },
  {
    "id": 560,
    "db_id": "dorm_1",
    "question": "Which dorms with a student capacity greater than 100 have a 'Pub in Basement' as an amenity?",
    "sql": "SELECT Dorm.dorm_name FROM Dorm JOIN Has_amenity ON Dorm.dormid = Has_amenity.dormid JOIN Dorm_amenity ON Has_amenity.amenid = Dorm_amenity.amenid WHERE Dorm.student_capacity > 100 AND Dorm_amenity.amenity_name = 'Pub in Basement';",
    "table_names": [
      "Dorm",
      "Dorm_amenity",
      "Has_amenity"
    ]
  },
  {
    "id": 461,
    "db_id": "customers_and_addresses",
    "question": "Find the names and prices of hardware products priced above 800, and the name of the customer who placed order number 14.",
    "sql": "SELECT p.product_name, p.product_price, c.customer_name FROM Products p JOIN Customer_Orders co ON co.order_id = 14 JOIN Customers c ON c.customer_id = co.customer_id WHERE p.product_type_code = 'Hardware' AND p.product_price > 800;",
    "table_names": [
      "Customers",
      "Products",
      "Customer_Orders",
      "Order_Items"
    ]
  },
  {
    "id": 671,
    "db_id": "pets_1",
    "question": "List the last name and first name of students who live in city code 'HKG' and own dogs.",
    "sql": "SELECT S.LName, S.Fname FROM Student S WHERE S.city_code = 'HKG' AND S.StuID IN (SELECT H.StuID FROM Has_Pet H INNER JOIN Pets P ON H.PetID = P.PetID WHERE P.PetType = 'dog');",
    "table_names": [
      "Student",
      "Has_Pet",
      "Pets"
    ]
  },
  {
    "id": 366,
    "db_id": "company_employee",
    "question": "Which automotive company employs a person from the United States who has been working there for at least 3 years?",
    "sql": "SELECT c.Name FROM company c JOIN employment e ON c.Company_ID = e.Company_ID JOIN people p ON e.People_ID = p.People_ID WHERE p.Nationality = 'United States' AND c.Industry = 'Automotive' AND e.Year_working >= 3;",
    "table_names": [
      "people",
      "company",
      "employment"
    ]
  },
  {
    "id": 644,
    "db_id": "flight_4",
    "question": "Return the number of routes with destination airport in Italy operated by the airline with name 'American Airlines'.",
    "sql": "SELECT count(*) FROM routes AS T1 JOIN airports AS T2 ON T1.dst_apid  =  T2.apid JOIN airlines AS T3 ON T1.alid  =  T3.alid WHERE T2.country  =  'Italy' AND T3.name  =  'American Airlines'",
    "table_names": [
      "routes",
      "airports",
      "airlines"
    ]
  },
  {
    "id": 528,
    "db_id": "products_gen_characteristics",
    "question": "What are the names of the seed products which have 'medium' value in the 'Grade' characteristic type?",
    "sql": "SELECT p.product_name FROM Products p JOIN Product_Characteristics pc ON p.product_id = pc.product_id JOIN Characteristics c ON c.characteristic_id = pc.characteristic_id WHERE c.characteristic_type_code = 'Grade' AND pc.product_characteristic_value = 'medium' AND p.product_category_code = 'Seeds';",
    "table_names": [
      "Characteristics",
      "Products",
      "Product_Characteristics"
    ]
  },
  {
    "id": 327,
    "db_id": "baseball_1",
    "question": "What are the first name and last name of the players who were paid salary by team Washington Nationals in both 2005 and 2007?",
    "sql": "SELECT T2.name_first ,  T2.name_last FROM salary AS T1 JOIN player AS T2 ON T1.player_id = T2.player_id JOIN team AS T3 ON T3.team_id_br = T1.team_id WHERE T1.year = 2005 AND T3.name = 'Washington Nationals' INTERSECT SELECT T2.name_first , T2.name_last FROM salary AS T1 JOIN player AS T2 ON T1.player_id = T2.player_id JOIN team AS T3 ON T3.team_id_br = T1.team_id WHERE T1.year = 2007 AND T3.name = 'Washington Nationals'",
    "table_names": [
      "player",
      "salary",
      "team"
    ]
  },
  {
    "id": 643,
    "db_id": "activity_1",
    "question": "Which instructor participates in the most number of activities? Provide their full name.",
    "sql": "SELECT F.Fname, F.Lname, COUNT(*) AS activity_count FROM Faculty F JOIN Faculty_Participates_in FP ON F.FacID = FP.FacID JOIN Activity A ON FP.actid = A.actid WHERE F.Rank = 'Instructor' GROUP BY F.FacID ORDER BY activity_count DESC LIMIT 1;",
    "table_names": [
      "Activity",
      "Faculty_Participates_in",
      "Faculty"
    ]
  },
  {
    "id": 522,
    "db_id": "products_gen_characteristics",
    "question": "What are the distinctly described colors of the herb products that have a recorded buying price?",
    "sql": "SELECT R.color_description FROM Products P JOIN Ref_Colors R ON P.color_code = R.color_code WHERE P.product_id IN (SELECT product_id FROM Products WHERE product_category_code = 'Herbs' AND typical_buying_price <> '') GROUP BY R.color_description;",
    "table_names": [
      "Ref_Colors",
      "Characteristics",
      "Products",
      "Product_Characteristics"
    ]
  },
  {
    "id": 446,
    "db_id": "entertainment_awards",
    "question": "In which festival and year did the artwork named 'I Know' win?",
    "sql": "SELECT fd.Festival_Name, fd.Year FROM festival_detail fd JOIN nomination n ON fd.Festival_ID = n.Festival_ID JOIN artwork a ON n.Artwork_ID = a.Artwork_ID WHERE a.Name = 'I Know' AND n.Result = 'Won';",
    "table_names": [
      "festival_detail",
      "artwork",
      "nomination"
    ]
  },
  {
    "id": 254,
    "db_id": "loan_1",
    "question": "What is the name of the customer from New York who has a Business loan and is associated with a bank branch having more than 300 customers?",
    "sql": "SELECT customer.cust_name FROM customer JOIN bank ON customer.branch_ID = bank.branch_ID JOIN loan ON customer.cust_ID = loan.cust_ID WHERE customer.state = 'New York' AND bank.no_of_customers > 300 AND loan.loan_type = 'Business';",
    "table_names": [
      "bank",
      "customer",
      "loan"
    ]
  },
  {
    "id": 46,
    "db_id": "medicine_enzyme_interaction",
    "question": "Which FDA-approved medicines act as inhibitors on enzymes located in the Cytosol?",
    "sql": "SELECT m.name FROM medicine m JOIN medicine_enzyme_interaction mei ON m.id = mei.medicine_id JOIN enzyme e ON mei.enzyme_id = e.id WHERE e.Location = 'Cytosol' AND mei.interaction_type = 'inhibitor' AND m.FDA_approved = 'Yes';",
    "table_names": [
      "medicine",
      "enzyme",
      "medicine_enzyme_interaction"
    ]
  },
  {
    "id": 505,
    "db_id": "products_gen_characteristics",
    "question": "Find the names of products in the 'Seeds' category that have a 'Grade' characteristic of 'fast' and specify their corresponding characteristic values.",
    "sql": "SELECT p.product_name, pc.product_characteristic_value FROM Products p JOIN Product_Characteristics pc ON p.product_id = pc.product_id JOIN Characteristics c ON pc.characteristic_id = c.characteristic_id WHERE p.product_category_code = 'Seeds' AND c.characteristic_type_code = 'Grade' AND c.characteristic_name = 'fast';",
    "table_names": [
      "Characteristics",
      "Products",
      "Product_Characteristics"
    ]
  },
  {
    "id": 480,
    "db_id": "store_product",
    "question": "What is the name of the district which has the store with the highest number of product categories?",
    "sql": "SELECT d.District_name FROM district d JOIN store_district sd ON d.District_ID = sd.District_ID JOIN store s ON sd.Store_ID = s.Store_ID WHERE s.Number_of_product_category = (SELECT MAX(Number_of_product_category) FROM store);",
    "table_names": [
      "store",
      "district",
      "store_district"
    ]
  },
  {
    "id": 520,
    "db_id": "products_gen_characteristics",
    "question": "What is the color of the product named 'cumin', if its product description matches the characteristic type code of a characteristic named 'cool'?",
    "sql": "SELECT rc.color_description FROM Ref_Colors rc JOIN Products p ON rc.color_code = p.color_code JOIN Characteristics c ON p.product_description = c.characteristic_type_code WHERE p.product_name = 'cumin' AND c.characteristic_name = 'cool';",
    "table_names": [
      "Ref_Colors",
      "Characteristics",
      "Products",
      "Product_Characteristics"
    ]
  },
  {
    "id": 264,
    "db_id": "assets_maintenance",
    "question": "Which chargeable parts have had faults that required skill ID 3 to fix?",
    "sql": "SELECT DISTINCT p.part_name FROM Parts p JOIN Part_Faults pf ON p.part_id = pf.part_id JOIN Skills_Required_To_Fix sf ON pf.part_fault_id = sf.part_fault_id WHERE sf.skill_id = 3 AND p.chargeable_yn = '1';",
    "table_names": [
      "Parts",
      "Part_Faults",
      "Skills_Required_To_Fix"
    ]
  },
  {
    "id": 152,
    "db_id": "formula_1",
    "question": "What are the forenames and surnames of drivers who participated in the races named Australian Grand Prix but not the races named Chinese Grand Prix?",
    "sql": "SELECT T3.forename ,  T3.surname FROM races AS T1 JOIN results AS T2 ON T1.raceid = T2.raceid JOIN drivers AS T3 ON T2.driverid = T3.driverid WHERE T1.name = \"Australian Grand Prix\" EXCEPT SELECT T3.forename ,  T3.surname FROM races AS T1 JOIN results AS T2 ON T1.raceid = T2.raceid JOIN drivers AS T3 ON T2.driverid = T3.driverid WHERE T1.name = \"Chinese Grand Prix\"",
    "table_names": [
      "races",
      "drivers",
      "results"
    ]
  },
  {
    "id": 635,
    "db_id": "train_station",
    "question": "Which stations served by 'Island Express' have more than 15 platforms?",
    "sql": "SELECT s.Name FROM station s JOIN train_station ts ON s.Station_ID = ts.Station_ID JOIN train t ON ts.Train_ID = t.Train_ID WHERE t.Name = 'Island Express' AND s.Number_of_Platforms > 15;",
    "table_names": [
      "station",
      "train",
      "train_station"
    ]
  },
  {
    "id": 537,
    "db_id": "dorm_1",
    "question": "How many dorms with a student capacity greater than 100 have the amenity 'Pub in Basement'?",
    "sql": "SELECT COUNT(DISTINCT d.dormid) FROM Dorm d JOIN Has_amenity ha ON d.dormid = ha.dormid JOIN Dorm_amenity da ON ha.amenid = da.amenid WHERE d.student_capacity > 100 AND da.amenity_name = 'Pub in Basement';",
    "table_names": [
      "Dorm",
      "Dorm_amenity",
      "Has_amenity"
    ]
  },
  {
    "id": 696,
    "db_id": "course_teach",
    "question": "What course scheduled on 9 May is taught by a teacher from Little Lever Urban District?",
    "sql": "SELECT course.Course FROM course JOIN course_arrange ON course.Course_ID = course_arrange.Course_ID JOIN teacher ON course_arrange.Teacher_ID = teacher.Teacher_ID WHERE teacher.Hometown = 'Little Lever Urban District' AND course.Staring_Date = '9 May';",
    "table_names": [
      "course",
      "teacher",
      "course_arrange"
    ]
  },
  {
    "id": 257,
    "db_id": "loan_1",
    "question": "Which loan types have customers with account balances greater than 100000 from banks in New York?",
    "sql": "SELECT loan.loan_type FROM loan INNER JOIN customer ON loan.cust_ID = customer.cust_ID INNER JOIN bank ON loan.branch_ID = bank.branch_ID WHERE bank.state = 'New York' AND customer.acc_bal > 100000;",
    "table_names": [
      "bank",
      "customer",
      "loan"
    ]
  },
  {
    "id": 662,
    "db_id": "pets_1",
    "question": "What is the average age of pets owned by students who live in city code 'HKG'?",
    "sql": "SELECT AVG(Pets.pet_age) FROM Student INNER JOIN Has_Pet ON Student.StuID = Has_Pet.StuID INNER JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE Student.city_code = 'HKG';",
    "table_names": [
      "Student",
      "Has_Pet",
      "Pets"
    ]
  },
  {
    "id": 543,
    "db_id": "dorm_1",
    "question": "What is the number of distinct dormitories housing students advised by advisor 1121?",
    "sql": "SELECT COUNT(DISTINCT d.dormid) FROM Dorm d JOIN Lives_in l ON d.dormid = l.dormid JOIN Student s ON s.StuID = l.stuid WHERE s.Advisor = 1121;",
    "table_names": [
      "Student",
      "Dorm",
      "Lives_in"
    ]
  },
  {
    "id": 110,
    "db_id": "small_bank_1",
    "question": "Which customers have a savings account balance greater than 100000 and a checking account balance less than 5000?",
    "sql": "SELECT a.name FROM ACCOUNTS a JOIN SAVINGS s ON a.custid = s.custid JOIN CHECKING c ON a.custid = c.custid WHERE s.balance > 100000 AND c.balance < 5000;",
    "table_names": [
      "ACCOUNTS",
      "SAVINGS",
      "CHECKING"
    ]
  },
  {
    "id": 706,
    "db_id": "student_transcripts_tracking",
    "question": "What is the country of the permanent address of the student enrolled in degree program 9 during semester 15?",
    "sql": "SELECT a.country FROM Addresses a JOIN Students s ON a.address_id = s.permanent_address_id JOIN Student_Enrolment e ON s.student_id = e.student_id WHERE e.degree_program_id = 9 AND e.semester_id = 15;",
    "table_names": [
      "Addresses",
      "Students",
      "Student_Enrolment"
    ]
  },
  {
    "id": 63,
    "db_id": "performance_attendance",
    "question": "What is the total attendance of all performances in which violin players performed?",
    "sql": "SELECT SUM(p.Attendance) FROM performance AS p JOIN member_attendance AS ma ON p.Performance_ID = ma.Performance_ID JOIN member AS m ON ma.Member_ID = m.Member_ID WHERE m.Role = 'Violin';",
    "table_names": [
      "member",
      "performance",
      "member_attendance"
    ]
  },
  {
    "id": 474,
    "db_id": "store_product",
    "question": "List the names, types of stores, and their corresponding district names and populations of cities where districts have city populations greater than 150000 and stores have more than 1500 product categories.",
    "sql": "SELECT s.Store_Name, s.Type, d.District_name, d.City_Population FROM store s JOIN store_district sd ON s.Store_ID = sd.Store_ID JOIN district d ON sd.District_ID = d.District_ID WHERE s.Number_of_product_category > 1500 AND d.City_Population > 150000;",
    "table_names": [
      "store",
      "district",
      "store_district"
    ]
  },
  {
    "id": 442,
    "db_id": "entertainment_awards",
    "question": "What is the most recent festival name in which an artwork with type 'Program Music/Variety Show' won?",
    "sql": "SELECT fd.Festival_Name FROM festival_detail fd JOIN nomination n ON fd.Festival_ID = n.Festival_ID JOIN artwork a ON n.Artwork_ID = a.Artwork_ID WHERE a.Type = 'Program Music/Variety Show' AND n.Result = 'Won' ORDER BY fd.Year DESC LIMIT 1;",
    "table_names": [
      "festival_detail",
      "artwork",
      "nomination"
    ]
  },
  {
    "id": 199,
    "db_id": "news_report",
    "question": "What are the names of the events that were hosted by journalists with more than 10 years of working experience?",
    "sql": "SELECT e.Name FROM event e JOIN news_report nr ON e.Event_ID = nr.Event_ID JOIN journalist j ON nr.journalist_ID = j.journalist_ID WHERE j.Years_working > 10 AND nr.Work_Type = 'Host';",
    "table_names": [
      "event",
      "journalist",
      "news_report"
    ]
  },
  {
    "id": 405,
    "db_id": "club_1",
    "question": "How many unique cities have students who hold the positions of President or Vice-President in their respective clubs?",
    "sql": "SELECT COUNT(DISTINCT Student.city_code) FROM Student INNER JOIN Member_of_club ON Student.StuID = Member_of_club.StuID WHERE Member_of_club.Position IN ('President', 'Vice-President');",
    "table_names": [
      "Student",
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 232,
    "db_id": "icfp_1",
    "question": "Who is the second author of the paper titled 'Functional Pearl: Modular Rollback through Control Logging'?",
    "sql": "SELECT A.fname, A.lname FROM Authors A JOIN Authorship AU ON A.authID = AU.authID JOIN Papers P ON AU.paperID = P.paperID WHERE P.title = 'Functional Pearl: Modular Rollback through Control Logging' AND AU.authOrder = 2;",
    "table_names": [
      "Authors",
      "Papers",
      "Authorship"
    ]
  },
  {
    "id": 37,
    "db_id": "journal_committee",
    "question": "Who was the editor responsible for the photo work in the journal issue with the highest sales?",
    "sql": "SELECT e.Name FROM editor e JOIN journal_committee jc ON e.Editor_ID = jc.Editor_ID JOIN journal j ON jc.Journal_ID = j.Journal_ID WHERE j.Sales = (SELECT MAX(Sales) FROM journal) AND jc.Work_Type = 'Photo';",
    "table_names": [
      "journal",
      "editor",
      "journal_committee"
    ]
  },
  {
    "id": 58,
    "db_id": "game_injury",
    "question": "In which stadium did Thiago Motta (2) sustain his injury during the 2011 season?",
    "sql": "SELECT s.name FROM stadium s JOIN game g ON s.id = g.stadium_id JOIN injury_accident i ON g.id = i.game_id WHERE i.Player = 'Thiago Motta (2)' AND g.Season = 2011;",
    "table_names": [
      "stadium",
      "game",
      "injury_accident"
    ]
  },
  {
    "id": 363,
    "db_id": "hospital_1",
    "question": "List the names of all patients who were prescribed the medication 'Thesisin' with a dose of 5.",
    "sql": "SELECT Patient.Name FROM Patient JOIN Prescribes ON Patient.SSN = Prescribes.Patient JOIN Medication ON Prescribes.Medication = Medication.Code WHERE Medication.Name = 'Thesisin' AND Prescribes.Dose = '5';",
    "table_names": [
      "Patient",
      "Medication",
      "Prescribes"
    ]
  },
  {
    "id": 367,
    "db_id": "company_employee",
    "question": "What is the name of the automotive company where an employee from the United States works?",
    "sql": "SELECT c.Name FROM company c JOIN employment e ON c.Company_ID = e.Company_ID JOIN people p ON p.People_ID = e.People_ID WHERE p.Nationality = 'United States' AND c.Industry = 'Automotive';",
    "table_names": [
      "people",
      "company",
      "employment"
    ]
  },
  {
    "id": 719,
    "db_id": "dog_kennels",
    "question": "Which veterinarian has performed the highest number of physical examinations, and how many examinations were performed by this veterinarian?",
    "sql": "SELECT p.first_name, p.last_name, COUNT(t.treatment_id) AS number_of_exams FROM Professionals AS p JOIN Treatments AS t ON p.professional_id = t.professional_id JOIN Treatment_Types AS tt ON t.treatment_type_code = tt.treatment_type_code WHERE tt.treatment_type_description = 'Physical examination' GROUP BY p.professional_id ORDER BY number_of_exams DESC LIMIT 1;",
    "table_names": [
      "Treatment_Types",
      "Professionals",
      "Treatments"
    ]
  },
  {
    "id": 151,
    "db_id": "formula_1",
    "question": "What is the id and first name of all the drivers who participated in the Australian Grand Prix and the Chinese Grand Prix?",
    "sql": "SELECT T2.driverid ,  T3.forename FROM races AS T1 JOIN results AS T2 ON T1.raceid = T2.raceid JOIN drivers AS T3 ON T2.driverid  =  T3.driverid WHERE T1.name = \"Australian Grand Prix\" INTERSECT SELECT T2.driverid ,  T3.forename FROM races AS T1 JOIN results AS T2 ON T1.raceid = T2.raceid JOIN drivers AS T3 ON T2.driverid  =  T3.driverid WHERE T1.name = \"Chinese Grand Prix\"",
    "table_names": [
      "races",
      "drivers",
      "results"
    ]
  },
  {
    "id": 686,
    "db_id": "car_1",
    "question": "How many unique car models are associated with car makers from Country '4'?",
    "sql": "SELECT COUNT(DISTINCT cn.Model) FROM car_names cn JOIN model_list ml ON cn.Model = ml.Model JOIN car_makers cm ON ml.Maker = cm.Id WHERE cm.Country = '4';",
    "table_names": [
      "car_makers",
      "model_list",
      "car_names"
    ]
  },
  {
    "id": 475,
    "db_id": "store_product",
    "question": "In which district is the store with the highest number of product categories located?",
    "sql": "SELECT d.District_name FROM district d JOIN store_district sd ON d.District_ID = sd.District_ID JOIN store s ON sd.Store_ID = s.Store_ID WHERE s.Number_of_product_category = (SELECT MAX(Number_of_product_category) FROM store);",
    "table_names": [
      "store",
      "district",
      "store_district"
    ]
  },
  {
    "id": 267,
    "db_id": "college_1",
    "question": "Which professors holding a Ph.D. degree working in departments of the Business school were hired before 1990?",
    "sql": "SELECT e.EMP_FNAME, e.EMP_LNAME FROM EMPLOYEE e JOIN PROFESSOR p ON e.EMP_NUM = p.EMP_NUM JOIN DEPARTMENT d ON p.DEPT_CODE = d.DEPT_CODE WHERE d.SCHOOL_CODE = 'BUS' AND p.PROF_HIGH_DEGREE = 'Ph.D.' AND e.EMP_HIREDATE < '1990-01-01';",
    "table_names": [
      "DEPARTMENT",
      "EMPLOYEE",
      "PROFESSOR"
    ]
  },
  {
    "id": 236,
    "db_id": "icfp_1",
    "question": "In which country is the institution affiliated with the author of the paper titled 'Making Standard ML a Practical Database Programming Language'?",
    "sql": "SELECT Inst.country FROM Inst JOIN Authors ON Inst.instID = Authors.authID JOIN Papers ON Papers.paperID = 204 WHERE Papers.title = 'Making Standard ML a Practical Database Programming Language';",
    "table_names": [
      "Inst",
      "Authors",
      "Papers",
      "Authorship"
    ]
  },
  {
    "id": 623,
    "db_id": "flight_company",
    "question": "What is the name of the airport and the principal activity of the operating company associated with the flight numbered 'M2-F1 #39'?",
    "sql": "SELECT a.name, oc.Principal_activities FROM flight f JOIN airport a ON f.airport_id = a.id JOIN operate_company oc ON f.company_id = oc.id WHERE f.Vehicle_Flight_number = 'M2-F1 #39';",
    "table_names": [
      "airport",
      "operate_company",
      "flight"
    ]
  },
  {
    "id": 207,
    "db_id": "customers_and_addresses",
    "question": "What are the names and payment methods of customers who have lived at addresses in Illinois?",
    "sql": "SELECT C.customer_name, C.payment_method FROM Customers C JOIN Customer_Addresses CA ON C.customer_id = CA.customer_id JOIN Addresses A ON CA.address_id = A.address_id WHERE A.state_province_county = 'Illinois';",
    "table_names": [
      "Addresses",
      "Customers",
      "Customer_Addresses"
    ]
  },
  {
    "id": 720,
    "db_id": "dog_kennels",
    "question": "Between March 1, 2018, and March 20, 2018, which type of treatment involved the greatest number of distinct professionals, and how many professionals were involved?",
    "sql": "SELECT TT.treatment_type_description, COUNT(DISTINCT T.professional_id) AS num_professionals FROM Treatments T JOIN Treatment_Types TT ON T.treatment_type_code = TT.treatment_type_code WHERE T.date_of_treatment BETWEEN '2018-03-01' AND '2018-03-20' GROUP BY TT.treatment_type_description ORDER BY num_professionals DESC LIMIT 1;",
    "table_names": [
      "Treatment_Types",
      "Professionals",
      "Treatments"
    ]
  },
  {
    "id": 370,
    "db_id": "film_rank",
    "question": "Which film has the highest combined estimated audience (using high estimates) in the markets of China and Japan?",
    "sql": "SELECT f.Title, SUM(fme.High_Estimate) AS total_high_estimate FROM film f JOIN film_market_estimation fme ON f.Film_ID = fme.Film_ID JOIN market m ON fme.Market_ID = m.Market_ID WHERE m.Country IN ('China', 'Japan') GROUP BY f.Film_ID ORDER BY total_high_estimate DESC LIMIT 1;",
    "table_names": [
      "film",
      "market",
      "film_market_estimation"
    ]
  },
  {
    "id": 57,
    "db_id": "game_injury",
    "question": "Which player had the highest number of matches missed due to injury during a game played at a stadium having greater than 100% capacity? Mention the stadium name, player name and number of matches missed.",
    "sql": "SELECT s.name, ia.Player, ia.Number_of_matches FROM stadium s JOIN game g ON g.stadium_id = s.id JOIN injury_accident ia ON ia.game_id = g.id WHERE s.Capacity_Percentage > 100 ORDER BY ia.Number_of_matches DESC LIMIT 1;",
    "table_names": [
      "stadium",
      "game",
      "injury_accident"
    ]
  },
  {
    "id": 634,
    "db_id": "train_station",
    "question": "Which station located in London served by Ananthapuri Express has the highest number of annual interchange passengers?",
    "sql": "SELECT s.Name FROM station AS s JOIN train_station AS ts ON s.Station_ID = ts.Station_ID JOIN train AS t ON ts.Train_ID = t.Train_ID WHERE s.Location = 'London' AND t.Name = 'Ananthapuri Express' ORDER BY s.Annual_interchanges DESC LIMIT 1;",
    "table_names": [
      "station",
      "train",
      "train_station"
    ]
  },
  {
    "id": 109,
    "db_id": "small_bank_1",
    "question": "What is the total combined balance from both savings and checking accounts of customers named Brown, Wang, and Granger?",
    "sql": "SELECT SUM(SAVINGS.balance + CHECKING.balance) FROM ACCOUNTS JOIN SAVINGS ON ACCOUNTS.custid = SAVINGS.custid JOIN CHECKING ON ACCOUNTS.custid = CHECKING.custid WHERE ACCOUNTS.name IN ('Brown','Wang','Granger');",
    "table_names": [
      "ACCOUNTS",
      "SAVINGS",
      "CHECKING"
    ]
  },
  {
    "id": 449,
    "db_id": "college_3",
    "question": "What are the first and last names of students who earned less than a B- grade in course 600.337?",
    "sql": "SELECT s.Fname, s.LName FROM Student s JOIN Enrolled_in e ON s.StuID = e.StuID JOIN Gradeconversion g ON e.Grade = g.lettergrade WHERE e.CID = '600.337' AND g.gradepoint < 2.7;",
    "table_names": [
      "Student",
      "Enrolled_in",
      "Gradeconversion"
    ]
  },
  {
    "id": 547,
    "db_id": "dorm_1",
    "question": "What are the names of the dormitories housing students from the city with city code 'PHL'?",
    "sql": "SELECT dorm_name FROM Dorm WHERE dormid IN (SELECT dormid FROM Lives_in WHERE stuid IN (SELECT StuID FROM Student WHERE city_code = 'PHL'))",
    "table_names": [
      "Student",
      "Dorm",
      "Lives_in"
    ]
  },
  {
    "id": 276,
    "db_id": "college_1",
    "question": "What courses has student Anne Smithson received a grade of B in?",
    "sql": "SELECT CLASS.CRS_CODE FROM CLASS JOIN ENROLL ON CLASS.CLASS_CODE = ENROLL.CLASS_CODE JOIN STUDENT ON ENROLL.STU_NUM = STUDENT.STU_NUM WHERE STUDENT.STU_LNAME = 'Smithson' AND ENROLL.ENROLL_GRADE = 'B';",
    "table_names": [
      "CLASS",
      "ENROLL",
      "STUDENT"
    ]
  },
  {
    "id": 517,
    "db_id": "products_gen_characteristics",
    "question": "Which 'Seeds' category products have a 'medium' value for characteristic type 'Grade'?",
    "sql": "SELECT P.product_name FROM Products P JOIN Product_Characteristics PC ON P.product_id = PC.product_id JOIN Characteristics C ON PC.characteristic_id = C.characteristic_id WHERE C.characteristic_type_code = 'Grade' AND PC.product_characteristic_value = 'medium' AND P.product_category_code = 'Seeds';",
    "table_names": [
      "Characteristics",
      "Products",
      "Product_Characteristics"
    ]
  },
  {
    "id": 147,
    "db_id": "local_govt_in_alabama",
    "question": "How many distinct participants (non-organizers) attended events with a successful outcome?",
    "sql": "SELECT COUNT(DISTINCT p.Participant_ID) FROM Participants p JOIN Participants_in_Events pe ON p.Participant_ID = pe.Participant_ID JOIN Events e ON pe.Event_ID = e.Event_ID WHERE p.Participant_Type_Code = 'Participant' AND e.Event_Details = 'Success';",
    "table_names": [
      "Participants",
      "Events",
      "Participants_in_Events"
    ]
  },
  {
    "id": 245,
    "db_id": "icfp_1",
    "question": "What are the titles of papers authored by researchers from Japanese institutions with more than one author?",
    "sql": "SELECT DISTINCT p.title FROM Papers p JOIN Authorship a ON p.paperID = a.paperID JOIN Inst i ON a.instID = i.instID WHERE i.country = 'Japan' GROUP BY p.paperID HAVING COUNT(a.authID) > 1;",
    "table_names": [
      "Inst",
      "Papers",
      "Authorship"
    ]
  },
  {
    "id": 586,
    "db_id": "customers_and_addresses",
    "question": "Which customers using a credit card as their payment method have addresses in Colorado?",
    "sql": "SELECT Customers.customer_name FROM Customers JOIN Customer_Addresses ON Customers.customer_id = Customer_Addresses.customer_id JOIN Addresses ON Customer_Addresses.address_id = Addresses.address_id WHERE Addresses.state_province_county = 'Colorado' AND Customers.payment_method = 'Credit Card';",
    "table_names": [
      "Addresses",
      "Customers",
      "Customer_Addresses"
    ]
  },
  {
    "id": 314,
    "db_id": "hr_1",
    "question": "What is the name of the country for the location with ID 1700 that has an employee with the last name 'King'?",
    "sql": "SELECT c.COUNTRY_NAME FROM countries c JOIN departments d ON c.COUNTRY_ID = 'US' AND d.LOCATION_ID = 1700 JOIN employees e ON e.DEPARTMENT_ID = d.DEPARTMENT_ID WHERE e.LAST_NAME = 'King';",
    "table_names": [
      "countries",
      "departments",
      "employees",
      "locations"
    ]
  },
  {
    "id": 271,
    "db_id": "college_1",
    "question": "Which classes (course code, section, class time, and professor number) offered by the Business school have a credit value of 4.0?",
    "sql": "SELECT COURSE.CRS_CODE, CLASS.CLASS_SECTION, CLASS.CLASS_TIME, CLASS.PROF_NUM FROM CLASS JOIN COURSE ON CLASS.CRS_CODE = COURSE.CRS_CODE JOIN DEPARTMENT ON COURSE.DEPT_CODE = DEPARTMENT.DEPT_CODE WHERE DEPARTMENT.SCHOOL_CODE = 'BUS' AND COURSE.CRS_CREDIT = 4.0;",
    "table_names": [
      "CLASS",
      "COURSE",
      "DEPARTMENT"
    ]
  },
  {
    "id": 559,
    "db_id": "dorm_1",
    "question": "What dormitory with a student capacity greater than 300 provides both 'Air Conditioning' and also 'Allows Pets'?",
    "sql": "SELECT dorm_name FROM Dorm WHERE dormid IN (SELECT dormid FROM Has_amenity WHERE amenid = (SELECT amenid FROM Dorm_amenity WHERE amenity_name = 'Air Conditioning')) AND dormid IN (SELECT dormid FROM Has_amenity WHERE amenid = (SELECT amenid FROM Dorm_amenity WHERE amenity_name = 'Allows Pets')) AND student_capacity > 300;",
    "table_names": [
      "Dorm",
      "Dorm_amenity",
      "Has_amenity"
    ]
  },
  {
    "id": 371,
    "db_id": "film_rank",
    "question": "What is the most recent film title associated with a 'Mass suicide' event estimation for the Chinese market?",
    "sql": "SELECT f.Title FROM film AS f JOIN film_market_estimation AS fme ON f.Film_ID = fme.Film_ID JOIN market AS m ON fme.Market_ID = m.Market_ID WHERE m.Country = 'China' AND fme.Type = 'Mass suicide' ORDER BY fme.Year DESC LIMIT 1;",
    "table_names": [
      "film",
      "market",
      "film_market_estimation"
    ]
  },
  {
    "id": 665,
    "db_id": "pets_1",
    "question": "What is the average weight of pets owned by students majoring in the major code 600 who live in cities coded 'BAL' or 'HKG'?",
    "sql": "SELECT AVG(p.weight) FROM Student s JOIN Has_Pet hp ON s.StuID = hp.StuID JOIN Pets p ON hp.PetID = p.PetID WHERE s.Major = 600 AND s.city_code IN ('BAL', 'HKG');",
    "table_names": [
      "Student",
      "Has_Pet",
      "Pets"
    ]
  },
  {
    "id": 79,
    "db_id": "college_2",
    "question": "In which building is located the department where the student with the highest total credits belongs to?",
    "sql": "SELECT building FROM department WHERE dept_name = (SELECT dept_name FROM student WHERE tot_cred = (SELECT MAX(tot_cred) FROM student))",
    "table_names": [
      "department",
      "instructor",
      "student"
    ]
  },
  {
    "id": 666,
    "db_id": "pets_1",
    "question": "What is the average weight of dogs owned by students from city code 'HKG'?",
    "sql": "SELECT AVG(P.weight) FROM Student S JOIN Has_Pet HP ON S.StuID = HP.StuID JOIN Pets P ON HP.PetID = P.PetID WHERE S.city_code = 'HKG' AND P.PetType = 'dog';",
    "table_names": [
      "Student",
      "Has_Pet",
      "Pets"
    ]
  },
  {
    "id": 68,
    "db_id": "college_2",
    "question": "List the names of the instructors whose salary exceeds $100,000 and who are advisors to students from the Physics department.",
    "sql": "SELECT instructor.name FROM instructor JOIN advisor ON instructor.ID = advisor.i_ID WHERE advisor.s_ID IN (SELECT ID FROM student WHERE dept_name = 'Physics') AND instructor.salary > 100000;",
    "table_names": [
      "instructor",
      "student",
      "advisor"
    ]
  },
  {
    "id": 84,
    "db_id": "debate",
    "question": "Who was the affirmative speaker in the debate with the largest audience which the affirmative side lost?",
    "sql": "SELECT p.Name FROM people p JOIN debate_people dp ON p.People_ID = dp.Affirmative JOIN debate d ON dp.Debate_ID = d.Debate_ID WHERE d.Num_of_Audience = (SELECT MAX(Num_of_Audience) FROM debate) AND dp.If_Affirmative_Win = 'F';",
    "table_names": [
      "people",
      "debate",
      "debate_people"
    ]
  },
  {
    "id": 7,
    "db_id": "student_assessment",
    "question": "What is the zip_postcode of the address where Barry lived, and what state is it located in?",
    "sql": "SELECT a.zip_postcode, a.state_province_county FROM Addresses a JOIN People_Addresses pa ON a.address_id = pa.address_id JOIN Students s ON pa.student_id = s.student_id WHERE s.student_details = 'Barry';",
    "table_names": [
      "Addresses",
      "Students",
      "People_Addresses"
    ]
  },
  {
    "id": 77,
    "db_id": "college_2",
    "question": "What are the names of students who haven't taken any Biology courses?",
    "sql": "SELECT name FROM student WHERE id NOT IN (SELECT T1.id FROM takes AS T1 JOIN course AS T2 ON T1.course_id  =  T2.course_id WHERE T2.dept_name  =  'Biology')",
    "table_names": [
      "course",
      "student",
      "takes"
    ]
  },
  {
    "id": 263,
    "db_id": "assets_maintenance",
    "question": "What skills are required to fix the part faults with fault short name 'MW' for part with ID 3?",
    "sql": "SELECT s.skill_description FROM Skills s JOIN Skills_Required_To_Fix sr ON s.skill_id = sr.skill_id JOIN Part_Faults pf ON sr.part_fault_id = pf.part_fault_id WHERE pf.fault_short_name='MW' AND pf.part_id=3",
    "table_names": [
      "Skills",
      "Part_Faults",
      "Skills_Required_To_Fix"
    ]
  },
  {
    "id": 21,
    "db_id": "allergy_1",
    "question": "List the first and last names of students who live in NYC and have animal-type allergies.",
    "sql": "SELECT DISTINCT S.Fname, S.LName FROM Student S JOIN Has_Allergy HA ON S.StuID = HA.StuID JOIN Allergy_Type AT ON HA.Allergy = AT.Allergy WHERE AT.AllergyType = 'animal' AND S.city_code = 'NYC';",
    "table_names": [
      "Allergy_Type",
      "Has_Allergy",
      "Student"
    ]
  },
  {
    "id": 379,
    "db_id": "club_1",
    "question": "Who are the students from the city code 'BAL' members of the club 'Bootup Baltimore'?",
    "sql": "SELECT s.Fname, s.LName FROM Student s INNER JOIN Member_of_club mc ON s.StuID = mc.StuID INNER JOIN Club c ON mc.ClubID = c.ClubID WHERE c.ClubName = 'Bootup Baltimore' AND s.city_code = 'BAL';",
    "table_names": [
      "Student",
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 629,
    "db_id": "scientist_1",
    "question": "What are the names of scientists assigned to the project with the highest number of hours?",
    "sql": "SELECT Scientists.Name FROM Scientists JOIN AssignedTo ON Scientists.SSN = AssignedTo.Scientist JOIN Projects ON AssignedTo.Project = Projects.Code WHERE Projects.Hours = (SELECT MAX(Hours) FROM Projects);",
    "table_names": [
      "Scientists",
      "Projects",
      "AssignedTo"
    ]
  },
  {
    "id": 258,
    "db_id": "behavior_monitoring",
    "question": "What are the names of students living in the same address and Kentucky state as the teacher Gregory?",
    "sql": "SELECT students.first_name, students.last_name FROM Students JOIN Addresses ON Students.address_id = Addresses.address_id JOIN Teachers ON Addresses.address_id = Teachers.address_id WHERE Teachers.first_name = 'Gregory' AND Addresses.state_province_county = 'Kentucky';",
    "table_names": [
      "Addresses",
      "Students",
      "Teachers"
    ]
  },
  {
    "id": 281,
    "db_id": "college_1",
    "question": "What is the full name of the professor and their department who teaches section 1 of course QM-362?",
    "sql": "SELECT E.EMP_LNAME, E.EMP_FNAME, D.DEPT_NAME FROM EMPLOYEE E INNER JOIN DEPARTMENT D ON E.EMP_NUM = D.EMP_NUM INNER JOIN CLASS C ON E.EMP_NUM = C.PROF_NUM WHERE C.CRS_CODE = 'QM-362' AND C.CLASS_SECTION = '1';",
    "table_names": [
      "CLASS",
      "DEPARTMENT",
      "EMPLOYEE",
      "PROFESSOR"
    ]
  },
  {
    "id": 135,
    "db_id": "gas_company",
    "question": "Who is the manager of the gas station associated with the highest ranked company headquartered in the UK?",
    "sql": "SELECT g.Manager_Name FROM gas_station AS g JOIN station_company AS sc ON g.Station_ID = sc.Station_ID JOIN company AS c ON sc.Company_ID = c.Company_ID WHERE c.Headquarters = 'UK' ORDER BY sc.Rank_of_the_Year ASC LIMIT 1;",
    "table_names": [
      "company",
      "gas_station",
      "station_company"
    ]
  },
  {
    "id": 495,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "What is the name and city of VIP customers living in Alaska?",
    "sql": "SELECT Customers.Customer_Name, Addresses.City_Town FROM Customers INNER JOIN Addresses ON Customers.Address_ID = Addresses.Address_ID WHERE Customers.Other_Details = 'VIP' AND Addresses.State_County = 'Alaska';",
    "table_names": [
      "Addresses",
      "Performers",
      "Customers"
    ]
  },
  {
    "id": 562,
    "db_id": "dorm_1",
    "question": "How many students from PIT city have an advisor who also advises students living in dorms that have a kitchen in every room?",
    "sql": "SELECT COUNT(*) FROM Student WHERE city_code = 'PIT' AND Advisor IN (SELECT Advisor FROM Student WHERE StuID IN (SELECT dormid FROM Has_amenity WHERE amenid = (SELECT amenid FROM Dorm_amenity WHERE amenity_name = 'Kitchen in Every Room')));",
    "table_names": [
      "Student",
      "Dorm_amenity",
      "Has_amenity",
      "Lives_in"
    ]
  },
  {
    "id": 481,
    "db_id": "store_product",
    "question": "What is the name of the store with the highest rank, its ranking, and in which district and headquartered city is it located?",
    "sql": "SELECT d.District_name, d.Headquartered_City, s.Store_Name, s.Ranking FROM district d JOIN store_district sd ON d.District_ID = sd.District_ID JOIN store s ON sd.Store_ID = s.Store_ID WHERE s.Ranking = (SELECT MIN(Ranking) FROM store);",
    "table_names": [
      "store",
      "district",
      "store_district"
    ]
  },
  {
    "id": 602,
    "db_id": "customers_and_addresses",
    "question": "Which customer paying by cheque has purchased the highest total quantity of products from orders that were successfully delivered?",
    "sql": "SELECT Customers.customer_name, SUM(CAST(Order_Items.order_quantity AS INTEGER)) AS total_quantity FROM Customers JOIN Customer_Orders ON Customers.customer_id = Customer_Orders.customer_id JOIN Order_Items ON Customer_Orders.order_id = Order_Items.order_id WHERE Customers.payment_method = 'Cheque' AND Customer_Orders.order_status = 'Delivered' GROUP BY Customers.customer_name ORDER BY total_quantity DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Customer_Orders",
      "Order_Items"
    ]
  },
  {
    "id": 641,
    "db_id": "activity_1",
    "question": "Who participates in the greatest number of activities among the faculty members that are involved in either Mountain Climbing or Canoeing?",
    "sql": "SELECT F.Fname, F.Lname, COUNT(FP.actid) as activity_count FROM Faculty F JOIN Faculty_Participates_in FP ON F.FacID = FP.FacID JOIN Activity A ON FP.actid = A.actid WHERE A.activity_name IN ('Mountain Climbing', 'Canoeing') GROUP BY F.FacID ORDER BY activity_count DESC LIMIT 1;",
    "table_names": [
      "Activity",
      "Faculty_Participates_in",
      "Faculty"
    ]
  },
  {
    "id": 352,
    "db_id": "hospital_1",
    "question": "Which physicians have valid certifications after January 1, 2008, to perform procedures costing more than $3000?",
    "sql": "SELECT P.Name FROM Physician P JOIN Trained_In T ON P.EmployeeID = T.Physician JOIN Procedures PR ON T.Treatment = PR.Code WHERE PR.Cost > 3000 AND T.CertificationExpires > '2008-01-01';",
    "table_names": [
      "Physician",
      "Procedures",
      "Trained_In"
    ]
  },
  {
    "id": 231,
    "db_id": "icfp_1",
    "question": "Which institution has authored the highest number of unique papers?",
    "sql": "SELECT name FROM Inst WHERE instID IN (SELECT instID FROM Authorship GROUP BY instID ORDER BY COUNT(DISTINCT paperID) DESC LIMIT 1);",
    "table_names": [
      "Inst",
      "Papers",
      "Authorship"
    ]
  },
  {
    "id": 660,
    "db_id": "pets_1",
    "question": "What is the average weight of pets owned by students older than 18?",
    "sql": "SELECT AVG(Pets.weight) FROM Student INNER JOIN Has_Pet ON Student.StuID = Has_Pet.StuID INNER JOIN Pets ON Has_Pet.PetID = Pets.PetID WHERE Student.Age > 18;",
    "table_names": [
      "Student",
      "Has_Pet",
      "Pets"
    ]
  },
  {
    "id": 466,
    "db_id": "customers_and_addresses",
    "question": "Which customers have ordered the product with ID 13?",
    "sql": "SELECT customer_name FROM Customers WHERE customer_id IN (SELECT customer_id FROM Customer_Orders WHERE order_id IN (SELECT order_id FROM Order_Items WHERE product_id = 13));",
    "table_names": [
      "Customers",
      "Customer_Orders",
      "Order_Items"
    ]
  },
  {
    "id": 573,
    "db_id": "tracking_share_transactions",
    "question": "What is the total amount of purchase transactions involving lots owned by the investor with investor_id 7?",
    "sql": "SELECT SUM(t.amount_of_transaction) FROM Transactions t JOIN Transactions_Lots tl ON t.transaction_id = tl.transaction_id JOIN Lots l ON tl.lot_id = l.lot_id WHERE l.investor_id = 7 AND t.transaction_type_code = 'PUR';",
    "table_names": [
      "Lots",
      "Transactions",
      "Transactions_Lots"
    ]
  },
  {
    "id": 652,
    "db_id": "tracking_orders",
    "question": "What are the names of customers who placed orders after the year 2000 with the status 'Packing'?",
    "sql": "SELECT Customers.customer_name FROM Customers JOIN Orders ON Customers.customer_id = Orders.customer_id WHERE Orders.order_status = 'Packing' AND Orders.date_order_placed > '2000-01-01';",
    "table_names": [
      "Customers",
      "Orders",
      "Products",
      "Order_Items"
    ]
  },
  {
    "id": 195,
    "db_id": "storm_record",
    "question": "Which storm that caused more than 5 deaths affected the greatest total number of cities?",
    "sql": "SELECT s.Name, SUM(ar.Number_city_affected) as total_cities_affected FROM storm s JOIN affected_region ar ON s.Storm_ID = ar.Storm_ID WHERE s.Number_Deaths > 5 GROUP BY s.Name ORDER BY total_cities_affected DESC LIMIT 1;",
    "table_names": [
      "storm",
      "region",
      "affected_region"
    ]
  },
  {
    "id": 519,
    "db_id": "products_gen_characteristics",
    "question": "List the names of herb products that have a high purity characteristic?",
    "sql": "SELECT DISTINCT p.product_name FROM Products p JOIN Product_Characteristics pc ON p.product_id = pc.product_id JOIN Characteristics c ON pc.characteristic_id = c.characteristic_id WHERE c.characteristic_type_code = 'Purity' AND pc.product_characteristic_value = 'high' AND p.product_category_code = 'Herbs';",
    "table_names": [
      "Characteristics",
      "Products",
      "Product_Characteristics"
    ]
  },
  {
    "id": 143,
    "db_id": "pilot_record",
    "question": "Which aircraft manufacturer had flights operated by the highest number of different pilots?",
    "sql": "SELECT aircraft.Manufacturer, COUNT(DISTINCT pilot_record.Pilot_ID) as Pilot_Count FROM aircraft JOIN pilot_record ON aircraft.Aircraft_ID = pilot_record.Aircraft_ID GROUP BY aircraft.Manufacturer ORDER BY Pilot_Count DESC LIMIT 1;",
    "table_names": [
      "aircraft",
      "pilot",
      "pilot_record"
    ]
  },
  {
    "id": 140,
    "db_id": "gas_company",
    "question": "Which Chinese company owns a gas station ranked within the top 4 of the year, and what is the station's location and manager's name?",
    "sql": "SELECT c.Company, g.Location, g.Manager_Name FROM company c INNER JOIN station_company sc ON c.Company_ID = sc.Company_ID INNER JOIN gas_station g ON sc.Station_ID = g.Station_ID WHERE c.Headquarters = 'China' AND sc.Rank_of_the_Year < 5;",
    "table_names": [
      "company",
      "gas_station",
      "station_company"
    ]
  },
  {
    "id": 578,
    "db_id": "cre_Theme_park",
    "question": "Which tourist attraction can be reached by bus and has a parking feature?",
    "sql": "SELECT TA.Name FROM Tourist_Attractions TA JOIN Tourist_Attraction_Features TAF ON TA.Tourist_Attraction_ID = TAF.Tourist_Attraction_ID JOIN Features F ON TAF.Feature_ID = F.Feature_ID WHERE TA.How_to_Get_There = 'bus' AND F.Feature_Details = 'parking';",
    "table_names": [
      "Features",
      "Tourist_Attractions",
      "Tourist_Attraction_Features"
    ]
  },
  {
    "id": 82,
    "db_id": "debate",
    "question": "On what dates did debates occur where Horace F. Clark argued the negative side and the affirmative team lost?",
    "sql": "SELECT d.Date FROM debate d JOIN debate_people dp ON d.Debate_ID = dp.Debate_ID JOIN people p ON p.People_ID = dp.Negative WHERE p.Name = 'Horace F. Clark' AND dp.If_Affirmative_Win = 'F';",
    "table_names": [
      "people",
      "debate",
      "debate_people"
    ]
  },
  {
    "id": 530,
    "db_id": "swimming",
    "question": "Which swimmer from a country matching the stadium hosting the 'European FINA' event had the fastest overall recorded time?",
    "sql": "SELECT s.name FROM swimmer s JOIN event e ON e.Name = 'European FINA' JOIN stadium st ON e.Stadium_ID = st.ID WHERE s.Nationality = st.Country ORDER BY s.Time ASC LIMIT 1;",
    "table_names": [
      "swimmer",
      "stadium",
      "event",
      "record"
    ]
  },
  {
    "id": 99,
    "db_id": "small_bank_1",
    "question": "Which customers have both savings balances greater than 50000 and checking balances greater than 5000?",
    "sql": "SELECT a.name FROM ACCOUNTS a JOIN SAVINGS s ON a.custid = s.custid JOIN CHECKING c ON a.custid = c.custid WHERE s.balance > 50000 AND c.balance > 5000;",
    "table_names": [
      "ACCOUNTS",
      "SAVINGS",
      "CHECKING"
    ]
  },
  {
    "id": 704,
    "db_id": "student_transcripts_tracking",
    "question": "What are the names of students enrolled in degree programs that offer a Master's degree?",
    "sql": "SELECT S.first_name, S.last_name, D.degree_summary_name FROM Students S INNER JOIN Student_Enrolment SE ON S.student_id = SE.student_id INNER JOIN Degree_Programs D ON SE.degree_program_id = D.degree_program_id WHERE D.degree_summary_name='Master';",
    "table_names": [
      "Degree_Programs",
      "Students",
      "Student_Enrolment"
    ]
  },
  {
    "id": 274,
    "db_id": "college_1",
    "question": "List the course code, section, and classroom for the classes in which student Bowser received an 'A' grade.",
    "sql": "SELECT CLASS.CRS_CODE, CLASS.CLASS_SECTION, CLASS.CLASS_ROOM FROM CLASS INNER JOIN ENROLL ON CLASS.CLASS_CODE = ENROLL.CLASS_CODE INNER JOIN STUDENT ON ENROLL.STU_NUM = STUDENT.STU_NUM WHERE STUDENT.STU_LNAME = 'Bowser' AND ENROLL.ENROLL_GRADE = 'A';",
    "table_names": [
      "CLASS",
      "ENROLL",
      "STUDENT"
    ]
  },
  {
    "id": 67,
    "db_id": "college_2",
    "question": "What is the average salary of instructors who advise students from the Psychology department?",
    "sql": "SELECT AVG(instructor.salary) FROM instructor JOIN advisor ON instructor.ID = advisor.i_ID JOIN student ON student.ID = advisor.s_ID WHERE student.dept_name = 'Psychology';",
    "table_names": [
      "instructor",
      "student",
      "advisor"
    ]
  },
  {
    "id": 273,
    "db_id": "college_1",
    "question": "What is the class time and room for the course QM-261 in which the student Bowser is enrolled?",
    "sql": "SELECT C.CLASS_TIME, C.CLASS_ROOM FROM CLASS C JOIN ENROLL E ON C.CLASS_CODE = E.CLASS_CODE JOIN STUDENT S ON E.STU_NUM = S.STU_NUM WHERE S.STU_LNAME = 'Bowser' AND C.CRS_CODE = 'QM-261';",
    "table_names": [
      "CLASS",
      "ENROLL",
      "STUDENT"
    ]
  },
  {
    "id": 347,
    "db_id": "hospital_1",
    "question": "Who is affiliated with the General Medicine department but doesn't have it as their primary affiliation?",
    "sql": "SELECT p.Name FROM Physician p JOIN Affiliated_With a ON p.EmployeeID = a.Physician JOIN Department d ON d.DepartmentID = a.Department WHERE d.Name = 'General Medicine' AND a.PrimaryAffiliation = 0;",
    "table_names": [
      "Physician",
      "Department",
      "Affiliated_With"
    ]
  },
  {
    "id": 404,
    "db_id": "club_1",
    "question": "Who is the teaching coordinator of 'Bootup Baltimore' and how old are they?",
    "sql": "SELECT Student.Fname, Student.LName, Student.Age FROM Student JOIN Member_of_club ON Student.StuID = Member_of_club.StuID JOIN Club ON Member_of_club.ClubID = Club.ClubID WHERE Club.ClubName = 'Bootup Baltimore' AND Member_of_club.Position = 'Teaching Coordinator';",
    "table_names": [
      "Student",
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 617,
    "db_id": "city_record",
    "question": "What is the average July temperature for cities that have hosted matches and have a GDP greater than 500?",
    "sql": "SELECT AVG(t.Jul) FROM temperature t INNER JOIN hosting_city hc ON t.City_ID = CAST(hc.Host_City AS INTEGER) INNER JOIN city c ON t.City_ID = c.City_ID WHERE c.GDP > 500;",
    "table_names": [
      "city",
      "temperature",
      "hosting_city"
    ]
  },
  {
    "id": 19,
    "db_id": "allergy_1",
    "question": "Find the first and last names of students who live in PIT and have allergies to animals.",
    "sql": "SELECT DISTINCT s.Fname, s.LName FROM Student s JOIN Has_Allergy ha ON s.StuID = ha.StuID JOIN Allergy_Type at ON ha.Allergy = at.Allergy WHERE at.AllergyType = 'animal' AND s.city_code = 'PIT';",
    "table_names": [
      "Allergy_Type",
      "Has_Allergy",
      "Student"
    ]
  },
  {
    "id": 533,
    "db_id": "customers_and_addresses",
    "question": "What is the name of the customer who placed an order containing exactly 3 quantities of product ID 15?",
    "sql": "SELECT customer_name FROM Customers WHERE customer_id IN (SELECT customer_id FROM Customer_Orders WHERE order_id IN (SELECT order_id FROM Order_Items WHERE product_id = 15 AND order_quantity = '3'));",
    "table_names": [
      "Customers",
      "Customer_Orders",
      "Order_Items"
    ]
  },
  {
    "id": 364,
    "db_id": "hospital_1",
    "question": "What is the name of the patient prescribed a medication with a dose of 10 from the brand 'Foo Labs'?",
    "sql": "SELECT Patient.Name FROM Patient JOIN Prescribes ON Patient.SSN = Prescribes.Patient JOIN Medication ON Prescribes.Medication = Medication.Code WHERE Medication.Brand = 'Foo Labs' AND Prescribes.Dose = '10';",
    "table_names": [
      "Patient",
      "Medication",
      "Prescribes"
    ]
  },
  {
    "id": 0,
    "db_id": "department_management",
    "question": "What are the names of heads serving as temporary acting heads in departments with rankings better than 5?",
    "sql": "SELECT head.head_Name FROM head INNER JOIN management ON head.head_ID = management.head_ID INNER JOIN department ON management.Department_ID = department.Department_ID WHERE department.Ranking < 5 AND management.temporary_acting = 'Yes';",
    "table_names": [
      "department",
      "head",
      "management"
    ]
  },
  {
    "id": 576,
    "db_id": "cre_Theme_park",
    "question": "Which visitors have visited both the 'haunted mansion' and the 'jungle cruise'?",
    "sql": "SELECT v.Tourist_Details FROM Visitors v WHERE v.Tourist_ID IN (SELECT vs1.Tourist_ID FROM Visits vs1 JOIN Tourist_Attractions ta1 ON vs1.Tourist_Attraction_ID = ta1.Tourist_Attraction_ID WHERE ta1.Name = 'haunted mansion') AND v.Tourist_ID IN (SELECT vs2.Tourist_ID FROM Visits vs2 JOIN Tourist_Attractions ta2 ON vs2.Tourist_Attraction_ID = ta2.Tourist_Attraction_ID WHERE ta2.Name = 'jungle cruise');",
    "table_names": [
      "Visitors",
      "Tourist_Attractions",
      "Visits"
    ]
  },
  {
    "id": 585,
    "db_id": "game_1",
    "question": "List the first and last names of students from city code 'BAL' who play Role-playing games?",
    "sql": "SELECT s.Fname, s.LName FROM Student s JOIN Plays_Games pg ON s.StuID = pg.StuID JOIN Video_Games vg ON pg.GameID = vg.GameID WHERE vg.GType = 'Role-playing game' AND s.city_code = 'BAL';",
    "table_names": [
      "Student",
      "Video_Games",
      "Plays_Games"
    ]
  },
  {
    "id": 191,
    "db_id": "storm_record",
    "question": "Which region had the highest number of cities affected by the storm with the slowest maximum speed?",
    "sql": "SELECT r.Region_name FROM region r JOIN affected_region ar ON r.Region_id = ar.Region_id JOIN storm s ON ar.Storm_ID = s.Storm_ID WHERE s.Max_speed = (SELECT MIN(Max_speed) FROM storm) AND ar.Number_city_affected = (SELECT MAX(Number_city_affected) FROM affected_region WHERE Storm_ID IN (SELECT Storm_ID FROM storm WHERE Max_speed = (SELECT MIN(Max_speed) FROM storm)));",
    "table_names": [
      "storm",
      "region",
      "affected_region"
    ]
  },
  {
    "id": 415,
    "db_id": "club_1",
    "question": "List the first and last names of students younger than 19 who belong to clubs located in 'AKW', along with the names of these clubs.",
    "sql": "SELECT Student.Fname, Student.LName, Club.ClubName FROM Student INNER JOIN Member_of_club ON Student.StuID = Member_of_club.StuID INNER JOIN Club ON Member_of_club.ClubID = Club.ClubID WHERE Club.ClubLocation = 'AKW' AND Student.Age < 19;",
    "table_names": [
      "Student",
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 632,
    "db_id": "train_station",
    "question": "Which stations with more than 15 platforms does the Island Express serve?",
    "sql": "SELECT s.Name FROM station s JOIN train_station ts ON s.Station_ID = ts.Station_ID JOIN train t ON t.Train_ID = ts.Train_ID WHERE t.Name = 'Island Express' AND s.Number_of_Platforms > 15",
    "table_names": [
      "station",
      "train",
      "train_station"
    ]
  },
  {
    "id": 149,
    "db_id": "formula_1",
    "question": "What are the names and years of all races that had a driver with the last name Lewis?",
    "sql": "SELECT T2.name ,  T2.year FROM results AS T1 JOIN races AS T2 ON T1.raceid = T2.raceid JOIN drivers AS T3 ON T1.driverid = T3.driverid WHERE T3.forename = \"Lewis\"",
    "table_names": [
      "races",
      "drivers",
      "results"
    ]
  },
  {
    "id": 608,
    "db_id": "customers_and_addresses",
    "question": "List the customer name and payment method for customers who used 'Cheque' payment method and have placed at least one 'Delivered' order, along with the order dates of their delivered orders.",
    "sql": "SELECT Customers.customer_name, Customers.payment_method, Customer_Orders.order_date FROM Customers INNER JOIN Customer_Orders ON Customers.customer_id = Customer_Orders.customer_id WHERE Customers.payment_method = 'Cheque' AND Customer_Orders.order_status = 'Delivered';",
    "table_names": [
      "Products",
      "Customers",
      "Customer_Orders",
      "Order_Items"
    ]
  },
  {
    "id": 338,
    "db_id": "hospital_1",
    "question": "How many distinct rooms on the first floor had patients staying beyond May 2, 2008?",
    "sql": "SELECT COUNT(DISTINCT s.Room) FROM Stay s JOIN Patient p ON s.Patient = p.SSN JOIN Room r ON s.Room = r.RoomNumber WHERE r.BlockFloor = 1 AND s.StayEnd > '2008-05-02';",
    "table_names": [
      "Patient",
      "Room",
      "Stay"
    ]
  },
  {
    "id": 120,
    "db_id": "small_bank_1",
    "question": "Which customers have savings account balances greater than 100,000 and checking account balances of at least 5,000?",
    "sql": "SELECT name FROM ACCOUNTS WHERE custid IN (SELECT custid FROM SAVINGS WHERE balance > 100000) AND custid IN (SELECT custid FROM CHECKING WHERE balance >= 5000);",
    "table_names": [
      "ACCOUNTS",
      "SAVINGS",
      "CHECKING"
    ]
  },
  {
    "id": 552,
    "db_id": "dorm_1",
    "question": "Which dorms with a student capacity of more than 300 have a pub in the basement?",
    "sql": "SELECT dorm_name FROM Dorm WHERE dormid IN (SELECT dormid FROM Has_amenity WHERE amenid IN (SELECT amenid FROM Dorm_amenity WHERE amenity_name = 'Pub in Basement')) AND student_capacity > 300;",
    "table_names": [
      "Dorm",
      "Dorm_amenity",
      "Has_amenity"
    ]
  },
  {
    "id": 208,
    "db_id": "icfp_1",
    "question": "Which author has contributed to exactly two papers and is listed as the first author on one paper titled 'Proving the Unique Fixed-Point Principle Correct: An Adventure with Category Theory'?",
    "sql": "SELECT fname, lname FROM Authors WHERE authID IN (SELECT authID FROM Authorship GROUP BY authID HAVING COUNT(DISTINCT paperID) = 2) AND authID IN (SELECT Authorship.authID FROM Authorship JOIN Papers ON Authorship.paperID = Papers.paperID WHERE Papers.title = 'Proving the Unique Fixed-Point Principle Correct: An Adventure with Category Theory' AND Authorship.authOrder = 1);",
    "table_names": [
      "Authors",
      "Papers",
      "Authorship"
    ]
  },
  {
    "id": 545,
    "db_id": "dorm_1",
    "question": "How many students under the age of 20 live in dormitories that accept all genders (designated by 'X')?",
    "sql": "SELECT COUNT(DISTINCT Student.StuID) FROM Student JOIN Lives_in ON Student.StuID = Lives_in.stuid JOIN Dorm ON Lives_in.dormid = Dorm.dormid WHERE Dorm.gender = 'X' AND Student.Age < 20;",
    "table_names": [
      "Student",
      "Dorm",
      "Lives_in"
    ]
  },
  {
    "id": 647,
    "db_id": "tracking_orders",
    "question": "How many distinct orders that are currently 'On Road' have at least one 'music' product item with a status of 'Payed'?",
    "sql": "SELECT COUNT(DISTINCT oi.order_id) FROM Orders o JOIN Order_Items oi ON o.order_id = oi.order_id JOIN Products p ON oi.product_id = p.product_id WHERE o.order_status = 'On Road' AND oi.order_item_status = 'Payed' AND p.product_name = 'music';",
    "table_names": [
      "Orders",
      "Products",
      "Order_Items"
    ]
  },
  {
    "id": 3,
    "db_id": "student_assessment",
    "question": "List the names of students who are registered for both the 'statistics' and 'French' courses.",
    "sql": "SELECT student_details FROM Students WHERE student_id IN (SELECT student_id FROM Student_Course_Registrations WHERE course_id IN (SELECT course_id FROM Courses WHERE course_name = 'statistics')) AND student_id IN (SELECT student_id FROM Student_Course_Registrations WHERE course_id IN (SELECT course_id FROM Courses WHERE course_name = 'French'));",
    "table_names": [
      "Students",
      "Courses",
      "Student_Course_Registrations"
    ]
  },
  {
    "id": 687,
    "db_id": "car_1",
    "question": "What is the full name of the maker manufacturing the model 'honda civic'?",
    "sql": "SELECT cm.FullName FROM car_makers AS cm JOIN model_list AS ml ON cm.Id = ml.Maker JOIN car_names AS cn ON ml.Model = cn.Model WHERE cn.Make = 'honda civic';",
    "table_names": [
      "car_makers",
      "model_list",
      "car_names"
    ]
  },
  {
    "id": 187,
    "db_id": "party_host",
    "question": "Who are the main hosts from the United States that were in charge of parties hosted at the Heineken Music Hall Amsterdam?",
    "sql": "SELECT h.Name FROM host h JOIN party_host ph ON h.Host_ID = ph.Host_ID JOIN party p ON ph.Party_ID = p.Party_ID WHERE p.Location LIKE '%Heineken Music Hall Amsterdam%' AND ph.Is_Main_in_Charge = 'T' AND h.Nationality = 'United States';",
    "table_names": [
      "party",
      "host",
      "party_host"
    ]
  },
  {
    "id": 478,
    "db_id": "store_product",
    "question": "What are the names of stores with more than 1000 product categories located in districts whose headquarter cities have populations below 200,000?",
    "sql": "SELECT s.Store_Name, d.District_name FROM store s JOIN store_district sd ON s.Store_ID = sd.Store_ID JOIN district d ON sd.District_ID = d.District_ID WHERE s.Number_of_product_category > 1000 AND d.City_Population < 200000;",
    "table_names": [
      "store",
      "district",
      "store_district"
    ]
  },
  {
    "id": 702,
    "db_id": "battle_death",
    "question": "What battle led to the sinking of the brig 'Bacchus', and how many casualties were caused by ships lost in that particular battle?",
    "sql": "SELECT b.name AS battle_name, SUM(d.killed) AS total_killed FROM battle b JOIN ship s ON b.id = s.lost_in_battle JOIN death d ON s.id = d.caused_by_ship_id WHERE s.name = 'Bacchus' GROUP BY b.name;",
    "table_names": [
      "battle",
      "ship",
      "death"
    ]
  },
  {
    "id": 645,
    "db_id": "flight_4",
    "question": "What is the number of routes operated by the airline American Airlines whose destinations are in Italy?",
    "sql": "SELECT count(*) FROM routes AS T1 JOIN airports AS T2 ON T1.dst_apid  =  T2.apid JOIN airlines AS T3 ON T1.alid  =  T3.alid WHERE T2.country  =  'Italy' AND T3.name  =  'American Airlines'",
    "table_names": [
      "routes",
      "airports",
      "airlines"
    ]
  },
  {
    "id": 30,
    "db_id": "store_1",
    "question": "List the name of tracks belongs to genre Rock or media type is MPEG audio file.",
    "sql": "SELECT T2.name FROM genres AS T1 JOIN tracks AS T2 ON T1.id = T2.genre_id JOIN media_types AS T3 ON T3.id = T2.media_type_id WHERE T1.name = \"Rock\" OR T3.name = \"MPEG audio file\";",
    "table_names": [
      "genres",
      "media_types",
      "tracks"
    ]
  },
  {
    "id": 680,
    "db_id": "car_1",
    "question": "What are the car makers located in countries which are part of the Asian continent?",
    "sql": "SELECT Maker FROM car_makers WHERE Country IN (SELECT CountryId FROM countries WHERE Continent IN (SELECT ContId FROM continents WHERE Continent = 'asia'));",
    "table_names": [
      "continents",
      "countries",
      "car_makers"
    ]
  },
  {
    "id": 707,
    "db_id": "voter_1",
    "question": "Which contestant received the highest number of votes?",
    "sql": "SELECT contestant_name FROM CONTESTANTS WHERE contestant_number = (SELECT contestant_number FROM (SELECT contestant_number, COUNT(*) AS total_votes FROM VOTES GROUP BY contestant_number ORDER BY total_votes DESC LIMIT 1) AS most_votes);",
    "table_names": [
      "AREA_CODE_STATE",
      "CONTESTANTS",
      "VOTES"
    ]
  },
  {
    "id": 129,
    "db_id": "protein_institute",
    "question": "Which buildings host institutions that have proteins with sequence lengths exceeding 1800 and are taller than 250 feet?",
    "sql": "SELECT b.Name FROM building b JOIN Institution i ON b.building_id = i.building_id JOIN protein p ON i.Institution_id = p.Institution_id WHERE p.sequence_length > 1800 AND b.Height_feet > 250;",
    "table_names": [
      "building",
      "Institution",
      "protein"
    ]
  },
  {
    "id": 11,
    "db_id": "flight_1",
    "question": "Who has the highest salary among the employees certified to fly the Airbus A340-300 aircraft, and what is their salary?",
    "sql": "SELECT e.ename, e.salary FROM employee e JOIN certificate c ON e.eid = c.eid JOIN aircraft a ON c.aid = a.aid WHERE a.aname = 'Airbus A340-300' ORDER BY e.salary DESC LIMIT 1;",
    "table_names": [
      "aircraft",
      "employee",
      "certificate"
    ]
  },
  {
    "id": 599,
    "db_id": "customers_and_addresses",
    "question": "Which customer with a 'Credit Card' payment method has the highest total quantity of ordered items in cancelled orders?",
    "sql": "SELECT customer_name, SUM(CAST(order_quantity AS INTEGER)) AS total_quantity FROM Customers JOIN Customer_Orders ON Customers.customer_id = Customer_Orders.customer_id JOIN Order_Items ON Customer_Orders.order_id = Order_Items.order_id WHERE payment_method = 'Credit Card' AND Customer_Orders.order_status = 'Cancelled' GROUP BY customer_name ORDER BY total_quantity DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Customer_Orders",
      "Order_Items"
    ]
  },
  {
    "id": 285,
    "db_id": "college_1",
    "question": "List the first and last names along with the highest degree of professors holding a Ph.D. who work in departments within the BUS school.",
    "sql": "SELECT EMPLOYEE.EMP_FNAME, EMPLOYEE.EMP_LNAME, PROFESSOR.PROF_HIGH_DEGREE FROM EMPLOYEE INNER JOIN PROFESSOR ON EMPLOYEE.EMP_NUM = PROFESSOR.EMP_NUM INNER JOIN DEPARTMENT ON PROFESSOR.DEPT_CODE = DEPARTMENT.DEPT_CODE WHERE DEPARTMENT.SCHOOL_CODE = 'BUS' AND PROFESSOR.PROF_HIGH_DEGREE = 'Ph.D.' AND EMPLOYEE.EMP_JOBCODE = 'PROF';",
    "table_names": [
      "DEPARTMENT",
      "EMPLOYEE",
      "PROFESSOR"
    ]
  },
  {
    "id": 574,
    "db_id": "cre_Theme_park",
    "question": "Which tourists have visited both the 'history gallery' and the 'US museum'?",
    "sql": "SELECT v.Tourist_ID FROM Visits v JOIN Tourist_Attractions ta ON v.Tourist_Attraction_ID = ta.Tourist_Attraction_ID WHERE ta.Name = 'history gallery' INTERSECT SELECT v.Tourist_ID FROM Visits v JOIN Tourist_Attractions ta ON v.Tourist_Attraction_ID = ta.Tourist_Attraction_ID WHERE ta.Name = 'US museum';",
    "table_names": [
      "Visitors",
      "Tourist_Attractions",
      "Visits"
    ]
  },
  {
    "id": 512,
    "db_id": "products_gen_characteristics",
    "question": "What are the names of herb products that have a high value of the characteristic 'warm'?",
    "sql": "SELECT Products.product_name FROM Products JOIN Product_Characteristics ON Products.product_id = Product_Characteristics.product_id JOIN Characteristics ON Product_Characteristics.characteristic_id = Characteristics.characteristic_id WHERE Products.product_category_code = 'Herbs' AND Characteristics.characteristic_name = 'warm' AND Product_Characteristics.product_characteristic_value = 'high';",
    "table_names": [
      "Characteristics",
      "Products",
      "Product_Characteristics"
    ]
  },
  {
    "id": 423,
    "db_id": "tracking_grants_for_research",
    "question": "How many tasks belong to projects initiated by organisation 3 and have produced a paper outcome?",
    "sql": "SELECT COUNT(*) FROM Tasks WHERE project_id IN (SELECT project_id FROM Projects WHERE organisation_id=3) AND project_id IN (SELECT project_id FROM Project_Outcomes WHERE outcome_code='Paper');",
    "table_names": [
      "Project_Outcomes",
      "Projects",
      "Tasks"
    ]
  },
  {
    "id": 427,
    "db_id": "tracking_grants_for_research",
    "question": "What are the distinct role descriptions of staff members who worked on projects with outcome coded as 'Patent'?",
    "sql": "SELECT DISTINCT sr.role_description FROM Project_Outcomes po JOIN Project_Staff ps ON po.project_id = ps.project_id JOIN Staff_Roles sr ON ps.role_code = sr.role_code WHERE po.outcome_code = 'Patent';",
    "table_names": [
      "Project_Outcomes",
      "Project_Staff",
      "Staff_Roles"
    ]
  },
  {
    "id": 73,
    "db_id": "college_2",
    "question": "What is the maximum salary of the instructors advising Statistics students who have completed more than 100 total credits?",
    "sql": "SELECT MAX(instructor.salary) FROM instructor JOIN advisor ON instructor.ID = advisor.i_ID JOIN student ON student.ID = advisor.s_ID WHERE student.tot_cred > 100 AND student.dept_name = 'Statistics';",
    "table_names": [
      "instructor",
      "student",
      "advisor"
    ]
  },
  {
    "id": 31,
    "db_id": "store_1",
    "question": "What are the names of all tracks that belong to the Rock genre and whose media type is MPEG?",
    "sql": "SELECT T2.name FROM genres AS T1 JOIN tracks AS T2 ON T1.id = T2.genre_id JOIN media_types AS T3 ON T3.id = T2.media_type_id WHERE T1.name = \"Rock\" OR T3.name = \"MPEG audio file\";",
    "table_names": [
      "genres",
      "media_types",
      "tracks"
    ]
  },
  {
    "id": 32,
    "db_id": "store_1",
    "question": "List all tracks bought by customer Daan Peeters.",
    "sql": "SELECT T1.name FROM tracks AS T1 JOIN invoice_lines AS T2 ON T1.id = T2.track_id JOIN invoices AS T3 ON T3.id = T2.invoice_id JOIN customers AS T4 ON T4.id = T3.customer_id WHERE T4.first_name = \"Daan\" AND T4.last_name = \"Peeters\";",
    "table_names": [
      "customers",
      "invoices",
      "tracks",
      "invoice_lines"
    ]
  },
  {
    "id": 182,
    "db_id": "local_govt_mdm",
    "question": "List the customer names who have rent arrears records.",
    "sql": "SELECT cmi_details FROM Customer_Master_Index WHERE master_customer_id IN (SELECT master_customer_id FROM CMI_Cross_References WHERE cmi_cross_ref_id IN (SELECT cmi_cross_ref_id FROM Rent_Arrears));",
    "table_names": [
      "Customer_Master_Index",
      "CMI_Cross_References",
      "Rent_Arrears"
    ]
  },
  {
    "id": 124,
    "db_id": "browser_web",
    "question": "Which web client accelerators compatible with Firefox since 2007 or earlier support wireless connections?",
    "sql": "SELECT wca.name FROM Web_client_accelerator wca JOIN accelerator_compatible_browser acb ON wca.id = acb.accelerator_id JOIN browser b ON acb.browser_id = b.id WHERE b.name = 'Firefox' AND wca.Connection LIKE '%Wireless%' AND acb.compatible_since_year <= 2007;",
    "table_names": [
      "Web_client_accelerator",
      "browser",
      "accelerator_compatible_browser"
    ]
  },
  {
    "id": 56,
    "db_id": "game_injury",
    "question": "In which stadium did Esteban Cambiasso suffer his second recorded injury?",
    "sql": "SELECT s.name FROM stadium s JOIN game g ON s.id = g.stadium_id JOIN injury_accident ia ON g.id = ia.game_id WHERE ia.Player = 'Esteban Cambiasso (2)' ORDER BY g.Date DESC LIMIT 1;",
    "table_names": [
      "stadium",
      "game",
      "injury_accident"
    ]
  },
  {
    "id": 105,
    "db_id": "small_bank_1",
    "question": "Who has savings account balance greater than 100000 and checking account balance greater than 5000?",
    "sql": "SELECT name FROM ACCOUNTS WHERE custid IN (SELECT SAVINGS.custid FROM SAVINGS JOIN CHECKING ON SAVINGS.custid = CHECKING.custid WHERE SAVINGS.balance > 100000 AND CHECKING.balance > 5000);",
    "table_names": [
      "ACCOUNTS",
      "SAVINGS",
      "CHECKING"
    ]
  },
  {
    "id": 538,
    "db_id": "dorm_1",
    "question": "What is the name of the female-only dormitory that has a Study Room amenity?",
    "sql": "SELECT Dorm.dorm_name FROM Dorm JOIN Has_amenity ON Dorm.dormid = Has_amenity.dormid JOIN Dorm_amenity ON Has_amenity.amenid = Dorm_amenity.amenid WHERE Dorm_amenity.amenity_name = 'Study Room' AND Dorm.gender = 'F';",
    "table_names": [
      "Dorm",
      "Dorm_amenity",
      "Has_amenity"
    ]
  },
  {
    "id": 554,
    "db_id": "dorm_1",
    "question": "Which gender-neutral dorm has a 'Pub in Basement' amenity and can accommodate more than 300 students?",
    "sql": "SELECT Dorm.dorm_name FROM Dorm JOIN Has_amenity ON Dorm.dormid = Has_amenity.dormid JOIN Dorm_amenity ON Has_amenity.amenid = Dorm_amenity.amenid WHERE Dorm.gender = 'X' AND Dorm_amenity.amenity_name = 'Pub in Basement' AND Dorm.student_capacity > 300;",
    "table_names": [
      "Dorm",
      "Dorm_amenity",
      "Has_amenity"
    ]
  },
  {
    "id": 167,
    "db_id": "machine_repair",
    "question": "What are the names of technicians who are younger than 40 years and have been assigned to repair machines whose value points exceed 100?",
    "sql": "SELECT distinct technician.Name FROM machine INNER JOIN repair_assignment ON machine.Machine_ID = repair_assignment.Machine_ID INNER JOIN technician ON repair_assignment.technician_id = technician.technician_id WHERE machine.value_points > 100 AND technician.Age < 40;",
    "table_names": [
      "machine",
      "technician",
      "repair_assignment"
    ]
  },
  {
    "id": 669,
    "db_id": "pets_1",
    "question": "What's the average age of pets owned by students from city code 'HKG'?",
    "sql": "SELECT AVG(p.pet_age) FROM Student s JOIN Has_Pet hp ON s.StuID = hp.StuID JOIN Pets p ON hp.PetID = p.PetID WHERE s.city_code = 'HKG';",
    "table_names": [
      "Student",
      "Has_Pet",
      "Pets"
    ]
  },
  {
    "id": 699,
    "db_id": "course_teach",
    "question": "Who is the teacher teaching the Math course to students in grade 3?",
    "sql": "SELECT teacher.Name FROM teacher JOIN course_arrange ON teacher.Teacher_ID = course_arrange.Teacher_ID JOIN course ON course.Course_ID = course_arrange.Course_ID WHERE course.Course = 'Math' AND course_arrange.Grade = 3;",
    "table_names": [
      "course",
      "teacher",
      "course_arrange"
    ]
  },
  {
    "id": 441,
    "db_id": "company_office",
    "question": "Which buildings in Mexico City that are currently under construction will have banking industry companies moving in before 2025?",
    "sql": "SELECT b.name FROM buildings b JOIN Office_locations o ON b.id = o.building_id JOIN Companies c ON o.company_id = c.id WHERE c.Industry = 'Banking' AND b.City = 'Mexico City' AND o.move_in_year < 2025 AND b.Status = 'under construction';",
    "table_names": [
      "buildings",
      "Companies",
      "Office_locations"
    ]
  },
  {
    "id": 630,
    "db_id": "scientist_1",
    "question": "Who are the scientists involved in the project with the highest number of hours?",
    "sql": "SELECT Scientists.Name FROM Scientists JOIN AssignedTo ON Scientists.SSN = AssignedTo.Scientist JOIN Projects ON AssignedTo.Project = Projects.Code WHERE Projects.Hours = (SELECT MAX(Hours) FROM Projects)",
    "table_names": [
      "Scientists",
      "Projects",
      "AssignedTo"
    ]
  },
  {
    "id": 471,
    "db_id": "aircraft",
    "question": "Which airport has a helicopter assigned to it with the maximum gross weight?",
    "sql": "SELECT airport.Airport_Name FROM airport JOIN airport_aircraft ON airport.Airport_ID = airport_aircraft.Airport_ID JOIN aircraft ON aircraft.Aircraft_ID = airport_aircraft.Aircraft_ID WHERE aircraft.Max_Gross_Weight = (SELECT MAX(Max_Gross_Weight) FROM aircraft);",
    "table_names": [
      "aircraft",
      "airport",
      "airport_aircraft"
    ]
  },
  {
    "id": 631,
    "db_id": "scientist_1",
    "question": "Who are the scientists working on the project with the highest number of hours?",
    "sql": "SELECT S.Name FROM Scientists S JOIN AssignedTo A ON S.SSN = A.Scientist JOIN Projects P ON A.Project = P.Code WHERE P.Hours = (SELECT MAX(Hours) FROM Projects)",
    "table_names": [
      "Scientists",
      "Projects",
      "AssignedTo"
    ]
  },
  {
    "id": 298,
    "db_id": "college_1",
    "question": "Which professor is teaching the most classes that earn 4.0 credits?",
    "sql": "SELECT E.EMP_FNAME, E.EMP_LNAME, COUNT(CL.CLASS_CODE) AS num_classes FROM EMPLOYEE E JOIN CLASS CL ON E.EMP_NUM = CL.PROF_NUM JOIN COURSE CR ON CL.CRS_CODE = CR.CRS_CODE WHERE CR.CRS_CREDIT = 4.0 GROUP BY E.EMP_NUM ORDER BY num_classes DESC LIMIT 1;",
    "table_names": [
      "CLASS",
      "COURSE",
      "EMPLOYEE"
    ]
  },
  {
    "id": 584,
    "db_id": "game_1",
    "question": "List the names of video games played for more than 10 hours by students who live in the city with code 'BAL'.",
    "sql": "SELECT VG.GName FROM Video_Games VG JOIN Plays_Games PG ON VG.GameID = PG.GameID JOIN Student S ON PG.StuID = S.StuID WHERE S.city_code = 'BAL' AND PG.Hours_Played > 10;",
    "table_names": [
      "Student",
      "Video_Games",
      "Plays_Games"
    ]
  },
  {
    "id": 150,
    "db_id": "formula_1",
    "question": "Find the id and forenames of drivers who participated both the races with name Australian Grand Prix and the races with name Chinese Grand Prix?",
    "sql": "SELECT T2.driverid ,  T3.forename FROM races AS T1 JOIN results AS T2 ON T1.raceid = T2.raceid JOIN drivers AS T3 ON T2.driverid  =  T3.driverid WHERE T1.name = \"Australian Grand Prix\" INTERSECT SELECT T2.driverid ,  T3.forename FROM races AS T1 JOIN results AS T2 ON T1.raceid = T2.raceid JOIN drivers AS T3 ON T2.driverid  =  T3.driverid WHERE T1.name = \"Chinese Grand Prix\"",
    "table_names": [
      "races",
      "drivers",
      "results"
    ]
  },
  {
    "id": 280,
    "db_id": "college_1",
    "question": "Which classes, along with their times and rooms, belong to the 'Computer Info. Systems' department and have a course credit of 4.0?",
    "sql": "SELECT CLASS.CLASS_CODE, CLASS.CLASS_TIME, CLASS.CLASS_ROOM FROM CLASS INNER JOIN COURSE ON CLASS.CRS_CODE = COURSE.CRS_CODE INNER JOIN DEPARTMENT ON COURSE.DEPT_CODE = DEPARTMENT.DEPT_CODE WHERE DEPARTMENT.DEPT_NAME = 'Computer Info. Systems' AND COURSE.CRS_CREDIT = 4.0;",
    "table_names": [
      "CLASS",
      "COURSE",
      "DEPARTMENT",
      "ENROLL"
    ]
  },
  {
    "id": 324,
    "db_id": "baseball_1",
    "question": "What is the average height of the players from the college named 'Yale University'?",
    "sql": "SELECT avg(T1.height) FROM player AS T1 JOIN player_college AS T2 ON T1.player_id  =  T2.player_id JOIN college AS T3 ON T3.college_id  =  T2.college_id WHERE T3.name_full  =  'Yale University';",
    "table_names": [
      "player_college",
      "player",
      "college"
    ]
  },
  {
    "id": 300,
    "db_id": "college_1",
    "question": "What are the first and last names of professors along with class section, class time, and course description for classes scheduled specifically on Wednesday evening with more than 3 credit hours?",
    "sql": "SELECT E.EMP_FNAME, E.EMP_LNAME, C.CLASS_SECTION, C.CLASS_TIME, CRS.CRS_DESCRIPTION FROM EMPLOYEE E JOIN CLASS C ON E.EMP_NUM = C.PROF_NUM JOIN COURSE CRS ON C.CRS_CODE = CRS.CRS_CODE WHERE CRS.CRS_CREDIT > 3.0 AND C.CLASS_TIME LIKE '%W 6:00-8:40 p.m.%';",
    "table_names": [
      "CLASS",
      "COURSE",
      "EMPLOYEE",
      "PROFESSOR"
    ]
  },
  {
    "id": 172,
    "db_id": "movie_1",
    "question": "Which movies directed by Steven Spielberg were rated by Chris Jackson?",
    "sql": "SELECT DISTINCT Movie.title FROM Movie JOIN Rating ON Movie.mID = Rating.mID WHERE Rating.rID IN (SELECT rID FROM Reviewer WHERE name = 'Chris Jackson') AND Movie.director = 'Steven Spielberg';",
    "table_names": [
      "Movie",
      "Reviewer",
      "Rating"
    ]
  },
  {
    "id": 502,
    "db_id": "products_gen_characteristics",
    "question": "Which product in the Seeds category has a high characteristic value for the 'slow' characteristic?",
    "sql": "SELECT P.product_name FROM Products P JOIN Product_Characteristics PC ON P.product_id = PC.product_id JOIN Characteristics C ON PC.characteristic_id = C.characteristic_id WHERE C.characteristic_name = 'slow' AND PC.product_characteristic_value = 'high' AND P.product_category_code = 'Seeds';",
    "table_names": [
      "Characteristics",
      "Products",
      "Product_Characteristics"
    ]
  },
  {
    "id": 438,
    "db_id": "company_office",
    "question": "Which is the tallest building occupied by a company operating in the Banking industry?",
    "sql": "SELECT b.name FROM buildings b JOIN Office_locations ol ON b.id = ol.building_id JOIN Companies c ON ol.company_id = c.id WHERE c.Industry = 'Banking' ORDER BY b.Height DESC LIMIT 1;",
    "table_names": [
      "buildings",
      "Companies",
      "Office_locations"
    ]
  },
  {
    "id": 544,
    "db_id": "dorm_1",
    "question": "In which dorm does Sarah Schmidt reside?",
    "sql": "SELECT d.dorm_name FROM Dorm d INNER JOIN Lives_in li ON d.dormid = li.dormid INNER JOIN Student s ON li.stuid = s.StuID WHERE s.LName = 'Schmidt' AND s.Fname = 'Sarah';",
    "table_names": [
      "Student",
      "Dorm",
      "Lives_in"
    ]
  },
  {
    "id": 243,
    "db_id": "icfp_1",
    "question": "What are the titles of papers which have first authors associated with institutions from the USA?",
    "sql": "SELECT Papers.title FROM Papers JOIN Authorship ON Papers.paperID = Authorship.paperID JOIN Inst ON Authorship.instID = Inst.instID WHERE Inst.country = 'USA' AND Authorship.authOrder = 1;",
    "table_names": [
      "Inst",
      "Papers",
      "Authorship"
    ]
  },
  {
    "id": 355,
    "db_id": "hospital_1",
    "question": "Which physicians have valid certifications expiring on December 31, 2008, and are trained to perform procedures costing more than $5000?",
    "sql": "SELECT Physician.Name FROM Physician JOIN Trained_In ON Physician.EmployeeID = Trained_In.Physician JOIN Procedures ON Trained_In.Treatment = Procedures.Code WHERE Procedures.Cost > 5000 AND Trained_In.CertificationExpires = '2008-12-31';",
    "table_names": [
      "Physician",
      "Procedures",
      "Trained_In"
    ]
  },
  {
    "id": 613,
    "db_id": "city_record",
    "question": "What was the average July temperature for the city that hosted a match in 2013?",
    "sql": "SELECT city.City, temperature.Jul FROM city JOIN temperature ON city.City_ID = temperature.City_ID JOIN hosting_city ON city.City_ID = CAST(hosting_city.Host_City AS INT) WHERE hosting_city.Year = 2013;",
    "table_names": [
      "city",
      "temperature",
      "hosting_city"
    ]
  },
  {
    "id": 242,
    "db_id": "icfp_1",
    "question": "List all the paper titles whose first authors are from institutions in the USA.",
    "sql": "SELECT P.title FROM Papers P JOIN Authorship A ON P.paperID = A.paperID JOIN Inst I ON A.instID = I.instID WHERE I.country = 'USA' AND A.authOrder = 1;",
    "table_names": [
      "Inst",
      "Papers",
      "Authorship"
    ]
  },
  {
    "id": 75,
    "db_id": "college_2",
    "question": "Which course from the Cybernetics department has been held in a classroom with a capacity greater than 100, and in which semester and year was it taught?",
    "sql": "SELECT c.title, s.semester, s.year FROM section s JOIN course c ON s.course_id = c.course_id JOIN classroom cl ON s.building = cl.building AND s.room_number = cl.room_number WHERE cl.capacity > 100 AND c.dept_name = 'Cybernetics';",
    "table_names": [
      "classroom",
      "course",
      "section"
    ]
  },
  {
    "id": 303,
    "db_id": "college_1",
    "question": "Which students earned a grade of 'A' in courses having exactly 3 credit hours?",
    "sql": "SELECT E.STU_NUM FROM ENROLL E JOIN CLASS CL ON E.CLASS_CODE = CL.CLASS_CODE JOIN COURSE C ON CL.CRS_CODE = C.CRS_CODE WHERE C.CRS_CREDIT = 3.0 AND E.ENROLL_GRADE = 'A';",
    "table_names": [
      "CLASS",
      "COURSE",
      "ENROLL",
      "STUDENT"
    ]
  },
  {
    "id": 443,
    "db_id": "entertainment_awards",
    "question": "In which festival did the artwork named 'I Know' win an award?",
    "sql": "SELECT fd.Festival_Name FROM festival_detail fd JOIN nomination n ON fd.Festival_ID = n.Festival_ID JOIN artwork aw ON aw.Artwork_ID = n.Artwork_ID WHERE aw.Name = 'I Know' AND n.Result = 'Won';",
    "table_names": [
      "festival_detail",
      "artwork",
      "nomination"
    ]
  },
  {
    "id": 356,
    "db_id": "hospital_1",
    "question": "What is the total cost of all procedures that Christopher Turk is certified to perform as of December 1, 2008?",
    "sql": "SELECT SUM(Procedures.Cost) FROM Procedures WHERE Code IN (SELECT Treatment FROM Trained_In WHERE Physician = (SELECT EmployeeID FROM Physician WHERE Name = 'Christopher Turk') AND CertificationExpires >= '2008-12-01');",
    "table_names": [
      "Physician",
      "Procedures",
      "Trained_In"
    ]
  },
  {
    "id": 158,
    "db_id": "formula_1",
    "question": "Find the driver id and number of races of all drivers who have at most participated in 30 races?",
    "sql": "SELECT T1.driverid ,  count(*) FROM drivers AS T1 JOIN results AS T2 ON T1.driverid = T2.driverid JOIN races AS T3 ON T2.raceid = T3.raceid GROUP BY T1.driverid HAVING count(*)  <=  30",
    "table_names": [
      "races",
      "drivers",
      "results"
    ]
  },
  {
    "id": 262,
    "db_id": "assets_maintenance",
    "question": "How many maintenance engineers from company number 3 have either Electrical or TV, Video skills?",
    "sql": "SELECT COUNT(DISTINCT me.engineer_id) FROM Maintenance_Engineers me INNER JOIN Engineer_Skills es ON me.engineer_id = es.engineer_id INNER JOIN Skills s ON es.skill_id = s.skill_id WHERE s.skill_code IN ('ELEC', 'TV') AND me.company_id = 3;",
    "table_names": [
      "Skills",
      "Maintenance_Engineers",
      "Engineer_Skills"
    ]
  },
  {
    "id": 65,
    "db_id": "college_2",
    "question": "Who taught courses offered by the Cybernetics department in the Fall semester of 2003?",
    "sql": "SELECT i.name FROM instructor i JOIN teaches t ON i.ID = t.ID JOIN course c ON t.course_id = c.course_id WHERE c.dept_name = 'Cybernetics' AND t.semester = 'Fall' AND t.year = 2003;",
    "table_names": [
      "course",
      "instructor",
      "teaches"
    ]
  },
  {
    "id": 365,
    "db_id": "hospital_1",
    "question": "What are the names of all medications prescribed to the patient living at '1100 Foobaz Avenue' and what are their respective doses?",
    "sql": "SELECT Medication.Name, Prescribes.Dose FROM Medication JOIN Prescribes ON Medication.Code = Prescribes.Medication JOIN Patient ON Patient.SSN = Prescribes.Patient WHERE Patient.Address = '1100 Foobaz Avenue';",
    "table_names": [
      "Patient",
      "Medication",
      "Prescribes"
    ]
  },
  {
    "id": 250,
    "db_id": "sakila_1",
    "question": "Find the length of the shortest movie in the 'Drama' category.",
    "sql": "SELECT MIN(f.length) FROM film AS f JOIN film_category AS fc ON f.film_id = fc.film_id JOIN category AS c ON fc.category_id = c.category_id WHERE c.name = 'Drama';",
    "table_names": [
      "category",
      "film",
      "film_category"
    ]
  },
  {
    "id": 603,
    "db_id": "customers_and_addresses",
    "question": "Which customer was the first to have a cancelled order containing product with product_id 2?",
    "sql": "SELECT c.customer_name FROM Customers c JOIN Customer_Orders co ON c.customer_id = co.customer_id JOIN Order_Items oi ON co.order_id = oi.order_id WHERE co.order_status = 'Cancelled' AND oi.product_id = 2 ORDER BY co.order_date LIMIT 1;",
    "table_names": [
      "Customers",
      "Customer_Orders",
      "Order_Items"
    ]
  },
  {
    "id": 305,
    "db_id": "college_1",
    "question": "What is the name and department of the professor teaching class code '10016'?",
    "sql": "SELECT EMPLOYEE.EMP_FNAME, EMPLOYEE.EMP_LNAME, DEPARTMENT.DEPT_NAME FROM EMPLOYEE JOIN DEPARTMENT ON EMPLOYEE.EMP_NUM = DEPARTMENT.EMP_NUM JOIN CLASS ON EMPLOYEE.EMP_NUM = CLASS.PROF_NUM WHERE CLASS.CLASS_CODE = '10016';",
    "table_names": [
      "CLASS",
      "DEPARTMENT",
      "EMPLOYEE",
      "PROFESSOR"
    ]
  },
  {
    "id": 421,
    "db_id": "tracking_grants_for_research",
    "question": "What is the total grant amount associated with documents of type 'Initial Application' sent after January 1, 2000?",
    "sql": "SELECT SUM(G.grant_amount) FROM Grants G JOIN Documents D ON G.grant_id = D.grant_id JOIN Document_Types DT ON D.document_type_code = DT.document_type_code WHERE DT.document_description = 'Initial Application' AND D.sent_date > '2000-01-01';",
    "table_names": [
      "Document_Types",
      "Documents",
      "Grants"
    ]
  },
  {
    "id": 506,
    "db_id": "products_gen_characteristics",
    "question": "Which products in the 'Seeds' category have a 'medium' value for the 'Grade' characteristic?",
    "sql": "SELECT P.product_name FROM Products P JOIN Product_Characteristics PC ON P.product_id = PC.product_id JOIN Characteristics C ON PC.characteristic_id = C.characteristic_id WHERE C.characteristic_type_code = 'Grade' AND PC.product_characteristic_value = 'medium' AND P.product_category_code = 'Seeds';",
    "table_names": [
      "Characteristics",
      "Products",
      "Product_Characteristics"
    ]
  },
  {
    "id": 193,
    "db_id": "storm_record",
    "question": "Which region has been most impacted financially by storms overall in terms of total damage, and how many cities and deaths are related to storms in this region?",
    "sql": "SELECT r.Region_name, SUM(ar.Number_city_affected) as total_cities_affected, SUM(s.Number_Deaths) as total_deaths, SUM(s.Damage_millions_USD) as total_damage FROM affected_region ar JOIN region r ON ar.Region_id = r.Region_id JOIN storm s ON ar.Storm_ID = s.Storm_ID GROUP BY r.Region_name ORDER BY total_damage DESC LIMIT 1;",
    "table_names": [
      "storm",
      "region",
      "affected_region"
    ]
  },
  {
    "id": 326,
    "db_id": "baseball_1",
    "question": "List players' first name and last name who received salary from team Washington Nationals in both 2005 and 2007.",
    "sql": "SELECT T2.name_first ,  T2.name_last FROM salary AS T1 JOIN player AS T2 ON T1.player_id = T2.player_id JOIN team AS T3 ON T3.team_id_br = T1.team_id WHERE T1.year = 2005 AND T3.name = 'Washington Nationals' INTERSECT SELECT T2.name_first , T2.name_last FROM salary AS T1 JOIN player AS T2 ON T1.player_id = T2.player_id JOIN team AS T3 ON T3.team_id_br = T1.team_id WHERE T1.year = 2007 AND T3.name = 'Washington Nationals'",
    "table_names": [
      "player",
      "salary",
      "team"
    ]
  },
  {
    "id": 579,
    "db_id": "cre_Theme_park",
    "question": "List the names of tourist attractions that can be reached by bus and have a garden feature.",
    "sql": "SELECT DISTINCT ta.Name FROM Tourist_Attractions AS ta JOIN Tourist_Attraction_Features AS taf ON ta.Tourist_Attraction_ID = taf.Tourist_Attraction_ID JOIN Features AS f ON taf.Feature_ID = f.Feature_ID WHERE ta.How_to_Get_There = 'bus' AND f.Feature_Details = 'garden';",
    "table_names": [
      "Features",
      "Tourist_Attractions",
      "Tourist_Attraction_Features"
    ]
  },
  {
    "id": 201,
    "db_id": "news_report",
    "question": "Which journalist hosted the event named 'Olympia Games Openning'?",
    "sql": "SELECT journalist.Name FROM journalist INNER JOIN news_report ON journalist.journalist_ID = news_report.journalist_ID INNER JOIN event ON news_report.Event_ID = event.Event_ID WHERE event.Name = 'Olympia Games Openning' AND news_report.Work_Type = 'Host';",
    "table_names": [
      "event",
      "journalist",
      "news_report"
    ]
  },
  {
    "id": 658,
    "db_id": "concert_singer",
    "question": "Which singers from France performed at concerts held in the year 2014?",
    "sql": "SELECT DISTINCT s.Name FROM singer AS s JOIN singer_in_concert AS sc ON s.Singer_ID = sc.Singer_ID JOIN concert AS c ON sc.concert_ID = c.concert_ID WHERE s.Country = 'France' AND c.Year = '2014';",
    "table_names": [
      "singer",
      "concert",
      "singer_in_concert"
    ]
  },
  {
    "id": 85,
    "db_id": "insurance_and_eClaims",
    "question": "What is the total amount paid for all disputed claims made by Buddy Marquardt under the Uniformed policy type?",
    "sql": "SELECT SUM(Claim_Headers.Amount_Piad) FROM Claim_Headers JOIN Policies ON Claim_Headers.Policy_ID = Policies.Policy_ID JOIN Customers ON Policies.Customer_ID = Customers.Customer_ID WHERE Customers.Customer_Details = 'Buddy Marquardt' AND Policies.Policy_Type_Code = 'Uniformed' AND Claim_Headers.Claim_Status_Code = 'Disputed';",
    "table_names": [
      "Customers",
      "Policies",
      "Claim_Headers"
    ]
  },
  {
    "id": 302,
    "db_id": "college_1",
    "question": "Which classroom hosts the class with the highest credit value offered by the 'Computer Info. Systems' department?",
    "sql": "SELECT CLASS.CLASS_ROOM FROM CLASS JOIN COURSE ON CLASS.CRS_CODE = COURSE.CRS_CODE JOIN DEPARTMENT ON COURSE.DEPT_CODE = DEPARTMENT.DEPT_CODE WHERE DEPARTMENT.DEPT_NAME = 'Computer Info. Systems' ORDER BY COURSE.CRS_CREDIT DESC LIMIT 1;",
    "table_names": [
      "CLASS",
      "COURSE",
      "DEPARTMENT",
      "EMPLOYEE",
      "PROFESSOR"
    ]
  },
  {
    "id": 240,
    "db_id": "icfp_1",
    "question": "Who is the first author of the paper titled 'Binders Unbound'?",
    "sql": "SELECT fname, lname FROM Authors WHERE authID IN (SELECT authID FROM Authorship WHERE paperID = (SELECT paperID FROM Papers WHERE title = 'Binders Unbound') ORDER BY authOrder ASC LIMIT 1);",
    "table_names": [
      "Authors",
      "Papers",
      "Authorship"
    ]
  },
  {
    "id": 396,
    "db_id": "club_1",
    "question": "List the names of students who are members of the 'Bootup Baltimore' club but do not live in Baltimore.",
    "sql": "SELECT Student.Fname, Student.LName FROM Student INNER JOIN Member_of_club ON Student.StuID = Member_of_club.StuID INNER JOIN Club ON Member_of_club.ClubID = Club.ClubID WHERE Club.ClubName = 'Bootup Baltimore' AND Student.city_code NOT IN ('BAL');",
    "table_names": [
      "Student",
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 412,
    "db_id": "club_1",
    "question": "How many students come from the same cities as students who are members of 'Bootup Baltimore' club but are themselves not members of this club?",
    "sql": "SELECT COUNT(*) FROM Student WHERE city_code IN (SELECT city_code FROM Student JOIN Member_of_club ON Student.StuID = Member_of_club.StuID WHERE ClubID = (SELECT ClubID FROM Club WHERE ClubName = 'Bootup Baltimore')) AND StuID NOT IN (SELECT StuID FROM Member_of_club WHERE ClubID = (SELECT ClubID FROM Club WHERE ClubName = 'Bootup Baltimore'));",
    "table_names": [
      "Student",
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 192,
    "db_id": "storm_record",
    "question": "Which region had the highest number of cities affected by a single storm?",
    "sql": "SELECT r.Region_name FROM region r JOIN affected_region ar ON r.Region_id = ar.Region_id WHERE ar.Number_city_affected = (SELECT MAX(Number_city_affected) FROM affected_region);",
    "table_names": [
      "storm",
      "region",
      "affected_region"
    ]
  },
  {
    "id": 406,
    "db_id": "club_1",
    "question": "How many students from city code 'BAL' are members of the club 'Bootup Baltimore'?",
    "sql": "SELECT COUNT(*) FROM Student WHERE city_code = 'BAL' AND StuID IN (SELECT StuID FROM Member_of_club WHERE ClubID = (SELECT ClubID FROM Club WHERE ClubName = 'Bootup Baltimore'));",
    "table_names": [
      "Student",
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 685,
    "db_id": "car_1",
    "question": "Which German car manufacturer has the most number of distinct car models listed?",
    "sql": "SELECT cm.FullName, COUNT(cn.MakeId) FROM car_makers cm JOIN model_list ml ON cm.Id = ml.Maker JOIN car_names cn ON ml.Model = cn.Model WHERE cm.Country = '2' GROUP BY cm.FullName ORDER BY COUNT(cn.MakeId) DESC LIMIT 1;",
    "table_names": [
      "car_makers",
      "model_list",
      "car_names",
      "cars_data"
    ]
  },
  {
    "id": 497,
    "db_id": "tracking_software_problems",
    "question": "Which product has Junius Treutel authorised the closure of the most problems for?",
    "sql": "SELECT p.product_name, COUNT(pb.problem_id) AS num_problems FROM Product p JOIN Problems pb ON p.product_id = pb.product_id JOIN Staff s ON pb.closure_authorised_by_staff_id = s.staff_id WHERE s.staff_first_name = 'Junius' AND s.staff_last_name = 'Treutel' GROUP BY p.product_name ORDER BY num_problems DESC LIMIT 1;",
    "table_names": [
      "Product",
      "Staff",
      "Problems"
    ]
  },
  {
    "id": 29,
    "db_id": "store_1",
    "question": "What are the names of all Rock tracks that are stored on MPEG audio files?",
    "sql": "SELECT T2.name FROM genres AS T1 JOIN tracks AS T2 ON T1.id = T2.genre_id JOIN media_types AS T3 ON T3.id = T2.media_type_id WHERE T1.name = \"Rock\" AND T3.name = \"MPEG audio file\";",
    "table_names": [
      "genres",
      "media_types",
      "tracks"
    ]
  },
  {
    "id": 716,
    "db_id": "dog_kennels",
    "question": "What is the average cost of treatments for dogs of the breed ESK, owned by people living in Maryland?",
    "sql": "SELECT AVG(T.cost_of_treatment) AS average_cost FROM Treatments AS T JOIN Dogs AS D ON T.dog_id = D.dog_id JOIN Owners AS O ON D.owner_id = O.owner_id WHERE O.state = 'Maryland' AND D.breed_code = 'ESK';",
    "table_names": [
      "Owners",
      "Dogs",
      "Treatments"
    ]
  },
  {
    "id": 115,
    "db_id": "small_bank_1",
    "question": "How many customers have a savings account balance of at least 200,000 and also have at least 5,000 in their checking account?",
    "sql": "SELECT COUNT(*) FROM ACCOUNTS a JOIN SAVINGS s ON a.custid = s.custid JOIN CHECKING c ON a.custid = c.custid WHERE s.balance >= 200000 AND c.balance >= 5000;",
    "table_names": [
      "ACCOUNTS",
      "SAVINGS",
      "CHECKING"
    ]
  },
  {
    "id": 154,
    "db_id": "formula_1",
    "question": "What is the id and last name of the driver who participated in the most races after 2010?",
    "sql": "SELECT T1.driverid ,  T1.surname FROM drivers AS T1 JOIN results AS T2 ON T1.driverid  =  T2.driverid JOIN races AS T3 ON T2.raceid = T3.raceid WHERE T3.year > 2010 GROUP BY T1.driverid ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "races",
      "drivers",
      "results"
    ]
  },
  {
    "id": 93,
    "db_id": "theme_gallery",
    "question": "Which artist's exhibitions have drawn the highest total attendance?",
    "sql": "SELECT a.Name, SUM(r.Attendance) AS Total_Attendance FROM artist a JOIN exhibition e ON a.Artist_ID = e.Artist_ID JOIN exhibition_record r ON e.Exhibition_ID = r.Exhibition_ID GROUP BY a.Artist_ID ORDER BY Total_Attendance DESC LIMIT 1;",
    "table_names": [
      "artist",
      "exhibition",
      "exhibition_record"
    ]
  },
  {
    "id": 329,
    "db_id": "mountain_photos",
    "question": "What are the names of the mountains photographed using camera lenses from the Sigma brand?",
    "sql": "SELECT mountain.name FROM mountain WHERE mountain.id IN (SELECT photos.mountain_id FROM photos WHERE photos.camera_lens_id IN (SELECT camera_lens.id FROM camera_lens WHERE camera_lens.brand = 'Sigma'))",
    "table_names": [
      "mountain",
      "camera_lens",
      "photos"
    ]
  },
  {
    "id": 261,
    "db_id": "assets_maintenance",
    "question": "What are the names of the staff members who recorded fault logs for asset_id 5 that currently have the fault status marked as 'Waiting'?",
    "sql": "SELECT s.staff_name FROM Staff s JOIN Fault_Log fl ON s.staff_id = fl.recorded_by_staff_id JOIN Engineer_Visits ev ON fl.fault_log_entry_id = ev.fault_log_entry_id WHERE ev.fault_status = 'Waiting' AND fl.asset_id = 5;",
    "table_names": [
      "Staff",
      "Fault_Log",
      "Engineer_Visits"
    ]
  },
  {
    "id": 54,
    "db_id": "phone_1",
    "question": "How many different phone companies manufactured devices using a chip model that supports WiFi '802.11b' and utilizing a screen mode classified as 'Graphics'?",
    "sql": "SELECT COUNT(DISTINCT phone.Company_name) FROM phone JOIN chip_model ON phone.chip_model = chip_model.Model_name JOIN screen_mode ON phone.screen_mode = screen_mode.Graphics_mode WHERE chip_model.WiFi = '802.11b' AND screen_mode.Type = 'Graphics';",
    "table_names": [
      "chip_model",
      "screen_mode",
      "phone"
    ]
  },
  {
    "id": 83,
    "db_id": "debate",
    "question": "List the dates of debates where the affirmative speaker was from the Republican party but did not win the debate.",
    "sql": "SELECT d.Date FROM debate d JOIN debate_people dp ON d.Debate_ID = dp.Debate_ID JOIN people p ON dp.Affirmative = p.People_ID WHERE p.Party = 'Republican' AND dp.If_Affirmative_Win = 'F';",
    "table_names": [
      "people",
      "debate",
      "debate_people"
    ]
  },
  {
    "id": 222,
    "db_id": "icfp_1",
    "question": "What is the title of the paper where the author Ralf Hinze has the highest authorship order (closest to first author)?",
    "sql": "SELECT p.title FROM Papers p JOIN Authorship a ON p.paperID = a.paperID JOIN Authors au ON a.authID = au.authID WHERE au.fname = 'Ralf' AND au.lname = 'Hinze' ORDER BY a.authOrder ASC LIMIT 1;",
    "table_names": [
      "Authors",
      "Papers",
      "Authorship"
    ]
  },
  {
    "id": 624,
    "db_id": "scientist_1",
    "question": "List the names of scientists assigned to projects requiring more than 500 hours.",
    "sql": "SELECT Name FROM Scientists WHERE SSN IN (SELECT Scientist FROM AssignedTo WHERE Project IN (SELECT Code FROM Projects WHERE Hours > 500));",
    "table_names": [
      "Scientists",
      "Projects",
      "AssignedTo"
    ]
  },
  {
    "id": 403,
    "db_id": "club_1",
    "question": "How many unique clubs have at least one member who is a student from the city with the city_code 'BAL'?",
    "sql": "SELECT COUNT(DISTINCT c.ClubName) FROM Club c JOIN Member_of_club m ON c.ClubID = m.ClubID JOIN Student s ON m.StuID = s.StuID WHERE s.city_code = 'BAL';",
    "table_names": [
      "Student",
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 668,
    "db_id": "pets_1",
    "question": "Who among the students in the city code 'HKG' has the highest total number of pets, and how many pets do they have?",
    "sql": "SELECT S.Fname, S.LName, COUNT(HP.PetID) AS NumPets FROM Student S JOIN Has_Pet HP ON S.StuID = HP.StuID JOIN Pets P ON HP.PetID = P.PetID WHERE S.city_code='HKG' GROUP BY S.StuID ORDER BY NumPets DESC LIMIT 1;",
    "table_names": [
      "Student",
      "Has_Pet",
      "Pets"
    ]
  },
  {
    "id": 678,
    "db_id": "car_1",
    "question": "Which country is associated with the car model 'saab'?",
    "sql": "SELECT c.CountryName FROM countries c JOIN car_makers cm ON c.CountryId = cm.Country JOIN model_list ml ON cm.Id = ml.Maker WHERE ml.Model = 'saab';",
    "table_names": [
      "countries",
      "car_makers",
      "model_list"
    ]
  },
  {
    "id": 333,
    "db_id": "hospital_1",
    "question": "Who are the physicians having primary affiliation with the Surgery department?",
    "sql": "SELECT Physician.Name FROM Physician JOIN Affiliated_With ON Physician.EmployeeID = Affiliated_With.Physician JOIN Department ON Affiliated_With.Department = Department.DepartmentID WHERE Department.Name = 'Surgery' AND Affiliated_With.PrimaryAffiliation = 1;",
    "table_names": [
      "Physician",
      "Department",
      "Affiliated_With"
    ]
  },
  {
    "id": 598,
    "db_id": "customers_and_addresses",
    "question": "Which customers placed orders containing product ID 2 that ended up getting cancelled?",
    "sql": "SELECT customer_name FROM Customers WHERE customer_id IN (SELECT customer_id FROM Customer_Orders WHERE order_id IN (SELECT order_id FROM Order_Items WHERE product_id = 2) AND order_status = 'Cancelled');",
    "table_names": [
      "Customers",
      "Customer_Orders",
      "Order_Items"
    ]
  },
  {
    "id": 92,
    "db_id": "theme_gallery",
    "question": "Which artist's exhibitions had the highest overall attendance?",
    "sql": "SELECT a.Name FROM artist a JOIN exhibition e ON a.Artist_ID = e.Artist_ID JOIN exhibition_record er ON e.Exhibition_ID = er.Exhibition_ID GROUP BY a.Name ORDER BY SUM(er.Attendance) DESC LIMIT 1;",
    "table_names": [
      "artist",
      "exhibition",
      "exhibition_record"
    ]
  },
  {
    "id": 420,
    "db_id": "tracking_grants_for_research",
    "question": "What is the total grant amount associated with all documents labeled as 'Initial Application'?",
    "sql": "SELECT SUM(g.grant_amount) FROM Grants g INNER JOIN Documents d ON g.grant_id = d.grant_id INNER JOIN Document_Types dt ON d.document_type_code = dt.document_type_code WHERE dt.document_description = 'Initial Application';",
    "table_names": [
      "Document_Types",
      "Documents",
      "Grants"
    ]
  },
  {
    "id": 139,
    "db_id": "gas_company",
    "question": "Which gas station locations are associated with companies headquartered in the Netherlands having a station rank of below 5?",
    "sql": "SELECT g.Location FROM gas_station AS g JOIN station_company AS sc ON g.Station_ID = sc.Station_ID JOIN company AS c ON sc.Company_ID = c.Company_ID WHERE c.Headquarters = 'Netherlands' AND sc.Rank_of_the_Year < 5;",
    "table_names": [
      "company",
      "gas_station",
      "station_company"
    ]
  },
  {
    "id": 582,
    "db_id": "cre_Theme_park",
    "question": "Which tourist visited the attraction named 'parking' accessible by shuttle?",
    "sql": "SELECT v.Tourist_ID FROM Visitors AS v JOIN Visits AS vs ON v.Tourist_ID = vs.Tourist_ID JOIN Tourist_Attractions AS ta ON vs.Tourist_Attraction_ID = ta.Tourist_Attraction_ID WHERE ta.How_to_Get_There = 'shuttle' AND ta.Name = 'parking';",
    "table_names": [
      "Visitors",
      "Tourist_Attractions",
      "Visits"
    ]
  },
  {
    "id": 503,
    "db_id": "products_gen_characteristics",
    "question": "What is the name of the herb product that has a high purity characteristic?",
    "sql": "SELECT Products.product_name FROM Products JOIN Product_Characteristics ON Products.product_id = Product_Characteristics.product_id JOIN Characteristics ON Product_Characteristics.characteristic_id = Characteristics.characteristic_id WHERE Products.product_category_code = 'Herbs' AND Characteristics.characteristic_type_code = 'Purity' AND Product_Characteristics.product_characteristic_value = 'high';",
    "table_names": [
      "Characteristics",
      "Products",
      "Product_Characteristics"
    ]
  },
  {
    "id": 52,
    "db_id": "phone_1",
    "question": "List the company names, hardware model names, chip model names, Bluetooth versions, and pixel resolutions of all phones with Bluetooth version 1.2 and a screen width resolution of at least 320 pixels.",
    "sql": "SELECT p.Company_name, p.Hardware_Model_name, c.Model_name, c.Bluetooth, s.Pixels FROM phone p JOIN chip_model c ON p.chip_model = c.Model_name JOIN screen_mode s ON p.screen_mode = CAST(s.Graphics_mode AS TEXT) WHERE c.Bluetooth = '1.2' AND CAST(substr(s.Pixels, 1, instr(s.Pixels, ' ') - 1) AS INTEGER) >= 320;",
    "table_names": [
      "chip_model",
      "screen_mode",
      "phone"
    ]
  },
  {
    "id": 299,
    "db_id": "college_1",
    "question": "What are the names of professors teaching 4-credit courses in room KLR200, along with their class timings and course descriptions?",
    "sql": "SELECT E.EMP_FNAME, E.EMP_LNAME, C.CLASS_TIME, CR.CRS_DESCRIPTION FROM CLASS C JOIN COURSE CR ON C.CRS_CODE = CR.CRS_CODE JOIN EMPLOYEE E ON C.PROF_NUM = E.EMP_NUM WHERE CR.CRS_CREDIT = 4.0 AND C.CLASS_ROOM = 'KLR200';",
    "table_names": [
      "CLASS",
      "COURSE",
      "EMPLOYEE",
      "PROFESSOR"
    ]
  },
  {
    "id": 653,
    "db_id": "tracking_orders",
    "question": "What is the name of the customer who has placed an order with status 'Packing' and whose customer details are 'corrupti'?",
    "sql": "SELECT customer_name FROM Customers WHERE customer_id IN (SELECT customer_id FROM Orders WHERE order_status = 'Packing') AND customer_details = 'corrupti';",
    "table_names": [
      "Customers",
      "Orders",
      "Products",
      "Order_Items"
    ]
  },
  {
    "id": 385,
    "db_id": "club_1",
    "question": "How many students from city code 'BAL' are members of clubs located at 'AKW'?",
    "sql": "SELECT COUNT(DISTINCT s.StuID) FROM Student s JOIN Member_of_club m ON s.StuID = m.StuID JOIN Club c ON m.ClubID = c.ClubID WHERE s.city_code = 'BAL' AND c.ClubLocation = 'AKW';",
    "table_names": [
      "Student",
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 400,
    "db_id": "club_1",
    "question": "Who are the students that share the same hometown as the CTO of Hopkins Student Enterprises club?",
    "sql": "SELECT Fname, LName FROM Student WHERE city_code = (SELECT city_code FROM Student WHERE StuID = (SELECT StuID FROM Member_of_club WHERE ClubID = (SELECT ClubID FROM Club WHERE ClubName = 'Hopkins Student Enterprises') AND Position = 'CTO'));",
    "table_names": [
      "Student",
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 111,
    "db_id": "small_bank_1",
    "question": "What is the average total balance (savings and checking combined) of customers who have savings account balances greater than 100,000?",
    "sql": "SELECT AVG(SAVINGS.balance + CHECKING.balance) AS avg_total_balance FROM SAVINGS INNER JOIN CHECKING ON SAVINGS.custid = CHECKING.custid WHERE SAVINGS.balance > 100000;",
    "table_names": [
      "ACCOUNTS",
      "SAVINGS",
      "CHECKING"
    ]
  },
  {
    "id": 422,
    "db_id": "tracking_grants_for_research",
    "question": "What are the task details of tasks belonging to projects from organisation_id 1 that have resulted in at least one patent?",
    "sql": "SELECT DISTINCT t.task_details FROM Tasks t JOIN Projects p ON t.project_id = p.project_id JOIN Project_Outcomes po ON p.project_id = po.project_id WHERE po.outcome_code = 'Patent' AND p.organisation_id = 1;",
    "table_names": [
      "Project_Outcomes",
      "Projects",
      "Tasks"
    ]
  },
  {
    "id": 106,
    "db_id": "small_bank_1",
    "question": "Which customers have savings account balances greater than 50,000 and checking account balances greater than 5,000?",
    "sql": "SELECT name FROM ACCOUNTS WHERE custid IN (SELECT custid FROM SAVINGS WHERE balance > 50000) AND custid IN (SELECT custid FROM CHECKING WHERE balance > 5000);",
    "table_names": [
      "ACCOUNTS",
      "SAVINGS",
      "CHECKING"
    ]
  },
  {
    "id": 297,
    "db_id": "college_1",
    "question": "Find the first names of all instructors who have taught some course and the course description.",
    "sql": "SELECT T2.emp_fname ,  T3.crs_description FROM CLASS AS T1 JOIN employee AS T2 ON T1.prof_num  =  T2.emp_num JOIN course AS T3 ON T1.crs_code  =  T3.crs_code",
    "table_names": [
      "CLASS",
      "COURSE",
      "EMPLOYEE"
    ]
  },
  {
    "id": 377,
    "db_id": "club_1",
    "question": "Who is the teaching coordinator of 'Bootup Baltimore' club, and which city is the person from?",
    "sql": "SELECT s.Fname, s.LName FROM Student s JOIN Member_of_club m ON s.StuID = m.StuID JOIN Club c ON m.ClubID = c.ClubID WHERE c.ClubName = 'Bootup Baltimore' AND s.city_code = 'HOU';",
    "table_names": [
      "Student",
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 246,
    "db_id": "icfp_1",
    "question": "What are the first and last names of the second author of the paper titled 'Functional Pearl: Modular Rollback through Control Logging'?",
    "sql": "SELECT fname, lname FROM Authors WHERE authID IN (SELECT authID FROM Authorship WHERE paperID = (SELECT paperID FROM Papers WHERE title = 'Functional Pearl: Modular Rollback through Control Logging') AND authOrder = 2);",
    "table_names": [
      "Authors",
      "Papers",
      "Authorship"
    ]
  },
  {
    "id": 185,
    "db_id": "party_host",
    "question": "What are the names of the hosts who were the main in charge of parties held entirely between the years 2000 and 2003?",
    "sql": "SELECT h.Name FROM host h INNER JOIN party_host ph ON h.Host_ID = ph.Host_ID INNER JOIN party p ON ph.Party_ID = p.Party_ID WHERE p.First_year >= '2000' AND p.Last_year <= '2003' AND ph.Is_Main_in_Charge = 'T';",
    "table_names": [
      "party",
      "host",
      "party_host"
    ]
  },
  {
    "id": 38,
    "db_id": "chinook_1",
    "question": "What are the album titles for albums containing both 'Reggae' and 'Rock' genre tracks?",
    "sql": "SELECT T1.Title FROM Album AS T1 JOIN Track AS T2 ON T1.AlbumId  =  T2.AlbumId JOIN Genre AS T3 ON T2.GenreID  =  T3.GenreID WHERE T3.Name  =  'Reggae' INTERSECT SELECT T1.Title FROM Album AS T1 JOIN Track AS T2 ON T1.AlbumId  =  T2.AlbumId JOIN Genre AS T3 ON T2.GenreID  =  T3.GenreID WHERE T3.Name  =  'Rock'",
    "table_names": [
      "Album",
      "Genre",
      "Track"
    ]
  },
  {
    "id": 381,
    "db_id": "club_1",
    "question": "How many distinct city codes do students belong to who are members of clubs located in 'AKW'?",
    "sql": "SELECT COUNT(DISTINCT Student.city_code) FROM Student INNER JOIN Member_of_club ON Student.StuID = Member_of_club.StuID INNER JOIN Club ON Member_of_club.ClubID = Club.ClubID WHERE Club.ClubLocation = 'AKW';",
    "table_names": [
      "Student",
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 159,
    "db_id": "formula_1",
    "question": "For each id of a driver who participated in at most 30 races, how many races did they participate in?",
    "sql": "SELECT T1.driverid ,  count(*) FROM drivers AS T1 JOIN results AS T2 ON T1.driverid = T2.driverid JOIN races AS T3 ON T2.raceid = T3.raceid GROUP BY T1.driverid HAVING count(*)  <=  30",
    "table_names": [
      "races",
      "drivers",
      "results"
    ]
  },
  {
    "id": 189,
    "db_id": "party_host",
    "question": "How many distinct hosts from the United States have hosted parties located at Heineken Music Hall Amsterdam?",
    "sql": "SELECT COUNT(DISTINCT h.Name) FROM host h JOIN party_host ph ON h.Host_ID = ph.Host_ID JOIN party p ON ph.Party_ID = p.Party_ID WHERE p.Location LIKE '%Heineken Music Hall Amsterdam%' AND h.Nationality = 'United States';",
    "table_names": [
      "party",
      "host",
      "party_host"
    ]
  },
  {
    "id": 6,
    "db_id": "student_assessment",
    "question": "What country did the student John live in?",
    "sql": "SELECT A.country FROM Addresses A INNER JOIN People_Addresses PA ON A.address_id = PA.address_id INNER JOIN Students S ON PA.student_id = S.student_id WHERE S.student_details = 'John';",
    "table_names": [
      "Addresses",
      "Students",
      "People_Addresses"
    ]
  },
  {
    "id": 313,
    "db_id": "manufacturer",
    "question": "List the names of manufacturers opened after year 2000 that produce furniture items with more than 10 components.",
    "sql": "SELECT m.Name FROM manufacturer m JOIN furniture_manufacte fm ON m.Manufacturer_ID = fm.Manufacturer_ID JOIN furniture f ON fm.Furniture_ID = f.Furniture_ID WHERE f.Num_of_Component > 10 AND m.Open_Year > 2000;",
    "table_names": [
      "manufacturer",
      "furniture",
      "furniture_manufacte"
    ]
  },
  {
    "id": 636,
    "db_id": "activity_1",
    "question": "Which instructors participate in the 'Crossword Puzzles' activity?",
    "sql": "SELECT F.Fname, F.Lname FROM Faculty F JOIN Faculty_Participates_in FP ON F.FacID = FP.FacID JOIN Activity A ON FP.actid = A.actid WHERE A.activity_name = 'Crossword Puzzles' AND F.Rank = 'Instructor';",
    "table_names": [
      "Activity",
      "Faculty_Participates_in",
      "Faculty"
    ]
  },
  {
    "id": 492,
    "db_id": "customers_and_addresses",
    "question": "What is the total sales amount for all orders containing products named 'film'?",
    "sql": "SELECT SUM(p.Product_Price * oi.Order_Quantity) AS total_film_sales FROM Products p JOIN Order_Items oi ON p.Product_ID = oi.Product_ID WHERE p.Product_Name = 'film';",
    "table_names": [
      "Products",
      "Customer_Orders",
      "Order_Items"
    ]
  },
  {
    "id": 251,
    "db_id": "sakila_1",
    "question": "What is the average film length (in minutes) for films in the 'Comedy' category?",
    "sql": "SELECT AVG(f.length) AS avg_length FROM film f JOIN film_category fc ON f.film_id = fc.film_id JOIN category c ON fc.category_id = c.category_id WHERE c.name = 'Comedy';",
    "table_names": [
      "category",
      "film",
      "film_category"
    ]
  },
  {
    "id": 462,
    "db_id": "department_store",
    "question": "Which supplier provided the hardware product with the highest total value purchased, and what is their contact phone number?",
    "sql": "SELECT s.supplier_name, s.supplier_phone FROM Suppliers s JOIN Product_Suppliers ps ON s.supplier_id = ps.supplier_id JOIN Products p ON ps.product_id = p.product_id WHERE p.product_type_code = 'Hardware' AND ps.total_value_purchased = (SELECT MAX(total_value_purchased) FROM Product_Suppliers ps JOIN Products p ON ps.product_id = p.product_id WHERE p.product_type_code = 'Hardware')",
    "table_names": [
      "Suppliers",
      "Products",
      "Product_Suppliers"
    ]
  },
  {
    "id": 252,
    "db_id": "sakila_1",
    "question": "What is the film title and inventory id of the item in the inventory which was rented most frequently?",
    "sql": "SELECT T1.title ,  T2.inventory_id FROM film AS T1 JOIN inventory AS T2 ON T1.film_id  =  T2.film_id JOIN rental AS T3 ON T2.inventory_id  =  T3.inventory_id GROUP BY T2.inventory_id ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "film",
      "inventory",
      "rental"
    ]
  },
  {
    "id": 700,
    "db_id": "museum_visit",
    "question": "Which museums opened after 2010 has Fernando Gago visited?",
    "sql": "SELECT m.Name FROM museum m JOIN visit v ON m.Museum_ID = v.Museum_ID JOIN visitor vr ON v.visitor_ID = vr.ID WHERE vr.Name = 'Fernando Gago' AND m.Open_Year > '2010';",
    "table_names": [
      "museum",
      "visitor",
      "visit"
    ]
  },
  {
    "id": 229,
    "db_id": "icfp_1",
    "question": "What is the country of the institution associated with the author who has the third authorship order of the paper 'Binders Unbound'?",
    "sql": "SELECT Inst.country FROM Inst JOIN Authorship ON Inst.instID = Authorship.instID JOIN Papers ON Authorship.paperID = Papers.paperID WHERE Papers.title = 'Binders Unbound' AND Authorship.authOrder = 3;",
    "table_names": [
      "Inst",
      "Papers",
      "Authorship"
    ]
  },
  {
    "id": 607,
    "db_id": "customers_and_addresses",
    "question": "Which customer has the most cancelled orders and how many times have they cancelled their orders?",
    "sql": "SELECT C.customer_name, COUNT(O.order_id) AS total_cancelled_orders FROM Customers C INNER JOIN Customer_Orders O ON C.customer_id = O.customer_id WHERE O.order_status = 'Cancelled' GROUP BY C.customer_id ORDER BY total_cancelled_orders DESC LIMIT 1",
    "table_names": [
      "Products",
      "Customers",
      "Customer_Orders",
      "Order_Items"
    ]
  },
  {
    "id": 27,
    "db_id": "allergy_1",
    "question": "How many unique students from the city PIT have food-related allergies?",
    "sql": "SELECT COUNT(DISTINCT HA.StuID) FROM Has_Allergy HA JOIN Allergy_Type AT ON HA.Allergy = AT.Allergy JOIN Student S ON HA.StuID = S.StuID WHERE AT.AllergyType = 'food' AND S.city_code = 'PIT';",
    "table_names": [
      "Allergy_Type",
      "Has_Allergy",
      "Student"
    ]
  },
  {
    "id": 651,
    "db_id": "tracking_orders",
    "question": "Which customer has the highest number of orders currently 'On Road'?",
    "sql": "SELECT Customers.customer_name, COUNT(Orders.order_id) AS order_count FROM Customers INNER JOIN Orders ON Customers.customer_id = Orders.customer_id WHERE Orders.order_status = 'On Road' GROUP BY Customers.customer_name ORDER BY order_count DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Orders",
      "Products",
      "Order_Items"
    ]
  },
  {
    "id": 550,
    "db_id": "dorm_1",
    "question": "Identify the names of students older than 20 who are residing in the dorm named 'Fawlty Towers'.",
    "sql": "SELECT s.LName, s.Fname FROM Student s JOIN Lives_in l ON s.StuID = l.stuid JOIN Dorm d ON d.dormid = l.dormid WHERE s.Age > 20 AND d.dorm_name = 'Fawlty Towers';",
    "table_names": [
      "Student",
      "Dorm",
      "Lives_in"
    ]
  },
  {
    "id": 266,
    "db_id": "station_weather",
    "question": "What are the names of the trains that stop at stations in the Chiltern local authority area and have Chennai as their destination?",
    "sql": "SELECT DISTINCT train.name FROM train INNER JOIN route ON train.id = route.train_id INNER JOIN station ON route.station_id = station.id WHERE station.local_authority = 'Chiltern' AND train.destination = 'Chennai';",
    "table_names": [
      "train",
      "station",
      "route"
    ]
  },
  {
    "id": 249,
    "db_id": "icfp_1",
    "question": "Which authors contributed to papers that have more than two authors?",
    "sql": "SELECT DISTINCT a.lname, a.fname FROM Authors a JOIN Authorship au ON a.authID = au.authID JOIN Papers p ON au.paperID = p.paperID WHERE p.paperID IN (SELECT paperID FROM Authorship GROUP BY paperID HAVING COUNT(DISTINCT authID) > 2);",
    "table_names": [
      "Authors",
      "Papers",
      "Authorship"
    ]
  },
  {
    "id": 107,
    "db_id": "small_bank_1",
    "question": "Find the name of the customer who has a balance in the checking account but has no savings account.",
    "sql": "SELECT name FROM ACCOUNTS WHERE custid NOT IN (SELECT custid FROM SAVINGS) AND custid IN (SELECT custid FROM CHECKING)",
    "table_names": [
      "ACCOUNTS",
      "SAVINGS",
      "CHECKING"
    ]
  },
  {
    "id": 36,
    "db_id": "journal_committee",
    "question": "Who was the editor of the journal entry with the highest sales?",
    "sql": "SELECT e.Name FROM editor e INNER JOIN journal_committee jc ON e.Editor_ID = jc.Editor_ID INNER JOIN journal j ON jc.Journal_ID = j.Journal_ID WHERE j.Sales = (SELECT MAX(Sales) FROM journal);",
    "table_names": [
      "journal",
      "editor",
      "journal_committee"
    ]
  },
  {
    "id": 40,
    "db_id": "insurance_fnol",
    "question": "What is the earliest date Jay Chou opened a Mortgage Insurance policy?",
    "sql": "SELECT cp.Date_Opened FROM Customers c JOIN Customers_Policies cp ON c.Customer_ID = cp.Customer_ID JOIN Available_Policies ap ON cp.Policy_ID = ap.Policy_ID WHERE c.Customer_name = 'Jay Chou' AND ap.policy_type_code = 'Mortgage Insurance' ORDER BY cp.Date_Opened LIMIT 1;",
    "table_names": [
      "Customers",
      "Available_Policies",
      "Customers_Policies"
    ]
  },
  {
    "id": 465,
    "db_id": "customers_and_addresses",
    "question": "What is the total revenue generated by the products categorized as 'Hardware' sold through orders that are 'Completed' or 'PartFilled'?",
    "sql": "SELECT SUM(p.product_price) FROM Products p JOIN Order_Items oi ON p.product_id = oi.product_id JOIN Customer_Orders co ON oi.order_id = co.order_id WHERE p.product_type_code = 'Hardware' AND co.order_status_code IN ('Completed', 'PartFilled');",
    "table_names": [
      "Products",
      "Customer_Orders",
      "Order_Items"
    ]
  },
  {
    "id": 637,
    "db_id": "activity_1",
    "question": "How many professors participate in either Mountain Climbing or Canoeing activities?",
    "sql": "SELECT COUNT(DISTINCT fp.FacID) FROM Faculty_Participates_in fp JOIN Faculty f ON fp.FacID = f.FacID JOIN Activity a ON fp.actid = a.actid WHERE a.activity_name IN ('Mountain Climbing', 'Canoeing') AND f.Rank = 'Professor';",
    "table_names": [
      "Activity",
      "Faculty_Participates_in",
      "Faculty"
    ]
  },
  {
    "id": 101,
    "db_id": "small_bank_1",
    "question": "Which customers have at least $100,000 in their savings account and at least $5,000 in their checking account?",
    "sql": "SELECT A.name FROM ACCOUNTS A JOIN SAVINGS S ON A.custid = S.custid JOIN CHECKING C ON A.custid = C.custid WHERE S.balance >= 100000 AND C.balance >= 5000;",
    "table_names": [
      "ACCOUNTS",
      "SAVINGS",
      "CHECKING"
    ]
  },
  {
    "id": 591,
    "db_id": "customers_and_addresses",
    "question": "What is the state of the residential address for Kitty Padberg III?",
    "sql": "SELECT Addresses.state_province_county FROM Addresses INNER JOIN Customer_Addresses ON Addresses.address_id = Customer_Addresses.address_id INNER JOIN Customers ON Customer_Addresses.customer_id = Customers.customer_id WHERE Customers.customer_name = 'Kitty Padberg III' AND Customer_Addresses.address_type = 'Residential';",
    "table_names": [
      "Addresses",
      "Customers",
      "Customer_Addresses"
    ]
  },
  {
    "id": 39,
    "db_id": "chinook_1",
    "question": "Find the titles of albums that contain tracks of both the Reggae and Rock genres.",
    "sql": "SELECT T1.Title FROM Album AS T1 JOIN Track AS T2 ON T1.AlbumId  =  T2.AlbumId JOIN Genre AS T3 ON T2.GenreID  =  T3.GenreID WHERE T3.Name  =  'Reggae' INTERSECT SELECT T1.Title FROM Album AS T1 JOIN Track AS T2 ON T1.AlbumId  =  T2.AlbumId JOIN Genre AS T3 ON T2.GenreID  =  T3.GenreID WHERE T3.Name  =  'Rock'",
    "table_names": [
      "Album",
      "Genre",
      "Track"
    ]
  },
  {
    "id": 116,
    "db_id": "small_bank_1",
    "question": "Which customers have a balance of less than 5000 in their checking account and more than 100000 in their savings account?",
    "sql": "SELECT A.name FROM ACCOUNTS AS A JOIN CHECKING AS C ON A.custid = C.custid JOIN SAVINGS AS S ON A.custid = S.custid WHERE C.balance < 5000 AND S.balance > 100000;",
    "table_names": [
      "ACCOUNTS",
      "SAVINGS",
      "CHECKING"
    ]
  },
  {
    "id": 168,
    "db_id": "csu_1",
    "question": "Which campus had the highest degree-to-faculty ratio in the year 2004, and what were the total degrees awarded and the number of faculty then?",
    "sql": "SELECT c.Campus, f.Faculty, d.Degrees FROM Campuses c JOIN faculty f ON c.Id = f.Campus JOIN degrees d ON c.Id = d.Campus AND f.Year = d.Year WHERE f.Year = 2004 ORDER BY (d.Degrees/f.Faculty) DESC LIMIT 1;",
    "table_names": [
      "Campuses",
      "degrees",
      "faculty"
    ]
  },
  {
    "id": 256,
    "db_id": "loan_1",
    "question": "What is the total loan amount for customers having a credit score greater than 25 who hold savings account and belong to a bank branch in New York City?",
    "sql": "SELECT SUM(l.amount) FROM loan l JOIN customer c ON l.cust_ID = c.cust_ID JOIN bank b ON c.branch_ID = b.branch_ID WHERE c.credit_score > 25 AND c.acc_type = 'saving' AND b.city = 'New York City';",
    "table_names": [
      "bank",
      "customer",
      "loan"
    ]
  },
  {
    "id": 278,
    "db_id": "college_1",
    "question": "How many classes are offered by the Computer Info. Systems department with a course credit of 3.0?",
    "sql": "SELECT COUNT(*) FROM CLASS INNER JOIN COURSE ON CLASS.CRS_CODE = COURSE.CRS_CODE INNER JOIN DEPARTMENT ON COURSE.DEPT_CODE = DEPARTMENT.DEPT_CODE WHERE DEPARTMENT.DEPT_NAME = 'Computer Info. Systems' AND COURSE.CRS_CREDIT = 3.0;",
    "table_names": [
      "CLASS",
      "COURSE",
      "DEPARTMENT",
      "ENROLL"
    ]
  },
  {
    "id": 310,
    "db_id": "college_1",
    "question": "What are the names and highest degrees of professors working in departments within the School of Business ('BUS') who do not have a Ph.D.?",
    "sql": "SELECT E.EMP_FNAME, E.EMP_LNAME, P.PROF_HIGH_DEGREE FROM EMPLOYEE E JOIN PROFESSOR P ON E.EMP_NUM = P.EMP_NUM JOIN DEPARTMENT D ON P.DEPT_CODE = D.DEPT_CODE WHERE D.SCHOOL_CODE = 'BUS' AND P.PROF_HIGH_DEGREE != 'Ph.D.';",
    "table_names": [
      "DEPARTMENT",
      "EMPLOYEE",
      "PROFESSOR"
    ]
  },
  {
    "id": 25,
    "db_id": "allergy_1",
    "question": "Find the first and last names of students who have both animal and food allergies.",
    "sql": "SELECT DISTINCT S.Fname, S.LName FROM Student S JOIN Has_Allergy HA ON S.StuID = HA.StuID JOIN Allergy_Type AT ON HA.Allergy = AT.Allergy WHERE AT.AllergyType = 'animal' AND HA.StuID IN (SELECT StuID FROM Has_Allergy HA2 JOIN Allergy_Type AT2 ON HA2.Allergy = AT2.Allergy WHERE AT2.AllergyType = 'food');",
    "table_names": [
      "Allergy_Type",
      "Has_Allergy",
      "Student"
    ]
  },
  {
    "id": 126,
    "db_id": "browser_web",
    "question": "What web client accelerators compatible with the Opera browser since 2000 or earlier support a Dial-up connection?",
    "sql": "SELECT wc.name FROM Web_client_accelerator wc JOIN accelerator_compatible_browser acb ON wc.id = acb.accelerator_id JOIN browser b ON acb.browser_id = b.id WHERE acb.compatible_since_year <= 2000 AND b.name = 'Opera' AND wc.Connection LIKE '%Dial-up%';",
    "table_names": [
      "Web_client_accelerator",
      "browser",
      "accelerator_compatible_browser"
    ]
  },
  {
    "id": 689,
    "db_id": "car_1",
    "question": "How many distinct car makers from European countries have at least one car model listed?",
    "sql": "SELECT COUNT(DISTINCT cm.Maker) FROM car_makers cm JOIN countries c ON cm.Country = c.CountryId JOIN model_list ml ON ml.Maker = cm.Id WHERE c.Continent = 2;",
    "table_names": [
      "countries",
      "car_makers",
      "model_list"
    ]
  }
]