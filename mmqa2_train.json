[
  {
    "id": 71,
    "db_id": "bike_1",
    "question": "What are the id and name of the stations that have ever had more than 12 bikes available?",
    "sql": "SELECT DISTINCT T1.id ,  T1.name FROM station AS T1 JOIN status AS T2 ON T1.id  =  T2.station_id WHERE T2.bikes_available  >  12",
    "table_names": [
      "station",
      "status"
    ]
  },
  {
    "id": 839,
    "db_id": "movie_1",
    "question": "Which reviewers gave multiple ratings between January 10, 2011 and January 25, 2011, and what was their average star rating during this period?",
    "sql": "SELECT Reviewer.name, AVG(Rating.stars) AS AvgRating FROM Reviewer JOIN Rating ON Reviewer.rID = Rating.rID WHERE Rating.ratingDate BETWEEN '2011-01-10' AND '2011-01-25' GROUP BY Reviewer.name HAVING COUNT(Rating.stars) > 1;",
    "table_names": [
      "Reviewer",
      "Rating"
    ]
  },
  {
    "id": 2542,
    "db_id": "dog_kennels",
    "question": "What are the names of male bulldogs who have received vaccinations?",
    "sql": "SELECT D.name FROM Dogs D JOIN Treatments T ON D.dog_id = T.dog_id WHERE T.treatment_type_code = 'VAC' AND D.breed_code = 'BUL' AND D.gender = '0';",
    "table_names": [
      "Dogs",
      "Treatments"
    ]
  },
  {
    "id": 531,
    "db_id": "tracking_orders",
    "question": "Which customers from Mississippi made orders, and how many orders has each placed?",
    "sql": "SELECT Customers.customer_first_name, Customers.customer_last_name, Customers.email_address, COUNT(Orders.order_id) AS total_orders FROM Customers JOIN Orders ON Customers.customer_id = Orders.customer_id WHERE Customers.state_county_province = 'Mississippi' GROUP BY Customers.customer_id, Customers.customer_first_name, Customers.customer_last_name, Customers.email_address;",
    "table_names": [
      "Customers",
      "Orders"
    ]
  },
  {
    "id": 1674,
    "db_id": "manufactory_1",
    "question": "What is the average price of products made by manufacturers whose revenue exceeds 100 million?",
    "sql": "SELECT AVG(Products.Price) FROM Products INNER JOIN Manufacturers ON Products.Manufacturer = Manufacturers.Code WHERE Manufacturers.Revenue > 100;",
    "table_names": [
      "Manufacturers",
      "Products"
    ]
  },
  {
    "id": 2165,
    "db_id": "flight_4",
    "question": "Find the number of routes and airport name for each source airport, order the results by decreasing number of routes.",
    "sql": "SELECT count(*) ,  T1.name FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.src_apid GROUP BY T1.name ORDER BY count(*) DESC",
    "table_names": [
      "routes",
      "airports"
    ]
  },
  {
    "id": 1227,
    "db_id": "mountain_photos",
    "question": "How many distinct RGB photos were taken with Sigma branded camera lenses?",
    "sql": "SELECT COUNT(DISTINCT p.id) FROM photos p JOIN camera_lens cl ON p.camera_lens_id = cl.id WHERE cl.brand = 'Sigma' AND p.color = 'RBG';",
    "table_names": [
      "camera_lens",
      "photos"
    ]
  },
  {
    "id": 1525,
    "db_id": "department_store",
    "question": "Which department store chain has the highest number of stores listed in the database, and how many stores does it have?",
    "sql": "SELECT dsc.dept_store_chain_name, COUNT(ds.dept_store_id) AS number_of_stores FROM Department_Store_Chain dsc JOIN Department_Stores ds ON dsc.dept_store_chain_id = ds.dept_store_chain_id GROUP BY dsc.dept_store_chain_name ORDER BY number_of_stores DESC LIMIT 1;",
    "table_names": [
      "Department_Store_Chain",
      "Department_Stores"
    ]
  },
  {
    "id": 781,
    "db_id": "csu_1",
    "question": "How many undergraduates are there in \"San Jose State University\" in year 2004?",
    "sql": "SELECT sum(t1.undergraduate) FROM discipline_enrollments AS t1 JOIN campuses AS t2 ON t1.campus  =  t2.id WHERE t1.year  =  2004 AND t2.campus  =  \"San Jose State University\"",
    "table_names": [
      "Campuses",
      "discipline_enrollments"
    ]
  },
  {
    "id": 1883,
    "db_id": "game_1",
    "question": "Show all male student ids who don't play football.",
    "sql": "SELECT StuID FROM Student WHERE sex  =  'M' EXCEPT SELECT StuID FROM Sportsinfo WHERE sportname  =  \"Football\"",
    "table_names": [
      "Student",
      "SportsInfo"
    ]
  },
  {
    "id": 9,
    "db_id": "farm",
    "question": "What is the official name of the city that hosted the farm competition themed 'MTV Cube' in 2003?",
    "sql": "SELECT city.Official_Name FROM city JOIN farm_competition ON city.City_ID = farm_competition.Host_city_ID WHERE farm_competition.Year = 2003;",
    "table_names": [
      "city",
      "farm_competition"
    ]
  },
  {
    "id": 2569,
    "db_id": "dog_kennels",
    "question": "How many dogs of breed 'HUS' have owners residing in the state of NorthDakota?",
    "sql": "SELECT COUNT(*) FROM Dogs d JOIN Owners o ON d.owner_id = o.owner_id WHERE o.state = 'NorthDakota' AND d.breed_code = 'HUS';",
    "table_names": [
      "Owners",
      "Dogs"
    ]
  },
  {
    "id": 927,
    "db_id": "election",
    "question": "Who was the delegate representing district 3, and who was the Attorney General candidate for the delegate's party in the 2006 election?",
    "sql": "SELECT e.Delegate, p.Attorney_General FROM election e JOIN party p ON e.Party = p.Party_ID WHERE e.District = 3 AND p.Year = 2006;",
    "table_names": [
      "party",
      "election"
    ]
  },
  {
    "id": 809,
    "db_id": "movie_1",
    "question": "Who is the director after 1980 whose movies received the most ratings in total?",
    "sql": "SELECT Movie.director, COUNT(Rating.stars) AS total_ratings FROM Movie JOIN Rating ON Movie.mID = Rating.mID WHERE Movie.year > 1980 GROUP BY Movie.director ORDER BY total_ratings DESC LIMIT 1;",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 2379,
    "db_id": "wta_1",
    "question": "What are the first names of all players, and their total ranking points?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "players",
      "rankings"
    ]
  },
  {
    "id": 1966,
    "db_id": "city_record",
    "question": "Which cities have a GDP greater than 500 billion and a temperature higher than 28.5 degrees Celsius in July?",
    "sql": "SELECT city.City FROM city JOIN temperature ON city.City_ID = temperature.City_ID WHERE city.GDP > 500 AND temperature.Jul > 28.5;",
    "table_names": [
      "city",
      "temperature"
    ]
  },
  {
    "id": 2208,
    "db_id": "tracking_orders",
    "question": "How many unique products have a 'Payed' status in order items belonging to orders with 'On Road' status?",
    "sql": "SELECT COUNT(DISTINCT oi.product_id) FROM Orders o JOIN Order_Items oi ON o.order_id = oi.order_id WHERE o.order_status = 'On Road' AND oi.order_item_status = 'Payed';",
    "table_names": [
      "Orders",
      "Order_Items"
    ]
  },
  {
    "id": 2079,
    "db_id": "driving_school",
    "question": "Which staff members who lived in Connecticut left the staff on or after March 1st, 2018?",
    "sql": "SELECT Staff.first_name, Staff.last_name FROM Staff INNER JOIN Addresses ON Staff.staff_address_id = Addresses.address_id WHERE Addresses.state_province_county = 'Connecticut' AND Staff.date_left_staff >= '2018-03-01 00:00:00';",
    "table_names": [
      "Addresses",
      "Staff"
    ]
  },
  {
    "id": 1748,
    "db_id": "voter_2",
    "question": "Find the distinct last names of all the students who have president votes and whose advisor is not 2192.",
    "sql": "SELECT DISTINCT T1.LName FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  PRESIDENT_Vote EXCEPT SELECT DISTINCT LName FROM STUDENT WHERE Advisor  =  \"2192\"",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 2097,
    "db_id": "driving_school",
    "question": "What is the full name of the staff member who has completed the highest number of lessons?",
    "sql": "SELECT S.first_name, S.middle_name, S.last_name FROM Staff S JOIN Lessons L ON S.staff_id = L.staff_id WHERE L.lesson_status_code = 'Completed' GROUP BY S.staff_id ORDER BY COUNT(L.lesson_id) DESC LIMIT 1;",
    "table_names": [
      "Staff",
      "Lessons"
    ]
  },
  {
    "id": 829,
    "db_id": "movie_1",
    "question": "Among directors who made films after 1980, which director has the highest average star rating?",
    "sql": "SELECT M.director, AVG(R.stars) AS AvgRating FROM Movie M INNER JOIN Rating R ON M.mID = R.mID WHERE M.year > 1980 GROUP BY M.director ORDER BY AvgRating DESC LIMIT 1;",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 1698,
    "db_id": "tracking_software_problems",
    "question": "What are the names of products that have been reported with problems more than twice, and how many problems were reported for each of them?",
    "sql": "SELECT p.product_name, COUNT(*) AS total_problems FROM Product p JOIN Problems pb ON p.product_id = pb.product_id GROUP BY p.product_name HAVING COUNT(*) > 2;",
    "table_names": [
      "Product",
      "Problems"
    ]
  },
  {
    "id": 136,
    "db_id": "allergy_1",
    "question": "How many students have both animal and food allergies?",
    "sql": "SELECT COUNT(DISTINCT StuID) FROM Has_Allergy WHERE Allergy IN (SELECT Allergy FROM Allergy_Type WHERE AllergyType = 'animal') AND StuID IN (SELECT StuID FROM Has_Allergy WHERE Allergy IN (SELECT Allergy FROM Allergy_Type WHERE AllergyType = 'food'));",
    "table_names": [
      "Allergy_Type",
      "Has_Allergy"
    ]
  },
  {
    "id": 610,
    "db_id": "small_bank_1",
    "question": "What is the total balance of customers in the checking account who have a name beginning with 'W'?",
    "sql": "SELECT SUM(CHECKING.balance) FROM CHECKING INNER JOIN ACCOUNTS ON CHECKING.custid = ACCOUNTS.custid WHERE ACCOUNTS.name LIKE 'W%';",
    "table_names": [
      "ACCOUNTS",
      "CHECKING"
    ]
  },
  {
    "id": 995,
    "db_id": "behavior_monitoring",
    "question": "What are the first names, last names, and email addresses of students who have assessment notes dated before the year 1980?",
    "sql": "SELECT s.first_name, s.last_name, s.email_address FROM Students AS s JOIN Assessment_Notes AS an ON s.student_id = an.student_id WHERE YEAR(an.date_of_notes) < 1980;",
    "table_names": [
      "Students",
      "Assessment_Notes"
    ]
  },
  {
    "id": 2293,
    "db_id": "car_1",
    "question": "What are the names of the countries with no car makers?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "countries",
      "car_makers"
    ]
  },
  {
    "id": 180,
    "db_id": "store_1",
    "question": "List the name of tracks belongs to genre Rock or genre Jazz.",
    "sql": "SELECT T2.name FROM genres AS T1 JOIN tracks AS T2 ON T1.id = T2.genre_id WHERE T1.name = \"Rock\" OR T1.name = \"Jazz\"",
    "table_names": [
      "genres",
      "tracks"
    ]
  },
  {
    "id": 1804,
    "db_id": "customer_complaints",
    "question": "Which product currently has the highest number of open complaints?",
    "sql": "SELECT product_name, COUNT(Complaints.complaint_id) AS Number_of_Complaints FROM Products JOIN Complaints ON Products.product_id = Complaints.product_id WHERE complaint_status_code = 'Open' GROUP BY product_name ORDER BY Number_of_Complaints DESC LIMIT 1;",
    "table_names": [
      "Products",
      "Complaints"
    ]
  },
  {
    "id": 1885,
    "db_id": "game_1",
    "question": "Show total hours per week and number of games played for student David Shieber.",
    "sql": "SELECT sum(hoursperweek) ,  sum(gamesplayed) FROM Sportsinfo AS T1 JOIN Student AS T2 ON T1.StuID  =  T2.StuID WHERE T2.Fname  =  \"David\" AND T2.Lname  =  \"Shieber\"",
    "table_names": [
      "Student",
      "SportsInfo"
    ]
  },
  {
    "id": 1095,
    "db_id": "sports_competition",
    "question": "Which players from clubs in the UK region have scored more points than the average points scored by all players?",
    "sql": "SELECT player.name FROM player JOIN club ON player.Club_ID = club.Club_ID WHERE club.Region = 'UK' AND player.Points > (SELECT AVG(Points) FROM player);",
    "table_names": [
      "club",
      "player"
    ]
  },
  {
    "id": 929,
    "db_id": "news_report",
    "question": "Which journalists with more than 10 years of experience have reported news related to music events?",
    "sql": "SELECT journalist.Name FROM journalist JOIN news_report ON journalist.journalist_ID = news_report.journalist_ID WHERE news_report.Work_Type = 'Music' AND journalist.Years_working > 10;",
    "table_names": [
      "journalist",
      "news_report"
    ]
  },
  {
    "id": 992,
    "db_id": "loan_1",
    "question": "What is the average loan amount for customers from branches located in Utah or Texas?",
    "sql": "SELECT AVG(l.amount) FROM loan l JOIN customer c ON l.cust_ID = c.cust_ID WHERE c.state IN ('Utah', 'Texas');",
    "table_names": [
      "customer",
      "loan"
    ]
  },
  {
    "id": 1772,
    "db_id": "products_gen_characteristics",
    "question": "List the names of all 'Seeds' category products that have the color 'blue' and a typical selling price greater than 1000?",
    "sql": "SELECT p.product_name FROM Products p JOIN Ref_Colors rc ON p.color_code = rc.color_code WHERE rc.color_description = 'blue' AND p.product_category_code = 'Seeds' AND CAST(p.typical_selling_price AS FLOAT) > 1000;",
    "table_names": [
      "Ref_Colors",
      "Products"
    ]
  },
  {
    "id": 1134,
    "db_id": "music_1",
    "question": "List the names of artists from India who sang Bangla songs with ratings greater than 7.",
    "sql": "SELECT artist.artist_name FROM artist JOIN song ON artist.artist_name = song.artist_name WHERE artist.country = 'India' AND song.rating > 7 AND song.languages = 'bangla';",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 2175,
    "db_id": "flight_4",
    "question": "Find the id of routes whose source and destination airports are in the United States.",
    "sql": "SELECT rid FROM routes WHERE dst_apid IN (SELECT apid FROM airports WHERE country  =  'United States') AND src_apid IN (SELECT apid FROM airports WHERE country  =  'United States')",
    "table_names": [
      "routes",
      "airports"
    ]
  },
  {
    "id": 2145,
    "db_id": "activity_1",
    "question": "What is the first and last name of the student participating in the most activities?",
    "sql": "SELECT T1.fname ,  T1.lname FROM Student AS T1 JOIN Participates_in AS T2 ON T1.StuID  =  T2.StuID GROUP BY T1.StuID ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "Participates_in",
      "Student"
    ]
  },
  {
    "id": 1389,
    "db_id": "cre_Doc_Tracking_DB",
    "question": "How many employees with the role of 'Editor' have birth dates before the year 1980?",
    "sql": "SELECT COUNT(*) FROM Employees WHERE Role_Code = (SELECT Role_Code FROM Roles WHERE Role_Name = 'Editor') AND DATE(Date_of_Birth) < '1980-01-01';",
    "table_names": [
      "Roles",
      "Employees"
    ]
  },
  {
    "id": 43,
    "db_id": "bike_1",
    "question": "Return the unique name for stations that have ever had 7 bikes available.",
    "sql": "SELECT DISTINCT T1.name FROM station AS T1 JOIN status AS T2 ON T1.id  =  T2.station_id WHERE T2.bikes_available  =  7",
    "table_names": [
      "station",
      "status"
    ]
  },
  {
    "id": 1010,
    "db_id": "student_assessment",
    "question": "What are the first names and last names of students with address in Wisconsin state?",
    "sql": "SELECT T2.first_name ,  T2.last_name FROM Addresses AS T1 JOIN Students AS T2 ON T1.address_id  =  T2.address_id WHERE T1.state_province_county  =  \"Wisconsin\"",
    "table_names": [
      "Addresses",
      "Students"
    ]
  },
  {
    "id": 1364,
    "db_id": "student_1",
    "question": "Find the name of the teacher who teaches the largest number of students.",
    "sql": "SELECT T2.firstname ,  T2.lastname FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom GROUP BY T2.firstname ,  T2.lastname ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "list",
      "teachers"
    ]
  },
  {
    "id": 2326,
    "db_id": "employee_hire_evaluation",
    "question": "Which shops have more than 5000 products and employ any part-time staff?",
    "sql": "SELECT s.Name FROM shop s JOIN hiring h ON s.Shop_ID = h.Shop_ID WHERE s.Number_products > 5000 AND h.Is_full_time = 'F';",
    "table_names": [
      "shop",
      "hiring"
    ]
  },
  {
    "id": 7,
    "db_id": "farm",
    "question": "What are the names of the cities which hosted farm competitions after 2005 and have an area larger than 5 km²?",
    "sql": "SELECT city.Official_Name FROM city JOIN farm_competition ON city.City_ID = farm_competition.Host_city_ID WHERE city.Area_km_2 > 5 AND farm_competition.Year > 2005;",
    "table_names": [
      "city",
      "farm_competition"
    ]
  },
  {
    "id": 3,
    "db_id": "department_management",
    "question": "Which department with temporary acting management has the highest budget?",
    "sql": "SELECT d.Name FROM department d JOIN management m ON d.Department_ID = m.department_ID WHERE m.temporary_acting = 'Yes' ORDER BY d.Budget_in_Billions DESC LIMIT 1;",
    "table_names": [
      "department",
      "management"
    ]
  },
  {
    "id": 288,
    "db_id": "insurance_fnol",
    "question": "Which customer has the highest number of policies?",
    "sql": "SELECT Customers.Customer_name, COUNT(Customers_Policies.Policy_ID) AS policy_count FROM Customers INNER JOIN Customers_Policies ON Customers.Customer_ID = Customers_Policies.Customer_ID GROUP BY Customers.Customer_ID ORDER BY policy_count DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Customers_Policies"
    ]
  },
  {
    "id": 630,
    "db_id": "school_finance",
    "question": "Which school has received endowments with the highest average donation amount?",
    "sql": "SELECT School_name FROM School WHERE School_id = (SELECT School_id FROM endowment GROUP BY School_id ORDER BY AVG(amount) DESC LIMIT 1)",
    "table_names": [
      "School",
      "endowment"
    ]
  },
  {
    "id": 518,
    "db_id": "customers_card_transactions",
    "question": "How many distinct Regular accounts are owned by customers residing in Mississippi?",
    "sql": "SELECT COUNT(DISTINCT a.account_id) FROM Accounts a JOIN Customers c ON a.customer_id = c.customer_id WHERE c.state_county_province = 'Mississippi' AND a.other_account_details = 'Regular';",
    "table_names": [
      "Customers",
      "Accounts"
    ]
  },
  {
    "id": 129,
    "db_id": "flight_1",
    "question": "Which employees have certifications for aircraft models capable of flying a distance greater than 6000 units?",
    "sql": "SELECT DISTINCT c.eid FROM certificate c INNER JOIN aircraft a ON c.aid = a.aid WHERE a.distance > 6000;",
    "table_names": [
      "aircraft",
      "certificate"
    ]
  },
  {
    "id": 1672,
    "db_id": "manufactory_1",
    "question": "List the names of products priced at $150 or more manufactured by companies headquartered in Austin.",
    "sql": "SELECT Products.Name FROM Products JOIN Manufacturers ON Products.Manufacturer = Manufacturers.Code WHERE Manufacturers.Headquarter = 'Austin' AND Products.Price >= 150;",
    "table_names": [
      "Manufacturers",
      "Products"
    ]
  },
  {
    "id": 2030,
    "db_id": "scientist_1",
    "question": "Which scientists are assigned to projects starting with 'Ast'?",
    "sql": "SELECT Name FROM Scientists WHERE SSN IN (SELECT Scientist FROM AssignedTo WHERE Project LIKE 'Ast%');",
    "table_names": [
      "Scientists",
      "AssignedTo"
    ]
  },
  {
    "id": 299,
    "db_id": "medicine_enzyme_interaction",
    "question": "Which enzymes located in the mitochondrion are inhibited by medicine with ID 2?",
    "sql": "SELECT enzyme.name FROM enzyme JOIN medicine_enzyme_interaction ON enzyme.id = medicine_enzyme_interaction.enzyme_id WHERE enzyme.Location = 'Mitochondrion' AND medicine_enzyme_interaction.interaction_type = 'inhibitor' AND medicine_enzyme_interaction.medicine_id = 2;",
    "table_names": [
      "enzyme",
      "medicine_enzyme_interaction"
    ]
  },
  {
    "id": 451,
    "db_id": "college_2",
    "question": "What are the names of instructors who advise more than one student?",
    "sql": "SELECT T1.name FROM instructor AS T1 JOIN advisor AS T2 ON T1.id  =  T2.i_id GROUP BY T2.i_id HAVING count(*)  >  1",
    "table_names": [
      "instructor",
      "advisor"
    ]
  },
  {
    "id": 1587,
    "db_id": "soccer_2",
    "question": "Which player without a yellow card successfully passed the tryout at ASU?",
    "sql": "SELECT Player.pName FROM Player JOIN Tryout ON Player.pID = Tryout.pID WHERE Tryout.cName = 'ASU' AND Tryout.decision = 'yes' AND Player.yCard = 'no';",
    "table_names": [
      "Player",
      "Tryout"
    ]
  },
  {
    "id": 2356,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "What is the name of the document that contains paragraphs about 'Korea' and has a document description marked as 'y'?",
    "sql": "SELECT d.Document_Name FROM Documents d JOIN Paragraphs p ON d.Document_ID = p.Document_ID WHERE p.Paragraph_Text = 'Korea' AND d.Document_Description = 'y';",
    "table_names": [
      "Documents",
      "Paragraphs"
    ]
  },
  {
    "id": 1905,
    "db_id": "customers_and_addresses",
    "question": "What are the names of customers who used 'Credit Card' as their payment method and have at least one cancelled order?",
    "sql": "SELECT DISTINCT c.customer_name FROM Customers c JOIN Customer_Orders o ON c.customer_id = o.customer_id WHERE c.payment_method = 'Credit Card' AND o.order_status = 'Cancelled';",
    "table_names": [
      "Customers",
      "Customer_Orders"
    ]
  },
  {
    "id": 1299,
    "db_id": "insurance_policies",
    "question": "What is the total amount settled for claims made under policy ID 473 that have settlements recorded with a Customer_Policy_ID greater than 500?",
    "sql": "SELECT SUM(s.Amount_Settled) FROM Claims c INNER JOIN Settlements s ON c.Claim_ID = s.Claim_ID WHERE c.Policy_ID = 473 AND s.Customer_Policy_ID > 500;",
    "table_names": [
      "Claims",
      "Settlements"
    ]
  },
  {
    "id": 908,
    "db_id": "election",
    "question": "What are the names and committees of delegates associated with the political party that nominated Jeanine Pirro as attorney general in the 2006 election?",
    "sql": "SELECT e.Delegate, e.Committee FROM election e JOIN party p ON e.Party = p.Party_ID WHERE p.Year = 2006 AND p.Attorney_General = 'Jeanine Pirro';",
    "table_names": [
      "party",
      "election"
    ]
  },
  {
    "id": 544,
    "db_id": "theme_gallery",
    "question": "What is the average ticket price of the exhibitions organized by artists from the United States who are older than 45?",
    "sql": "SELECT AVG(e.Ticket_Price) FROM exhibition e JOIN artist a ON e.Artist_ID = a.Artist_ID WHERE a.Country = 'United States' AND a.Age > 45;",
    "table_names": [
      "artist",
      "exhibition"
    ]
  },
  {
    "id": 921,
    "db_id": "election",
    "question": "Which delegates serving on the Appropriations committee belong to parties whose candidate for governor was Eliot Spitzer?",
    "sql": "SELECT DISTINCT e.Delegate FROM election e JOIN party p ON e.Party = p.Party_ID WHERE p.Governor = 'Eliot Spitzer' AND e.Committee = 'Appropriations';",
    "table_names": [
      "party",
      "election"
    ]
  },
  {
    "id": 815,
    "db_id": "movie_1",
    "question": "What is the average rating for movies directed by James Cameron?",
    "sql": "SELECT AVG(R.stars) FROM Movie M JOIN Rating R ON M.mID = R.mID WHERE M.director = 'James Cameron';",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 909,
    "db_id": "election",
    "question": "Who are the delegates first elected in 1994 belonging to the party whose governor candidate was Eliot Spitzer? Provide their names, year first elected, and committee.",
    "sql": "SELECT e.Delegate, e.First_Elected, e.Committee FROM election e INNER JOIN party p ON e.Party = p.Party_ID WHERE p.Governor = 'Eliot Spitzer' AND e.First_Elected = 1994.0",
    "table_names": [
      "party",
      "election"
    ]
  },
  {
    "id": 0,
    "db_id": "department_management",
    "question": "Which department currently headed by a temporary acting manager has the largest number of employees, and how many employees does it have?",
    "sql": "SELECT d.Name, SUM(d.Num_Employees) FROM department d JOIN management m ON d.Department_ID = m.department_ID WHERE m.temporary_acting = 'Yes' GROUP BY d.Name ORDER BY SUM(d.Num_Employees) DESC LIMIT 1;",
    "table_names": [
      "department",
      "management"
    ]
  },
  {
    "id": 977,
    "db_id": "loan_1",
    "question": "What is the total loan amount taken by customers who have a saving account and a credit score greater than 50?",
    "sql": "SELECT SUM(loan.amount) FROM customer INNER JOIN loan ON customer.cust_ID = loan.cust_ID WHERE customer.acc_type = 'saving' AND customer.credit_score > 50;",
    "table_names": [
      "customer",
      "loan"
    ]
  },
  {
    "id": 1754,
    "db_id": "products_gen_characteristics",
    "question": "What is the average typical selling price of products that are categorized as 'Seeds' and have a color described as 'blue'?",
    "sql": "SELECT AVG(p.typical_selling_price) FROM Products p JOIN Ref_Colors rc ON p.color_code = rc.color_code WHERE rc.color_description = 'blue' AND p.product_category_code = 'Seeds' AND p.typical_selling_price <> '';",
    "table_names": [
      "Ref_Colors",
      "Products"
    ]
  },
  {
    "id": 316,
    "db_id": "university_basketball",
    "question": "What is the location of the university whose basketball team is named 'Virginia Tech'?",
    "sql": "SELECT u.Location FROM basketball_match b JOIN university u ON b.School_ID = u.School_ID WHERE b.Team_Name = 'Virginia Tech';",
    "table_names": [
      "basketball_match",
      "university"
    ]
  },
  {
    "id": 1060,
    "db_id": "college_1",
    "question": "What is the name of department where has the smallest number of professors?",
    "sql": "SELECT T2.dept_name FROM professor AS T1 JOIN department AS T2 ON T1.dept_code  =  T2.dept_code GROUP BY T1.dept_code ORDER BY count(*) LIMIT 1",
    "table_names": [
      "DEPARTMENT",
      "PROFESSOR"
    ]
  },
  {
    "id": 2328,
    "db_id": "employee_hire_evaluation",
    "question": "Which shops have part-time employees and more than 10,000 products?",
    "sql": "SELECT s.Name FROM shop s INNER JOIN hiring h ON s.Shop_ID = h.Shop_ID WHERE h.Is_full_time = 'F' AND s.Number_products > 10000;",
    "table_names": [
      "shop",
      "hiring"
    ]
  },
  {
    "id": 1271,
    "db_id": "e_learning",
    "question": "Return the completion date for all the tests that have \"Fail\" result.",
    "sql": "SELECT T1.date_of_completion FROM Student_Course_Enrolment AS T1 JOIN Student_Tests_Taken AS T2 ON T1.registration_id  =  T2.registration_id WHERE T2.test_result  =  \"Fail\"",
    "table_names": [
      "Student_Course_Enrolment",
      "Student_Tests_Taken"
    ]
  },
  {
    "id": 2068,
    "db_id": "driving_school",
    "question": "Which staff members lived in Georgia and left the staff between March 1, 2018 and March 15, 2018?",
    "sql": "SELECT S.first_name, S.last_name FROM Staff AS S INNER JOIN Addresses AS A ON S.staff_address_id = A.address_id WHERE A.state_province_county = 'Georgia' AND S.date_left_staff BETWEEN '2018-03-01' AND '2018-03-15';",
    "table_names": [
      "Addresses",
      "Staff"
    ]
  },
  {
    "id": 235,
    "db_id": "chinook_1",
    "question": "Which artist has the greatest number of albums listed, and how many albums do they have?",
    "sql": "SELECT Artist.Name, COUNT(Album.AlbumId) as NumAlbums FROM Artist JOIN Album ON Artist.ArtistId = Album.ArtistId GROUP BY Artist.ArtistId ORDER BY NumAlbums DESC LIMIT 1;",
    "table_names": [
      "Album",
      "Artist"
    ]
  },
  {
    "id": 1624,
    "db_id": "device",
    "question": "Which shops opened before 2010 have more than 100 units of device ID 4 in stock, and where are they located?",
    "sql": "SELECT shop.Shop_Name, shop.Location FROM shop JOIN stock ON shop.Shop_ID = stock.Shop_ID WHERE stock.Device_ID = 4 AND stock.Quantity > 100 AND shop.Open_Year < 2010;",
    "table_names": [
      "shop",
      "stock"
    ]
  },
  {
    "id": 1285,
    "db_id": "e_learning",
    "question": "Count the number of students who did not enroll in any course.",
    "sql": "SELECT count(*) FROM Students WHERE student_id NOT IN (SELECT student_id FROM Student_Course_Enrolment)",
    "table_names": [
      "Students",
      "Student_Course_Enrolment"
    ]
  },
  {
    "id": 1371,
    "db_id": "film_rank",
    "question": "Which country's market had the highest total low estimation of films related to mass suicide or murder from 1940 to 2000?",
    "sql": "SELECT m.Country, SUM(f.Low_Estimate) AS Total_Low_Estimate FROM film_market_estimation f JOIN market m ON f.Market_ID = m.Market_ID WHERE f.Year >= 1940 AND f.Year <= 2000 GROUP BY m.Country ORDER BY Total_Low_Estimate DESC LIMIT 1;",
    "table_names": [
      "market",
      "film_market_estimation"
    ]
  },
  {
    "id": 1452,
    "db_id": "network_2",
    "question": "What are the distinct jobs held by the friends of people living in New York City?",
    "sql": "SELECT DISTINCT p1.job FROM Person p1 JOIN PersonFriend pf ON p1.name = pf.friend JOIN Person p2 ON pf.name = p2.name WHERE p2.city = 'new york city';",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 769,
    "db_id": "csu_1",
    "question": "Find the names of the campus which has more faculties in 2002 than every campus in Orange county.",
    "sql": "SELECT T1.campus FROM campuses AS T1 JOIN faculty AS T2 ON T1.id  =  T2.campus WHERE T2.year  =  2002 AND faculty  >  (SELECT max(faculty) FROM campuses AS T1 JOIN faculty AS T2 ON T1.id  =  T2.campus WHERE T2.year  =  2002 AND T1.county  =  \"Orange\")",
    "table_names": [
      "Campuses",
      "faculty"
    ]
  },
  {
    "id": 1951,
    "db_id": "ship_1",
    "question": "What are the names of ships built in 1997 and their respective captains who are younger than 45 years old?",
    "sql": "SELECT Ship.Name, captain.Name FROM captain JOIN Ship ON captain.Ship_ID = Ship.Ship_ID WHERE captain.age < '45' AND Ship.Built_Year = 1997.0;",
    "table_names": [
      "captain",
      "Ship"
    ]
  },
  {
    "id": 575,
    "db_id": "riding_club",
    "question": "What are the names of players coached by Jean Luc Bouché starting after the year 2010?",
    "sql": "SELECT p.Player_name FROM player p JOIN player_coach pc ON p.Player_ID = pc.Player_ID WHERE pc.Coach_ID = (SELECT Player_ID FROM player WHERE Player_name = 'Jean Luc Bouché') AND pc.Starting_year > 2010;",
    "table_names": [
      "player",
      "player_coach"
    ]
  },
  {
    "id": 2085,
    "db_id": "driving_school",
    "question": "What are the cities where bad customers with an outstanding amount over $7000 reside?",
    "sql": "SELECT Addresses.city FROM Addresses JOIN Customers ON Addresses.address_id = Customers.customer_address_id WHERE Customers.customer_status_code = 'Bad Customer' AND Customers.amount_outstanding > 7000;",
    "table_names": [
      "Addresses",
      "Customers"
    ]
  },
  {
    "id": 567,
    "db_id": "epinions_1",
    "question": "What is the average rating given by user named Mark?",
    "sql": "SELECT AVG(rating) FROM review WHERE u_id = (SELECT u_id FROM useracct WHERE name = 'Mark');",
    "table_names": [
      "review",
      "useracct"
    ]
  },
  {
    "id": 1282,
    "db_id": "e_learning",
    "question": "Find the personal names of students not enrolled in any course.",
    "sql": "SELECT personal_name FROM Students EXCEPT SELECT T1.personal_name FROM Students AS T1 JOIN Student_Course_Enrolment AS T2 ON T1.student_id  =  T2.student_id",
    "table_names": [
      "Students",
      "Student_Course_Enrolment"
    ]
  },
  {
    "id": 941,
    "db_id": "sakila_1",
    "question": "Which film is rented at a fee of 0.99 and has less than 3 in the inventory? List the film title and id.",
    "sql": "SELECT title ,  film_id FROM film WHERE rental_rate  =  0.99 INTERSECT SELECT T1.title ,  T1.film_id FROM film AS T1 JOIN inventory AS T2 ON T1.film_id  =  T2.film_id GROUP BY T1.film_id HAVING count(*)  <  3",
    "table_names": [
      "film",
      "inventory"
    ]
  },
  {
    "id": 2214,
    "db_id": "tracking_orders",
    "question": "What is the name of the customer who placed the earliest order among all orders with status 'Shipped'?",
    "sql": "SELECT customer_name FROM Customers WHERE customer_id = (SELECT customer_id FROM Orders WHERE order_status = 'Shipped' ORDER BY date_order_placed ASC LIMIT 1)",
    "table_names": [
      "Customers",
      "Orders"
    ]
  },
  {
    "id": 2000,
    "db_id": "cre_Docs_and_Epenses",
    "question": "How many documents of type rated either 'excellent' or 'very good' were created in the period from 1980 to 2000 inclusive?",
    "sql": "SELECT COUNT(*) FROM Documents d JOIN Ref_Document_Types r ON d.Document_Type_Code = r.Document_Type_Code WHERE r.Document_Type_Description IN ('excellent', 'very good') AND d.Document_Date BETWEEN '1980-01-01' AND '2000-12-31';",
    "table_names": [
      "Ref_Document_Types",
      "Documents"
    ]
  },
  {
    "id": 2404,
    "db_id": "student_transcripts_tracking",
    "question": "How many distinct students enrolled in semesters taking place in spring semesters described as 'x'?",
    "sql": "SELECT COUNT(DISTINCT se.student_id) FROM Student_Enrolment se JOIN Semesters s ON se.semester_id = s.semester_id WHERE s.semester_name LIKE '%spring%' AND s.semester_description = 'x';",
    "table_names": [
      "Semesters",
      "Student_Enrolment"
    ]
  },
  {
    "id": 1984,
    "db_id": "school_bus",
    "question": "What is the average age of drivers who have worked more than 5 years and are employed full-time?",
    "sql": "SELECT AVG(d.Age) FROM driver d JOIN school_bus s ON d.Driver_ID = s.Driver_ID WHERE s.Years_Working > 5 AND s.If_full_time = 'T';",
    "table_names": [
      "driver",
      "school_bus"
    ]
  },
  {
    "id": 948,
    "db_id": "sakila_1",
    "question": "What are the title, id, and description of the movie with the greatest number of actors?",
    "sql": "SELECT T2.title ,  T2.film_id ,  T2.description FROM film_actor AS T1 JOIN film AS T2 ON T1.film_id  =  T2.film_id GROUP BY T2.film_id ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "film",
      "film_actor"
    ]
  },
  {
    "id": 2523,
    "db_id": "network_1",
    "question": "What are the ids of students who both have friends and are liked?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Friend",
      "Likes"
    ]
  },
  {
    "id": 556,
    "db_id": "epinions_1",
    "question": "What is the title of the item that has the highest-ranked review?",
    "sql": "SELECT title FROM item WHERE i_id = (SELECT i_id FROM review WHERE rank = (SELECT MIN(rank) FROM review));",
    "table_names": [
      "item",
      "review"
    ]
  },
  {
    "id": 34,
    "db_id": "student_assessment",
    "question": "How many distinct students registered for courses before November 6, 2008, and attended those same courses after January 1, 2012?",
    "sql": "SELECT COUNT(DISTINCT r.student_id) FROM Student_Course_Registrations r JOIN Student_Course_Attendance a ON r.student_id = a.student_id AND r.course_id = a.course_id WHERE r.registration_date < '2008-11-06' AND a.date_of_attendance > '2012-01-01';",
    "table_names": [
      "Student_Course_Registrations",
      "Student_Course_Attendance"
    ]
  },
  {
    "id": 801,
    "db_id": "movie_1",
    "question": "Who gave a movie the highest rating on a known date and what was the name of this reviewer?",
    "sql": "SELECT Reviewer.name FROM Reviewer INNER JOIN Rating ON Reviewer.rID = Rating.rID WHERE Rating.stars = (SELECT MAX(stars) FROM Rating WHERE ratingDate IS NOT NULL) AND Rating.ratingDate IS NOT NULL;",
    "table_names": [
      "Reviewer",
      "Rating"
    ]
  },
  {
    "id": 1684,
    "db_id": "tracking_software_problems",
    "question": "Who is the staff member that has the most 'GUI' category problems with status 'Reported', and how many such problems do they have?",
    "sql": "SELECT s.staff_first_name, s.staff_last_name, COUNT(pl.problem_log_id) AS total_reported_gui_problems FROM Problem_Log pl JOIN Staff s ON pl.assigned_to_staff_id = s.staff_id WHERE pl.problem_category_code = 'GUI' AND pl.problem_status_code = 'Reported' GROUP BY s.staff_id ORDER BY total_reported_gui_problems DESC LIMIT 1;",
    "table_names": [
      "Problem_Log",
      "Staff"
    ]
  },
  {
    "id": 17,
    "db_id": "student_assessment",
    "question": "List the names of students who attended course 301 but did not attend course 302.",
    "sql": "SELECT student_details FROM Students WHERE student_id IN (SELECT student_id FROM Student_Course_Attendance WHERE course_id = 301) AND student_id NOT IN (SELECT student_id FROM Student_Course_Attendance WHERE course_id = 302);",
    "table_names": [
      "Students",
      "Student_Course_Attendance"
    ]
  },
  {
    "id": 1148,
    "db_id": "music_1",
    "question": "Which female artist from Bangladesh has songs rated higher than 6?",
    "sql": "SELECT artist.artist_name FROM artist JOIN song ON artist.artist_name = song.artist_name WHERE artist.gender = 'Female' AND artist.country = 'Bangladesh' AND song.rating > 6;",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1397,
    "db_id": "cre_Doc_Tracking_DB",
    "question": "Which employees authorized the destruction of documents that were destroyed before their planned destruction dates?",
    "sql": "SELECT e.Employee_Name FROM Employees e INNER JOIN Documents_to_be_Destroyed d ON e.Employee_ID = d.Destruction_Authorised_by_Employee_ID WHERE d.Actual_Destruction_Date < d.Planned_Destruction_Date",
    "table_names": [
      "Employees",
      "Documents_to_be_Destroyed"
    ]
  },
  {
    "id": 614,
    "db_id": "small_bank_1",
    "question": "Which customer has the highest savings balance?",
    "sql": "SELECT name FROM ACCOUNTS WHERE custid = (SELECT custid FROM SAVINGS ORDER BY balance DESC LIMIT 1);",
    "table_names": [
      "ACCOUNTS",
      "SAVINGS"
    ]
  },
  {
    "id": 2185,
    "db_id": "tracking_orders",
    "question": "What is the name of the customer who placed the earliest order currently with status 'On Road'?",
    "sql": "SELECT customer_name FROM Customers WHERE customer_id = (SELECT customer_id FROM Orders WHERE order_status = 'On Road' ORDER BY date_order_placed ASC LIMIT 1)",
    "table_names": [
      "Customers",
      "Orders"
    ]
  },
  {
    "id": 741,
    "db_id": "entrepreneur",
    "question": "Which entrepreneur with a height greater than 1.85 meters requested the highest amount of investment, and what was the name of their company and amount requested?",
    "sql": "SELECT p.Name, e.Company, e.Money_Requested FROM entrepreneur e INNER JOIN people p ON e.People_ID = p.People_ID WHERE p.Height > 1.85 ORDER BY e.Money_Requested DESC LIMIT 1;",
    "table_names": [
      "entrepreneur",
      "people"
    ]
  },
  {
    "id": 36,
    "db_id": "student_assessment",
    "question": "How many students registered before November 8, 2008, have attended their courses during or after the year 2012?",
    "sql": "SELECT COUNT(DISTINCT SCR.student_id) FROM Student_Course_Registrations AS SCR INNER JOIN Student_Course_Attendance AS SCA ON SCR.student_id = SCA.student_id AND SCR.course_id = SCA.course_id WHERE SCR.registration_date < '2008-11-08' AND SCA.date_of_attendance >= '2012-01-01';",
    "table_names": [
      "Student_Course_Registrations",
      "Student_Course_Attendance"
    ]
  },
  {
    "id": 174,
    "db_id": "store_1",
    "question": "What is title of album which track Balls to the Wall belongs to?",
    "sql": "SELECT T1.title FROM albums AS T1 JOIN tracks AS T2 ON T1.id = T2.genre_id WHERE T2.name = \"Balls to the Wall\";",
    "table_names": [
      "albums",
      "tracks"
    ]
  },
  {
    "id": 420,
    "db_id": "apartment_rentals",
    "question": "List apartment numbers of apartments having 3 bathrooms where the booking status is recorded as provisional.",
    "sql": "SELECT A.apt_number FROM Apartments A JOIN Apartment_Bookings B ON A.apt_id = B.apt_id WHERE A.bathroom_count = 3 AND B.booking_status_code = 'Provisional';",
    "table_names": [
      "Apartments",
      "Apartment_Bookings"
    ]
  },
  {
    "id": 1866,
    "db_id": "cre_Theme_park",
    "question": "What are the names and ids of the tourist attractions that are visited at most once?",
    "sql": "SELECT T1.Name ,  T1.Tourist_Attraction_ID FROM Tourist_Attractions AS T1 JOIN VISITS AS T2 ON T1.Tourist_Attraction_ID  =  T2.Tourist_Attraction_ID GROUP BY T2.Tourist_Attraction_ID HAVING count(*)  <=  1",
    "table_names": [
      "Tourist_Attractions",
      "Visits"
    ]
  },
  {
    "id": 506,
    "db_id": "customers_card_transactions",
    "question": "Which customer holds the highest number of VIP accounts?",
    "sql": "SELECT Customers.customer_first_name, Customers.customer_last_name, COUNT(Accounts.account_id) AS num_accounts FROM Customers JOIN Accounts ON Customers.customer_id = Accounts.customer_id WHERE Accounts.other_account_details='VIP' GROUP BY Customers.customer_id ORDER BY num_accounts DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Accounts"
    ]
  },
  {
    "id": 963,
    "db_id": "sakila_1",
    "question": "What are the first names of customers who have not rented any films after '2005-08-23 02:06:01'?",
    "sql": "SELECT first_name FROM customer WHERE customer_id NOT IN( SELECT customer_id FROM rental WHERE rental_date  >  '2005-08-23 02:06:01' )",
    "table_names": [
      "customer",
      "rental"
    ]
  },
  {
    "id": 924,
    "db_id": "election",
    "question": "Which delegates and their respective committees belong to the political parties that had Eliot Spitzer as nominee for Governor in the year 2006?",
    "sql": "SELECT e.Delegate, e.Committee FROM election e JOIN party p ON e.Party = p.Party_ID WHERE p.Governor = 'Eliot Spitzer' AND p.Year = 2006.0;",
    "table_names": [
      "party",
      "election"
    ]
  },
  {
    "id": 2203,
    "db_id": "tracking_orders",
    "question": "How many distinct customers currently have orders with status 'On Road' that were shipped before the year 2000?",
    "sql": "SELECT COUNT(DISTINCT Orders.customer_id) FROM Orders INNER JOIN Shipments ON Orders.order_id = Shipments.order_id WHERE Orders.order_status = 'On Road' AND Shipments.shipment_date < '2000-01-01';",
    "table_names": [
      "Orders",
      "Shipments"
    ]
  },
  {
    "id": 221,
    "db_id": "race_track",
    "question": "Which is the oldest track to host a race exclusively with GT cars?",
    "sql": "SELECT track.Name FROM track JOIN race ON track.Track_ID = race.Track_ID WHERE race.Class = 'GT' ORDER BY track.Year_Opened ASC LIMIT 1;",
    "table_names": [
      "race",
      "track"
    ]
  },
  {
    "id": 1991,
    "db_id": "flight_company",
    "question": "List all companies incorporated in Hong Kong that had flights piloted by Peterson.",
    "sql": "SELECT oc.name FROM operate_company oc JOIN flight f ON oc.id = f.company_id WHERE f.Pilot = 'Peterson' AND oc.Incorporated_in = 'Hong Kong';",
    "table_names": [
      "operate_company",
      "flight"
    ]
  },
  {
    "id": 1894,
    "db_id": "game_1",
    "question": "What is the name of the game that student ID 1032 has spent the most time playing?",
    "sql": "SELECT VG.GName FROM Video_Games VG JOIN Plays_Games PG ON VG.GameID = PG.GameID WHERE PG.StuID = 1032 AND PG.Hours_Played = (SELECT MAX(Hours_Played) FROM Plays_Games WHERE StuID = 1032);",
    "table_names": [
      "Video_Games",
      "Plays_Games"
    ]
  },
  {
    "id": 281,
    "db_id": "insurance_fnol",
    "question": "How many distinct customers have requested either 'Change a policy' or 'Upgrade a policy' services?",
    "sql": "SELECT COUNT(DISTINCT fnol.Customer_ID) FROM First_Notification_of_Loss fnol JOIN Services svc ON fnol.Service_ID = svc.Service_ID WHERE svc.Service_name IN ('Change a policy', 'Upgrade a policy');",
    "table_names": [
      "Services",
      "First_Notification_of_Loss"
    ]
  },
  {
    "id": 2286,
    "db_id": "car_1",
    "question": "How many countries has more than 2 car makers ?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "countries",
      "car_makers"
    ]
  },
  {
    "id": 88,
    "db_id": "musical",
    "question": "Which musicals that won an award featured actors older than 20 years?",
    "sql": "SELECT m.Name FROM musical m JOIN actor a ON m.Musical_ID = a.Musical_ID WHERE a.age > 20 AND m.Result = 'Won';",
    "table_names": [
      "musical",
      "actor"
    ]
  },
  {
    "id": 445,
    "db_id": "college_2",
    "question": "Count the number of courses without prerequisites.",
    "sql": "SELECT count(*) FROM course WHERE course_id NOT IN (SELECT course_id FROM prereq)",
    "table_names": [
      "course",
      "prereq"
    ]
  },
  {
    "id": 158,
    "db_id": "store_1",
    "question": "What are the titles of 'Deep Purple' albums that contain the word 'Live' in their titles?",
    "sql": "SELECT albums.title FROM albums JOIN artists ON albums.artist_id = artists.id WHERE artists.name = 'Deep Purple' AND albums.title LIKE '%Live%';",
    "table_names": [
      "artists",
      "albums"
    ]
  },
  {
    "id": 475,
    "db_id": "college_2",
    "question": "How many instructors are in the department with the highest budget, and what is their average salary?",
    "sql": "SELECT avg(T1.salary) ,  count(*) FROM instructor AS T1 JOIN department AS T2 ON T1.dept_name  =  T2.dept_name ORDER BY T2.budget DESC LIMIT 1",
    "table_names": [
      "department",
      "instructor"
    ]
  },
  {
    "id": 1638,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "What is the total price of all services categorized under 'provide filming service'?",
    "sql": "SELECT SUM(Product_Price) FROM Services WHERE Service_Type_Code IN (SELECT Service_Type_Code FROM Ref_Service_Types WHERE Parent_Service_Type_Code='1' AND Service_Type_Description='provide filming service');",
    "table_names": [
      "Ref_Service_Types",
      "Services"
    ]
  },
  {
    "id": 1080,
    "db_id": "college_1",
    "question": "What is the average GPA of students who got a grade of 'B' in any class?",
    "sql": "SELECT AVG(STU_GPA) FROM STUDENT WHERE STU_NUM IN (SELECT STU_NUM FROM ENROLL WHERE ENROLL_GRADE = 'B');",
    "table_names": [
      "ENROLL",
      "STUDENT"
    ]
  },
  {
    "id": 2005,
    "db_id": "cre_Docs_and_Epenses",
    "question": "Which project has the most documents created after the year 2000, and how many documents does it have?",
    "sql": "SELECT Projects.Project_Details, COUNT(Documents.Document_ID) FROM Projects JOIN Documents ON Projects.Project_ID = Documents.Project_ID WHERE YEAR(Documents.Document_Date) > 2000 GROUP BY Projects.Project_Details ORDER BY COUNT(Documents.Document_ID) DESC LIMIT 1;",
    "table_names": [
      "Projects",
      "Documents"
    ]
  },
  {
    "id": 1259,
    "db_id": "e_learning",
    "question": "Find the the date of enrollment of the \"Spanish\" course.",
    "sql": "SELECT T2.date_of_enrolment FROM Courses AS T1 JOIN Student_Course_Enrolment AS T2 ON T1.course_id  =  T2.course_id WHERE T1.course_name  =  \"Spanish\"",
    "table_names": [
      "Courses",
      "Student_Course_Enrolment"
    ]
  },
  {
    "id": 395,
    "db_id": "apartment_rentals",
    "question": "What are the apartment numbers and types of all apartments that had confirmed bookings ending in the month of September 2017?",
    "sql": "SELECT a.apt_number, a.apt_type_code FROM Apartments a JOIN Apartment_Bookings b ON a.apt_id = b.apt_id WHERE b.booking_status_code = 'Confirmed' AND b.booking_end_date BETWEEN '2017-09-01' AND '2017-09-30';",
    "table_names": [
      "Apartments",
      "Apartment_Bookings"
    ]
  },
  {
    "id": 875,
    "db_id": "local_govt_mdm",
    "question": "How many business rates are related to each cmi cross reference? List cross reference id, master customer id and the n",
    "sql": "SELECT T2.cmi_cross_ref_id ,  T2.master_customer_id ,  count(*) FROM Business_Rates AS T1 JOIN CMI_Cross_References AS T2 ON T1.cmi_cross_ref_id  =  T2.cmi_cross_ref_id GROUP BY T2.cmi_cross_ref_id",
    "table_names": [
      "CMI_Cross_References",
      "Business_Rates"
    ]
  },
  {
    "id": 159,
    "db_id": "store_1",
    "question": "Who is the artist of the album titled 'Physical Graffiti [Disc 1]'?",
    "sql": "SELECT artists.name FROM artists JOIN albums ON artists.id = albums.artist_id WHERE albums.title = 'Physical Graffiti [Disc 1]';",
    "table_names": [
      "artists",
      "albums"
    ]
  },
  {
    "id": 1436,
    "db_id": "network_2",
    "question": "What are the cities where the friends of engineers live, given that the friendships have lasted at least 5 years?",
    "sql": "SELECT p2.city FROM PersonFriend pf JOIN Person p1 ON pf.name = p1.name JOIN Person p2 ON pf.friend = p2.name WHERE p1.job = 'engineer' AND pf.year >= 5;",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 767,
    "db_id": "csu_1",
    "question": "For each Orange county campus, report the number of degrees granted after 2000.",
    "sql": "SELECT T1.campus ,  sum(T2.degrees) FROM campuses AS T1 JOIN degrees AS T2 ON T1.id  =  T2.campus WHERE T1.county  =  \"Orange\" AND T2.year  >=  2000 GROUP BY T1.campus",
    "table_names": [
      "Campuses",
      "degrees"
    ]
  },
  {
    "id": 1956,
    "db_id": "city_record",
    "question": "What was the population of the city hosting the match in the year 2012?",
    "sql": "SELECT city.City, city.Regional_Population FROM city INNER JOIN hosting_city ON city.City_ID = CAST(hosting_city.Host_City AS INTEGER) WHERE hosting_city.Year = 2012;",
    "table_names": [
      "city",
      "hosting_city"
    ]
  },
  {
    "id": 2313,
    "db_id": "flight_2",
    "question": "Which airlines have less than 200 flights?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "airlines",
      "flights"
    ]
  },
  {
    "id": 2156,
    "db_id": "flight_4",
    "question": "What is the name and city of the airport that the most routes end at?",
    "sql": "SELECT T1.name ,  T1.city ,  T2.dst_apid FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.dst_apid GROUP BY T2.dst_apid ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "routes",
      "airports"
    ]
  },
  {
    "id": 1614,
    "db_id": "soccer_2",
    "question": "What is the state of the college where the player with pID 10001 successfully passed the tryout?",
    "sql": "SELECT College.state FROM College INNER JOIN Tryout ON College.cName = Tryout.cName WHERE Tryout.pID = 10001 AND Tryout.decision = 'yes';",
    "table_names": [
      "College",
      "Tryout"
    ]
  },
  {
    "id": 725,
    "db_id": "formula_1",
    "question": "For each race name, What is the maximum fastest lap speed for races after 2004 ordered by year?",
    "sql": "SELECT max(T2.fastestlapspeed) ,  T1.name ,  T1.year FROM races AS T1 JOIN results AS T2 ON T1.raceid = T2.raceid WHERE T1.year > 2014 GROUP BY T1.name ORDER BY T1.year",
    "table_names": [
      "races",
      "results"
    ]
  },
  {
    "id": 1186,
    "db_id": "baseball_1",
    "question": "Find the id and rank of the team that has the highest average attendance rate in 2014.",
    "sql": "SELECT T2.team_id ,  T2.rank FROM home_game AS T1 JOIN team AS T2 ON T1.team_id  =  T2.team_id WHERE T1.year  =  2014 GROUP BY T1.team_id ORDER BY avg(T1.attendance) DESC LIMIT 1;",
    "table_names": [
      "home_game",
      "team"
    ]
  },
  {
    "id": 1361,
    "db_id": "student_1",
    "question": "What are the first and last names of the first-grade students who are NOT taught by teacher OTHA MOYER?",
    "sql": "SELECT DISTINCT T1.firstname ,  T1.lastname FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom WHERE T1.grade  =  1 EXCEPT SELECT T1.firstname ,  T1.lastname FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom WHERE T2.firstname  =  \"OTHA\" AND T2.lastname  =  \"MOYER\"",
    "table_names": [
      "list",
      "teachers"
    ]
  },
  {
    "id": 2338,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "What is the template type code of the template used by document with the name \"Data base\"?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Templates",
      "Documents"
    ]
  },
  {
    "id": 1637,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "What are the names of the marketing regions where stores with a rating of '5 stars' are located?",
    "sql": "SELECT DISTINCT m.Marketing_Region_Name FROM Marketing_Regions m JOIN Stores s ON m.Marketing_Region_Code = s.Marketing_Region_Code WHERE s.Other_Details = '5 stars';",
    "table_names": [
      "Marketing_Regions",
      "Stores"
    ]
  },
  {
    "id": 1127,
    "db_id": "music_1",
    "question": "What mp4 formatted songs from India have a rating of 8 or higher?",
    "sql": "SELECT song.song_name FROM song INNER JOIN files ON song.f_id = files.f_id WHERE song.country = 'India' AND files.formats = 'mp4' AND song.rating >= 8;",
    "table_names": [
      "files",
      "song"
    ]
  },
  {
    "id": 340,
    "db_id": "match_season",
    "question": "Which player comes from the country whose capital is Jakarta and what is his playing position?",
    "sql": "SELECT ms.Player, ms.Position FROM match_season ms JOIN country c ON ms.Country = c.Country_id WHERE c.Capital = 'Jakarta';",
    "table_names": [
      "country",
      "match_season"
    ]
  },
  {
    "id": 1518,
    "db_id": "college_3",
    "question": "What are the full names of students minoring in department 140?",
    "sql": "SELECT T2.Fname ,  T2.Lname FROM MINOR_IN AS T1 JOIN STUDENT AS T2 ON T1.StuID  =  T2.StuID WHERE T1.DNO  =  140",
    "table_names": [
      "Student",
      "Minor_in"
    ]
  },
  {
    "id": 1267,
    "db_id": "e_learning",
    "question": "List the name and the number of enrolled student for each course.",
    "sql": "SELECT T1.course_name ,  COUNT(*) FROM Courses AS T1 JOIN Student_Course_Enrolment AS T2 ON T1.course_id  =  T2.course_id GROUP BY T1.course_name",
    "table_names": [
      "Courses",
      "Student_Course_Enrolment"
    ]
  },
  {
    "id": 1733,
    "db_id": "voter_2",
    "question": "What are the distinct majors that students with treasurer votes are studying?",
    "sql": "SELECT DISTINCT T1.Major FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  T2.Treasurer_Vote",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 743,
    "db_id": "entrepreneur",
    "question": "Can you list the names of entrepreneurs, their companies, and the money requested for those who asked for more than 80000 and whose height is above 1.85 meters?",
    "sql": "SELECT p.Name, e.Company, e.Money_Requested FROM entrepreneur e INNER JOIN people p ON e.People_ID = p.People_ID WHERE e.Money_Requested > 80000 AND p.Height > 1.85;",
    "table_names": [
      "entrepreneur",
      "people"
    ]
  },
  {
    "id": 2045,
    "db_id": "wine_1",
    "question": "What are the names of wines made from red grapes and with prices above 50?",
    "sql": "SELECT T2.Name FROM Grapes AS T1 JOIN WINE AS T2 ON T1.Grape  =  T2.Grape WHERE T1.Color  =  \"Red\" AND T2.price  >  50",
    "table_names": [
      "grapes",
      "wine"
    ]
  },
  {
    "id": 2067,
    "db_id": "driving_school",
    "question": "What are the first and last names of staff members who live in Connecticut?",
    "sql": "SELECT first_name, last_name FROM Staff WHERE staff_address_id IN (SELECT address_id FROM Addresses WHERE state_province_county = 'Connecticut');",
    "table_names": [
      "Addresses",
      "Staff"
    ]
  },
  {
    "id": 581,
    "db_id": "gymnast",
    "question": "Which gymnast from Santo Domingo achieved the highest score in the Horizontal Bar event?",
    "sql": "SELECT p.Name FROM gymnast g JOIN people p ON g.Gymnast_ID = p.People_ID WHERE g.Horizontal_Bar_Points = (SELECT MAX(Horizontal_Bar_Points) FROM gymnast) AND p.Hometown = 'Santo Domingo';",
    "table_names": [
      "gymnast",
      "people"
    ]
  },
  {
    "id": 1424,
    "db_id": "tracking_grants_for_research",
    "question": "How many research staff members are employed by organisations categorized as 'RES'?",
    "sql": "SELECT COUNT(*) FROM Research_Staff rs INNER JOIN Organisations o ON rs.employer_organisation_id = o.organisation_id WHERE o.organisation_type = 'RES';",
    "table_names": [
      "Organisations",
      "Research_Staff"
    ]
  },
  {
    "id": 1070,
    "db_id": "college_1",
    "question": "Find the first name of the professor who is teaching two courses with code CIS-220 and QM-261.",
    "sql": "SELECT T1.emp_fname FROM employee AS T1 JOIN CLASS AS T2 ON T1.emp_num  =  T2.prof_num WHERE crs_code  =  'CIS-220' INTERSECT SELECT T1.emp_fname FROM employee AS T1 JOIN CLASS AS T2 ON T1.emp_num  =  T2.prof_num WHERE crs_code  =  'QM-261'",
    "table_names": [
      "CLASS",
      "EMPLOYEE"
    ]
  },
  {
    "id": 2343,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "What are the different template type codes, and how many documents use each type?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Templates",
      "Documents"
    ]
  },
  {
    "id": 421,
    "db_id": "apartment_rentals",
    "question": "How many available apartments with 2 or more bathrooms exist for each apartment type?",
    "sql": "SELECT apt_type_code, COUNT(*) as total_available FROM Apartments a JOIN View_Unit_Status v ON a.apt_id = v.apt_id WHERE v.available_yn = 1 AND a.bathroom_count >= 2 GROUP BY apt_type_code;",
    "table_names": [
      "Apartments",
      "View_Unit_Status"
    ]
  },
  {
    "id": 959,
    "db_id": "sakila_1",
    "question": "Where does the customer with the first name Linda live? And what is her email?",
    "sql": "SELECT T2.address ,  T1.email FROM customer AS T1 JOIN address AS T2 ON T2.address_id  =  T1.address_id WHERE T1.first_name  =  'LINDA'",
    "table_names": [
      "address",
      "customer"
    ]
  },
  {
    "id": 1191,
    "db_id": "baseball_1",
    "question": "What is the highest salary among each team? List the team name, id and maximum salary.",
    "sql": "SELECT T1.name ,  T1.team_id ,  max(T2.salary) FROM team AS T1 JOIN salary AS T2 ON T1.team_id  =  T2.team_id GROUP BY T1.team_id;",
    "table_names": [
      "salary",
      "team"
    ]
  },
  {
    "id": 1052,
    "db_id": "college_1",
    "question": "How many different classrooms are used for courses from the CIS department that have 4.0 credits?",
    "sql": "SELECT COUNT(DISTINCT CLASS.CLASS_ROOM) FROM CLASS JOIN COURSE ON CLASS.CRS_CODE = COURSE.CRS_CODE WHERE COURSE.DEPT_CODE = 'CIS' AND COURSE.CRS_CREDIT = 4.0;",
    "table_names": [
      "CLASS",
      "COURSE"
    ]
  },
  {
    "id": 361,
    "db_id": "climbing",
    "question": "What is the name of the highest mountain climbed by a climber from the United Kingdom?",
    "sql": "SELECT mountain.Name FROM mountain JOIN climber ON mountain.Mountain_ID = climber.Mountain_ID WHERE climber.Country = 'United Kingdom' ORDER BY mountain.Height DESC LIMIT 1;",
    "table_names": [
      "mountain",
      "climber"
    ]
  },
  {
    "id": 1349,
    "db_id": "student_1",
    "question": "What are the first names of the teachers who teach grade 1?",
    "sql": "SELECT DISTINCT T2.firstname FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom WHERE grade  =  1",
    "table_names": [
      "list",
      "teachers"
    ]
  },
  {
    "id": 2080,
    "db_id": "driving_school",
    "question": "Which 'Bad Customer' has spent the most money on 'Completed' lessons, and what is the total amount spent?",
    "sql": "SELECT c.first_name, c.last_name, SUM(l.price) AS total_completed_lesson_price FROM Customers c JOIN Lessons l ON c.customer_id = l.customer_id WHERE c.customer_status_code = 'Bad Customer' AND l.lesson_status_code = 'Completed' GROUP BY c.customer_id ORDER BY total_completed_lesson_price DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Lessons"
    ]
  },
  {
    "id": 99,
    "db_id": "twitter_1",
    "question": "Which user has posted the most number of tweets?",
    "sql": "SELECT u.name FROM user_profiles u JOIN tweets t ON u.uid = t.uid GROUP BY u.uid ORDER BY COUNT(t.id) DESC LIMIT 1;",
    "table_names": [
      "tweets",
      "user_profiles"
    ]
  },
  {
    "id": 2458,
    "db_id": "voter_1",
    "question": "What are the names of contestants who received votes from voters in NY?",
    "sql": "SELECT contestant_name FROM CONTESTANTS WHERE contestant_number IN (SELECT contestant_number FROM VOTES WHERE state = 'NY');",
    "table_names": [
      "CONTESTANTS",
      "VOTES"
    ]
  },
  {
    "id": 2537,
    "db_id": "dog_kennels",
    "question": "Who is the owner living in Mississippi, and can you provide the name of the Veterinarian also operating in the same state?",
    "sql": "SELECT o.first_name, o.last_name, p.first_name, p.last_name FROM Owners o JOIN Professionals p ON o.state = p.state WHERE o.state = 'Mississippi' AND p.role_code = 'Veterenarian';",
    "table_names": [
      "Owners",
      "Professionals"
    ]
  },
  {
    "id": 677,
    "db_id": "party_people",
    "question": "Which political party organized an Election Meeting in the region with Region_ID equal to 1?",
    "sql": "SELECT party.Party_name FROM party JOIN party_events ON party.Party_ID = party_events.Party_ID WHERE party_events.Event_Name = 'Election Meeting' AND party.Region_ID = 1;",
    "table_names": [
      "party",
      "party_events"
    ]
  },
  {
    "id": 1448,
    "db_id": "network_2",
    "question": "Which male individuals have friends whose job is student?",
    "sql": "SELECT p1.name FROM Person p1 JOIN PersonFriend pf ON p1.name = pf.name JOIN Person p2 ON pf.friend = p2.name WHERE p1.gender = 'male' AND p2.job = 'student';",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1037,
    "db_id": "college_1",
    "question": "How many professors are in the accounting dept?",
    "sql": "SELECT count(*) FROM professor AS T1 JOIN department AS T2 ON T1.dept_code  =  T2.dept_code WHERE DEPT_NAME  =  \"Accounting\"",
    "table_names": [
      "DEPARTMENT",
      "PROFESSOR"
    ]
  },
  {
    "id": 1123,
    "db_id": "hr_1",
    "question": "display the department name and number of employees in each of the department.",
    "sql": "SELECT department_name ,  COUNT(*) FROM employees AS T1 JOIN departments AS T2 ON T1.department_id  =  T2.department_id GROUP BY department_name",
    "table_names": [
      "departments",
      "employees"
    ]
  },
  {
    "id": 1585,
    "db_id": "school_player",
    "question": "What are the schools' names, their respective locations and nicknames, which offer only day school facilities and compete in Division 1?",
    "sql": "SELECT s.School, s.Location, sd.Nickname FROM school s JOIN school_details sd ON s.School_ID = sd.School_ID WHERE s.Day_or_Boarding = 'Day' AND sd.Division = 'Division 1';",
    "table_names": [
      "school",
      "school_details"
    ]
  },
  {
    "id": 1774,
    "db_id": "products_gen_characteristics",
    "question": "What is the name of the product with the highest selling price among all products that have the color description 'red'?",
    "sql": "SELECT product_name FROM Products WHERE typical_selling_price = (SELECT MAX(CAST(typical_selling_price AS FLOAT)) FROM Products WHERE color_code = (SELECT color_code FROM Ref_Colors WHERE color_description = 'red'));",
    "table_names": [
      "Ref_Colors",
      "Products"
    ]
  },
  {
    "id": 2182,
    "db_id": "flight_4",
    "question": "What is the name of the airport that is the destination of the most number of routes that start in China?",
    "sql": "SELECT T1.name FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.dst_apid WHERE T1.country  =  'China' GROUP BY T1.name ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "routes",
      "airports"
    ]
  },
  {
    "id": 236,
    "db_id": "chinook_1",
    "question": "Which artist created the album 'Ride The Lightning' and also produced the album 'St. Anger'?",
    "sql": "SELECT Artist.Name FROM Album JOIN Artist ON Album.ArtistId = Artist.ArtistId WHERE Album.Title IN ('Ride The Lightning', 'St. Anger') GROUP BY Artist.Name HAVING COUNT(DISTINCT Album.Title) = 2;",
    "table_names": [
      "Album",
      "Artist"
    ]
  },
  {
    "id": 390,
    "db_id": "apartment_rentals",
    "question": "How many distinct guests have confirmed bookings for apartments that have at least 5 bedrooms?",
    "sql": "SELECT COUNT(DISTINCT ab.guest_id) FROM Apartments a INNER JOIN Apartment_Bookings ab ON a.apt_id = ab.apt_id WHERE a.bedroom_count >= 5 AND ab.booking_status_code = 'Confirmed';",
    "table_names": [
      "Apartments",
      "Apartment_Bookings"
    ]
  },
  {
    "id": 2321,
    "db_id": "employee_hire_evaluation",
    "question": "What is the average bonus awarded to employees from Bristol?",
    "sql": "SELECT AVG(evaluation.Bonus) FROM employee JOIN evaluation ON employee.Employee_ID = evaluation.Employee_ID WHERE employee.City = 'Bristol';",
    "table_names": [
      "employee",
      "evaluation"
    ]
  },
  {
    "id": 2136,
    "db_id": "activity_1",
    "question": "How many faculty members participate in each activity? Return the activity names and the number of faculty members.",
    "sql": "SELECT T1.activity_name ,  count(*) FROM Activity AS T1 JOIN Faculty_participates_in AS T2 ON T1.actID  =  T2.actID GROUP BY T1.actID",
    "table_names": [
      "Activity",
      "Faculty_Participates_in"
    ]
  },
  {
    "id": 1319,
    "db_id": "hospital_1",
    "question": "What is the name and position of the Primary Care Physician assigned to the patient with Insurance ID 36546321?",
    "sql": "SELECT Physician.Name, Physician.Position FROM Physician INNER JOIN Patient ON Physician.EmployeeID = Patient.PCP WHERE Patient.InsuranceID = 36546321;",
    "table_names": [
      "Physician",
      "Patient"
    ]
  },
  {
    "id": 364,
    "db_id": "climbing",
    "question": "What is the name of the mountain and the range climbed by the climber who achieved the lowest points?",
    "sql": "SELECT mountain.Name, mountain.Range FROM mountain JOIN climber ON mountain.Mountain_ID = climber.Mountain_ID WHERE climber.Points = (SELECT MIN(Points) FROM climber);",
    "table_names": [
      "mountain",
      "climber"
    ]
  },
  {
    "id": 10,
    "db_id": "farm",
    "question": "Which city hosted the farm competition in 2002 and has a population less than 500?",
    "sql": "SELECT city.Official_Name FROM city JOIN farm_competition ON city.City_ID = farm_competition.Host_city_ID WHERE farm_competition.Year = 2002 AND city.Population < 500;",
    "table_names": [
      "city",
      "farm_competition"
    ]
  },
  {
    "id": 112,
    "db_id": "product_catalog",
    "question": "What are the names of catalog entries that have a price greater than $600 and a specific attribute id 4 with value '1'?",
    "sql": "SELECT c.catalog_entry_name FROM Catalog_Contents c JOIN Catalog_Contents_Additional_Attributes a ON c.catalog_entry_id = a.catalog_entry_id WHERE c.price_in_dollars > 600 AND a.attribute_id = 4 AND a.attribute_value = '1';",
    "table_names": [
      "Catalog_Contents",
      "Catalog_Contents_Additional_Attributes"
    ]
  },
  {
    "id": 2020,
    "db_id": "scientist_1",
    "question": "Which projects are assigned to scientists who are working on more than one project, and what is the total number of hours dedicated to each of these projects, ordered by the project with the most hours?",
    "sql": "SELECT p.Name, SUM(p.Hours) AS TotalHours FROM Projects p INNER JOIN AssignedTo a ON p.Code = a.Project WHERE a.Scientist IN (SELECT Scientist FROM AssignedTo GROUP BY Scientist HAVING COUNT(Project) > 1) GROUP BY p.Name ORDER BY TotalHours DESC;",
    "table_names": [
      "Projects",
      "AssignedTo"
    ]
  },
  {
    "id": 67,
    "db_id": "bike_1",
    "question": "For each station, return its longitude and the average duration of trips that started from the station.",
    "sql": "SELECT T1.name ,  T1.long ,  avg(T2.duration) FROM station AS T1 JOIN trip AS T2 ON T1.id  =  T2.start_station_id GROUP BY T2.start_station_id",
    "table_names": [
      "station",
      "trip"
    ]
  },
  {
    "id": 648,
    "db_id": "products_for_hire",
    "question": "Which good customer has the highest average payable amount among their bookings that were returned damaged?",
    "sql": "SELECT c.first_name, c.last_name, AVG(b.amount_payable) AS avg_payable FROM Customers c INNER JOIN Bookings b ON c.customer_id = b.customer_id WHERE c.good_or_bad_customer = 'good' AND b.returned_damaged_yn = '1' GROUP BY c.customer_id ORDER BY avg_payable DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Bookings"
    ]
  },
  {
    "id": 2474,
    "db_id": "world_1",
    "question": "Give the names of nations that speak both English and French.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 1657,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "List the email addresses of the drama workshop groups located in Alaska state.",
    "sql": "SELECT T2.Store_Email_Address FROM Addresses AS T1 JOIN Drama_Workshop_Groups AS T2 ON T1.Address_ID  =  T2.Address_ID WHERE T1.State_County  =  \"Alaska\"",
    "table_names": [
      "Addresses",
      "Drama_Workshop_Groups"
    ]
  },
  {
    "id": 1932,
    "db_id": "music_4",
    "question": "Which artist had the most total weeks at the top throughout all their songs listed, and how many top songs did they have?",
    "sql": "SELECT a.Artist, COUNT(v.Song) AS Total_Songs, SUM(v.Weeks_on_Top) AS Total_Weeks FROM artist a JOIN volume v ON a.Artist_ID = v.Artist_ID GROUP BY a.Artist ORDER BY Total_Weeks DESC LIMIT 1;",
    "table_names": [
      "artist",
      "volume"
    ]
  },
  {
    "id": 2334,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "What is the id and type code for the template used by the most documents?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Templates",
      "Documents"
    ]
  },
  {
    "id": 1724,
    "db_id": "voter_2",
    "question": "Find the distinct last names of the students who have class president votes.",
    "sql": "SELECT DISTINCT T1.LName FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  T2.CLASS_President_VOTE",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 1020,
    "db_id": "assets_maintenance",
    "question": "What is the total chargeable amount for all chargeable parts associated with asset_id 3?",
    "sql": "SELECT SUM(P.chargeable_amount) FROM Parts P INNER JOIN Asset_Parts AP ON P.part_id = AP.part_id WHERE AP.asset_id = 3 AND P.chargeable_yn = '1';",
    "table_names": [
      "Parts",
      "Asset_Parts"
    ]
  },
  {
    "id": 1763,
    "db_id": "products_gen_characteristics",
    "question": "What are the names of products in the 'Seeds' category that are blue in color and have a typical selling price greater than 60000?",
    "sql": "SELECT Products.product_name FROM Products JOIN Ref_Colors ON Products.color_code = Ref_Colors.color_code WHERE Ref_Colors.color_description = 'blue' AND Products.product_category_code = 'Seeds' AND Products.typical_selling_price > 60000;",
    "table_names": [
      "Ref_Colors",
      "Products"
    ]
  },
  {
    "id": 715,
    "db_id": "formula_1",
    "question": "What are the names of all races held after 2000 in Spain?",
    "sql": "SELECT DISTINCT T1.name FROM races AS T1 JOIN circuits AS T2 ON T1.circuitid = T2.circuitid WHERE T2.country = \"Spain\" AND T1.year > 2000",
    "table_names": [
      "circuits",
      "races"
    ]
  },
  {
    "id": 1471,
    "db_id": "decoration_competition",
    "question": "Who from United States was ranked 1st in any round?",
    "sql": "SELECT m.Name FROM member m JOIN round r ON m.Member_ID = r.Member_ID WHERE m.Country = 'United States' AND r.Rank_in_Round = 1;",
    "table_names": [
      "member",
      "round"
    ]
  },
  {
    "id": 1833,
    "db_id": "tracking_share_transactions",
    "question": "What is the total sale amount for all transactions associated with lot ID 1?",
    "sql": "SELECT SUM(t.amount_of_transaction) FROM Transactions t JOIN Transactions_Lots tl ON t.transaction_id = tl.transaction_id WHERE tl.lot_id = 1 AND t.transaction_type_code = 'SALE';",
    "table_names": [
      "Transactions",
      "Transactions_Lots"
    ]
  },
  {
    "id": 1129,
    "db_id": "music_1",
    "question": "What is the artist name and file size of songs that belong to the pop genre and have a rating greater than or equal to 7?",
    "sql": "SELECT f.artist_name, f.file_size FROM files f JOIN song s ON f.f_id = s.f_id WHERE s.genre_is = 'pop' AND s.rating >= 7;",
    "table_names": [
      "files",
      "song"
    ]
  },
  {
    "id": 2576,
    "db_id": "dog_kennels",
    "question": "How many dogs of the breed 'BUL' weighing more than 5 units are owned by people from North Dakota?",
    "sql": "SELECT COUNT(*) FROM Dogs AS d JOIN Owners AS o ON d.owner_id = o.owner_id WHERE o.state = 'NorthDakota' AND d.breed_code = 'BUL' AND d.weight > 5;",
    "table_names": [
      "Owners",
      "Dogs"
    ]
  },
  {
    "id": 310,
    "db_id": "university_basketball",
    "question": "What are the names of universities, their basketball teams, and enrollments for schools with basketball overall game win percentages greater than 80% and student enrollment above 15,000?",
    "sql": "SELECT u.School, b.Team_Name, u.Enrollment FROM basketball_match b INNER JOIN university u ON b.School_ID = u.School_ID WHERE b.All_Games_Percent > 0.8 AND u.Enrollment > 15000;",
    "table_names": [
      "basketball_match",
      "university"
    ]
  },
  {
    "id": 763,
    "db_id": "csu_1",
    "question": "Which campus has the most faculties in year 2003?",
    "sql": "SELECT T1.campus FROM campuses AS T1 JOIN faculty AS T2 ON T1.id  =  T2.campus WHERE T2.year  =  2003 ORDER BY T2.faculty DESC LIMIT 1",
    "table_names": [
      "Campuses",
      "faculty"
    ]
  },
  {
    "id": 312,
    "db_id": "university_basketball",
    "question": "Which basketball teams are associated with universities founded before 1800 that have an overall games winning percentage higher than 0.8?",
    "sql": "SELECT b.Team_Name FROM basketball_match b JOIN university u ON b.School_ID = u.School_ID WHERE u.Founded < 1800 AND CAST(b.All_Games_Percent AS FLOAT) > 0.8;",
    "table_names": [
      "basketball_match",
      "university"
    ]
  },
  {
    "id": 425,
    "db_id": "game_injury",
    "question": "How many games are free of injury accidents?",
    "sql": "SELECT count(*) FROM game WHERE id NOT IN ( SELECT game_id FROM injury_accident )",
    "table_names": [
      "game",
      "injury_accident"
    ]
  },
  {
    "id": 1830,
    "db_id": "tracking_share_transactions",
    "question": "What is the total transaction amount for all purchase transactions that have purchase details marked as 'a'?",
    "sql": "SELECT SUM(T.amount_of_transaction) FROM Transactions T JOIN Purchases P ON T.transaction_id = P.purchase_transaction_id WHERE P.purchase_details = 'a' AND T.transaction_type_code = 'PUR';",
    "table_names": [
      "Transactions",
      "Purchases"
    ]
  },
  {
    "id": 1786,
    "db_id": "swimming",
    "question": "Which swimmers won Event 3 and achieved a 400-meter time faster than 3 minutes and 56 seconds, and what is their nationality?",
    "sql": "SELECT swimmer.name, swimmer.Nationality FROM swimmer JOIN record ON swimmer.ID = record.Swimmer_ID WHERE record.Event_ID = 3 AND record.Result = 'Win' AND swimmer.meter_400 < '3:56.00';",
    "table_names": [
      "swimmer",
      "record"
    ]
  },
  {
    "id": 1927,
    "db_id": "music_4",
    "question": "What is the total number of weeks that songs by artists 'Tangorodrim' and 'Gorgoroth' spent at the top?",
    "sql": "SELECT SUM(v.Weeks_on_Top) FROM volume v JOIN artist a ON v.Artist_ID = a.Artist_ID WHERE a.Artist IN ('Tangorodrim', 'Gorgoroth');",
    "table_names": [
      "artist",
      "volume"
    ]
  },
  {
    "id": 2031,
    "db_id": "scientist_1",
    "question": "What are the names of the scientists assigned to the project 'Ast3'?",
    "sql": "SELECT Name FROM Scientists WHERE SSN IN (SELECT Scientist FROM AssignedTo WHERE Project = 'Ast3');",
    "table_names": [
      "Scientists",
      "AssignedTo"
    ]
  },
  {
    "id": 2372,
    "db_id": "wta_1",
    "question": "What are the country code and first name of the players who won in both tourney WTA Championships and Australian Open?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "players",
      "matches"
    ]
  },
  {
    "id": 546,
    "db_id": "theme_gallery",
    "question": "Who was the artist that participated in the earliest exhibition that had a ticket price greater than 15?",
    "sql": "SELECT a.Name FROM artist a JOIN exhibition e ON a.Artist_ID = e.Artist_ID WHERE e.Year IN (SELECT MIN(Year) FROM exhibition WHERE Ticket_Price > 15);",
    "table_names": [
      "artist",
      "exhibition"
    ]
  },
  {
    "id": 1655,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "Return the the names of the drama workshop groups that are located in Feliciaberg city.",
    "sql": "SELECT T2.Store_Name FROM Addresses AS T1 JOIN Drama_Workshop_Groups AS T2 ON T1.Address_ID  =  T2.Address_ID WHERE T1.City_Town  =  \"Feliciaberg\"",
    "table_names": [
      "Addresses",
      "Drama_Workshop_Groups"
    ]
  },
  {
    "id": 1599,
    "db_id": "soccer_2",
    "question": "What are the IDs of players who applied to be goalies at colleges with enrollments over 15000 but were rejected?",
    "sql": "SELECT Tryout.pID FROM Tryout JOIN College ON Tryout.cName = College.cName WHERE College.enr > 15000 AND Tryout.pPos = 'goalie' AND Tryout.decision = 'no';",
    "table_names": [
      "College",
      "Tryout"
    ]
  },
  {
    "id": 857,
    "db_id": "inn_1",
    "question": "Which room has the highest rate? List the room's full name, rate, check in and check out date.",
    "sql": "SELECT T2.roomName ,  T1.Rate ,  T1.CheckIn ,  T1.CheckOut FROM Reservations AS T1 JOIN Rooms AS T2 ON T1.Room  =  T2.RoomId GROUP BY T1.Room ORDER BY T1.Rate DESC LIMIT 1;",
    "table_names": [
      "Rooms",
      "Reservations"
    ]
  },
  {
    "id": 984,
    "db_id": "loan_1",
    "question": "What is the total amount of loans taken by customers from Utah?",
    "sql": "SELECT SUM(amount) FROM loan WHERE cust_ID IN (SELECT cust_ID FROM customer WHERE state = 'Utah');",
    "table_names": [
      "customer",
      "loan"
    ]
  },
  {
    "id": 1231,
    "db_id": "mountain_photos",
    "question": "What are the names of the camera lenses used to take RBG colored photos at mountain ID 12?",
    "sql": "SELECT camera_lens.name FROM camera_lens JOIN photos ON camera_lens.id = photos.camera_lens_id WHERE photos.mountain_id = 12 AND photos.color = 'RBG';",
    "table_names": [
      "camera_lens",
      "photos"
    ]
  },
  {
    "id": 2011,
    "db_id": "cre_Docs_and_Epenses",
    "question": "How many documents associated with project 105 have a government ('GV') budget type?",
    "sql": "SELECT COUNT(DISTINCT d.Document_ID) FROM Documents d INNER JOIN Documents_with_Expenses dwe ON d.Document_ID = dwe.Document_ID WHERE d.Project_ID = 105 AND dwe.Budget_Type_Code = 'GV';",
    "table_names": [
      "Documents",
      "Documents_with_Expenses"
    ]
  },
  {
    "id": 2272,
    "db_id": "car_1",
    "question": "What are the countries having at least one car maker? List name and id.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "countries",
      "car_makers"
    ]
  },
  {
    "id": 2179,
    "db_id": "flight_4",
    "question": "Find the busiest source airport that runs most number of routes in China.",
    "sql": "SELECT T1.name FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.src_apid WHERE T1.country  =  'China' GROUP BY T1.name ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "routes",
      "airports"
    ]
  },
  {
    "id": 795,
    "db_id": "candidate_poll",
    "question": "What are the support rates and poll sources for all candidates taller than 195cm, as measured in the poll conducted from Nov 9–10, 2006?",
    "sql": "SELECT candidate.Support_rate, candidate.Poll_Source FROM candidate JOIN people ON candidate.People_ID = people.People_ID WHERE people.Height > 195.0 AND candidate.Date = 'Nov 9–10, 2006';",
    "table_names": [
      "candidate",
      "people"
    ]
  },
  {
    "id": 662,
    "db_id": "party_people",
    "question": "Which members from parties led by Ebenezer Ako-Adjei (MP) are currently in office?",
    "sql": "SELECT m.Member_Name FROM member AS m JOIN party AS p ON m.Party_ID = p.Party_ID WHERE p.Minister = 'Ebenezer Ako-Adjei (MP)' AND m.In_office LIKE '%present%';",
    "table_names": [
      "party",
      "member"
    ]
  },
  {
    "id": 877,
    "db_id": "local_govt_mdm",
    "question": "Wat is the tax source system code and master customer id of the taxes related to each parking fine id?",
    "sql": "SELECT T1.source_system_code ,  T1.master_customer_id ,  T2.council_tax_id FROM CMI_Cross_References AS T1 JOIN Parking_Fines AS T2 ON T1.cmi_cross_ref_id  =  T2.cmi_cross_ref_id",
    "table_names": [
      "CMI_Cross_References",
      "Parking_Fines"
    ]
  },
  {
    "id": 128,
    "db_id": "flight_1",
    "question": "Which aircrafts with a certified pilot having employee ID 142519864 have a flying distance greater than 5000?",
    "sql": "SELECT a.name FROM aircraft a JOIN certificate c ON a.aid = c.aid WHERE c.eid = 142519864 AND a.distance > 5000;",
    "table_names": [
      "aircraft",
      "certificate"
    ]
  },
  {
    "id": 192,
    "db_id": "customers_card_transactions",
    "question": "What is the email address of the customer who owns the account named '546'?",
    "sql": "SELECT C.customer_email FROM Customers C JOIN Accounts A ON C.customer_id = A.customer_id WHERE A.account_name = '546';",
    "table_names": [
      "Accounts",
      "Customers"
    ]
  },
  {
    "id": 489,
    "db_id": "insurance_and_eClaims",
    "question": "How many distinct claims have a recorded outcome as 'Disputed' at the 'Close' claim processing stage?",
    "sql": "SELECT COUNT(DISTINCT cp.Claim_ID) FROM Claims_Processing cp JOIN Claims_Processing_Stages cps ON cp.Claim_Stage_ID = cps.Claim_Stage_ID WHERE cps.Claim_Status_Name = 'Close' AND cp.Claim_Outcome_Code = 'Disputed';",
    "table_names": [
      "Claims_Processing_Stages",
      "Claims_Processing"
    ]
  },
  {
    "id": 1955,
    "db_id": "city_record",
    "question": "What was the GDP of the city that hosted the match in the year 2011?",
    "sql": "SELECT c.City, c.GDP FROM city c JOIN hosting_city h ON c.City_ID = CAST(h.Host_City AS INTEGER) WHERE h.Year = 2011;",
    "table_names": [
      "city",
      "hosting_city"
    ]
  },
  {
    "id": 157,
    "db_id": "tracking_orders",
    "question": "What is the total amount spent by all customers located in Germany?",
    "sql": "SELECT SUM(invoices.total) FROM invoices JOIN customers ON invoices.customer_id = customers.id WHERE customers.country = 'Germany';",
    "table_names": [
      "customers",
      "invoices"
    ]
  },
  {
    "id": 640,
    "db_id": "protein_institute",
    "question": "Which protein associated with a private institution has the highest sequence identity to human protein, and what is its divergence from the human lineage along with the common name of the species and the institution name?",
    "sql": "SELECT p.common_name, p.protein_name, p.divergence_from_human_lineage, i.Institution FROM protein p JOIN Institution i ON p.Institution_id = i.Institution_id WHERE i.Type = 'Private' AND p.sequence_identity_to_human_protein = (SELECT MAX(sequence_identity_to_human_protein) FROM protein p2 JOIN Institution i2 ON p2.Institution_id = i2.Institution_id WHERE i2.Type = 'Private');",
    "table_names": [
      "Institution",
      "protein"
    ]
  },
  {
    "id": 325,
    "db_id": "phone_1",
    "question": "What are the hardware model names and pixel resolutions of Samsung Electronics phones that use Graphics type screen modes?",
    "sql": "SELECT p.Hardware_Model_name, s.Pixels FROM phone p JOIN screen_mode s ON CAST(p.screen_mode AS FLOAT) = s.Graphics_mode WHERE p.Company_name = 'Samsung Electronics Co Ltd' AND s.Type = 'Graphics';",
    "table_names": [
      "screen_mode",
      "phone"
    ]
  },
  {
    "id": 1223,
    "db_id": "baseball_1",
    "question": "Which park had most attendances in 2008?",
    "sql": "SELECT T2.park_name FROM home_game AS T1 JOIN park AS T2 ON T1.park_id  =  T2.park_id WHERE T1.year = 2008 ORDER BY T1.attendance DESC LIMIT 1;",
    "table_names": [
      "home_game",
      "park"
    ]
  },
  {
    "id": 477,
    "db_id": "college_2",
    "question": "What are the building, room number, semester and year of courses in the Psychology department, sorted using course title?",
    "sql": "SELECT T2.building ,  T2.room_number ,  T2.semester ,  T2.year FROM course AS T1 JOIN SECTION AS T2 ON T1.course_id  =  T2.course_id WHERE T1.dept_name  =  'Psychology' ORDER BY T1.title",
    "table_names": [
      "course",
      "section"
    ]
  },
  {
    "id": 1571,
    "db_id": "local_govt_and_lot",
    "question": "How many 'Unsatisfied' cleaning services were provided by all subsidiary organizations under 'Reinger, Hudson and Nolan Group'?",
    "sql": "SELECT COUNT(*) FROM Things WHERE organization_id IN (SELECT organization_id FROM Organizations WHERE parent_organization_id = 7 AND organization_id <> 7) AND service_type_code = 'Cleanning' AND service_details = 'Unsatisfied';",
    "table_names": [
      "Organizations",
      "Things"
    ]
  },
  {
    "id": 2309,
    "db_id": "flight_2",
    "question": "What is the abbreviation of the airilne has the fewest flights and what country is it in?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "airlines",
      "flights"
    ]
  },
  {
    "id": 2152,
    "db_id": "flight_4",
    "question": "How many routes does American Airlines operate?",
    "sql": "SELECT count(*) FROM airlines AS T1 JOIN routes AS T2 ON T1.alid  =  T2.alid WHERE T1.name  =  'American Airlines'",
    "table_names": [
      "routes",
      "airlines"
    ]
  },
  {
    "id": 574,
    "db_id": "epinions_1",
    "question": "What is the average rating of items that are fruits?",
    "sql": "SELECT AVG(rating) FROM review WHERE i_id IN (SELECT i_id FROM item WHERE title IN ('pear', 'orange', 'apple', 'avocado'));",
    "table_names": [
      "item",
      "review"
    ]
  },
  {
    "id": 66,
    "db_id": "bike_1",
    "question": "What are the names of all stations that have more than 10 bikes available and are not located in San Jose?",
    "sql": "SELECT T1.name FROM station AS T1 JOIN status AS T2 ON T1.id  =  T2.station_id GROUP BY T2.station_id HAVING avg(bikes_available)  >  10 EXCEPT SELECT name FROM station WHERE city  =  \"San Jose\"",
    "table_names": [
      "station",
      "status"
    ]
  },
  {
    "id": 1718,
    "db_id": "shop_membership",
    "question": "How many distinct hometown locations are associated with members who registered in 2016?",
    "sql": "SELECT COUNT(DISTINCT m.Hometown) FROM member m JOIN membership_register_branch r ON m.Member_ID = r.Member_ID WHERE r.Register_Year = '2016';",
    "table_names": [
      "member",
      "membership_register_branch"
    ]
  },
  {
    "id": 732,
    "db_id": "entrepreneur",
    "question": "Which companies are founded by entrepreneurs taller than 1.8 meters that requested more than 100,000 money?",
    "sql": "SELECT e.Company FROM entrepreneur e JOIN people p ON e.People_ID = p.People_ID WHERE p.Height > 1.8 AND e.Money_Requested > 100000;",
    "table_names": [
      "entrepreneur",
      "people"
    ]
  },
  {
    "id": 430,
    "db_id": "soccer_1",
    "question": "What is the name of the league in the country whose name is Portugal?",
    "sql": "SELECT League.name FROM League JOIN Country ON League.country_id = Country.id WHERE Country.name = 'Portugal';",
    "table_names": [
      "League",
      "Country"
    ]
  },
  {
    "id": 1287,
    "db_id": "insurance_policies",
    "question": "What is the average amount settled in the Settlements table for all claims associated with policy ID 473 from the Claims table?",
    "sql": "SELECT AVG(s.Amount_Settled) FROM Settlements s JOIN Claims c ON s.Claim_ID = c.Claim_ID WHERE c.Policy_ID = 473;",
    "table_names": [
      "Claims",
      "Settlements"
    ]
  },
  {
    "id": 1512,
    "db_id": "college_3",
    "question": "What is the full name of the instructor who has a course named COMPUTER LITERACY?",
    "sql": "SELECT T2.Fname ,  T2.Lname FROM COURSE AS T1 JOIN FACULTY AS T2 ON T1.Instructor  =  T2.FacID WHERE T1.CName  =  \"COMPUTER LITERACY\"",
    "table_names": [
      "Faculty",
      "Course"
    ]
  },
  {
    "id": 1248,
    "db_id": "e_learning",
    "question": "Who are the authors that have created more than one course?",
    "sql": "SELECT family_name, personal_name FROM Course_Authors_and_Tutors WHERE author_id IN (SELECT author_id FROM Courses GROUP BY author_id HAVING COUNT(course_id) > 1);",
    "table_names": [
      "Course_Authors_and_Tutors",
      "Courses"
    ]
  },
  {
    "id": 305,
    "db_id": "medicine_enzyme_interaction",
    "question": "How many distinct enzymes have an activitor type interaction with FDA-approved medicines?",
    "sql": "SELECT COUNT(DISTINCT me.enzyme_id) FROM medicine_enzyme_interaction me JOIN medicine m ON me.medicine_id = m.id WHERE m.FDA_approved='Yes' AND me.interaction_type='activitor';",
    "table_names": [
      "medicine",
      "medicine_enzyme_interaction"
    ]
  },
  {
    "id": 1640,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "What is the total price for all services that fall under the parent service type 'provide photo service' and have the product name 'photo'?",
    "sql": "SELECT SUM(s.Product_Price) FROM Services s JOIN Ref_Service_Types r ON s.Service_Type_Code = r.Service_Type_Code WHERE r.Parent_Service_Type_Code = '1' AND s.Product_Name = 'photo';",
    "table_names": [
      "Ref_Service_Types",
      "Services"
    ]
  },
  {
    "id": 681,
    "db_id": "pilot_record",
    "question": "What is the nationality of the pilot who has the earliest record, and in what team does the pilot play?",
    "sql": "SELECT nationality, Team FROM pilot WHERE Pilot_ID = (SELECT Pilot_ID FROM pilot_record ORDER BY Date ASC LIMIT 1);",
    "table_names": [
      "pilot",
      "pilot_record"
    ]
  },
  {
    "id": 1408,
    "db_id": "tracking_grants_for_research",
    "question": "Which organisation has projects that resulted in the highest number of different types of outcomes?",
    "sql": "SELECT p.organisation_id, COUNT(DISTINCT po.outcome_code) AS num_outcome_types FROM Projects p JOIN Project_Outcomes po ON p.project_id = po.project_id GROUP BY p.organisation_id ORDER BY num_outcome_types DESC LIMIT 1;",
    "table_names": [
      "Project_Outcomes",
      "Projects"
    ]
  },
  {
    "id": 2258,
    "db_id": "car_1",
    "question": "Which model of the car has the minimum horsepower?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "car_names",
      "cars_data"
    ]
  },
  {
    "id": 1086,
    "db_id": "college_1",
    "question": "How many courses offered by departments within the BUS school have exactly 4 credit hours?",
    "sql": "SELECT COUNT(*) FROM COURSE AS C JOIN DEPARTMENT AS D ON C.DEPT_CODE = D.DEPT_CODE WHERE D.SCHOOL_CODE = 'BUS' AND C.CRS_CREDIT = 4.0;",
    "table_names": [
      "COURSE",
      "DEPARTMENT"
    ]
  },
  {
    "id": 1312,
    "db_id": "hospital_1",
    "question": "How many patients stay in room 112?",
    "sql": "SELECT count(patient) FROM stay WHERE room  =  112",
    "table_names": [
      "Room",
      "Stay"
    ]
  },
  {
    "id": 2247,
    "db_id": "pets_1",
    "question": "What is the id of the pet owned by the student whose last name is 'Smith'?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Student",
      "Has_Pet"
    ]
  },
  {
    "id": 793,
    "db_id": "candidate_poll",
    "question": "Among candidates taller than 195 cm, who had the highest recorded support rate, and what was that rate?",
    "sql": "SELECT p.Name, MAX(c.Support_rate) AS Highest_Support_Rate FROM candidate c JOIN people p ON c.People_ID = p.People_ID WHERE p.Height > 195 GROUP BY p.Name ORDER BY Highest_Support_Rate DESC LIMIT 1;",
    "table_names": [
      "candidate",
      "people"
    ]
  },
  {
    "id": 1824,
    "db_id": "workshop_paper",
    "question": "What is the college of the highest scoring author whose submission was accepted?",
    "sql": "SELECT College FROM submission WHERE Submission_ID IN (SELECT Submission_ID FROM Acceptance WHERE Result = 'Accepted') ORDER BY Scores DESC LIMIT 1;",
    "table_names": [
      "submission",
      "Acceptance"
    ]
  },
  {
    "id": 1089,
    "db_id": "sports_competition",
    "question": "What is the name of the club in Japan that has a player in the position of 'Second Row'?",
    "sql": "SELECT club.name FROM club INNER JOIN player ON club.Club_ID = player.Club_ID WHERE player.Position = 'Second Row' AND club.Region = 'Japan';",
    "table_names": [
      "club",
      "player"
    ]
  },
  {
    "id": 645,
    "db_id": "cinema",
    "question": "What is the title and director of the film scheduled for 4 showtimes per day at cinema ID 6?",
    "sql": "SELECT Title, Directed_by FROM film WHERE Film_ID IN (SELECT Film_ID FROM schedule WHERE Cinema_ID = 6 AND Show_times_per_day = 4);",
    "table_names": [
      "film",
      "schedule"
    ]
  },
  {
    "id": 1860,
    "db_id": "cre_Theme_park",
    "question": "How many tourist attractions classified as a gallery can be reached by bus?",
    "sql": "SELECT COUNT(*) FROM Tourist_Attractions ta JOIN Ref_Attraction_Types rat ON ta.Attraction_Type_Code = rat.Attraction_Type_Code WHERE rat.Attraction_Type_Description = 'gallery' AND ta.How_to_Get_There = 'bus';",
    "table_names": [
      "Ref_Attraction_Types",
      "Tourist_Attractions"
    ]
  },
  {
    "id": 2320,
    "db_id": "employee_hire_evaluation",
    "question": "Which employees from Bristol received a bonus of at least 3000, and what were their awarded bonuses?",
    "sql": "SELECT employee.Name, employee.City, evaluation.Bonus FROM employee JOIN evaluation ON employee.Employee_ID = CAST(evaluation.Employee_ID AS INTEGER) WHERE employee.City = 'Bristol' AND evaluation.Bonus >= 3000;",
    "table_names": [
      "employee",
      "evaluation"
    ]
  },
  {
    "id": 1862,
    "db_id": "cre_Theme_park",
    "question": "What are the name, id and the corresponding number of visits for each  tourist attraction?",
    "sql": "SELECT T1.Name ,  T2.Tourist_Attraction_ID ,   COUNT(*) FROM Tourist_Attractions AS T1 JOIN VISITS AS T2 ON T1.Tourist_Attraction_ID  =  T2.Tourist_Attraction_ID GROUP BY T2.Tourist_Attraction_ID",
    "table_names": [
      "Tourist_Attractions",
      "Visits"
    ]
  },
  {
    "id": 1549,
    "db_id": "department_store",
    "question": "What is the total amount purchased of products in order id 15?",
    "sql": "SELECT SUM(ps.total_amount_purchased) FROM Order_Items oi JOIN Product_Suppliers ps ON oi.product_id = ps.product_id WHERE oi.order_id = 15;",
    "table_names": [
      "Order_Items",
      "Product_Suppliers"
    ]
  },
  {
    "id": 699,
    "db_id": "local_govt_in_alabama",
    "question": "How many distinct participants have participated in successful events related to the service with Service_ID 5?",
    "sql": "SELECT COUNT(DISTINCT pe.Participant_ID) FROM Events e JOIN Participants_in_Events pe ON e.Event_ID = pe.Event_ID WHERE e.Service_ID = 5 AND e.Event_Details = 'Success';",
    "table_names": [
      "Events",
      "Participants_in_Events"
    ]
  },
  {
    "id": 2105,
    "db_id": "driving_school",
    "question": "What is the total price of all completed lessons taken by good customers?",
    "sql": "SELECT SUM(L.price) FROM Customers AS C JOIN Lessons AS L ON C.customer_id = L.customer_id WHERE C.customer_status_code = 'Good Customer' AND L.lesson_status_code = 'Completed';",
    "table_names": [
      "Customers",
      "Lessons"
    ]
  },
  {
    "id": 2139,
    "db_id": "activity_1",
    "question": "What is the name of the activity that has the most faculty members involved in?",
    "sql": "SELECT T1.activity_name FROM Activity AS T1 JOIN Faculty_participates_in AS T2 ON T1.actID  =  T2.actID GROUP BY T1.actID ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "Activity",
      "Faculty_Participates_in"
    ]
  },
  {
    "id": 356,
    "db_id": "match_season",
    "question": "Which team had the highest number of players playing as defenders across all seasons?",
    "sql": "SELECT team.Name, COUNT(match_season.Player) AS total_players FROM team JOIN match_season ON team.Team_id = match_season.Team WHERE match_season.Position = 'Defender' GROUP BY team.Name ORDER BY total_players DESC LIMIT 1;",
    "table_names": [
      "team",
      "match_season"
    ]
  },
  {
    "id": 510,
    "db_id": "customers_card_transactions",
    "question": "How many unique regular accounts are there among customers from Mississippi?",
    "sql": "SELECT COUNT(DISTINCT a.account_id) FROM Accounts a JOIN Customers c ON a.customer_id = c.customer_id WHERE c.state_county_province = 'Mississippi' AND a.other_account_details = 'Regular';",
    "table_names": [
      "Customers",
      "Accounts"
    ]
  },
  {
    "id": 1598,
    "db_id": "soccer_2",
    "question": "Which states have colleges that accepted players trying out for the goalie position?",
    "sql": "SELECT state FROM College WHERE cName IN (SELECT cName FROM Tryout WHERE pPos = 'goalie' AND decision = 'yes')",
    "table_names": [
      "College",
      "Tryout"
    ]
  },
  {
    "id": 2049,
    "db_id": "wine_1",
    "question": "What is the area for the appelation which produced the most wines prior to 2010?",
    "sql": "SELECT T1.Area FROM APPELLATIONS AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation GROUP BY T2.Appelation HAVING T2.year  <  2010 ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "appellations",
      "wine"
    ]
  },
  {
    "id": 1607,
    "db_id": "soccer_2",
    "question": "Which players received yellow cards and were rejected at tryouts for the goalie position?",
    "sql": "SELECT Player.pName FROM Player JOIN Tryout ON Player.pID = Tryout.pID WHERE Player.yCard = 'yes' AND Tryout.decision = 'no' AND Tryout.pPos = 'goalie';",
    "table_names": [
      "Player",
      "Tryout"
    ]
  },
  {
    "id": 1660,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "How many bookings have a 'good' status with workshop groups located in the Russian marketing region (RU)?",
    "sql": "SELECT COUNT(*) FROM Bookings AS b JOIN Drama_Workshop_Groups AS d ON b.Workshop_Group_ID = d.Workshop_Group_ID WHERE d.Marketing_Region_Code = 'RU' AND b.Status_Code = 'good';",
    "table_names": [
      "Drama_Workshop_Groups",
      "Bookings"
    ]
  },
  {
    "id": 303,
    "db_id": "medicine_enzyme_interaction",
    "question": "Which enzyme located in the Cytosol is activated by medicine with ID 20?",
    "sql": "SELECT enzyme.name FROM enzyme INNER JOIN medicine_enzyme_interaction ON enzyme.id = medicine_enzyme_interaction.enzyme_id WHERE medicine_enzyme_interaction.medicine_id = 20 AND enzyme.Location = 'Cytosol' AND medicine_enzyme_interaction.interaction_type = 'activitor';",
    "table_names": [
      "enzyme",
      "medicine_enzyme_interaction"
    ]
  },
  {
    "id": 1027,
    "db_id": "assets_maintenance",
    "question": "How many unique skills are required to fix part_fault_id 1 and 15?",
    "sql": "SELECT COUNT(DISTINCT s.skill_id) FROM Skills s JOIN Skills_Required_To_Fix sf ON s.skill_id = sf.skill_id WHERE sf.part_fault_id IN (1, 15);",
    "table_names": [
      "Skills",
      "Skills_Required_To_Fix"
    ]
  },
  {
    "id": 2117,
    "db_id": "activity_1",
    "question": "Show the faculty id of each faculty member, along with the number of students he or she advises.",
    "sql": "SELECT T1.FacID ,  count(*) FROM Faculty AS T1 JOIN Student AS T2 ON T1.FacID  =  T2.advisor GROUP BY T1.FacID",
    "table_names": [
      "Student",
      "Faculty"
    ]
  },
  {
    "id": 778,
    "db_id": "csu_1",
    "question": "What is the number of faculty at Long Beach State University in 2002?",
    "sql": "SELECT faculty FROM faculty AS T1 JOIN campuses AS T2 ON T1.campus  =  T2.id WHERE T1.year  =  2002 AND T2.campus  =  \"Long Beach State University\"",
    "table_names": [
      "Campuses",
      "faculty"
    ]
  },
  {
    "id": 277,
    "db_id": "chinook_1",
    "question": "What are the duration of the longest and shortest pop tracks in milliseconds?",
    "sql": "SELECT max(Milliseconds) ,  min(Milliseconds) FROM GENRE AS T1 JOIN TRACK AS T2 ON T1.GenreId  =  T2.GenreId WHERE T1.Name  =  \"Pop\"",
    "table_names": [
      "Genre",
      "Track"
    ]
  },
  {
    "id": 1082,
    "db_id": "college_1",
    "question": "What is the full name of the student who received an 'A' grade in class with class code '10018'?",
    "sql": "SELECT STU_FNAME, STU_LNAME FROM STUDENT WHERE STU_NUM IN (SELECT STU_NUM FROM ENROLL WHERE CLASS_CODE = '10018' AND ENROLL_GRADE = 'A')",
    "table_names": [
      "ENROLL",
      "STUDENT"
    ]
  },
  {
    "id": 571,
    "db_id": "epinions_1",
    "question": "What are the names of items that have an average rating of at least 7?",
    "sql": "SELECT title FROM item WHERE i_id IN (SELECT i_id FROM review GROUP BY i_id HAVING AVG(rating) >= 7);",
    "table_names": [
      "item",
      "review"
    ]
  },
  {
    "id": 2035,
    "db_id": "wine_1",
    "question": "What are the distinct names of wines that have appellations in the North Coast area?",
    "sql": "SELECT DISTINCT T2.Name FROM APPELLATIONs AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation WHERE T1.Area  =  \"North Coast\"",
    "table_names": [
      "appellations",
      "wine"
    ]
  },
  {
    "id": 1891,
    "db_id": "game_1",
    "question": "What is the total number of gaming hours played by students who are on a sports scholarship?",
    "sql": "SELECT SUM(p.Hours_Played) FROM Plays_Games p JOIN SportsInfo s ON p.StuID = s.StuID WHERE s.OnScholarship = 'Y';",
    "table_names": [
      "Plays_Games",
      "SportsInfo"
    ]
  },
  {
    "id": 1416,
    "db_id": "tracking_grants_for_research",
    "question": "What is the organisation_id associated with the project having the researcher with staff_id 29?",
    "sql": "SELECT p.organisation_id FROM Projects p JOIN Project_Staff ps ON p.project_id = ps.project_id WHERE ps.staff_id = 29;",
    "table_names": [
      "Project_Staff",
      "Projects"
    ]
  },
  {
    "id": 2126,
    "db_id": "activity_1",
    "question": "What are the ids of the faculty members who do not advise any student.",
    "sql": "SELECT FacID FROM Faculty EXCEPT SELECT advisor FROM Student",
    "table_names": [
      "Student",
      "Faculty"
    ]
  },
  {
    "id": 1353,
    "db_id": "student_1",
    "question": "Find the number of students taught by the teacher KAWA GORDON.",
    "sql": "SELECT count(*) FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom WHERE T2.firstname  =  \"KAWA\" AND T2.lastname  =  \"GORDON\"",
    "table_names": [
      "list",
      "teachers"
    ]
  },
  {
    "id": 651,
    "db_id": "products_for_hire",
    "question": "Which available product in the category 'Cutlery' has the highest daily hire cost, and what is that cost?",
    "sql": "SELECT ph.product_name, ph.daily_hire_cost FROM Products_for_Hire ph JOIN View_Product_Availability vpa ON ph.product_id = vpa.product_id WHERE ph.product_type_code = 'Cutlery' AND vpa.available_yn = '1' ORDER BY ph.daily_hire_cost DESC LIMIT 1;",
    "table_names": [
      "Products_for_Hire",
      "View_Product_Availability"
    ]
  },
  {
    "id": 1087,
    "db_id": "college_1",
    "question": "What is the total number of course credits offered by departments belonging to the 'BUS' school?",
    "sql": "SELECT SUM(c.CRS_CREDIT) FROM COURSE c JOIN DEPARTMENT d ON c.DEPT_CODE = d.DEPT_CODE WHERE d.SCHOOL_CODE = 'BUS';",
    "table_names": [
      "COURSE",
      "DEPARTMENT"
    ]
  },
  {
    "id": 777,
    "db_id": "csu_1",
    "question": "What is the number of faculty lines in campus \"Long Beach State University\" in 2002?",
    "sql": "SELECT faculty FROM faculty AS T1 JOIN campuses AS T2 ON T1.campus  =  T2.id WHERE T1.year  =  2002 AND T2.campus  =  \"Long Beach State University\"",
    "table_names": [
      "Campuses",
      "faculty"
    ]
  },
  {
    "id": 94,
    "db_id": "musical",
    "question": "Who is the oldest actor appearing in a musical that won an award?",
    "sql": "SELECT a.Name FROM actor a JOIN musical m ON a.Musical_ID = m.Musical_ID WHERE m.Result = 'Won' AND a.age = (SELECT MAX(age) FROM actor WHERE Musical_ID IN (SELECT Musical_ID FROM musical WHERE Result = 'Won'));",
    "table_names": [
      "musical",
      "actor"
    ]
  },
  {
    "id": 1644,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "What is the total price of all 'photo' services delivered by workshops located in the 'RU' marketing region?",
    "sql": "SELECT SUM(s.Product_Price) FROM Services s JOIN Drama_Workshop_Groups d ON s.Workshop_Group_ID = d.Workshop_Group_ID WHERE d.Marketing_Region_Code = 'RU' AND s.Product_Name = 'photo';",
    "table_names": [
      "Drama_Workshop_Groups",
      "Services"
    ]
  },
  {
    "id": 647,
    "db_id": "products_for_hire",
    "question": "What is the average discount coupon amount received by good female customers?",
    "sql": "SELECT AVG(dc.coupon_amount) FROM Discount_Coupons dc JOIN Customers c ON dc.coupon_id = c.coupon_id WHERE c.good_or_bad_customer = 'good' AND c.gender_mf = '0';",
    "table_names": [
      "Discount_Coupons",
      "Customers"
    ]
  },
  {
    "id": 2043,
    "db_id": "wine_1",
    "question": "Find the white grape used to produce wines with scores above 90.",
    "sql": "SELECT DISTINCT T1.Grape FROM GRAPES AS T1 JOIN WINE AS T2 ON T1.Grape  =  T2.Grape WHERE T1.Color  =  \"White\" AND T2.score  >  90",
    "table_names": [
      "grapes",
      "wine"
    ]
  },
  {
    "id": 2072,
    "db_id": "driving_school",
    "question": "Which staff members born before the year 2000 reside in Georgia?",
    "sql": "SELECT s.first_name, s.last_name FROM Staff s JOIN Addresses a ON s.staff_address_id = a.address_id WHERE a.state_province_county = 'Georgia' AND s.date_of_birth < '2000-01-01';",
    "table_names": [
      "Addresses",
      "Staff"
    ]
  },
  {
    "id": 969,
    "db_id": "loan_1",
    "question": "Which customer from Utah has taken an Auto loan?",
    "sql": "SELECT c.cust_name FROM customer c JOIN loan l ON c.cust_ID = l.cust_ID WHERE l.loan_type = 'Auto' AND c.state = 'Utah';",
    "table_names": [
      "customer",
      "loan"
    ]
  },
  {
    "id": 1569,
    "db_id": "local_govt_and_lot",
    "question": "How many different residents requested services and were unsatisfied, and also moved out before January 1st, 2018?",
    "sql": "SELECT COUNT(DISTINCT rs.resident_id) FROM Residents_Services rs JOIN Residents r ON rs.resident_id = r.resident_id WHERE rs.other_details = 'Unsatisfied' AND r.date_moved_out < '2018-01-01';",
    "table_names": [
      "Residents",
      "Residents_Services"
    ]
  },
  {
    "id": 2575,
    "db_id": "dog_kennels",
    "question": "What is the average cost of 'WALK' treatments provided to dogs of breed 'ESK'?",
    "sql": "SELECT AVG(T.cost_of_treatment) FROM Treatments T JOIN Dogs D ON T.dog_id = D.dog_id WHERE D.breed_code = 'ESK' AND T.treatment_type_code = 'WALK';",
    "table_names": [
      "Dogs",
      "Treatments"
    ]
  },
  {
    "id": 1978,
    "db_id": "e_government",
    "question": "Which organization's contact individuals had contact periods starting before it was officially formed, and what are the respective individual IDs?",
    "sql": "SELECT O.organization_name, OCI.individual_id FROM Organizations O JOIN Organization_Contact_Individuals OCI ON O.organization_id = OCI.organization_id WHERE OCI.date_contact_from < O.date_formed;",
    "table_names": [
      "Organizations",
      "Organization_Contact_Individuals"
    ]
  },
  {
    "id": 566,
    "db_id": "epinions_1",
    "question": "What is the average rating given by Mark for reviews ranked 5 or better?",
    "sql": "SELECT AVG(rating) FROM review WHERE u_id = (SELECT u_id FROM useracct WHERE name = 'Mark') AND rank <= 5;",
    "table_names": [
      "review",
      "useracct"
    ]
  },
  {
    "id": 922,
    "db_id": "election",
    "question": "In the year that Eliot Spitzer ran for governor, who was the delegate from district 3, and what was their committee?",
    "sql": "SELECT e.Delegate, e.Committee FROM election e INNER JOIN party p ON e.Party = p.Party_ID WHERE p.Year = 2006 AND p.Governor = 'Eliot Spitzer' AND e.District = 3;",
    "table_names": [
      "party",
      "election"
    ]
  },
  {
    "id": 388,
    "db_id": "election_representative",
    "question": "Who was the representative elected in the election with the greatest number of seats?",
    "sql": "SELECT r.Name FROM election e JOIN representative r ON e.Representative_ID = r.Representative_ID WHERE e.Seats = (SELECT MAX(Seats) FROM election);",
    "table_names": [
      "election",
      "representative"
    ]
  },
  {
    "id": 248,
    "db_id": "chinook_1",
    "question": "Count the number of tracks that are part of the rock genre.",
    "sql": "SELECT COUNT(*) FROM GENRE AS T1 JOIN TRACK AS T2 ON T1.GenreId  =  T2.GenreId WHERE T1.Name  =  \"Rock\"",
    "table_names": [
      "Genre",
      "Track"
    ]
  },
  {
    "id": 59,
    "db_id": "bike_1",
    "question": "Which trip started from the station with the largest dock count? Give me the trip id.",
    "sql": "SELECT T1.id FROM trip AS T1 JOIN station AS T2 ON T1.start_station_id  =  T2.id ORDER BY T2.dock_count DESC LIMIT 1",
    "table_names": [
      "station",
      "trip"
    ]
  },
  {
    "id": 2052,
    "db_id": "wine_1",
    "question": "Find the country of all appelations who have at most three wines.",
    "sql": "SELECT T1.County FROM APPELLATIONS AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation GROUP BY T2.Appelation HAVING count(*)  <=  3",
    "table_names": [
      "appellations",
      "wine"
    ]
  },
  {
    "id": 109,
    "db_id": "product_catalog",
    "question": "List the product names and their prices in dollars from the catalog entries that have an attribute ID 3 set as '1' and attribute ID 4 set as '0'.",
    "sql": "SELECT c.catalog_entry_name, c.price_in_dollars FROM Catalog_Contents c JOIN Catalog_Contents_Additional_Attributes ca1 ON c.catalog_entry_id = ca1.catalog_entry_id JOIN Catalog_Contents_Additional_Attributes ca2 ON c.catalog_entry_id = ca2.catalog_entry_id WHERE ca1.attribute_id = 3 AND ca1.attribute_value = '1' AND ca2.attribute_id = 4 AND ca2.attribute_value = '0';",
    "table_names": [
      "Catalog_Contents",
      "Catalog_Contents_Additional_Attributes"
    ]
  },
  {
    "id": 1641,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "What is the average product price of all 'photo' services whose service type has the parent service type code of '1'?",
    "sql": "SELECT AVG(s.Product_Price) FROM Services s JOIN Ref_Service_Types r ON s.Service_Type_Code = r.Service_Type_Code WHERE r.Parent_Service_Type_Code = '1' AND s.Product_Name = 'photo';",
    "table_names": [
      "Ref_Service_Types",
      "Services"
    ]
  },
  {
    "id": 1152,
    "db_id": "music_1",
    "question": "What are the names and durations of songs that have ratings higher than 7, are in the Bangla language, and have an mp4 file format?",
    "sql": "SELECT song.song_name,files.duration FROM song JOIN files ON song.f_id = files.f_id WHERE song.languages='bangla' AND files.formats='mp4' AND rating > 7;",
    "table_names": [
      "files",
      "song"
    ]
  },
  {
    "id": 1662,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "Show the names of all the clients with no booking.",
    "sql": "SELECT Customer_Name FROM Clients EXCEPT SELECT T2.Customer_Name FROM Bookings AS T1 JOIN Clients AS T2 ON T1.Customer_ID  =  T2.Client_ID",
    "table_names": [
      "Clients",
      "Bookings"
    ]
  },
  {
    "id": 2109,
    "db_id": "driving_school",
    "question": "How many completed lessons were taught by staff members living at staff_address_id 1?",
    "sql": "SELECT COUNT(DISTINCT l.lesson_id) FROM Lessons l JOIN Staff s ON l.staff_id = s.staff_id WHERE s.staff_address_id = 1 AND l.lesson_status_code = 'Completed';",
    "table_names": [
      "Staff",
      "Lessons"
    ]
  },
  {
    "id": 2505,
    "db_id": "orchestra",
    "question": "What is the average age of conductors who work with orchestras recorded by Decca Records?",
    "sql": "SELECT AVG(conductor.Age) FROM conductor INNER JOIN orchestra ON conductor.Conductor_ID = orchestra.Conductor_ID WHERE orchestra.Record_Company = 'Decca Records';",
    "table_names": [
      "conductor",
      "orchestra"
    ]
  },
  {
    "id": 749,
    "db_id": "entrepreneur",
    "question": "Which entrepreneurs have requested money above the average request and have a height of at least 1.85 meters?",
    "sql": "SELECT p.Name FROM entrepreneur AS e JOIN people AS p ON e.People_ID = p.People_ID WHERE e.Money_Requested > (SELECT AVG(Money_Requested) FROM entrepreneur) AND p.Height >= 1.85;",
    "table_names": [
      "entrepreneur",
      "people"
    ]
  },
  {
    "id": 108,
    "db_id": "product_catalog",
    "question": "What is the most expensive product in dollars that has an attribute with id 4 set to value 1?",
    "sql": "SELECT CC.catalog_entry_name, CC.price_in_dollars FROM Catalog_Contents CC JOIN Catalog_Contents_Additional_Attributes CCAA ON CC.catalog_entry_id = CCAA.catalog_entry_id WHERE CCAA.attribute_id = 4 AND CCAA.attribute_value = '1' ORDER BY CC.price_in_dollars DESC LIMIT 1;",
    "table_names": [
      "Catalog_Contents",
      "Catalog_Contents_Additional_Attributes"
    ]
  },
  {
    "id": 1486,
    "db_id": "solvency_ii",
    "question": "What is the average price of products that participated in events which featured 'TV Equipments'?",
    "sql": "SELECT AVG(P.Product_Price) FROM Products AS P JOIN Products_in_Events AS PE ON P.Product_ID = PE.Product_ID WHERE PE.Event_ID IN (SELECT DISTINCT Event_ID FROM Products_in_Events WHERE Product_ID IN (SELECT Product_ID FROM Products WHERE Product_Name = 'TV Equipments'));",
    "table_names": [
      "Products",
      "Products_in_Events"
    ]
  },
  {
    "id": 2047,
    "db_id": "wine_1",
    "question": "Give the neames of wines with prices below 50 and with appelations in Monterey county.",
    "sql": "SELECT T2.Name FROM APPELLATIONS AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation WHERE T1.County  =  \"Monterey\" AND T2.price  <  50",
    "table_names": [
      "appellations",
      "wine"
    ]
  },
  {
    "id": 1150,
    "db_id": "music_1",
    "question": "What are the names of songs with a rating greater than 6 from Bangladesh that have an mp4 file format?",
    "sql": "SELECT song.song_name FROM song JOIN files ON song.f_id = files.f_id WHERE files.formats = 'mp4' AND song.country = 'Bangladesh' AND song.rating > 6;",
    "table_names": [
      "files",
      "song"
    ]
  },
  {
    "id": 709,
    "db_id": "formula_1",
    "question": "What are all the different first names of the drivers who are in position as standing and won?",
    "sql": "SELECT DISTINCT T1.forename FROM drivers AS T1 JOIN driverstandings AS T2 ON T1.driverid = T2.driverid WHERE T2.position = 1 AND T2.wins = 1",
    "table_names": [
      "drivers",
      "driverStandings"
    ]
  },
  {
    "id": 2024,
    "db_id": "scientist_1",
    "question": "Which project is scientist George ODonnell assigned to?",
    "sql": "SELECT Project FROM AssignedTo WHERE Scientist = (SELECT SSN FROM Scientists WHERE Name = 'George ODonnell');",
    "table_names": [
      "Scientists",
      "AssignedTo"
    ]
  },
  {
    "id": 2291,
    "db_id": "car_1",
    "question": "Among the cars that do not have the minimum horsepower , what are the make ids and names of all those with less than 4 cylinders ?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "car_names",
      "cars_data"
    ]
  },
  {
    "id": 2063,
    "db_id": "train_station",
    "question": "Which station has the highest number of trains stopping at it, and how many trains stop there compared to the number of platforms it has?",
    "sql": "SELECT s.Name, COUNT(ts.Train_ID) AS number_of_trains, s.Number_of_Platforms FROM station s JOIN train_station ts ON s.Station_ID = ts.Station_ID GROUP BY s.Name, s.Number_of_Platforms ORDER BY number_of_trains DESC LIMIT 1;",
    "table_names": [
      "station",
      "train_station"
    ]
  },
  {
    "id": 1244,
    "db_id": "e_learning",
    "question": "How many courses are authored by male authors?",
    "sql": "SELECT COUNT(*) FROM Courses WHERE author_id IN (SELECT author_id FROM Course_Authors_and_Tutors WHERE gender_mf = '1');",
    "table_names": [
      "Course_Authors_and_Tutors",
      "Courses"
    ]
  },
  {
    "id": 2520,
    "db_id": "network_1",
    "question": "Show names of all high school students who do not have any friends.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Highschooler",
      "Friend"
    ]
  },
  {
    "id": 689,
    "db_id": "cre_Doc_Control_Systems",
    "question": "How many documents currently have a 'working' status and were shipped by Fedex?",
    "sql": "SELECT COUNT(*) FROM Documents d JOIN Ref_Shipping_Agents s ON d.shipping_agent_code = s.shipping_agent_code WHERE d.document_status_code = 'working' AND s.shipping_agent_name = 'Fedex';",
    "table_names": [
      "Ref_Shipping_Agents",
      "Documents"
    ]
  },
  {
    "id": 1810,
    "db_id": "customer_complaints",
    "question": "How many open complaints are there from customers located in Tennessee?",
    "sql": "SELECT COUNT(*) FROM Complaints c JOIN Customers cu ON c.customer_id = cu.customer_id WHERE cu.state = 'Tennessee' AND c.complaint_status_code = 'Open';",
    "table_names": [
      "Customers",
      "Complaints"
    ]
  },
  {
    "id": 74,
    "db_id": "bike_1",
    "question": "What are the zip codes that have an average mean humidity below 70 and had at least 100 trips come through there?",
    "sql": "SELECT zip_code FROM weather GROUP BY zip_code HAVING avg(mean_humidity)  <  70 INTERSECT SELECT zip_code FROM trip GROUP BY zip_code HAVING count(*)  >=  100",
    "table_names": [
      "trip",
      "weather"
    ]
  },
  {
    "id": 1369,
    "db_id": "film_rank",
    "question": "Which Paramount distributed film has the highest sum of high market estimates?",
    "sql": "SELECT f.Title, SUM(fme.High_Estimate) AS Total_High_Estimate FROM film AS f JOIN film_market_estimation AS fme ON f.Film_ID = fme.Film_ID WHERE f.Studio LIKE '%Paramount%' GROUP BY f.Title ORDER BY Total_High_Estimate DESC LIMIT 1;",
    "table_names": [
      "film",
      "film_market_estimation"
    ]
  },
  {
    "id": 744,
    "db_id": "entrepreneur",
    "question": "Which companies have entrepreneurs taller than 1.85 meters who requested more than 100,000 dollars?",
    "sql": "SELECT e.Company FROM entrepreneur e JOIN people p ON e.People_ID = p.People_ID WHERE p.Height > 1.85 AND e.Money_Requested > 100000;",
    "table_names": [
      "entrepreneur",
      "people"
    ]
  },
  {
    "id": 271,
    "db_id": "chinook_1",
    "question": "Please list the name and id of all artists that have at least 3 albums in alphabetical order.",
    "sql": "SELECT T2.Name ,  T1.ArtistId FROM ALBUM AS T1 JOIN ARTIST AS T2 ON T1.ArtistId  =  T2.ArtistID GROUP BY T1.ArtistId HAVING COUNT(*)  >=  3 ORDER BY T2.Name",
    "table_names": [
      "Album",
      "Artist"
    ]
  },
  {
    "id": 2055,
    "db_id": "wine_1",
    "question": "Which 3 wineries produce the most wines made from white grapes?",
    "sql": "SELECT T2.Winery FROM GRAPES AS T1 JOIN WINE AS T2 ON T1.GRAPE  =  T2.GRAPE WHERE T1.Color  =  \"White\" GROUP BY T2.Winery ORDER BY count(*) DESC LIMIT 3",
    "table_names": [
      "grapes",
      "wine"
    ]
  },
  {
    "id": 196,
    "db_id": "customers_card_transactions",
    "question": "List the first and last names of customers who own more than one VIP account.",
    "sql": "SELECT customer_first_name, customer_last_name FROM Customers WHERE customer_id IN (SELECT customer_id FROM Accounts WHERE other_account_details = 'VIP' GROUP BY customer_id HAVING COUNT(account_id) > 1);",
    "table_names": [
      "Accounts",
      "Customers"
    ]
  },
  {
    "id": 2116,
    "db_id": "activity_1",
    "question": "Which students are advised by Michael Goodrich? Give me their first and last names.",
    "sql": "SELECT T2.fname ,  T2.lname FROM Faculty AS T1 JOIN Student AS T2 ON T1.FacID  =  T2.advisor WHERE T1.fname  =  \"Michael\" AND T1.lname  =  \"Goodrich\"",
    "table_names": [
      "Student",
      "Faculty"
    ]
  },
  {
    "id": 508,
    "db_id": "customers_card_transactions",
    "question": "Which customer has the highest number of accounts and how many accounts do they have?",
    "sql": "SELECT c.customer_first_name, c.customer_last_name, COUNT(a.account_id) as account_count FROM Customers c JOIN Accounts a ON c.customer_id = a.customer_id GROUP BY c.customer_id ORDER BY account_count DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Accounts"
    ]
  },
  {
    "id": 903,
    "db_id": "election",
    "question": "Which county has the highest total population among counties that belong to election districts represented by delegates from party 1?",
    "sql": "SELECT county.County_name, SUM(county.Population) AS total_population FROM county JOIN election ON county.Zip_code = CONCAT('D', LPAD(election.District, 2, '0')) WHERE election.Party = 1 GROUP BY county.County_name ORDER BY total_population DESC LIMIT 1;",
    "table_names": [
      "county",
      "election"
    ]
  },
  {
    "id": 2495,
    "db_id": "world_1",
    "question": "For the countries founded before 1930, what is the total number of distinct official languages?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 1066,
    "db_id": "college_1",
    "question": "Find the last name and hire date of the professor who is in office DRE 102.",
    "sql": "SELECT T1.emp_lname ,  T1.emp_hiredate FROM employee AS T1 JOIN professor AS T2 ON T1.emp_num  =  T2.emp_num WHERE T2.prof_office  =  'DRE 102'",
    "table_names": [
      "EMPLOYEE",
      "PROFESSOR"
    ]
  },
  {
    "id": 1088,
    "db_id": "sports_competition",
    "question": "What are the names of the clubs that have players playing as 'Second Row' and scoring more than 15 points?",
    "sql": "SELECT club.name FROM club JOIN player ON club.Club_ID = player.Club_ID WHERE player.Position = 'Second Row' AND player.Points > 15;",
    "table_names": [
      "club",
      "player"
    ]
  },
  {
    "id": 1385,
    "db_id": "cre_Doc_Tracking_DB",
    "question": "How many employees working as either 'Editor' or 'Proof Reader' were born before 1985?",
    "sql": "SELECT COUNT(*) FROM Employees e JOIN Roles r ON e.Role_Code = r.Role_Code WHERE r.Role_Name IN ('Editor', 'Proof Reader') AND YEAR(e.Date_of_Birth) < 1985;",
    "table_names": [
      "Roles",
      "Employees"
    ]
  },
  {
    "id": 774,
    "db_id": "csu_1",
    "question": "How many degrees were conferred at San Jose State University in 2000?",
    "sql": "SELECT degrees FROM campuses AS T1 JOIN degrees AS T2 ON t1.id  =  t2.campus WHERE t1.campus  =  \"San Jose State University\" AND t2.year  =  2000",
    "table_names": [
      "Campuses",
      "degrees"
    ]
  },
  {
    "id": 137,
    "db_id": "allergy_1",
    "question": "How many students have both animal and food allergies?",
    "sql": "SELECT COUNT(DISTINCT ha.StuID) FROM Has_Allergy ha JOIN Allergy_Type at ON ha.Allergy = at.Allergy WHERE at.AllergyType = 'food' AND ha.StuID IN (SELECT StuID FROM Has_Allergy ha2 JOIN Allergy_Type at2 ON ha2.Allergy = at2.Allergy WHERE at2.AllergyType = 'animal');",
    "table_names": [
      "Allergy_Type",
      "Has_Allergy"
    ]
  },
  {
    "id": 1133,
    "db_id": "music_1",
    "question": "What is the average rating of songs performed by female artists from Bangladesh?",
    "sql": "SELECT AVG(s.rating) FROM song s JOIN artist a ON s.artist_name = a.artist_name WHERE a.gender = 'Female' AND a.country = 'Bangladesh';",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 993,
    "db_id": "loan_1",
    "question": "Which customer from Utah has taken an Auto loan?",
    "sql": "SELECT customer.cust_name FROM customer JOIN loan ON customer.cust_ID = loan.cust_ID WHERE loan.loan_type = 'Auto' AND customer.state = 'Utah';",
    "table_names": [
      "customer",
      "loan"
    ]
  },
  {
    "id": 279,
    "db_id": "chinook_1",
    "question": "How many artists do not have any album?",
    "sql": "SELECT count(*) FROM ARTIST WHERE artistid NOT IN(SELECT artistid FROM ALBUM)",
    "table_names": [
      "Album",
      "Artist"
    ]
  },
  {
    "id": 1909,
    "db_id": "customers_and_addresses",
    "question": "How many unique customers canceled orders that included product_id 2?",
    "sql": "SELECT COUNT(DISTINCT co.customer_id) FROM Customer_Orders co JOIN Order_Items oi ON co.order_id = oi.order_id WHERE co.order_status = 'Cancelled' AND oi.product_id = 2;",
    "table_names": [
      "Customer_Orders",
      "Order_Items"
    ]
  },
  {
    "id": 561,
    "db_id": "epinions_1",
    "question": "Which item received the highest number of reviews?",
    "sql": "SELECT item.title FROM item JOIN review ON item.i_id = review.i_id GROUP BY item.i_id ORDER BY COUNT(review.a_id) DESC LIMIT 1;",
    "table_names": [
      "item",
      "review"
    ]
  },
  {
    "id": 1741,
    "db_id": "voter_2",
    "question": "Which students live in the city with code \"NYC\" and have class senator votes in the spring election cycle? Count the numbers.",
    "sql": "SELECT count(*) FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  Class_Senator_Vote WHERE T1.city_code  =  \"NYC\" AND T2.Election_Cycle  =  \"Spring\"",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 53,
    "db_id": "bike_1",
    "question": "What is the average longitude of stations that never had bike availability more than 10?",
    "sql": "SELECT avg(long) FROM station WHERE id NOT IN (SELECT station_id FROM status GROUP BY station_id HAVING max(bikes_available)  >  10)",
    "table_names": [
      "station",
      "status"
    ]
  },
  {
    "id": 1785,
    "db_id": "swimming",
    "question": "What are the names of Australian swimmers who won in event 1?",
    "sql": "SELECT swimmer.name FROM swimmer JOIN record ON swimmer.ID = record.Swimmer_ID WHERE swimmer.Nationality = 'Australia' AND record.Result = 'Win' AND record.Event_ID = 1;",
    "table_names": [
      "swimmer",
      "record"
    ]
  },
  {
    "id": 2460,
    "db_id": "world_1",
    "question": "What region is Kabul in?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "city",
      "country"
    ]
  },
  {
    "id": 1505,
    "db_id": "college_3",
    "question": "What are the first and last names of the instructors who teach the top 3 number of courses?",
    "sql": "SELECT T2.Fname ,  T2.Lname FROM COURSE AS T1 JOIN FACULTY AS T2 ON T1.Instructor  =  T2.FacID GROUP BY T1.Instructor ORDER BY count(*) DESC LIMIT 3",
    "table_names": [
      "Faculty",
      "Course"
    ]
  },
  {
    "id": 1215,
    "db_id": "baseball_1",
    "question": "What is the total home game attendance of team Boston Red Stockings from 2000 to 2010?",
    "sql": "SELECT sum(T1.attendance) FROM home_game AS T1 JOIN team AS T2 ON T1.team_id  =  T2.team_id_br WHERE T2.name  =  'Boston Red Stockings' AND T1.year BETWEEN 2000 AND 2010;",
    "table_names": [
      "home_game",
      "team"
    ]
  },
  {
    "id": 2299,
    "db_id": "flight_2",
    "question": "How many flights fly from Aberdeen to Ashley?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "airports",
      "flights"
    ]
  },
  {
    "id": 4,
    "db_id": "farm",
    "question": "What are the names of cities or villages with populations below 2000 that hosted farm competitions between the years 2002 and 2005?",
    "sql": "SELECT city.Official_Name FROM city JOIN farm_competition ON city.City_ID = farm_competition.Host_city_ID WHERE city.Population < 2000 AND farm_competition.Year BETWEEN 2002 AND 2005;",
    "table_names": [
      "city",
      "farm_competition"
    ]
  },
  {
    "id": 363,
    "db_id": "climbing",
    "question": "What is the name of the mountain climbed by the highest-scoring climber from the United Kingdom?",
    "sql": "SELECT m.Name FROM mountain AS m JOIN climber AS c ON m.Mountain_ID = c.Mountain_ID WHERE c.Points = (SELECT MAX(Points) FROM climber WHERE Country = 'United Kingdom');",
    "table_names": [
      "mountain",
      "climber"
    ]
  },
  {
    "id": 2585,
    "db_id": "singer",
    "question": "What is the average net worth of singers who have songs with sales above 300,000 and that reached number one position?",
    "sql": "SELECT AVG(s.Net_Worth_Millions) FROM singer s JOIN song so ON s.Singer_ID = so.Singer_ID WHERE so.Sales > 300000 AND so.Highest_Position = 1;",
    "table_names": [
      "singer",
      "song"
    ]
  },
  {
    "id": 863,
    "db_id": "inn_1",
    "question": "Find the first and last names of people who payed more than the rooms' base prices.",
    "sql": "SELECT T1.firstname ,  T1.lastname FROM Reservations AS T1 JOIN Rooms AS T2 ON T1.Room  =  T2.RoomId WHERE T1.Rate - T2.basePrice  >  0",
    "table_names": [
      "Rooms",
      "Reservations"
    ]
  },
  {
    "id": 2396,
    "db_id": "student_transcripts_tracking",
    "question": "What are the names and email addresses of students who are enrolled in degree program number 9 and have their permanent address with the address ID 5?",
    "sql": "SELECT Students.first_name, Students.last_name, Students.email_address FROM Students JOIN Student_Enrolment ON Students.student_id = Student_Enrolment.student_id WHERE Student_Enrolment.degree_program_id = 9 AND Students.permanent_address_id = 5;",
    "table_names": [
      "Students",
      "Student_Enrolment"
    ]
  },
  {
    "id": 2111,
    "db_id": "activity_1",
    "question": "What are the first name and last name of Linda Smith's advisor?",
    "sql": "SELECT T1.fname ,  T1.lname FROM Faculty AS T1 JOIN Student AS T2 ON T1.FacID  =  T2.advisor WHERE T2.fname  =  \"Linda\" AND T2.lname  =  \"Smith\"",
    "table_names": [
      "Student",
      "Faculty"
    ]
  },
  {
    "id": 1164,
    "db_id": "music_1",
    "question": "List the names of female artists from Bangladesh who have songs with ratings higher than 6.",
    "sql": "SELECT artist.artist_name FROM artist JOIN song ON artist.artist_name = song.artist_name WHERE artist.country = 'Bangladesh' AND song.rating > 6 AND artist.gender = 'Female';",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1072,
    "db_id": "college_1",
    "question": "Which business department has the highest average GPA among students?",
    "sql": "SELECT D.DEPT_NAME, AVG(S.STU_GPA) AS AVG_GPA FROM DEPARTMENT D JOIN STUDENT S ON D.DEPT_CODE = S.DEPT_CODE WHERE D.SCHOOL_CODE = 'BUS' GROUP BY D.DEPT_NAME ORDER BY AVG_GPA DESC LIMIT 1;",
    "table_names": [
      "DEPARTMENT",
      "STUDENT"
    ]
  },
  {
    "id": 1046,
    "db_id": "college_1",
    "question": "Which school has the smallest amount of professors?",
    "sql": "SELECT T1.school_code FROM department AS T1 JOIN professor AS T2 ON T1.dept_code  =  T2.dept_code GROUP BY T1.school_code ORDER BY count(*) LIMIT 1",
    "table_names": [
      "DEPARTMENT",
      "PROFESSOR"
    ]
  },
  {
    "id": 1460,
    "db_id": "network_2",
    "question": "What is the average age of the friends of 'Zach'?",
    "sql": "SELECT AVG(p.age) FROM Person p JOIN PersonFriend pf ON p.name = pf.friend WHERE pf.name = 'Zach';",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 2178,
    "db_id": "flight_4",
    "question": "What is the name of the airline with the most routes?",
    "sql": "SELECT T1.name FROM airlines AS T1 JOIN routes AS T2 ON T1.alid  =  T2.alid GROUP BY T1.name ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "routes",
      "airlines"
    ]
  },
  {
    "id": 148,
    "db_id": "tracking_orders",
    "question": "Which customer from Germany has the highest total spending amount? Provide their first name, last name, and the total spent.",
    "sql": "SELECT customers.first_name, customers.last_name, SUM(invoices.total) AS total_spent FROM customers JOIN invoices ON customers.id = invoices.customer_id WHERE customers.country = 'Germany' GROUP BY customers.first_name, customers.last_name ORDER BY total_spent DESC LIMIT 1;",
    "table_names": [
      "customers",
      "invoices"
    ]
  },
  {
    "id": 1461,
    "db_id": "network_2",
    "question": "What is the average friendship duration of relationships where the person is a doctor and their friend is a student?",
    "sql": "SELECT AVG(pf.year) FROM PersonFriend pf JOIN Person p1 ON pf.name = p1.name JOIN Person p2 ON pf.friend = p2.name WHERE p1.job = 'doctor' AND p2.job = 'student';",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1604,
    "db_id": "soccer_2",
    "question": "Which player with a high school score greater than 1000 was accepted as a goalie during tryouts?",
    "sql": "SELECT p.pName FROM Player p INNER JOIN Tryout t ON p.pID = t.pID WHERE p.HS > 1000 AND t.decision = 'yes' AND t.pPos = 'goalie';",
    "table_names": [
      "Player",
      "Tryout"
    ]
  },
  {
    "id": 1173,
    "db_id": "music_1",
    "question": "Which songs have file sizes larger than 4.00 MB and ratings higher than 7?",
    "sql": "SELECT song.song_name FROM song INNER JOIN files ON song.f_id = files.f_id WHERE files.file_size > '4.00 MB' AND song.rating > 7;",
    "table_names": [
      "files",
      "song"
    ]
  },
  {
    "id": 2037,
    "db_id": "wine_1",
    "question": "What is the average price of wines produced in appelations in Sonoma County?",
    "sql": "SELECT AVG(T2.Price) FROM APPELLATIONS AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation WHERE T1.County  =  \"Sonoma\"",
    "table_names": [
      "appellations",
      "wine"
    ]
  },
  {
    "id": 84,
    "db_id": "book_2",
    "question": "What is the total price of all books with at least 5 issues that were not published by Wiley?",
    "sql": "SELECT SUM(publication.Price) FROM publication INNER JOIN book ON publication.Book_ID = book.Book_ID WHERE book.Issues >= 5 AND publication.Publisher != 'Wiley';",
    "table_names": [
      "publication",
      "book"
    ]
  },
  {
    "id": 11,
    "db_id": "farm",
    "question": "What is the Official Name of the city that hosted the farm competition with the theme 'MTV Cube'?",
    "sql": "SELECT city.Official_Name FROM city JOIN farm_competition ON city.City_ID = farm_competition.Host_city_ID WHERE farm_competition.Year = 2003;",
    "table_names": [
      "city",
      "farm_competition"
    ]
  },
  {
    "id": 2131,
    "db_id": "activity_1",
    "question": "How many activities does Mark Giuliano participate in?",
    "sql": "SELECT count(*) FROM Faculty AS T1 JOIN Faculty_participates_in AS T2 ON T1.facID  =  T2.facID WHERE T1.fname  =  \"Mark\" AND T1.lname  =  \"Giuliano\"",
    "table_names": [
      "Faculty_Participates_in",
      "Faculty"
    ]
  },
  {
    "id": 1711,
    "db_id": "shop_membership",
    "question": "Which branches located in Oxford had new membership registrations in the year 2016?",
    "sql": "SELECT b.Name FROM branch b JOIN membership_register_branch mrb ON b.Branch_ID = mrb.Branch_ID WHERE mrb.Register_Year = '2016' AND b.City = 'Oxford';",
    "table_names": [
      "branch",
      "membership_register_branch"
    ]
  },
  {
    "id": 620,
    "db_id": "wrestler",
    "question": "Which wrestler from Tokyo, Japan was eliminated using the Silver Spoon DDT?",
    "sql": "SELECT wrestler.Name FROM wrestler JOIN Elimination ON wrestler.Wrestler_ID = Elimination.Wrestler_ID WHERE wrestler.Location = 'Tokyo , Japan' AND Elimination.Elimination_Move = 'Silver Spoon DDT';",
    "table_names": [
      "wrestler",
      "Elimination"
    ]
  },
  {
    "id": 1218,
    "db_id": "baseball_1",
    "question": "Compute the total salary that the player with first name Len and last name Barker received between 1985 to 1990.",
    "sql": "SELECT sum(T1.salary) FROM salary AS T1 JOIN player AS T2 ON T1.player_id = T2.player_id WHERE T2.name_first  =  'Len' AND T2.name_last = 'Barker' AND T1.year BETWEEN 1985 AND 1990;",
    "table_names": [
      "player",
      "salary"
    ]
  },
  {
    "id": 1551,
    "db_id": "department_store",
    "question": "Who was assigned as a Clerical Staff to department 5 before the year 2017?",
    "sql": "SELECT s.staff_name FROM Staff s JOIN Staff_Department_Assignments a ON s.staff_id = a.staff_id WHERE a.department_id = 5 AND a.job_title_code = 'Clerical Staff' AND a.date_assigned_from < '2017-01-01';",
    "table_names": [
      "Staff",
      "Staff_Department_Assignments"
    ]
  },
  {
    "id": 2395,
    "db_id": "student_transcripts_tracking",
    "question": "How many unique students enrolled in degree program id 9 during all the spring semesters?",
    "sql": "SELECT COUNT(DISTINCT SE.student_id) FROM Student_Enrolment SE JOIN Semesters S ON SE.semester_id = S.semester_id WHERE S.semester_name LIKE '%spring%' AND SE.degree_program_id = 9;",
    "table_names": [
      "Semesters",
      "Student_Enrolment"
    ]
  },
  {
    "id": 498,
    "db_id": "insurance_and_eClaims",
    "question": "Which customers have more than one distinct type of policy?",
    "sql": "SELECT Customer_Details FROM Customers WHERE Customer_ID IN (SELECT Customer_ID FROM Policies GROUP BY Customer_ID HAVING COUNT(DISTINCT Policy_Type_Code) > 1);",
    "table_names": [
      "Customers",
      "Policies"
    ]
  },
  {
    "id": 135,
    "db_id": "allergy_1",
    "question": "List the unique first and last names of students who are allergic to nuts and are younger than 20.",
    "sql": "SELECT DISTINCT s.Fname, s.LName FROM Student s INNER JOIN Has_Allergy a ON s.StuID = a.StuID WHERE a.Allergy = 'Nuts' AND s.Age < 20;",
    "table_names": [
      "Has_Allergy",
      "Student"
    ]
  },
  {
    "id": 433,
    "db_id": "soccer_1",
    "question": "List the names of all players who have a crossing score higher than 90 and prefer their right foot.",
    "sql": "SELECT DISTINCT T1.player_name FROM Player AS T1 JOIN Player_Attributes AS T2 ON T1.player_api_id = T2.player_api_id WHERE T2.crossing  >  90 AND T2.preferred_foot  =  \"right\"",
    "table_names": [
      "Player_Attributes",
      "Player"
    ]
  },
  {
    "id": 558,
    "db_id": "epinions_1",
    "question": "What item received the highest rating from user with id 2?",
    "sql": "SELECT item.title FROM item JOIN review ON item.i_id = review.i_id WHERE review.rating = (SELECT MAX(rating) FROM review WHERE u_id = 2);",
    "table_names": [
      "item",
      "review"
    ]
  },
  {
    "id": 1497,
    "db_id": "customers_campaigns_ecommerce",
    "question": "What is the residential shipping address for customer ID 11?",
    "sql": "SELECT premises.premise_details FROM Premises premises JOIN Customer_Addresses ca ON premises.premise_id = ca.premise_id WHERE ca.customer_id = 11 AND ca.address_type_code = 'Shipping' AND premises.premises_type = 'Residence';",
    "table_names": [
      "Premises",
      "Customer_Addresses"
    ]
  },
  {
    "id": 755,
    "db_id": "perpetrator",
    "question": "What is the name and the country of the perpetrator who had killed at least 30 people and has a height of at least 6.5 feet?",
    "sql": "SELECT people.Name, perpetrator.Country FROM perpetrator JOIN people ON perpetrator.People_ID = people.People_ID WHERE perpetrator.Killed >= 30 AND people.Height >= 6.5;",
    "table_names": [
      "perpetrator",
      "people"
    ]
  },
  {
    "id": 2308,
    "db_id": "flight_2",
    "question": "Find the abbreviation and country of the airline that has fewest number of flights?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "airlines",
      "flights"
    ]
  },
  {
    "id": 2228,
    "db_id": "concert_singer",
    "question": "What is the name of the stadium that hosted the concert with the theme 'Bleeding Love'?",
    "sql": "SELECT stadium.Name FROM stadium JOIN concert ON stadium.Stadium_ID = concert.Stadium_ID WHERE concert.Theme = 'Bleeding Love';",
    "table_names": [
      "stadium",
      "concert"
    ]
  },
  {
    "id": 2094,
    "db_id": "driving_school",
    "question": "Which 'Bad Customer' has made the largest total payments, and what is the total payment amount?",
    "sql": "SELECT c.first_name, c.last_name, SUM(cp.amount_payment) AS total_payments FROM Customers c JOIN Customer_Payments cp ON c.customer_id = cp.customer_id WHERE c.customer_status_code = 'Bad Customer' GROUP BY c.customer_id ORDER BY total_payments DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Customer_Payments"
    ]
  },
  {
    "id": 1126,
    "db_id": "music_1",
    "question": "List the songs performed by female artists with a rating higher than 6 and a resolution of at least 320.",
    "sql": "SELECT s.song_name FROM song s JOIN artist a ON s.artist_name = a.artist_name WHERE a.gender = 'Female' AND s.rating > 6 AND s.resolution >= 320;",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1981,
    "db_id": "school_bus",
    "question": "What is the average age of Democratic drivers who work full-time?",
    "sql": "SELECT AVG(driver.Age) FROM driver JOIN school_bus ON driver.Driver_ID = school_bus.Driver_ID WHERE school_bus.If_full_time = 'T' AND driver.Party = 'Dem';",
    "table_names": [
      "driver",
      "school_bus"
    ]
  },
  {
    "id": 2555,
    "db_id": "dog_kennels",
    "question": "What is the total cost of treatments performed by veterinarians located in Mississippi?",
    "sql": "SELECT SUM(cost_of_treatment) FROM Treatments WHERE professional_id IN (SELECT professional_id FROM Professionals WHERE role_code = 'Veterenarian' AND state='Mississippi');",
    "table_names": [
      "Professionals",
      "Treatments"
    ]
  },
  {
    "id": 87,
    "db_id": "musical",
    "question": "Which musical that won an award featured the actor with the highest age?",
    "sql": "SELECT m.Name FROM musical m JOIN actor a ON m.Musical_ID = a.Musical_ID WHERE a.age = (SELECT MAX(age) FROM actor) AND m.Result = 'Won';",
    "table_names": [
      "musical",
      "actor"
    ]
  },
  {
    "id": 110,
    "db_id": "product_catalog",
    "question": "What is the average price in dollars of products whose parent entries are sub-categories priced above 700 dollars?",
    "sql": "SELECT AVG(price_in_dollars) FROM Catalog_Contents WHERE catalog_level_number = (SELECT catalog_level_number FROM Catalog_Structure WHERE catalog_level_name = 'Product') AND parent_entry_id IN (SELECT catalog_entry_id FROM Catalog_Contents WHERE catalog_level_number = (SELECT catalog_level_number FROM Catalog_Structure WHERE catalog_level_name = 'Sub-Category') AND price_in_dollars > 700)",
    "table_names": [
      "Catalog_Structure",
      "Catalog_Contents"
    ]
  },
  {
    "id": 166,
    "db_id": "store_1",
    "question": "Who are the employees with the title 'Sales Support Agent' who serve customers located in Germany?",
    "sql": "SELECT e.first_name || ' ' || e.last_name FROM employees e JOIN customers c ON e.id = c.support_rep_id WHERE c.country = 'Germany' AND e.title = 'Sales Support Agent';",
    "table_names": [
      "employees",
      "customers"
    ]
  },
  {
    "id": 1858,
    "db_id": "cre_Theme_park",
    "question": "Find the visit date and details of the tourist whose detail is 'Vincent'",
    "sql": "SELECT T2.Visit_Date ,  T2.Visit_Details FROM VISITORS AS T1 JOIN VISITS AS T2 ON T1.Tourist_ID  =  T2.Tourist_ID WHERE T1.Tourist_Details  =  \"Vincent\"",
    "table_names": [
      "Visitors",
      "Visits"
    ]
  },
  {
    "id": 456,
    "db_id": "college_2",
    "question": "Find the name of the courses that do not have any prerequisite?",
    "sql": "SELECT title FROM course WHERE course_id NOT IN (SELECT course_id FROM prereq)",
    "table_names": [
      "course",
      "prereq"
    ]
  },
  {
    "id": 1534,
    "db_id": "customers_and_addresses",
    "question": "Can you provide the names and email addresses of customers whose orders were cancelled during February 2018?",
    "sql": "SELECT customer_name, customer_email FROM Customers WHERE customer_id IN (SELECT customer_id FROM Customer_Orders WHERE order_status_code = 'Cancelled' AND order_date BETWEEN '2018-02-01' AND '2018-03-01');",
    "table_names": [
      "Customers",
      "Customer_Orders"
    ]
  },
  {
    "id": 2378,
    "db_id": "wta_1",
    "question": "Find the total ranking points for each player and their first name.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "players",
      "rankings"
    ]
  },
  {
    "id": 944,
    "db_id": "world_1",
    "question": "Count the number of cities in Australia.",
    "sql": "SELECT count(*) FROM city AS T1 JOIN country AS T2 ON T1.country_id  =  T2.country_id WHERE T2.country  =  'Australia'",
    "table_names": [
      "city",
      "country"
    ]
  },
  {
    "id": 1729,
    "db_id": "voter_2",
    "question": "What are the distinct ages of students who have secretary votes in the fall election cycle?",
    "sql": "SELECT DISTINCT T1.Age FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  T2.Secretary_Vote WHERE T2.Election_Cycle  =  \"Fall\"",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 979,
    "db_id": "loan_1",
    "question": "What is the total sum of loan amounts from all bank branches located in the state of New York?",
    "sql": "SELECT SUM(loan.amount) FROM loan JOIN bank ON loan.branch_ID = bank.branch_ID WHERE bank.state = 'New York';",
    "table_names": [
      "bank",
      "loan"
    ]
  },
  {
    "id": 376,
    "db_id": "body_builder",
    "question": "Who among body builders born in Michigan achieved the highest total score, and what was that total?",
    "sql": "SELECT people.Name, body_builder.Total FROM people JOIN body_builder ON people.People_ID = body_builder.People_ID WHERE people.Birth_Place LIKE '%Michigan%' ORDER BY body_builder.Total DESC LIMIT 1;",
    "table_names": [
      "body_builder",
      "people"
    ]
  },
  {
    "id": 1212,
    "db_id": "baseball_1",
    "question": "Count the number of games taken place in park \"Columbia Park\" in 1907.",
    "sql": "SELECT count(*) FROM home_game AS T1 JOIN park AS T2 ON T1.park_id  =  T2.park_id WHERE T1.year = 1907 AND T2.park_name = 'Columbia Park';",
    "table_names": [
      "home_game",
      "park"
    ]
  },
  {
    "id": 2167,
    "db_id": "flight_4",
    "question": "For each country and airline name, how many routes are there?",
    "sql": "SELECT T1.country ,  T1.name ,  count(*) FROM airlines AS T1 JOIN routes AS T2 ON T1.alid  =  T2.alid GROUP BY T1.country ,  T1.name",
    "table_names": [
      "routes",
      "airlines"
    ]
  },
  {
    "id": 608,
    "db_id": "small_bank_1",
    "question": "Which customers have savings account balances lower than the average balance in all saving accounts?",
    "sql": "SELECT a.name FROM ACCOUNTS a INNER JOIN SAVINGS s ON a.custid = s.custid WHERE s.balance < (SELECT AVG(balance) FROM SAVINGS);",
    "table_names": [
      "ACCOUNTS",
      "SAVINGS"
    ]
  },
  {
    "id": 953,
    "db_id": "sakila_1",
    "question": "Which customer, who has made at least one payment, has spent the least money? List his or her first name, last name, and the id.",
    "sql": "SELECT T1.first_name ,  T1.last_name ,  T1.customer_id FROM customer AS T1 JOIN payment AS T2 ON T1.customer_id  =  T2.customer_id GROUP BY T1.customer_id ORDER BY sum(amount) ASC LIMIT 1",
    "table_names": [
      "customer",
      "payment"
    ]
  },
  {
    "id": 2418,
    "db_id": "student_assessment",
    "question": "What is the first and last name of students whose permanent addresses are located in Haiti, and what city in Haiti are they located in?",
    "sql": "SELECT s.first_name, s.last_name, a.city, a.country FROM Students s JOIN Addresses a ON s.permanent_address_id = a.address_id WHERE a.country = 'Haiti';",
    "table_names": [
      "Addresses",
      "Students"
    ]
  },
  {
    "id": 1690,
    "db_id": "tracking_software_problems",
    "question": "Which product has the highest number of reported problems?",
    "sql": "SELECT p.product_name, COUNT(pr.problem_id) AS total_problems FROM Product p JOIN Problems pr ON p.product_id = pr.product_id GROUP BY p.product_id ORDER BY total_problems DESC LIMIT 1;",
    "table_names": [
      "Product",
      "Problems"
    ]
  },
  {
    "id": 736,
    "db_id": "entrepreneur",
    "question": "Which entrepreneur with a height greater than 1.85 meters requested the highest amount of money, and what is the company name?",
    "sql": "SELECT p.Name, e.Company, e.Money_Requested FROM entrepreneur e JOIN people p ON e.People_ID = p.People_ID WHERE p.Height > 1.85 ORDER BY e.Money_Requested DESC LIMIT 1;",
    "table_names": [
      "entrepreneur",
      "people"
    ]
  },
  {
    "id": 1002,
    "db_id": "behavior_monitoring",
    "question": "What is the detention ID and start datetime of the most recent lunch-time detention?",
    "sql": "SELECT dt.detention_id, dt.datetime_detention_start FROM Detention dt JOIN Ref_Detention_Type rdt ON dt.detention_type_code = rdt.detention_type_code WHERE rdt.detention_type_description = 'Lunch-time' ORDER BY dt.datetime_detention_start DESC LIMIT 1;",
    "table_names": [
      "Ref_Detention_Type",
      "Detention"
    ]
  },
  {
    "id": 213,
    "db_id": "customers_card_transactions",
    "question": "List the email addresses of customers who hold both a Debit and a Credit card.",
    "sql": "SELECT customer_email FROM Customers WHERE customer_id IN (SELECT customer_id FROM Customers_Cards WHERE card_type_code = 'Credit') AND customer_id IN (SELECT customer_id FROM Customers_Cards WHERE card_type_code = 'Debit');",
    "table_names": [
      "Customers",
      "Customers_Cards"
    ]
  },
  {
    "id": 2414,
    "db_id": "student_transcripts_tracking",
    "question": "How many unique student course IDs were involved in transcripts recorded between the years 1980 and 1990 inclusive?",
    "sql": "SELECT COUNT(DISTINCT tc.student_course_id) FROM Transcripts t JOIN Transcript_Contents tc ON t.transcript_id = tc.transcript_id WHERE YEAR(t.transcript_date) BETWEEN 1980 AND 1990;",
    "table_names": [
      "Transcripts",
      "Transcript_Contents"
    ]
  },
  {
    "id": 1341,
    "db_id": "ship_mission",
    "question": "What was the mission code of the mission involving a ship classified as a British battle ship that launched before 1930 and had a speed of less than 20 knots?",
    "sql": "SELECT m.Code FROM mission m JOIN ship s ON m.Ship_ID = s.Ship_ID WHERE s.Type = 'Battle ship' AND s.Nationality = 'United Kingdom' AND m.Launched_Year < 1930 AND m.Speed_knots < 20;",
    "table_names": [
      "mission",
      "ship"
    ]
  },
  {
    "id": 2504,
    "db_id": "orchestra",
    "question": "Which conductors have worked more than 15 years and conducted orchestras whose major record format is CD?",
    "sql": "SELECT c.Name FROM conductor c JOIN orchestra o ON c.Conductor_ID = o.Conductor_ID WHERE c.Year_of_Work > 15 AND o.Major_Record_Format = 'CD';",
    "table_names": [
      "conductor",
      "orchestra"
    ]
  },
  {
    "id": 142,
    "db_id": "allergy_1",
    "question": "How many distinct students from PIT city have an allergy to either Shellfish or Nuts?",
    "sql": "SELECT COUNT(DISTINCT Has_Allergy.StuID) FROM Has_Allergy JOIN Student ON Has_Allergy.StuID = Student.StuID WHERE Student.city_code = 'PIT' AND Has_Allergy.Allergy IN ('Shellfish', 'Nuts');",
    "table_names": [
      "Has_Allergy",
      "Student"
    ]
  },
  {
    "id": 1758,
    "db_id": "products_gen_characteristics",
    "question": "What are the names of seed products with a selling price greater than 50000 and color blue?",
    "sql": "SELECT Products.product_name FROM Products INNER JOIN Ref_Colors ON Products.color_code = Ref_Colors.color_code WHERE Ref_Colors.color_description = 'blue' AND Products.product_category_code = 'Seeds' AND Products.typical_selling_price > 50000;",
    "table_names": [
      "Ref_Colors",
      "Products"
    ]
  },
  {
    "id": 542,
    "db_id": "theme_gallery",
    "question": "What is the average ticket price of exhibitions created by artists from the United States who are older than 45?",
    "sql": "SELECT AVG(e.Ticket_Price) FROM exhibition e JOIN artist a ON e.Artist_ID = a.Artist_ID WHERE a.Country = 'United States' AND a.Age > 45;",
    "table_names": [
      "artist",
      "exhibition"
    ]
  },
  {
    "id": 2218,
    "db_id": "architecture",
    "question": "Which male architect designed the highest number of bridges?",
    "sql": "SELECT architect.name, COUNT(bridge.id) FROM architect JOIN bridge ON architect.id = bridge.architect_id WHERE architect.gender = 'male' GROUP BY architect.id ORDER BY COUNT(bridge.id) DESC LIMIT 1;",
    "table_names": [
      "architect",
      "bridge"
    ]
  },
  {
    "id": 1216,
    "db_id": "baseball_1",
    "question": "How many games in total did team Boston Red Stockings attend from 2000 to 2010?",
    "sql": "SELECT sum(T1.attendance) FROM home_game AS T1 JOIN team AS T2 ON T1.team_id  =  T2.team_id_br WHERE T2.name  =  'Boston Red Stockings' AND T1.year BETWEEN 2000 AND 2010;",
    "table_names": [
      "home_game",
      "team"
    ]
  },
  {
    "id": 1504,
    "db_id": "college_3",
    "question": "What is the name of the department with the fewest members?",
    "sql": "SELECT T1.DName FROM DEPARTMENT AS T1 JOIN MEMBER_OF AS T2 ON T1.DNO  =  T2.DNO GROUP BY T2.DNO ORDER BY count(*) ASC LIMIT 1",
    "table_names": [
      "Department",
      "Member_of"
    ]
  },
  {
    "id": 1853,
    "db_id": "cre_Theme_park",
    "question": "What is the name of the staff that is in charge of the attraction named \"US museum\"?",
    "sql": "SELECT T1.Name FROM STAFF AS T1 JOIN TOURIST_ATTRACTIONS AS T2 ON T1.Tourist_Attraction_ID  =  T2.Tourist_Attraction_ID WHERE T2.Name  =  \"US museum\"",
    "table_names": [
      "Tourist_Attractions",
      "Staff"
    ]
  },
  {
    "id": 496,
    "db_id": "customer_complaints",
    "question": "List the Customer_ID and Customer_Details of all customers whose Customer_ID is greater than the Staff_ID of staff member 'Margaretta'.",
    "sql": "SELECT Customer_ID, Customer_Details FROM Customers WHERE Customer_ID > (SELECT Staff_ID FROM Staff WHERE Staff_Details = 'Margaretta');",
    "table_names": [
      "Customers",
      "Staff"
    ]
  },
  {
    "id": 623,
    "db_id": "wrestler",
    "question": "Name the wrestler who was eliminated by Batista and has held the wrestling title more than once.",
    "sql": "SELECT wrestler.Name FROM wrestler INNER JOIN Elimination ON wrestler.Wrestler_ID = Elimination.Wrestler_ID WHERE Elimination.Eliminated_By = 'Batista' AND wrestler.Reign > 1;",
    "table_names": [
      "wrestler",
      "Elimination"
    ]
  },
  {
    "id": 1646,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "What is the total price of all 'photo' products offered by drama workshops located in the marketing region 'RU'?",
    "sql": "SELECT SUM(S.Product_Price) FROM Services S JOIN Drama_Workshop_Groups DWG ON S.Workshop_Group_ID = DWG.Workshop_Group_ID WHERE DWG.Marketing_Region_Code = 'RU' AND S.Product_Name = 'photo';",
    "table_names": [
      "Drama_Workshop_Groups",
      "Services"
    ]
  },
  {
    "id": 205,
    "db_id": "customers_card_transactions",
    "question": "Which customer has the highest number of credit cards, and how many credit cards does this customer have?",
    "sql": "SELECT c.customer_first_name, c.customer_last_name, COUNT(cc.card_id) AS total_cards FROM Customers c JOIN Customers_Cards cc ON c.customer_id = cc.customer_id WHERE cc.card_type_code = 'Credit' GROUP BY c.customer_first_name, c.customer_last_name ORDER BY total_cards DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Customers_Cards"
    ]
  },
  {
    "id": 2057,
    "db_id": "wine_1",
    "question": "What are the appelations for wines produced after 2008 but not in the Central Coast area?",
    "sql": "SELECT Appelation FROM WINE WHERE YEAR  >  2008 EXCEPT SELECT Appelation FROM APPELLATIONS WHERE Area  =  \"Central Coast\"",
    "table_names": [
      "appellations",
      "wine"
    ]
  },
  {
    "id": 2245,
    "db_id": "pets_1",
    "question": "What are the different first names and ages of the students who do have pets?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Student",
      "Has_Pet"
    ]
  },
  {
    "id": 246,
    "db_id": "chinook_1",
    "question": "What are the titles and ids for albums containing tracks with unit price greater than 1?",
    "sql": "SELECT T1.Title ,  T2.AlbumID FROM ALBUM AS T1 JOIN TRACK AS T2 ON T1.AlbumId  =  T2.AlbumId WHERE T2.UnitPrice  >  1 GROUP BY T2.AlbumID",
    "table_names": [
      "Album",
      "Track"
    ]
  },
  {
    "id": 1327,
    "db_id": "hospital_1",
    "question": "Who was the patient that underwent a procedure performed by Physician 3 on May 2, 2008?",
    "sql": "SELECT Patient.Name FROM Patient INNER JOIN Undergoes ON Patient.SSN = Undergoes.Patient WHERE Undergoes.Physician = 3 AND Undergoes.DateUndergoes = '2008-05-02';",
    "table_names": [
      "Patient",
      "Undergoes"
    ]
  },
  {
    "id": 1495,
    "db_id": "customers_campaigns_ecommerce",
    "question": "How many unique customers paying by 'Direct Debit' placed an order in March 2018?",
    "sql": "SELECT COUNT(DISTINCT c.customer_id) FROM Customers c INNER JOIN Mailshot_Customers m ON c.customer_id = m.customer_id WHERE c.payment_method = 'Direct Debit' AND m.outcome_code = 'Order' AND m.mailshot_customer_date BETWEEN '2018-03-01' AND '2018-03-31';",
    "table_names": [
      "Customers",
      "Mailshot_Customers"
    ]
  },
  {
    "id": 876,
    "db_id": "local_govt_mdm",
    "question": "What is the tax source system code related to the benefits and overpayments? List the code and the benifit id, order by benifit id.",
    "sql": "SELECT T1.source_system_code ,  T2.council_tax_id FROM CMI_Cross_References AS T1 JOIN Benefits_Overpayments AS T2 ON T1.cmi_cross_ref_id  =  T2.cmi_cross_ref_id ORDER BY T2.council_tax_id",
    "table_names": [
      "CMI_Cross_References",
      "Benefits_Overpayments"
    ]
  },
  {
    "id": 201,
    "db_id": "customers_card_transactions",
    "question": "What are the names and email addresses of customers who live in Kentucky and hold VIP accounts?",
    "sql": "SELECT Customers.customer_first_name, Customers.customer_last_name, Customers.customer_email FROM Customers JOIN Accounts ON Customers.customer_id = Accounts.customer_id WHERE Accounts.other_account_details = 'VIP' AND Customers.customer_address LIKE '%KY%'",
    "table_names": [
      "Accounts",
      "Customers"
    ]
  },
  {
    "id": 1635,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "Find the states or counties where the stores with marketing region code \"CA\" are located.",
    "sql": "SELECT T1.State_County FROM Addresses AS T1 JOIN Stores AS T2 ON T1.Address_ID  =  T2.Address_ID WHERE T2.Marketing_Region_Code  =  \"CA\"",
    "table_names": [
      "Addresses",
      "Stores"
    ]
  },
  {
    "id": 1031,
    "db_id": "station_weather",
    "question": "Which trains have routes covering more than two stations?",
    "sql": "SELECT name FROM train WHERE id IN (SELECT train_id FROM route GROUP BY train_id HAVING COUNT(station_id) > 2);",
    "table_names": [
      "train",
      "route"
    ]
  },
  {
    "id": 2383,
    "db_id": "battle_death",
    "question": "What is the name of the ship that sank in a battle commanded by Bulgarian commander Kaloyan?",
    "sql": "SELECT ship.name FROM ship JOIN battle ON ship.lost_in_battle = battle.id WHERE battle.bulgarian_commander = 'Kaloyan' AND ship.disposition_of_ship = 'Sank';",
    "table_names": [
      "battle",
      "ship"
    ]
  },
  {
    "id": 1467,
    "db_id": "decoration_competition",
    "question": "Which colleges have multiple members from Canada?",
    "sql": "SELECT college.Name FROM college JOIN member ON college.College_ID = member.College_ID WHERE member.Country = 'Canada' GROUP BY college.Name HAVING COUNT(*) > 1;",
    "table_names": [
      "college",
      "member"
    ]
  },
  {
    "id": 1412,
    "db_id": "tracking_grants_for_research",
    "question": "What are the details of the research staff members who are employed by organisations of type 'SPON'?",
    "sql": "SELECT rs.staff_details FROM Research_Staff rs JOIN Organisations o ON rs.employer_organisation_id = o.organisation_id WHERE o.organisation_type = 'SPON';",
    "table_names": [
      "Organisations",
      "Research_Staff"
    ]
  },
  {
    "id": 1029,
    "db_id": "assets_maintenance",
    "question": "How many unique engineers have performed visits with a 'Return' fault status where the contact staff member was a manager?",
    "sql": "SELECT COUNT(DISTINCT ev.engineer_id) FROM Engineer_Visits ev JOIN Staff s ON ev.contact_staff_id = s.staff_id WHERE s.other_staff_details = 'Manager' AND ev.fault_status = 'Return';",
    "table_names": [
      "Staff",
      "Engineer_Visits"
    ]
  },
  {
    "id": 301,
    "db_id": "medicine_enzyme_interaction",
    "question": "Which medicines have an 'activitor' interaction type with enzymes and are FDA approved?",
    "sql": "SELECT m.name FROM medicine m JOIN medicine_enzyme_interaction mei ON m.id = mei.medicine_id WHERE mei.interaction_type = 'activitor' AND m.FDA_approved = 'Yes';",
    "table_names": [
      "medicine",
      "medicine_enzyme_interaction"
    ]
  },
  {
    "id": 940,
    "db_id": "sakila_1",
    "question": "What are the city name, id, and number of addresses corresponding to the city with the most addressed?",
    "sql": "SELECT T2.city ,  count(*) ,  T1.city_id FROM address AS T1 JOIN city AS T2 ON T1.city_id  =  T2.city_id GROUP BY T1.city_id ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "address",
      "city"
    ]
  },
  {
    "id": 2385,
    "db_id": "battle_death",
    "question": "What are the names of the ships lost in battles won by the Bulgarian commander Kaloyan?",
    "sql": "SELECT ship.name FROM ship JOIN battle ON ship.lost_in_battle = battle.id WHERE battle.result = 'Bulgarian victory' AND battle.bulgarian_commander = 'Kaloyan';",
    "table_names": [
      "battle",
      "ship"
    ]
  },
  {
    "id": 44,
    "db_id": "bike_1",
    "question": "What are the different names for each station that has ever had 7 bikes available?",
    "sql": "SELECT DISTINCT T1.name FROM station AS T1 JOIN status AS T2 ON T1.id  =  T2.station_id WHERE T2.bikes_available  =  7",
    "table_names": [
      "station",
      "status"
    ]
  },
  {
    "id": 429,
    "db_id": "soccer_1",
    "question": "What is the name of the league that belongs to Germany, according to the database details?",
    "sql": "SELECT League.name FROM League JOIN Country ON League.country_id = Country.id WHERE Country.name = 'Germany';",
    "table_names": [
      "League",
      "Country"
    ]
  },
  {
    "id": 188,
    "db_id": "journal_committee",
    "question": "What is the average age of editors who have worked on journals performing 'Photo' type tasks?",
    "sql": "SELECT AVG(editor.Age) FROM editor JOIN journal_committee ON editor.Editor_ID = journal_committee.Editor_ID WHERE journal_committee.Work_Type = 'Photo';",
    "table_names": [
      "editor",
      "journal_committee"
    ]
  },
  {
    "id": 1775,
    "db_id": "products_gen_characteristics",
    "question": "What is the product name and typical buying price of the white herb product whose typical selling price exceeds 50000?",
    "sql": "SELECT P.product_name, P.typical_buying_price FROM Products P JOIN Ref_Colors C ON P.color_code = C.color_code WHERE C.color_description = 'white' AND P.product_category_code = 'Herbs' AND P.typical_selling_price > 50000;",
    "table_names": [
      "Ref_Colors",
      "Products"
    ]
  },
  {
    "id": 48,
    "db_id": "bike_1",
    "question": "What are the ids of the stations in San Francisco that normally have more than 10 bikes available?",
    "sql": "SELECT id FROM station WHERE city  =  \"San Francisco\" INTERSECT SELECT station_id FROM status GROUP BY station_id HAVING avg(bikes_available)  >  10",
    "table_names": [
      "station",
      "status"
    ]
  },
  {
    "id": 182,
    "db_id": "store_1",
    "question": "List the name of playlist which has number of tracks greater than 100.",
    "sql": "SELECT T2.name FROM playlist_tracks AS T1 JOIN playlists AS T2 ON T2.id = T1.playlist_id GROUP BY T1.playlist_id HAVING count(T1.track_id)  >  100;",
    "table_names": [
      "playlists",
      "playlist_tracks"
    ]
  },
  {
    "id": 23,
    "db_id": "student_assessment",
    "question": "Which students attended both statistics and French courses?",
    "sql": "SELECT DISTINCT student_id FROM Student_Course_Attendance WHERE course_id IN (SELECT course_id FROM Courses WHERE course_name IN ('statistics','French')) GROUP BY student_id HAVING COUNT(DISTINCT course_id) = 2",
    "table_names": [
      "Courses",
      "Student_Course_Attendance"
    ]
  },
  {
    "id": 775,
    "db_id": "csu_1",
    "question": "What are the degrees conferred in \"San Francisco State University\" in 2001.",
    "sql": "SELECT degrees FROM campuses AS T1 JOIN degrees AS T2 ON t1.id  =  t2.campus WHERE t1.campus  =  \"San Francisco State University\" AND t2.year  =  2001",
    "table_names": [
      "Campuses",
      "degrees"
    ]
  },
  {
    "id": 1725,
    "db_id": "voter_2",
    "question": "What are the distinct last names of the students who have class president votes?",
    "sql": "SELECT DISTINCT T1.LName FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  T2.CLASS_President_VOTE",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 21,
    "db_id": "student_assessment",
    "question": "List the names of courses that have had attendance from at least three different students.",
    "sql": "SELECT course_name FROM Courses WHERE course_id IN (SELECT course_id FROM Student_Course_Attendance GROUP BY course_id HAVING COUNT(DISTINCT student_id) >= 3);",
    "table_names": [
      "Courses",
      "Student_Course_Attendance"
    ]
  },
  {
    "id": 1021,
    "db_id": "assets_maintenance",
    "question": "How many distinct assets have fault log entries with parts that have the fault status 'Return' or 'Waiting'?",
    "sql": "SELECT COUNT(DISTINCT fl.asset_id) FROM Fault_Log fl INNER JOIN Fault_Log_Parts flp ON fl.fault_log_entry_id = flp.fault_log_entry_id WHERE flp.fault_status IN ('Return', 'Waiting');",
    "table_names": [
      "Fault_Log",
      "Fault_Log_Parts"
    ]
  },
  {
    "id": 1421,
    "db_id": "tracking_grants_for_research",
    "question": "How many unique projects from organisation 3 have resulted in at least one paper outcome?",
    "sql": "SELECT COUNT(DISTINCT po.project_id) FROM Project_Outcomes po JOIN Projects p ON po.project_id = p.project_id WHERE po.outcome_code = 'Paper' AND p.organisation_id = 3;",
    "table_names": [
      "Project_Outcomes",
      "Projects"
    ]
  },
  {
    "id": 398,
    "db_id": "apartment_rentals",
    "question": "How many unique guests have confirmed bookings for apartments with two or more bathrooms?",
    "sql": "SELECT COUNT(DISTINCT ab.guest_id) FROM Apartments a JOIN Apartment_Bookings ab ON a.apt_id = ab.apt_id WHERE a.bathroom_count >= 2 AND ab.booking_status_code = 'Confirmed';",
    "table_names": [
      "Apartments",
      "Apartment_Bookings"
    ]
  },
  {
    "id": 2431,
    "db_id": "tvshow",
    "question": "Which cartoon episodes aired on channels from Poland with high-definition TV available?",
    "sql": "SELECT Cartoon.Title FROM Cartoon INNER JOIN TV_Channel ON Cartoon.Channel = TV_Channel.id WHERE TV_Channel.Country = 'Poland' AND TV_Channel.Hight_definition_TV = 'yes';",
    "table_names": [
      "TV_Channel",
      "Cartoon"
    ]
  },
  {
    "id": 408,
    "db_id": "apartment_rentals",
    "question": "Which apartment has 'Boardband' facility and exactly 8 rooms?",
    "sql": "SELECT a.apt_number FROM Apartments a JOIN Apartment_Facilities af ON a.apt_id = af.apt_id WHERE af.facility_code = 'Boardband' AND a.room_count = '8';",
    "table_names": [
      "Apartments",
      "Apartment_Facilities"
    ]
  },
  {
    "id": 61,
    "db_id": "bike_1",
    "question": "Count the number of trips that did not end in San Francisco city.",
    "sql": "SELECT count(*) FROM trip AS T1 JOIN station AS T2 ON T1.end_station_id  =  T2.id WHERE T2.city !=  \"San Francisco\"",
    "table_names": [
      "station",
      "trip"
    ]
  },
  {
    "id": 2118,
    "db_id": "activity_1",
    "question": "What are the faculty id and the number of students each faculty has?",
    "sql": "SELECT T1.FacID ,  count(*) FROM Faculty AS T1 JOIN Student AS T2 ON T1.FacID  =  T2.advisor GROUP BY T1.FacID",
    "table_names": [
      "Student",
      "Faculty"
    ]
  },
  {
    "id": 678,
    "db_id": "party_people",
    "question": "Which ministers belong to the party 'Convention Peoples Party' and participated in the event named 'Election Meeting'?",
    "sql": "SELECT DISTINCT p.Minister FROM party p JOIN party_events pe ON p.Party_ID = pe.Party_ID WHERE pe.Event_Name = 'Election Meeting' AND p.Party_name = 'Convention Peoples Party';",
    "table_names": [
      "party",
      "party_events"
    ]
  },
  {
    "id": 2434,
    "db_id": "tvshow",
    "question": "Which cartoon episode titles directed by Ben Jones aired on Italian channels with a pixel aspect ratio containing '16:9'?",
    "sql": "SELECT Cartoon.Title FROM Cartoon JOIN TV_Channel ON Cartoon.Channel = TV_Channel.id WHERE TV_Channel.Country = 'Italy' AND TV_Channel.Pixel_aspect_ratio_PAR LIKE '%16:9%' AND Cartoon.Directed_by = 'Ben Jones';",
    "table_names": [
      "TV_Channel",
      "Cartoon"
    ]
  },
  {
    "id": 1617,
    "db_id": "soccer_2",
    "question": "Which state's college accepted a player applying for the goalie position?",
    "sql": "SELECT state FROM College WHERE cName IN (SELECT cName FROM Tryout WHERE pPos = 'goalie' AND decision = 'yes');",
    "table_names": [
      "College",
      "Tryout"
    ]
  },
  {
    "id": 784,
    "db_id": "csu_1",
    "question": "How many people graduated from San Francisco State University in 2004?",
    "sql": "SELECT sum(t1.graduate) FROM discipline_enrollments AS t1 JOIN campuses AS t2 ON t1.campus  =  t2.id WHERE t1.year  =  2004 AND t2.campus  =  \"San Francisco State University\"",
    "table_names": [
      "Campuses",
      "discipline_enrollments"
    ]
  },
  {
    "id": 462,
    "db_id": "college_2",
    "question": "Find the names of students who have taken any course in the fall semester of year 2003.",
    "sql": "SELECT name FROM student WHERE id IN (SELECT id FROM takes WHERE semester  =  'Fall' AND YEAR  =  2003)",
    "table_names": [
      "student",
      "takes"
    ]
  },
  {
    "id": 1806,
    "db_id": "customer_complaints",
    "question": "How many open complaints were raised by customers residing in Tennessee?",
    "sql": "SELECT COUNT(*) FROM Complaints AS comp INNER JOIN Customers AS cust ON comp.customer_id = cust.customer_id WHERE cust.state = 'Tennessee' AND comp.complaint_status_code = 'Open';",
    "table_names": [
      "Customers",
      "Complaints"
    ]
  },
  {
    "id": 2283,
    "db_id": "car_1",
    "question": "What are the names and ids of all makers with more than 3 models?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "car_makers",
      "model_list"
    ]
  },
  {
    "id": 2169,
    "db_id": "flight_4",
    "question": "Find the number of routes with destination airports in Italy.",
    "sql": "SELECT count(*) FROM routes AS T1 JOIN airports AS T2 ON T1.dst_apid  =  T2.apid WHERE T2.country  =  'Italy'",
    "table_names": [
      "routes",
      "airports"
    ]
  },
  {
    "id": 403,
    "db_id": "apartment_rentals",
    "question": "Who are the guests that have confirmed bookings ending in or after November 2017?",
    "sql": "SELECT guest_first_name, guest_last_name FROM Guests WHERE guest_id IN (SELECT guest_id FROM Apartment_Bookings WHERE booking_status_code = 'Confirmed' AND booking_end_date >= '2017-11-01');",
    "table_names": [
      "Guests",
      "Apartment_Bookings"
    ]
  },
  {
    "id": 762,
    "db_id": "csu_1",
    "question": "What is the campus fee for San Francisco State University in 1996?",
    "sql": "SELECT campusfee FROM campuses AS T1 JOIN csu_fees AS T2 ON T1.id  =  t2.campus WHERE t1.campus  =  \"San Francisco State University\" AND T2.year  =  1996",
    "table_names": [
      "Campuses",
      "csu_fees"
    ]
  },
  {
    "id": 2427,
    "db_id": "tvshow",
    "question": "Which TV channels from Italy with a pixel aspect ratio of '16:9' aired episodes with ratings higher than 3.5?",
    "sql": "SELECT TV_Channel.series_name FROM TV_Channel JOIN TV_series ON TV_Channel.id = TV_series.Channel WHERE TV_Channel.Country = 'Italy' AND TV_Channel.Pixel_aspect_ratio_PAR = '16:9' AND TV_series.Rating > 3.5;",
    "table_names": [
      "TV_Channel",
      "TV_series"
    ]
  },
  {
    "id": 626,
    "db_id": "wrestler",
    "question": "Which wrestlers on Team Batista had title reigns longer than 500 days?",
    "sql": "SELECT w.Name FROM wrestler w JOIN Elimination e ON w.Wrestler_ID = e.Wrestler_ID WHERE e.Team = 'Team Batista' AND w.Days_held > 500;",
    "table_names": [
      "wrestler",
      "Elimination"
    ]
  },
  {
    "id": 1744,
    "db_id": "voter_2",
    "question": "Find the average age of female (sex is F) students who have secretary votes in the spring election cycle.",
    "sql": "SELECT avg(T1.Age) FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  SECRETARY_Vote WHERE T1.Sex  =  \"F\" AND T2.Election_Cycle  =  \"Spring\"",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 2282,
    "db_id": "car_1",
    "question": "Which makers designed more than 3 car models? List full name and the id.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "car_makers",
      "model_list"
    ]
  },
  {
    "id": 414,
    "db_id": "apartment_rentals",
    "question": "What is the name and apartment number of the building that contains an apartment with the highest number of bathrooms, and who is the manager of that building?",
    "sql": "SELECT ab.building_full_name, a.apt_number, ab.building_manager FROM Apartment_Buildings ab JOIN Apartments a ON ab.building_id = a.building_id WHERE a.bathroom_count = (SELECT MAX(bathroom_count) FROM Apartments);",
    "table_names": [
      "Apartment_Buildings",
      "Apartments"
    ]
  },
  {
    "id": 950,
    "db_id": "sakila_1",
    "question": "Return the full name and id of the actor or actress who starred in the greatest number of films.",
    "sql": "SELECT T2.first_name ,  T2.last_name ,  T2.actor_id FROM film_actor AS T1 JOIN actor AS T2 ON T1.actor_id  =  T2.actor_id GROUP BY T2.actor_id ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "actor",
      "film_actor"
    ]
  },
  {
    "id": 2151,
    "db_id": "flight_4",
    "question": "Find the number of routes operated by American Airlines.",
    "sql": "SELECT count(*) FROM airlines AS T1 JOIN routes AS T2 ON T1.alid  =  T2.alid WHERE T1.name  =  'American Airlines'",
    "table_names": [
      "routes",
      "airlines"
    ]
  },
  {
    "id": 2515,
    "db_id": "network_1",
    "question": "Return the names of friends of the high school student Kyle.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Highschooler",
      "Friend"
    ]
  },
  {
    "id": 918,
    "db_id": "election",
    "question": "What is the average population of the counties represented by delegates first elected before the year 2000?",
    "sql": "SELECT AVG(county.Population) FROM county JOIN election ON county.Zip_code = CONCAT('D', LPAD(election.District, 2, '0')) WHERE election.First_Elected < 2000;",
    "table_names": [
      "county",
      "election"
    ]
  },
  {
    "id": 2412,
    "db_id": "student_assessment",
    "question": "What is the name of the student whose permanent address is located in Haiti, and which city is it?",
    "sql": "SELECT S.first_name, S.last_name, A.city FROM Students S JOIN Addresses A ON S.permanent_address_id = A.address_id WHERE A.country = 'Haiti';",
    "table_names": [
      "Addresses",
      "Students"
    ]
  },
  {
    "id": 2234,
    "db_id": "concert_singer",
    "question": "How many unique singers participated in concerts held in stadium ID 1 or 2 during the year 2014?",
    "sql": "SELECT COUNT(DISTINCT sc.Singer_ID) FROM singer_in_concert sc JOIN concert c ON sc.concert_ID = c.concert_ID WHERE c.Year = '2014' AND c.Stadium_ID IN ('1', '2');",
    "table_names": [
      "concert",
      "singer_in_concert"
    ]
  },
  {
    "id": 1396,
    "db_id": "cre_Doc_Tracking_DB",
    "question": "What is the name of the employee who authorized the destruction of Document ID 170, and what is the role code of the employee who actually destroyed this document?",
    "sql": "SELECT E1.Employee_Name AS Authorizer_Name, E2.Role_Code AS Destroyer_Role FROM Documents_to_be_Destroyed D JOIN Employees E1 ON D.Destruction_Authorised_by_Employee_ID = E1.Employee_ID JOIN Employees E2 ON D.Destroyed_by_Employee_ID = E2.Employee_ID WHERE D.Document_ID = 170;",
    "table_names": [
      "Employees",
      "Documents_to_be_Destroyed"
    ]
  },
  {
    "id": 153,
    "db_id": "tracking_orders",
    "question": "Which customer from Germany spent the highest total amount according to their invoices?",
    "sql": "SELECT c.first_name, c.last_name, SUM(i.total) AS total_spent FROM customers c JOIN invoices i ON c.id = i.customer_id WHERE c.country = 'Germany' GROUP BY c.id ORDER BY total_spent DESC LIMIT 1;",
    "table_names": [
      "customers",
      "invoices"
    ]
  },
  {
    "id": 507,
    "db_id": "customers_card_transactions",
    "question": "Which USA customer owns the highest number of VIP accounts?",
    "sql": "SELECT Customers.customer_first_name, Customers.customer_last_name, COUNT(Accounts.account_id) AS account_count FROM Customers INNER JOIN Accounts ON Customers.customer_id = Accounts.customer_id WHERE Customers.country = 'USA' AND Accounts.other_account_details = 'VIP' GROUP BY Customers.customer_id ORDER BY account_count DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Accounts"
    ]
  },
  {
    "id": 2019,
    "db_id": "scientist_1",
    "question": "List the name(s) of all projects assigned to the scientists with IDs 152934485 and 745685214.",
    "sql": "SELECT Projects.Name FROM Projects JOIN AssignedTo ON Projects.Code = AssignedTo.Project WHERE AssignedTo.Scientist = 152934485 OR AssignedTo.Scientist = 745685214;",
    "table_names": [
      "Projects",
      "AssignedTo"
    ]
  },
  {
    "id": 2325,
    "db_id": "employee_hire_evaluation",
    "question": "Who received the highest bonus in the year 2016 and what was their name?",
    "sql": "SELECT e.Name FROM employee e JOIN evaluation ev ON e.Employee_ID = CAST(ev.Employee_ID AS INTEGER) WHERE ev.Bonus = (SELECT MAX(Bonus) FROM evaluation) AND ev.Year_awarded = '2016';",
    "table_names": [
      "employee",
      "evaluation"
    ]
  },
  {
    "id": 1967,
    "db_id": "city_record",
    "question": "What is the name and regional population of the city that hosted the match in 2011?",
    "sql": "SELECT c.City, c.Regional_Population FROM city c JOIN hosting_city h ON c.City_ID = h.Host_City WHERE h.Year = 2011;",
    "table_names": [
      "city",
      "hosting_city"
    ]
  },
  {
    "id": 705,
    "db_id": "formula_1",
    "question": "How many drivers were in the Australian Grand Prix held in 2009?",
    "sql": "SELECT count(*) FROM results AS T1 JOIN races AS T2 ON T1.raceid = T2.raceid WHERE T2.name = \"Australian Grand Prix\" AND YEAR = 2009",
    "table_names": [
      "races",
      "results"
    ]
  },
  {
    "id": 2327,
    "db_id": "employee_hire_evaluation",
    "question": "What are the district names of shops that have hired part-time employees?",
    "sql": "SELECT s.District FROM shop s JOIN hiring h ON s.Shop_ID = h.Shop_ID WHERE h.Is_full_time = 'F';",
    "table_names": [
      "shop",
      "hiring"
    ]
  },
  {
    "id": 354,
    "db_id": "match_season",
    "question": "Find the names, colleges, and singles win-loss records of midfield players who played for team number 3 and are associated with the 2011 year.",
    "sql": "SELECT ms.Player, ms.College, p.Singles_WL FROM match_season ms JOIN player p ON ms.Team = p.Team WHERE ms.Position = 'Midfielder' AND ms.Team = 3 AND p.Years_Played LIKE '%2011%';",
    "table_names": [
      "match_season",
      "player"
    ]
  },
  {
    "id": 2450,
    "db_id": "poker_player",
    "question": "What is the average height of poker players whose best finish position is 1?",
    "sql": "SELECT AVG(p.Height) FROM poker_player pp JOIN people p ON pp.People_ID = p.People_ID WHERE pp.Best_Finish = 1.0;",
    "table_names": [
      "poker_player",
      "people"
    ]
  },
  {
    "id": 2438,
    "db_id": "poker_player",
    "question": "What is the average height of Russian poker players who have earned more than 200,000?",
    "sql": "SELECT AVG(p.Height) FROM poker_player pp JOIN people p ON pp.People_ID = p.People_ID WHERE pp.Earnings > 200000 AND p.Nationality = 'Russia';",
    "table_names": [
      "poker_player",
      "people"
    ]
  },
  {
    "id": 970,
    "db_id": "loan_1",
    "question": "What is the total loan amount for customers from Utah who have a savings account?",
    "sql": "SELECT SUM(loan.amount) FROM loan INNER JOIN customer ON loan.cust_ID = customer.cust_ID WHERE customer.state = 'Utah' AND customer.acc_type = 'saving';",
    "table_names": [
      "customer",
      "loan"
    ]
  },
  {
    "id": 1710,
    "db_id": "shop_membership",
    "question": "Which branches located in Oxford had members registering in the year 2016?",
    "sql": "SELECT b.Name, b.City FROM branch b JOIN membership_register_branch mrb ON b.Branch_ID = mrb.Branch_ID WHERE mrb.Register_Year = '2016' AND b.City = 'Oxford';",
    "table_names": [
      "branch",
      "membership_register_branch"
    ]
  },
  {
    "id": 1688,
    "db_id": "tracking_software_problems",
    "question": "How many problems have been reported for the product named 'wechat'?",
    "sql": "SELECT COUNT(*) FROM Problems WHERE product_id = (SELECT product_id FROM Product WHERE product_name = 'wechat');",
    "table_names": [
      "Product",
      "Problems"
    ]
  },
  {
    "id": 1555,
    "db_id": "aircraft",
    "question": "Which aircraft won the match held at Flamengo Beach, Rio de Janeiro?",
    "sql": "SELECT a.Aircraft FROM aircraft a JOIN match m ON a.Aircraft_ID = m.Winning_Aircraft WHERE m.Location = 'Flamengo Beach , Rio de Janeiro';",
    "table_names": [
      "aircraft",
      "match"
    ]
  },
  {
    "id": 2084,
    "db_id": "driving_school",
    "question": "Which city in Louisiana has the highest total amount outstanding from its customers?",
    "sql": "SELECT A.city, SUM(C.amount_outstanding) AS total_outstanding FROM Customers C JOIN Addresses A ON C.customer_address_id = A.address_id WHERE A.state_province_county = 'Louisiana' GROUP BY A.city ORDER BY total_outstanding DESC LIMIT 1;",
    "table_names": [
      "Addresses",
      "Customers"
    ]
  },
  {
    "id": 1296,
    "db_id": "insurance_policies",
    "question": "What is the most recent car insurance policy ID of customer Dr. Diana Rath?",
    "sql": "SELECT cp.Policy_ID FROM Customer_Policies cp JOIN Customers c ON cp.Customer_ID = c.Customer_ID WHERE c.Customer_Details = 'Dr. Diana Rath' AND cp.Policy_Type_Code = 'Car' ORDER BY cp.Start_Date DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Customer_Policies"
    ]
  },
  {
    "id": 2008,
    "db_id": "cre_Docs_and_Epenses",
    "question": "How many documents have expenses listed under the budget type description 'Government'?",
    "sql": "SELECT COUNT(*) FROM Documents_with_Expenses INNER JOIN Ref_Budget_Codes ON Documents_with_Expenses.Budget_Type_Code = Ref_Budget_Codes.Budget_Type_Code WHERE Ref_Budget_Codes.Budget_Type_Description = 'Government';",
    "table_names": [
      "Ref_Budget_Codes",
      "Documents_with_Expenses"
    ]
  },
  {
    "id": 2271,
    "db_id": "car_1",
    "question": "What is the number of makers of care in France?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "countries",
      "car_makers"
    ]
  },
  {
    "id": 176,
    "db_id": "store_1",
    "question": "List name of all tracks in Balls to the Wall.",
    "sql": "SELECT T2.name FROM albums AS T1 JOIN tracks AS T2 ON T1.id = T2.genre_id WHERE T1.title = \"Balls to the Wall\";",
    "table_names": [
      "albums",
      "tracks"
    ]
  },
  {
    "id": 2591,
    "db_id": "real_estate_properties",
    "question": "What is the average agreed selling price of apartments having more than 5 rooms?",
    "sql": "SELECT AVG(P.agreed_selling_price) FROM Properties P JOIN Ref_Property_Types R ON P.property_type_code = R.property_type_code WHERE R.property_type_description = 'Apartment, Flat, Condo, etc.' AND P.room_count > 5;",
    "table_names": [
      "Ref_Property_Types",
      "Properties"
    ]
  },
  {
    "id": 2230,
    "db_id": "concert_singer",
    "question": "What is the name of the stadium with a capacity greater than 10,000 that hosted a concert with the theme 'Bleeding Love'?",
    "sql": "SELECT stadium.Name FROM stadium INNER JOIN concert ON stadium.Stadium_ID = concert.Stadium_ID WHERE concert.Theme = 'Bleeding Love' AND stadium.Capacity > 10000;",
    "table_names": [
      "stadium",
      "concert"
    ]
  },
  {
    "id": 704,
    "db_id": "formula_1",
    "question": "How many drivers participated in the race Australian Grand Prix held in 2009?",
    "sql": "SELECT count(*) FROM results AS T1 JOIN races AS T2 ON T1.raceid = T2.raceid WHERE T2.name = \"Australian Grand Prix\" AND YEAR = 2009",
    "table_names": [
      "races",
      "results"
    ]
  },
  {
    "id": 1428,
    "db_id": "tracking_grants_for_research",
    "question": "How many organisations have the type described as 'Research'?",
    "sql": "SELECT COUNT(*) FROM Organisations o JOIN Organisation_Types ot ON o.organisation_type = ot.organisation_type WHERE ot.organisation_type_description = 'Research';",
    "table_names": [
      "Organisation_Types",
      "Organisations"
    ]
  },
  {
    "id": 103,
    "db_id": "twitter_1",
    "question": "Which users with more than a million followers tweeted between March 9 and March 10, 2018?",
    "sql": "SELECT u.name FROM user_profiles u JOIN tweets t ON u.uid = t.uid WHERE u.followers > 1000000 AND t.createdate BETWEEN '2018-03-09' AND '2018-03-10';",
    "table_names": [
      "tweets",
      "user_profiles"
    ]
  },
  {
    "id": 2241,
    "db_id": "concert_singer",
    "question": "What is the stadium name where a concert with the theme 'Bleeding Love' took place in 2015?",
    "sql": "SELECT s.Name FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Theme = 'Bleeding Love' AND c.Year = '2015';",
    "table_names": [
      "stadium",
      "concert"
    ]
  },
  {
    "id": 1463,
    "db_id": "network_2",
    "question": "How many unique friends with the job 'student' or 'engineer' does the person from 'austin' have friendships lasting more than 5 years?",
    "sql": "SELECT COUNT(DISTINCTION pf.friend) FROM PersonFriend pf JOIN Person p ON pf.friend = p.name WHERE p.job IN ('student', 'engineer') AND pf.year > 5 AND pf.name IN (SELECT name FROM Person WHERE city = 'austin');",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 2411,
    "db_id": "student_transcripts_tracking",
    "question": "What is the most recent date of a transcript that is associated with more than one student course?",
    "sql": "SELECT transcript_date FROM Transcripts WHERE transcript_id IN (SELECT transcript_id FROM Transcript_Contents GROUP BY transcript_id HAVING COUNT(student_course_id) > 1) ORDER BY transcript_date DESC LIMIT 1;",
    "table_names": [
      "Transcripts",
      "Transcript_Contents"
    ]
  },
  {
    "id": 1974,
    "db_id": "e_government",
    "question": "How many distinct customers booked services categorized as 'Education' between March 1st, 2018 and March 15th, 2018?",
    "sql": "SELECT COUNT(DISTINCT ps.customer_id) FROM Party_Services ps JOIN Services s ON ps.service_id = s.service_id WHERE s.service_type_code = 'Education' AND ps.service_datetime BETWEEN '2018-03-01' AND '2018-03-15';",
    "table_names": [
      "Services",
      "Party_Services"
    ]
  },
  {
    "id": 318,
    "db_id": "phone_1",
    "question": "Which companies have phones accredited that use chips with '802.11b' WiFi support and ROM of at least 128 MiB, and what are the names of the chip models?",
    "sql": "SELECT p.Company_name, c.Model_name FROM phone p JOIN chip_model c ON p.chip_model = c.Model_name WHERE c.WiFi = '802.11b' AND c.ROM_MiB >= 128;",
    "table_names": [
      "chip_model",
      "phone"
    ]
  },
  {
    "id": 935,
    "db_id": "customer_deliveries",
    "question": "What are the names of delivery routes that deliver to locations with address id 7?",
    "sql": "SELECT dr.route_name FROM Delivery_Routes dr JOIN Delivery_Route_Locations drl ON dr.route_id = drl.route_id WHERE drl.location_address_id = 7;",
    "table_names": [
      "Delivery_Routes",
      "Delivery_Route_Locations"
    ]
  },
  {
    "id": 1274,
    "db_id": "e_learning",
    "question": "List the dates of enrollment and completion of the student with family name \"Zieme\" and personal name \"Bernie\".",
    "sql": "SELECT T1.date_of_enrolment ,  T1.date_of_completion FROM Student_Course_Enrolment AS T1 JOIN Students AS T2 ON T1.student_id  =  T2.student_id WHERE T2.family_name  =  \"Zieme\" AND T2.personal_name  =  \"Bernie\"",
    "table_names": [
      "Students",
      "Student_Course_Enrolment"
    ]
  },
  {
    "id": 447,
    "db_id": "college_2",
    "question": "What are the titles of courses without prerequisites?",
    "sql": "SELECT title FROM course WHERE course_id NOT IN (SELECT course_id FROM prereq)",
    "table_names": [
      "course",
      "prereq"
    ]
  },
  {
    "id": 1481,
    "db_id": "document_management",
    "question": "What are the names of advertisements that have a 'before' section with a section sequence greater than 6000?",
    "sql": "SELECT Documents.document_name FROM Documents JOIN Document_Sections ON Documents.document_code = Document_Sections.document_code WHERE Documents.document_type_code = 'Advertisement' AND Document_Sections.section_sequence > 6000 AND Document_Sections.section_title = 'before';",
    "table_names": [
      "Documents",
      "Document_Sections"
    ]
  },
  {
    "id": 1395,
    "db_id": "cre_Doc_Tracking_DB",
    "question": "Which employee authorized the planned destruction of document ID 170?",
    "sql": "SELECT Employee_Name FROM Employees WHERE Employee_ID IN (SELECT Destruction_Authorised_by_Employee_ID FROM Documents_to_be_Destroyed WHERE Document_ID = 170);",
    "table_names": [
      "Employees",
      "Documents_to_be_Destroyed"
    ]
  },
  {
    "id": 383,
    "db_id": "election_representative",
    "question": "Which representative secured the highest percentage of votes in any election?",
    "sql": "SELECT r.Name FROM election e JOIN representative r ON e.Representative_ID = r.Representative_ID WHERE e.Vote_Percent = (SELECT MAX(Vote_Percent) FROM election);",
    "table_names": [
      "election",
      "representative"
    ]
  },
  {
    "id": 1515,
    "db_id": "college_3",
    "question": "Find the full names of faculties who are members of department with department number 520.",
    "sql": "SELECT T1.Fname ,  T1.Lname FROM FACULTY AS T1 JOIN MEMBER_OF AS T2 ON T1.FacID  =  T2.FacID WHERE T2.DNO  =  520",
    "table_names": [
      "Faculty",
      "Member_of"
    ]
  },
  {
    "id": 297,
    "db_id": "medicine_enzyme_interaction",
    "question": "What enzymes located in the Cytosol have medicines interacting with them as activators?",
    "sql": "SELECT e.name FROM enzyme e JOIN medicine_enzyme_interaction mei ON e.id = mei.enzyme_id WHERE e.Location = 'Cytosol' AND mei.interaction_type = 'activitor' GROUP BY e.name",
    "table_names": [
      "enzyme",
      "medicine_enzyme_interaction"
    ]
  },
  {
    "id": 1852,
    "db_id": "cre_Theme_park",
    "question": "What are the tourist attractions accessible by shuttle and the details of their associated shops?",
    "sql": "SELECT ta.Name, s.Shop_Details FROM Tourist_Attractions ta JOIN Shops s ON ta.Tourist_Attraction_ID = s.Shop_ID WHERE ta.How_to_Get_There = 'shuttle';",
    "table_names": [
      "Tourist_Attractions",
      "Shops"
    ]
  },
  {
    "id": 2306,
    "db_id": "flight_2",
    "question": "Which airline has most number of flights?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "airlines",
      "flights"
    ]
  },
  {
    "id": 1667,
    "db_id": "manufactory_1",
    "question": "What's the average price of products made by manufacturers based in Tokyo and Taiwan?",
    "sql": "SELECT AVG(p.Price) FROM Products p JOIN Manufacturers m ON p.Manufacturer = m.Code WHERE m.Headquarter IN ('Tokyo','Taiwan');",
    "table_names": [
      "Manufacturers",
      "Products"
    ]
  },
  {
    "id": 2209,
    "db_id": "tracking_orders",
    "question": "Which customer placed the highest number of orders?",
    "sql": "SELECT c.customer_name, COUNT(o.order_id) AS total_orders FROM Customers c INNER JOIN Orders o ON c.customer_id = o.customer_id GROUP BY c.customer_name ORDER BY total_orders DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Orders"
    ]
  },
  {
    "id": 2481,
    "db_id": "world_1",
    "question": "Which countries have either English or Dutch as an official language?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2572,
    "db_id": "dog_kennels",
    "question": "How many dogs older than 5 years with breed code 'HUS' are owned by owners from North Dakota?",
    "sql": "SELECT COUNT(D.dog_id) FROM Dogs D INNER JOIN Owners O ON D.owner_id = O.owner_id WHERE O.state = 'NorthDakota' AND D.breed_code = 'HUS' AND D.age > 5;",
    "table_names": [
      "Owners",
      "Dogs"
    ]
  },
  {
    "id": 2445,
    "db_id": "poker_player",
    "question": "What are the earnings of poker players taller than 195 cm who had the best finish position of 1?",
    "sql": "SELECT pp.Earnings FROM poker_player AS pp JOIN people AS p ON pp.People_ID = p.People_ID WHERE p.Height > 195 AND pp.Best_Finish = 1;",
    "table_names": [
      "poker_player",
      "people"
    ]
  },
  {
    "id": 1079,
    "db_id": "college_1",
    "question": "What are the first names of all teachers who have taught a course and the corresponding course codes?",
    "sql": "SELECT T2.emp_fname ,  T1.crs_code FROM CLASS AS T1 JOIN employee AS T2 ON T1.prof_num  =  T2.emp_num",
    "table_names": [
      "CLASS",
      "EMPLOYEE"
    ]
  },
  {
    "id": 1591,
    "db_id": "soccer_2",
    "question": "What is the player ID of the applicant who was accepted by the college situated in Arizona?",
    "sql": "SELECT T.pID FROM Tryout T JOIN College C ON T.cName = C.cName WHERE T.decision = 'yes' AND C.state = 'AZ';",
    "table_names": [
      "College",
      "Tryout"
    ]
  },
  {
    "id": 2264,
    "db_id": "car_1",
    "question": "Which of the countries has the most car makers? List the country name.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "countries",
      "car_makers"
    ]
  },
  {
    "id": 1355,
    "db_id": "student_1",
    "question": "How many students are taught by teacher TARRING LEIA?",
    "sql": "SELECT count(*) FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom WHERE T2.firstname  =  \"TARRING\" AND T2.lastname  =  \"LEIA\"",
    "table_names": [
      "list",
      "teachers"
    ]
  },
  {
    "id": 932,
    "db_id": "restaurant_1",
    "question": "Which student visited restaurant most often? List student's first name and last name.",
    "sql": "SELECT Student.Fname , Student.Lname FROM Student JOIN Visits_Restaurant ON Student.StuID = Visits_Restaurant.StuID GROUP BY Student.StuID ORDER BY count(*) DESC LIMIT 1;",
    "table_names": [
      "Student",
      "Visits_Restaurant"
    ]
  },
  {
    "id": 1449,
    "db_id": "network_2",
    "question": "What are the occupations of Bob's friends?",
    "sql": "SELECT job FROM Person WHERE name IN (SELECT friend FROM PersonFriend WHERE name = 'Bob');",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 371,
    "db_id": "body_builder",
    "question": "What is the name and birth place of the body builder who achieved the highest total score?",
    "sql": "SELECT p.Name, p.Birth_Place FROM body_builder b JOIN people p ON b.People_ID = p.People_ID WHERE b.Total = (SELECT MAX(Total) FROM body_builder);",
    "table_names": [
      "body_builder",
      "people"
    ]
  },
  {
    "id": 2341,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "What are the names of documents that use templates with the code BK?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Templates",
      "Documents"
    ]
  },
  {
    "id": 264,
    "db_id": "chinook_1",
    "question": "Count the number of tracks that are of the media type \"AAC audio file\".",
    "sql": "SELECT COUNT(*) FROM MEDIATYPE AS T1 JOIN TRACK AS T2 ON T1.MediaTypeId  =  T2.MediaTypeId WHERE T1.Name  =  \"AAC audio file\"",
    "table_names": [
      "MediaType",
      "Track"
    ]
  },
  {
    "id": 253,
    "db_id": "chinook_1",
    "question": "How many customers from Brazil are assigned to a Sales Support Agent?",
    "sql": "SELECT COUNT(Customer.CustomerId) FROM Customer JOIN Employee ON Customer.SupportRepId = Employee.EmployeeId WHERE Employee.Title = 'Sales Support Agent' AND Customer.Country = 'Brazil';",
    "table_names": [
      "Customer",
      "Employee"
    ]
  },
  {
    "id": 1230,
    "db_id": "mountain_photos",
    "question": "How many distinct kinds of camera lenses are used to take photos of mountains in the country 'Ethiopia'?",
    "sql": "SELECT count(DISTINCT T2.camera_lens_id) FROM mountain AS T1 JOIN photos AS T2 ON T1.id  =  T2.mountain_id WHERE T1.country  =  'Ethiopia'",
    "table_names": [
      "mountain",
      "photos"
    ]
  },
  {
    "id": 2243,
    "db_id": "pets_1",
    "question": "How many pets are owned by students that have an age greater than 20?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Student",
      "Has_Pet"
    ]
  },
  {
    "id": 1447,
    "db_id": "network_2",
    "question": "List the names of people who have had friends for more than 5 years where the friend lives in a different city.",
    "sql": "SELECT pf.name FROM PersonFriend pf JOIN Person p1 ON pf.name = p1.name JOIN Person p2 ON pf.friend = p2.name WHERE p1.city != p2.city AND pf.year > 5;",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 2273,
    "db_id": "car_1",
    "question": "What are the names and ids of all countries with at least one car maker?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "countries",
      "car_makers"
    ]
  },
  {
    "id": 341,
    "db_id": "match_season",
    "question": "What is the official native language of the country whose capital is the homeland of the midfielder drafted in 2004 MLS SuperDraft from Furman?",
    "sql": "SELECT Official_native_language FROM country WHERE Country_id = (SELECT Country FROM match_season WHERE Draft_Class = '2004 MLS SuperDraft' AND College = 'Furman' AND Position = 'Midfielder');",
    "table_names": [
      "country",
      "match_season"
    ]
  },
  {
    "id": 548,
    "db_id": "theme_gallery",
    "question": "What are the themes of exhibitions hosted by artists from the United States with ticket prices under 15?",
    "sql": "SELECT e.Theme FROM exhibition e JOIN artist a ON e.Artist_ID = a.Artist_ID WHERE a.Country = 'United States' AND e.Ticket_Price < 15;",
    "table_names": [
      "artist",
      "exhibition"
    ]
  },
  {
    "id": 161,
    "db_id": "store_1",
    "question": "Who is the artist of the album titled 'Nevermind'?",
    "sql": "SELECT artists.name FROM artists JOIN albums ON artists.id = albums.artist_id WHERE albums.title = 'Nevermind';",
    "table_names": [
      "artists",
      "albums"
    ]
  },
  {
    "id": 934,
    "db_id": "cre_Doc_Control_Systems",
    "question": "What are the names and phone numbers of employees living in the state of Michigan?",
    "sql": "SELECT e.employee_name, e.employee_phone FROM Employees e JOIN Addresses a ON e.employee_address_id = a.address_id WHERE a.state_province_county = 'Michigan';",
    "table_names": [
      "Addresses",
      "Employees"
    ]
  },
  {
    "id": 1211,
    "db_id": "baseball_1",
    "question": "How many games were played in park \"Columbia Park\" in 1907?",
    "sql": "SELECT count(*) FROM home_game AS T1 JOIN park AS T2 ON T1.park_id  =  T2.park_id WHERE T1.year = 1907 AND T2.park_name = 'Columbia Park';",
    "table_names": [
      "home_game",
      "park"
    ]
  },
  {
    "id": 1025,
    "db_id": "assets_maintenance",
    "question": "Which engineers have visits with 'Return' fault status starting from the year 1990 onwards? Provide their first and last names.",
    "sql": "SELECT me.first_name, me.last_name FROM Maintenance_Engineers me JOIN Engineer_Visits ev ON me.engineer_id = ev.engineer_id WHERE ev.fault_status = 'Return' AND ev.visit_start_datetime >= '1990-01-01 00:00:00';",
    "table_names": [
      "Maintenance_Engineers",
      "Engineer_Visits"
    ]
  },
  {
    "id": 1038,
    "db_id": "college_1",
    "question": "What are the first names and date of birth of professors teaching course ACCT-211?",
    "sql": "SELECT DISTINCT T1.EMP_FNAME ,  T1.EMP_DOB FROM employee AS T1 JOIN CLASS AS T2 ON T1.EMP_NUM  =  T2.PROF_NUM WHERE CRS_CODE  =  \"ACCT-211\"",
    "table_names": [
      "CLASS",
      "EMPLOYEE"
    ]
  },
  {
    "id": 1524,
    "db_id": "customers_and_addresses",
    "question": "What are the names and phone numbers of all customers who paid by Credit Card and currently have orders in 'Pending' status?",
    "sql": "SELECT DISTINCT c.customer_name, c.customer_phone FROM Customers c INNER JOIN Customer_Orders co ON c.customer_id = co.customer_id WHERE co.order_status_code = 'Pending' AND c.payment_method_code = 'Credit Card';",
    "table_names": [
      "Customers",
      "Customer_Orders"
    ]
  },
  {
    "id": 231,
    "db_id": "chinook_1",
    "question": "What are the titles of albums created by the artist named Metallica?",
    "sql": "SELECT Album.Title FROM Album JOIN Artist ON Album.ArtistId = Artist.ArtistId WHERE Artist.Name = 'Metallica';",
    "table_names": [
      "Album",
      "Artist"
    ]
  },
  {
    "id": 1728,
    "db_id": "voter_2",
    "question": "Find the distinct ages of students who have secretary votes in the fall election cycle.",
    "sql": "SELECT DISTINCT T1.Age FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  T2.Secretary_Vote WHERE T2.Election_Cycle  =  \"Fall\"",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  }
]