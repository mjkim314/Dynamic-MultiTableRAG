[
  {
    "id": 0,
    "db_id": "department_management",
    "question": "Which department currently headed by a temporary acting manager has the largest number of employees, and how many employees does it have?",
    "sql": "SELECT d.Name, SUM(d.Num_Employees) FROM department d JOIN management m ON d.Department_ID = m.department_ID WHERE m.temporary_acting = 'Yes' GROUP BY d.Name ORDER BY SUM(d.Num_Employees) DESC LIMIT 1;",
    "table_names": [
      "department",
      "management"
    ]
  },
  {
    "id": 1,
    "db_id": "department_management",
    "question": "What are the names and budgets of departments ranked in the top 10 whose current managerial positions are temporarily acting?",
    "sql": "SELECT d.Name, d.Budget_in_Billions FROM department d JOIN management m ON d.Department_ID = m.department_ID WHERE d.Ranking < 10 AND m.temporary_acting = 'Yes';",
    "table_names": [
      "department",
      "management"
    ]
  },
  {
    "id": 2,
    "db_id": "department_management",
    "question": "What is the average age of department heads who are serving as temporary acting heads and were born in California?",
    "sql": "SELECT AVG(h.age) FROM head h JOIN management m ON h.head_ID = m.head_ID WHERE m.temporary_acting = 'Yes' AND h.born_state = 'California';",
    "table_names": [
      "head",
      "management"
    ]
  },
  {
    "id": 3,
    "db_id": "department_management",
    "question": "Which department with temporary acting management has the highest budget?",
    "sql": "SELECT d.Name FROM department d JOIN management m ON d.Department_ID = m.department_ID WHERE m.temporary_acting = 'Yes' ORDER BY d.Budget_in_Billions DESC LIMIT 1;",
    "table_names": [
      "department",
      "management"
    ]
  },
  {
    "id": 4,
    "db_id": "farm",
    "question": "What are the names of cities or villages with populations below 2000 that hosted farm competitions between the years 2002 and 2005?",
    "sql": "SELECT city.Official_Name FROM city JOIN farm_competition ON city.City_ID = farm_competition.Host_city_ID WHERE city.Population < 2000 AND farm_competition.Year BETWEEN 2002 AND 2005;",
    "table_names": [
      "city",
      "farm_competition"
    ]
  },
  {
    "id": 5,
    "db_id": "farm",
    "question": "Which city with a population greater than 1000 hosted the earliest farm competition?",
    "sql": "SELECT c.Official_Name FROM city c JOIN farm_competition f ON c.City_ID = f.Host_city_ID WHERE f.Year = (SELECT MIN(Year) FROM farm_competition WHERE Host_city_ID IN (SELECT City_ID FROM city WHERE Population > 1000));",
    "table_names": [
      "city",
      "farm_competition"
    ]
  },
  {
    "id": 6,
    "db_id": "farm",
    "question": "Which city with an area smaller than 10 square kilometers hosted the most recent farm competition after 2003, and had the highest population among such cities?",
    "sql": "SELECT city.Official_Name FROM city INNER JOIN farm_competition ON city.City_ID = farm_competition.Host_city_ID WHERE farm_competition.Year > 2003 AND city.Area_km_2 < 10 ORDER BY city.Population DESC LIMIT 1;",
    "table_names": [
      "city",
      "farm_competition"
    ]
  },
  {
    "id": 7,
    "db_id": "farm",
    "question": "What are the names of the cities which hosted farm competitions after 2005 and have an area larger than 5 kmÂ²?",
    "sql": "SELECT city.Official_Name FROM city JOIN farm_competition ON city.City_ID = farm_competition.Host_city_ID WHERE city.Area_km_2 > 5 AND farm_competition.Year > 2005;",
    "table_names": [
      "city",
      "farm_competition"
    ]
  },
  {
    "id": 8,
    "db_id": "farm",
    "question": "Which city has hosted the highest number of farm competitions, and how many have they hosted?",
    "sql": "SELECT city.Official_Name, COUNT(farm_competition.Competition_ID) AS Num_Hosted FROM city JOIN farm_competition ON city.City_ID = farm_competition.Host_city_ID GROUP BY city.Official_Name ORDER BY Num_Hosted DESC LIMIT 1;",
    "table_names": [
      "city",
      "farm_competition"
    ]
  },
  {
    "id": 9,
    "db_id": "farm",
    "question": "What is the official name of the city that hosted the farm competition themed 'MTV Cube' in 2003?",
    "sql": "SELECT city.Official_Name FROM city JOIN farm_competition ON city.City_ID = farm_competition.Host_city_ID WHERE farm_competition.Year = 2003;",
    "table_names": [
      "city",
      "farm_competition"
    ]
  },
  {
    "id": 10,
    "db_id": "farm",
    "question": "Which city hosted the farm competition in 2002 and has a population less than 500?",
    "sql": "SELECT city.Official_Name FROM city JOIN farm_competition ON city.City_ID = farm_competition.Host_city_ID WHERE farm_competition.Year = 2002 AND city.Population < 500;",
    "table_names": [
      "city",
      "farm_competition"
    ]
  },
  {
    "id": 11,
    "db_id": "farm",
    "question": "What is the Official Name of the city that hosted the farm competition with the theme 'MTV Cube'?",
    "sql": "SELECT city.Official_Name FROM city JOIN farm_competition ON city.City_ID = farm_competition.Host_city_ID WHERE farm_competition.Year = 2003;",
    "table_names": [
      "city",
      "farm_competition"
    ]
  },
  {
    "id": 12,
    "db_id": "student_assessment",
    "question": "What are the names of courses that have more than two unique students registered?",
    "sql": "SELECT course_name FROM Courses WHERE course_id IN (SELECT course_id FROM Student_Course_Registrations GROUP BY course_id HAVING COUNT(DISTINCT student_id) > 2);",
    "table_names": [
      "Courses",
      "Student_Course_Registrations"
    ]
  },
  {
    "id": 13,
    "db_id": "student_assessment",
    "question": "Which course has the highest number of student registrations?",
    "sql": "SELECT course_name FROM Courses WHERE course_id = (SELECT course_id FROM Student_Course_Registrations GROUP BY course_id ORDER BY COUNT(DISTINCT student_id) DESC LIMIT 1);",
    "table_names": [
      "Courses",
      "Student_Course_Registrations"
    ]
  },
  {
    "id": 14,
    "db_id": "student_assessment",
    "question": "What is the mobile number of the person whose candidate details indicate 'Alex'?",
    "sql": "SELECT People.cell_mobile_number FROM People JOIN Candidates ON People.person_id = Candidates.candidate_id WHERE Candidates.candidate_details = 'Alex';",
    "table_names": [
      "People",
      "Candidates"
    ]
  },
  {
    "id": 15,
    "db_id": "student_assessment",
    "question": "What is the email address of the person whose corresponding candidate detail is 'Leo'?",
    "sql": "SELECT email_address FROM People p JOIN Candidates c ON p.person_id = c.candidate_id WHERE c.candidate_details = 'Leo';",
    "table_names": [
      "People",
      "Candidates"
    ]
  },
  {
    "id": 16,
    "db_id": "student_assessment",
    "question": "Which students attended the course with ID 301 after January 1, 2010?",
    "sql": "SELECT student_details FROM Students WHERE student_id IN (SELECT student_id FROM Student_Course_Attendance WHERE course_id = 301 AND date_of_attendance > '2010-01-01')",
    "table_names": [
      "Students",
      "Student_Course_Attendance"
    ]
  },
  {
    "id": 17,
    "db_id": "student_assessment",
    "question": "List the names of students who attended course 301 but did not attend course 302.",
    "sql": "SELECT student_details FROM Students WHERE student_id IN (SELECT student_id FROM Student_Course_Attendance WHERE course_id = 301) AND student_id NOT IN (SELECT student_id FROM Student_Course_Attendance WHERE course_id = 302);",
    "table_names": [
      "Students",
      "Student_Course_Attendance"
    ]
  },
  {
    "id": 18,
    "db_id": "student_assessment",
    "question": "What are the names of the courses that have at least three different students registered?",
    "sql": "SELECT course_name FROM Courses WHERE course_id IN (SELECT course_id FROM Student_Course_Registrations GROUP BY course_id HAVING COUNT(DISTINCT student_id) >= 3);",
    "table_names": [
      "Courses",
      "Student_Course_Registrations"
    ]
  },
  {
    "id": 19,
    "db_id": "student_assessment",
    "question": "Which student has registered for both courses 301 and 302?",
    "sql": "SELECT student_details FROM Students WHERE student_id IN (SELECT student_id FROM Student_Course_Registrations WHERE course_id = 301) AND student_id IN (SELECT student_id FROM Student_Course_Registrations WHERE course_id = 302);",
    "table_names": [
      "Students",
      "Student_Course_Registrations"
    ]
  },
  {
    "id": 20,
    "db_id": "student_assessment",
    "question": "Which student has registered for both courses with course_id '301' and '303'?",
    "sql": "SELECT student_details FROM Students WHERE student_id IN (SELECT student_id FROM Student_Course_Registrations WHERE course_id = 301 AND student_id IN (SELECT student_id FROM Student_Course_Registrations WHERE course_id = 303));",
    "table_names": [
      "Students",
      "Student_Course_Registrations"
    ]
  },
  {
    "id": 21,
    "db_id": "student_assessment",
    "question": "List the names of courses that have had attendance from at least three different students.",
    "sql": "SELECT course_name FROM Courses WHERE course_id IN (SELECT course_id FROM Student_Course_Attendance GROUP BY course_id HAVING COUNT(DISTINCT student_id) >= 3);",
    "table_names": [
      "Courses",
      "Student_Course_Attendance"
    ]
  },
  {
    "id": 22,
    "db_id": "student_assessment",
    "question": "How many unique students attended either the statistics or database courses?",
    "sql": "SELECT COUNT(DISTINCT sca.student_id) FROM Student_Course_Attendance sca JOIN Courses c ON sca.course_id = c.course_id WHERE c.course_name IN ('statistics', 'database');",
    "table_names": [
      "Courses",
      "Student_Course_Attendance"
    ]
  },
  {
    "id": 23,
    "db_id": "student_assessment",
    "question": "Which students attended both statistics and French courses?",
    "sql": "SELECT DISTINCT student_id FROM Student_Course_Attendance WHERE course_id IN (SELECT course_id FROM Courses WHERE course_name IN ('statistics','French')) GROUP BY student_id HAVING COUNT(DISTINCT course_id) = 2",
    "table_names": [
      "Courses",
      "Student_Course_Attendance"
    ]
  },
  {
    "id": 24,
    "db_id": "student_assessment",
    "question": "Which students attended both 'statistics' and 'English' courses?",
    "sql": "SELECT DISTINCT s.student_id FROM Student_Course_Attendance s JOIN Courses c ON s.course_id = c.course_id WHERE c.course_name IN ('statistics', 'English') GROUP BY s.student_id HAVING COUNT(DISTINCT c.course_name) = 2;",
    "table_names": [
      "Courses",
      "Student_Course_Attendance"
    ]
  },
  {
    "id": 25,
    "db_id": "student_assessment",
    "question": "What is the email address of the candidate whose detail is listed as 'Robert'?",
    "sql": "SELECT People.email_address FROM People JOIN Candidates ON People.person_id = Candidates.candidate_id WHERE Candidates.candidate_details = 'Robert';",
    "table_names": [
      "People",
      "Candidates"
    ]
  },
  {
    "id": 26,
    "db_id": "student_assessment",
    "question": "What is the first and last name of the person whose candidate details are 'Robin'?",
    "sql": "SELECT People.first_name, People.last_name FROM People JOIN Candidates ON People.person_id = Candidates.candidate_id WHERE Candidates.candidate_details = 'Robin';",
    "table_names": [
      "People",
      "Candidates"
    ]
  },
  {
    "id": 27,
    "db_id": "student_assessment",
    "question": "Which student has registered for both courses with IDs 301 and 302?",
    "sql": "SELECT student_details FROM Students WHERE student_id IN (SELECT student_id FROM Student_Course_Registrations WHERE course_id = 301 AND student_id IN (SELECT student_id FROM Student_Course_Registrations WHERE course_id = 302));",
    "table_names": [
      "Students",
      "Student_Course_Registrations"
    ]
  },
  {
    "id": 28,
    "db_id": "student_assessment",
    "question": "List the names of students who have only registered for course 301 and no other courses.",
    "sql": "SELECT student_details FROM Students WHERE student_id IN (SELECT student_id FROM Student_Course_Registrations WHERE course_id = 301) AND student_id NOT IN (SELECT student_id FROM Student_Course_Registrations WHERE course_id != 301);",
    "table_names": [
      "Students",
      "Student_Course_Registrations"
    ]
  },
  {
    "id": 29,
    "db_id": "student_assessment",
    "question": "What are the names of students who registered for course 301 after November 1, 2008?",
    "sql": "SELECT student_details FROM Students WHERE student_id IN (SELECT student_id FROM Student_Course_Registrations WHERE course_id = 301 AND registration_date > '2008-11-01 00:00:00');",
    "table_names": [
      "Students",
      "Student_Course_Registrations"
    ]
  },
  {
    "id": 30,
    "db_id": "student_assessment",
    "question": "What are the names of students who enrolled in any courses that student Nikhil enrolled in, excluding Nikhil himself?",
    "sql": "SELECT student_details FROM Students WHERE student_id IN (SELECT student_id FROM Student_Course_Registrations WHERE course_id IN (SELECT course_id FROM Student_Course_Registrations WHERE student_id = 141) AND student_id !=141);",
    "table_names": [
      "Students",
      "Student_Course_Registrations"
    ]
  },
  {
    "id": 31,
    "db_id": "student_assessment",
    "question": "How many unique people started living at addresses in SouthDakota before the year 2011?",
    "sql": "SELECT COUNT(DISTINCT pa.person_id) FROM People_Addresses pa JOIN Addresses a ON pa.address_id = a.address_id WHERE a.state_province_county = 'SouthDakota' AND pa.date_from < '2011-01-01';",
    "table_names": [
      "Addresses",
      "People_Addresses"
    ]
  },
  {
    "id": 32,
    "db_id": "student_assessment",
    "question": "What is the state_province_county of the address where the person with person_id 141 lived?",
    "sql": "SELECT A.state_province_county FROM Addresses A JOIN People_Addresses PA ON A.address_id = PA.address_id WHERE PA.person_id = 141;",
    "table_names": [
      "Addresses",
      "People_Addresses"
    ]
  },
  {
    "id": 33,
    "db_id": "student_assessment",
    "question": "How many distinct students registered in November 2008 attended their registered courses between 2012 and 2015?",
    "sql": "SELECT COUNT(DISTINCT sr.student_id) FROM Student_Course_Registrations sr JOIN Student_Course_Attendance sa ON sr.student_id = sa.student_id AND sr.course_id = sa.course_id WHERE sr.registration_date BETWEEN '2008-11-01' AND '2008-11-30' AND sa.date_of_attendance BETWEEN '2012-01-01' AND '2015-12-31';",
    "table_names": [
      "Student_Course_Registrations",
      "Student_Course_Attendance"
    ]
  },
  {
    "id": 34,
    "db_id": "student_assessment",
    "question": "How many distinct students registered for courses before November 6, 2008, and attended those same courses after January 1, 2012?",
    "sql": "SELECT COUNT(DISTINCT r.student_id) FROM Student_Course_Registrations r JOIN Student_Course_Attendance a ON r.student_id = a.student_id AND r.course_id = a.course_id WHERE r.registration_date < '2008-11-06' AND a.date_of_attendance > '2012-01-01';",
    "table_names": [
      "Student_Course_Registrations",
      "Student_Course_Attendance"
    ]
  },
  {
    "id": 35,
    "db_id": "student_assessment",
    "question": "How many unique students registered for courses between November 5th and November 8th, 2008, actually attended their respective courses after January 1st, 2013?",
    "sql": "SELECT COUNT(DISTINCT scr.student_id) FROM Student_Course_Registrations scr INNER JOIN Student_Course_Attendance sca ON scr.student_id = sca.student_id AND scr.course_id = sca.course_id WHERE scr.registration_date BETWEEN '2008-11-05' AND '2008-11-08' AND sca.date_of_attendance > '2013-01-01';",
    "table_names": [
      "Student_Course_Registrations",
      "Student_Course_Attendance"
    ]
  },
  {
    "id": 36,
    "db_id": "student_assessment",
    "question": "How many students registered before November 8, 2008, have attended their courses during or after the year 2012?",
    "sql": "SELECT COUNT(DISTINCT SCR.student_id) FROM Student_Course_Registrations AS SCR INNER JOIN Student_Course_Attendance AS SCA ON SCR.student_id = SCA.student_id AND SCR.course_id = SCA.course_id WHERE SCR.registration_date < '2008-11-08' AND SCA.date_of_attendance >= '2012-01-01';",
    "table_names": [
      "Student_Course_Registrations",
      "Student_Course_Attendance"
    ]
  },
  {
    "id": 37,
    "db_id": "student_assessment",
    "question": "How many students registered before 7th November 2008 attended courses after 1st January 2012?",
    "sql": "SELECT COUNT(DISTINCT scr.student_id) FROM Student_Course_Registrations AS scr INNER JOIN Student_Course_Attendance AS sca ON scr.student_id = sca.student_id AND scr.course_id = sca.course_id WHERE scr.registration_date < '2008-11-07 00:00:00' AND sca.date_of_attendance > '2012-01-01 00:00:00';",
    "table_names": [
      "Student_Course_Registrations",
      "Student_Course_Attendance"
    ]
  },
  {
    "id": 38,
    "db_id": "student_assessment",
    "question": "How many students registered for courses before November 7th, 2008, and attended these courses after January 1st, 2012?",
    "sql": "SELECT COUNT(DISTINCT scr.student_id) AS num_students FROM Student_Course_Registrations scr JOIN Student_Course_Attendance sca ON scr.student_id = sca.student_id AND scr.course_id = sca.course_id WHERE scr.registration_date < '2008-11-07' AND sca.date_of_attendance > '2012-01-01';",
    "table_names": [
      "Student_Course_Registrations",
      "Student_Course_Attendance"
    ]
  },
  {
    "id": 39,
    "db_id": "student_assessment",
    "question": "List the names of courses that have at least one student registered before November 2008.",
    "sql": "SELECT c.course_name FROM Courses c JOIN Student_Course_Registrations r ON c.course_id = r.course_id WHERE r.registration_date < '2008-11-01';",
    "table_names": [
      "Courses",
      "Student_Course_Registrations"
    ]
  },
  {
    "id": 40,
    "db_id": "student_assessment",
    "question": "Which courses have more than two students registered?",
    "sql": "SELECT course_name FROM Courses WHERE course_id IN (SELECT course_id FROM Student_Course_Registrations GROUP BY course_id HAVING COUNT(student_id) > 2);",
    "table_names": [
      "Courses",
      "Student_Course_Registrations"
    ]
  },
  {
    "id": 41,
    "db_id": "student_assessment",
    "question": "Which course had the highest number of distinct student attendances from 2012 to 2015?",
    "sql": "SELECT c.course_name, COUNT(DISTINCT sca.student_id) AS student_count FROM Courses c JOIN Student_Course_Attendance sca ON c.course_id = sca.course_id WHERE sca.date_of_attendance BETWEEN '2012-01-01' AND '2015-12-31' GROUP BY c.course_name ORDER BY student_count DESC LIMIT 1;",
    "table_names": [
      "Courses",
      "Student_Course_Attendance"
    ]
  },
  {
    "id": 42,
    "db_id": "student_assessment",
    "question": "Which course had the highest number of distinct student attendances between the years 2012 and 2014?",
    "sql": "SELECT c.course_name, COUNT(DISTINCT sca.student_id) AS number_of_students FROM Courses c JOIN Student_Course_Attendance sca ON c.course_id = sca.course_id WHERE DATE(sca.date_of_attendance) BETWEEN '2012-01-01' AND '2014-12-31' GROUP BY c.course_name ORDER BY number_of_students DESC LIMIT 1;",
    "table_names": [
      "Courses",
      "Student_Course_Attendance"
    ]
  },
  {
    "id": 81,
    "db_id": "book_2",
    "question": "What is the total price of all books written by Garth Ennis?",
    "sql": "SELECT SUM(p.Price) FROM publication p JOIN book b ON p.Book_ID = b.Book_ID WHERE b.Writer = 'Garth Ennis';",
    "table_names": [
      "publication",
      "book"
    ]
  },
  {
    "id": 82,
    "db_id": "book_2",
    "question": "What books published by Pearson have more than 5 issues?",
    "sql": "SELECT book.Title FROM publication INNER JOIN book ON publication.Book_ID = book.Book_ID WHERE publication.Publisher = 'Pearson' AND book.Issues > 5;",
    "table_names": [
      "publication",
      "book"
    ]
  },
  {
    "id": 83,
    "db_id": "book_2",
    "question": "What are the titles of the books that have 5 or more issues and have a publication price higher than 4,000,000?",
    "sql": "SELECT b.Title FROM book b JOIN publication p ON b.Book_ID = p.Book_ID WHERE p.Price > 4000000 AND b.Issues >= 5;",
    "table_names": [
      "publication",
      "book"
    ]
  },
  {
    "id": 84,
    "db_id": "book_2",
    "question": "What is the total price of all books with at least 5 issues that were not published by Wiley?",
    "sql": "SELECT SUM(publication.Price) FROM publication INNER JOIN book ON publication.Book_ID = book.Book_ID WHERE book.Issues >= 5 AND publication.Publisher != 'Wiley';",
    "table_names": [
      "publication",
      "book"
    ]
  },
  {
    "id": 85,
    "db_id": "musical",
    "question": "Which actors played in musicals that won the Drama Desk Award?",
    "sql": "SELECT a.Name FROM actor a JOIN musical m ON a.Musical_ID = m.Musical_ID WHERE m.Award = 'Drama Desk Award' AND m.Result = 'Won';",
    "table_names": [
      "musical",
      "actor"
    ]
  },
  {
    "id": 86,
    "db_id": "musical",
    "question": "Who were the actors who participated in musicals that received a Drama Desk Award and won?",
    "sql": "SELECT a.Name FROM actor AS a INNER JOIN musical AS m ON a.Musical_ID = m.Musical_ID WHERE m.Name IN (SELECT Name FROM musical WHERE Award = 'Drama Desk Award' AND Result = 'Won');",
    "table_names": [
      "musical",
      "actor"
    ]
  },
  {
    "id": 87,
    "db_id": "musical",
    "question": "Which musical that won an award featured the actor with the highest age?",
    "sql": "SELECT m.Name FROM musical m JOIN actor a ON m.Musical_ID = a.Musical_ID WHERE a.age = (SELECT MAX(age) FROM actor) AND m.Result = 'Won';",
    "table_names": [
      "musical",
      "actor"
    ]
  },
  {
    "id": 88,
    "db_id": "musical",
    "question": "Which musicals that won an award featured actors older than 20 years?",
    "sql": "SELECT m.Name FROM musical m JOIN actor a ON m.Musical_ID = a.Musical_ID WHERE a.age > 20 AND m.Result = 'Won';",
    "table_names": [
      "musical",
      "actor"
    ]
  },
  {
    "id": 89,
    "db_id": "musical",
    "question": "Which actors performed in musicals that won for 'Outstanding Choreography'?",
    "sql": "SELECT actor.Name FROM actor JOIN musical ON actor.Musical_ID = musical.Musical_ID WHERE musical.Result = 'Won' AND musical.Category = 'Outstanding Choreography';",
    "table_names": [
      "musical",
      "actor"
    ]
  },
  {
    "id": 90,
    "db_id": "musical",
    "question": "Which actor performed in the musical that won the Tony Award for Best Choreography?",
    "sql": "SELECT a.Name FROM actor a JOIN musical m ON a.Musical_ID = m.Musical_ID WHERE m.Result = 'Won' AND m.Category = 'Best Choreography';",
    "table_names": [
      "musical",
      "actor"
    ]
  },
  {
    "id": 91,
    "db_id": "musical",
    "question": "Which actor performed in the musical that won the award for Best Choreography?",
    "sql": "SELECT a.Name FROM actor a JOIN musical m ON a.Musical_ID = m.Musical_ID WHERE m.Result = 'Won' AND m.Category = 'Best Choreography';",
    "table_names": [
      "musical",
      "actor"
    ]
  },
  {
    "id": 92,
    "db_id": "musical",
    "question": "List the names of musicals that were nominated for a Tony Award and had actors older than 20 performing in them.",
    "sql": "SELECT m.Name FROM musical m JOIN actor a ON m.Musical_ID = a.Musical_ID WHERE a.age > 20 AND m.Result = 'Nominated' AND m.Award = 'Tony Award';",
    "table_names": [
      "musical",
      "actor"
    ]
  },
  {
    "id": 93,
    "db_id": "musical",
    "question": "What musicals nominated for a Drama Desk Award featured actors older than 19 years?",
    "sql": "SELECT musical.Name FROM musical INNER JOIN actor ON musical.Musical_ID = actor.Musical_ID WHERE musical.Award = 'Drama Desk Award' AND musical.Result = 'Nominated' AND actor.age > 19;",
    "table_names": [
      "musical",
      "actor"
    ]
  },
  {
    "id": 94,
    "db_id": "musical",
    "question": "Who is the oldest actor appearing in a musical that won an award?",
    "sql": "SELECT a.Name FROM actor a JOIN musical m ON a.Musical_ID = m.Musical_ID WHERE m.Result = 'Won' AND a.age = (SELECT MAX(age) FROM actor WHERE Musical_ID IN (SELECT Musical_ID FROM musical WHERE Result = 'Won'));",
    "table_names": [
      "musical",
      "actor"
    ]
  },
  {
    "id": 95,
    "db_id": "musical",
    "question": "Who played characters in the musical that won the Tony Award for Best Choreography?",
    "sql": "SELECT a.Name FROM actor a JOIN musical m ON a.Musical_ID = m.Musical_ID WHERE m.Category = 'Best Choreography' AND m.Result = 'Won';",
    "table_names": [
      "musical",
      "actor"
    ]
  },
  {
    "id": 96,
    "db_id": "musical",
    "question": "Identify the names of actors who are at least 20 years old and played roles in musicals that have won a Tony Award?",
    "sql": "SELECT actor.Name FROM actor JOIN musical ON actor.Musical_ID = musical.Musical_ID WHERE musical.Award = 'Tony Award' AND musical.Result = 'Won' AND actor.age >= 20;",
    "table_names": [
      "musical",
      "actor"
    ]
  },
  {
    "id": 97,
    "db_id": "twitter_1",
    "question": "Which users followed by Iron Man have more than 10 million followers?",
    "sql": "SELECT u.name FROM follows f JOIN user_profiles u ON f.f2 = u.uid WHERE f.f1 = (SELECT uid FROM user_profiles WHERE name = 'Iron Man') AND u.followers > 10000000;",
    "table_names": [
      "follows",
      "user_profiles"
    ]
  },
  {
    "id": 98,
    "db_id": "twitter_1",
    "question": "Who does Iron Man follow that has more than 1 million followers?",
    "sql": "SELECT name FROM user_profiles WHERE uid IN (SELECT f2 FROM follows WHERE f1 IN (SELECT uid FROM user_profiles WHERE name = 'Iron Man')) AND followers > 1000000;",
    "table_names": [
      "follows",
      "user_profiles"
    ]
  },
  {
    "id": 99,
    "db_id": "twitter_1",
    "question": "Which user has posted the most number of tweets?",
    "sql": "SELECT u.name FROM user_profiles u JOIN tweets t ON u.uid = t.uid GROUP BY u.uid ORDER BY COUNT(t.id) DESC LIMIT 1;",
    "table_names": [
      "tweets",
      "user_profiles"
    ]
  },
  {
    "id": 100,
    "db_id": "twitter_1",
    "question": "What are the names of the users followed by the user that Natalie Portman is following?",
    "sql": "SELECT u.name FROM user_profiles u JOIN follows f ON u.uid = f.f2 WHERE f.f1 IN (SELECT f2 FROM follows WHERE f1 = (SELECT uid FROM user_profiles WHERE name = 'Natalie Portman'));",
    "table_names": [
      "follows",
      "user_profiles"
    ]
  },
  {
    "id": 101,
    "db_id": "twitter_1",
    "question": "Who is the user with the highest number of followers that posted a tweet exactly on '2018-03-12 02:30:30'?",
    "sql": "SELECT user_profiles.name FROM user_profiles INNER JOIN tweets ON user_profiles.uid = tweets.uid WHERE tweets.createdate = '2018-03-12 02:30:30' ORDER BY user_profiles.followers DESC LIMIT 1;",
    "table_names": [
      "tweets",
      "user_profiles"
    ]
  },
  {
    "id": 102,
    "db_id": "twitter_1",
    "question": "Which user's tweet was posted most recently among those who have less than 500,000 followers?",
    "sql": "SELECT user_profiles.name FROM tweets JOIN user_profiles ON tweets.uid = user_profiles.uid WHERE tweets.createdate = (SELECT MAX(createdate) FROM tweets) AND user_profiles.followers < 500000;",
    "table_names": [
      "tweets",
      "user_profiles"
    ]
  },
  {
    "id": 103,
    "db_id": "twitter_1",
    "question": "Which users with more than a million followers tweeted between March 9 and March 10, 2018?",
    "sql": "SELECT u.name FROM user_profiles u JOIN tweets t ON u.uid = t.uid WHERE u.followers > 1000000 AND t.createdate BETWEEN '2018-03-09' AND '2018-03-10';",
    "table_names": [
      "tweets",
      "user_profiles"
    ]
  },
  {
    "id": 104,
    "db_id": "twitter_1",
    "question": "What is the most recent tweet from any user who has more than 10 million followers?",
    "sql": "SELECT tweets.text FROM tweets JOIN user_profiles ON tweets.uid = user_profiles.uid WHERE user_profiles.followers > 10000000 ORDER BY tweets.createdate DESC LIMIT 1;",
    "table_names": [
      "tweets",
      "user_profiles"
    ]
  },
  {
    "id": 105,
    "db_id": "twitter_1",
    "question": "Among users who have tweeted posts with text length of at least 50 characters, who has the highest follower count?",
    "sql": "SELECT u.name FROM tweets t JOIN user_profiles u ON t.uid = u.uid WHERE LENGTH(t.text) >= 50 ORDER BY u.followers DESC LIMIT 1;",
    "table_names": [
      "tweets",
      "user_profiles"
    ]
  },
  {
    "id": 106,
    "db_id": "product_catalog",
    "question": "What is the date of the latest revision for the catalog item with catalog level name 'Product'?",
    "sql": "SELECT date_of_latest_revision FROM Catalogs WHERE catalog_id = (SELECT catalog_id FROM Catalog_Structure WHERE catalog_level_name = 'Product');",
    "table_names": [
      "Catalogs",
      "Catalog_Structure"
    ]
  },
  {
    "id": 107,
    "db_id": "product_catalog",
    "question": "What is the name of the catalog published by Murray Coffee shop categorized as a 'Sub-Category'?",
    "sql": "SELECT Catalogs.catalog_name FROM Catalogs INNER JOIN Catalog_Structure ON Catalogs.catalog_id = Catalog_Structure.catalog_id WHERE Catalog_Structure.catalog_level_name = 'Sub-Category' AND Catalogs.catalog_publisher = 'Murray Coffee shop';",
    "table_names": [
      "Catalogs",
      "Catalog_Structure"
    ]
  },
  {
    "id": 108,
    "db_id": "product_catalog",
    "question": "What is the most expensive product in dollars that has an attribute with id 4 set to value 1?",
    "sql": "SELECT CC.catalog_entry_name, CC.price_in_dollars FROM Catalog_Contents CC JOIN Catalog_Contents_Additional_Attributes CCAA ON CC.catalog_entry_id = CCAA.catalog_entry_id WHERE CCAA.attribute_id = 4 AND CCAA.attribute_value = '1' ORDER BY CC.price_in_dollars DESC LIMIT 1;",
    "table_names": [
      "Catalog_Contents",
      "Catalog_Contents_Additional_Attributes"
    ]
  },
  {
    "id": 109,
    "db_id": "product_catalog",
    "question": "List the product names and their prices in dollars from the catalog entries that have an attribute ID 3 set as '1' and attribute ID 4 set as '0'.",
    "sql": "SELECT c.catalog_entry_name, c.price_in_dollars FROM Catalog_Contents c JOIN Catalog_Contents_Additional_Attributes ca1 ON c.catalog_entry_id = ca1.catalog_entry_id JOIN Catalog_Contents_Additional_Attributes ca2 ON c.catalog_entry_id = ca2.catalog_entry_id WHERE ca1.attribute_id = 3 AND ca1.attribute_value = '1' AND ca2.attribute_id = 4 AND ca2.attribute_value = '0';",
    "table_names": [
      "Catalog_Contents",
      "Catalog_Contents_Additional_Attributes"
    ]
  },
  {
    "id": 110,
    "db_id": "product_catalog",
    "question": "What is the average price in dollars of products whose parent entries are sub-categories priced above 700 dollars?",
    "sql": "SELECT AVG(price_in_dollars) FROM Catalog_Contents WHERE catalog_level_number = (SELECT catalog_level_number FROM Catalog_Structure WHERE catalog_level_name = 'Product') AND parent_entry_id IN (SELECT catalog_entry_id FROM Catalog_Contents WHERE catalog_level_number = (SELECT catalog_level_number FROM Catalog_Structure WHERE catalog_level_name = 'Sub-Category') AND price_in_dollars > 700)",
    "table_names": [
      "Catalog_Structure",
      "Catalog_Contents"
    ]
  },
  {
    "id": 111,
    "db_id": "product_catalog",
    "question": "What is the average price in dollars of all items classified under the 'Product' catalog level?",
    "sql": "SELECT AVG(cc.price_in_dollars) AS avg_price FROM Catalog_Contents cc JOIN Catalog_Structure cs ON cc.catalog_level_number = cs.catalog_level_number WHERE cs.catalog_level_name = 'Product';",
    "table_names": [
      "Catalog_Structure",
      "Catalog_Contents"
    ]
  },
  {
    "id": 112,
    "db_id": "product_catalog",
    "question": "What are the names of catalog entries that have a price greater than $600 and a specific attribute id 4 with value '1'?",
    "sql": "SELECT c.catalog_entry_name FROM Catalog_Contents c JOIN Catalog_Contents_Additional_Attributes a ON c.catalog_entry_id = a.catalog_entry_id WHERE c.price_in_dollars > 600 AND a.attribute_id = 4 AND a.attribute_value = '1';",
    "table_names": [
      "Catalog_Contents",
      "Catalog_Contents_Additional_Attributes"
    ]
  },
  {
    "id": 113,
    "db_id": "product_catalog",
    "question": "What is the total price in dollars for all products listed in catalog level number 8 which have an attribute_id of 4 with attribute_value '1' in the additional attributes table?",
    "sql": "SELECT SUM(cc.price_in_dollars) FROM Catalog_Contents AS cc JOIN Catalog_Contents_Additional_Attributes AS cca ON cc.catalog_entry_id = cca.catalog_entry_id WHERE cc.catalog_level_number = 8 AND cca.attribute_id = 4 AND cca.attribute_value = '1';",
    "table_names": [
      "Catalog_Contents",
      "Catalog_Contents_Additional_Attributes"
    ]
  },
  {
    "id": 114,
    "db_id": "product_catalog",
    "question": "How many distinct catalog entries have either 'Sweet' or 'Green' attributes set as true?",
    "sql": "SELECT COUNT(DISTINCT catalog_entry_id) FROM Catalog_Contents_Additional_Attributes WHERE attribute_id IN (SELECT attribute_id FROM Attribute_Definitions WHERE attribute_name IN ('Sweet','Green')) AND attribute_value='1';",
    "table_names": [
      "Attribute_Definitions",
      "Catalog_Contents_Additional_Attributes"
    ]
  },
  {
    "id": 115,
    "db_id": "product_catalog",
    "question": "How many unique catalog entries have either the 'Green' or 'Sweet' attribute set to true?",
    "sql": "SELECT COUNT(DISTINCT catalog_entry_id) FROM Catalog_Contents_Additional_Attributes WHERE attribute_id IN (SELECT attribute_id FROM Attribute_Definitions WHERE attribute_name IN ('Green', 'Sweet')) AND attribute_value = '1';",
    "table_names": [
      "Attribute_Definitions",
      "Catalog_Contents_Additional_Attributes"
    ]
  },
  {
    "id": 116,
    "db_id": "flight_1",
    "question": "What destinations are served by flights using the Airbus A340-300 aircraft that cover distances greater than 5000 miles, and what is the price of each flight?",
    "sql": "SELECT f.destination, f.price FROM flight f JOIN aircraft a ON f.aid = a.aid WHERE a.name = 'Airbus A340-300' AND f.distance > 5000;",
    "table_names": [
      "flight",
      "aircraft"
    ]
  },
  {
    "id": 117,
    "db_id": "flight_1",
    "question": "List the flight numbers and aircraft names for flights covering a distance greater than 5000 miles, operated by aircraft models with a maximum distance capacity of less than 8000 miles.",
    "sql": "SELECT flight.flno, aircraft.name FROM flight INNER JOIN aircraft ON flight.aid = aircraft.aid WHERE flight.distance > 5000 AND aircraft.distance < 8000;",
    "table_names": [
      "flight",
      "aircraft"
    ]
  },
  {
    "id": 118,
    "db_id": "flight_1",
    "question": "Which flights have traveled distances greater than 5000 miles using aircrafts with a range below 8000 miles? List the flight number, origin, destination, and aircraft name.",
    "sql": "SELECT f.flno, f.origin, f.destination, a.name FROM flight f JOIN aircraft a ON f.aid = a.aid WHERE f.distance > 5000 AND a.distance < 8000;",
    "table_names": [
      "flight",
      "aircraft"
    ]
  },
  {
    "id": 119,
    "db_id": "flight_1",
    "question": "What are the flight number, origin, and destination for flights operated by Boeing 737-800 aircraft traveling more than 1200 miles?",
    "sql": "SELECT f.flno, f.origin, f.destination FROM flight f JOIN aircraft a ON f.aid = a.aid WHERE a.name = 'Boeing 737-800' AND f.distance > 1200;",
    "table_names": [
      "flight",
      "aircraft"
    ]
  },
  {
    "id": 120,
    "db_id": "flight_1",
    "question": "What is the flight number and aircraft name for the flight from Los Angeles to Sydney, and does the aircraft used have sufficient range for the distance?",
    "sql": "SELECT f.flno, a.name FROM flight f INNER JOIN aircraft a ON f.aid = a.aid WHERE f.origin = 'Los Angeles' AND f.destination = 'Sydney' AND a.distance >= f.distance;",
    "table_names": [
      "flight",
      "aircraft"
    ]
  },
  {
    "id": 121,
    "db_id": "flight_1",
    "question": "List the names of aircraft that have a maximum flight distance shorter than the distance required for the flight from Los Angeles to Sydney.",
    "sql": "SELECT name FROM aircraft WHERE distance < (SELECT distance FROM flight WHERE origin = 'Los Angeles' AND destination = 'Sydney');",
    "table_names": [
      "flight",
      "aircraft"
    ]
  },
  {
    "id": 122,
    "db_id": "flight_1",
    "question": "Which flights departing from Los Angeles use aircraft whose maximum range is shorter than the flight's scheduled distance, and what are the aircraft models for these flights?",
    "sql": "SELECT f.flno, a.name FROM flight f JOIN aircraft a ON f.aid = a.aid WHERE f.origin = 'Los Angeles' AND a.distance < f.distance;",
    "table_names": [
      "flight",
      "aircraft"
    ]
  },
  {
    "id": 123,
    "db_id": "flight_1",
    "question": "What aircraft model is used for the flight from Los Angeles to Sydney?",
    "sql": "SELECT aircraft.name FROM flight JOIN aircraft ON flight.aid = aircraft.aid WHERE flight.origin = 'Los Angeles' AND flight.destination = 'Sydney';",
    "table_names": [
      "flight",
      "aircraft"
    ]
  },
  {
    "id": 124,
    "db_id": "flight_1",
    "question": "Which employee or employees hold the highest number of certificates?",
    "sql": "SELECT name FROM employee WHERE eid IN (SELECT eid FROM certificate GROUP BY eid HAVING COUNT(aid) = (SELECT MAX(cert_count) FROM (SELECT COUNT(aid) as cert_count FROM certificate GROUP BY eid) as cnt));",
    "table_names": [
      "employee",
      "certificate"
    ]
  },
  {
    "id": 125,
    "db_id": "flight_1",
    "question": "Which employee with a salary above 200000 holds certificates with aid values of 3, 4, and 5?",
    "sql": "SELECT e.name FROM employee e INNER JOIN certificate c ON e.eid = c.eid WHERE c.aid IN (3, 4, 5) GROUP BY e.eid HAVING COUNT(DISTINCT c.aid) = 3 AND salary > 200000;",
    "table_names": [
      "employee",
      "certificate"
    ]
  },
  {
    "id": 126,
    "db_id": "flight_1",
    "question": "What are the names of aircrafts certified by eid 567354612 that have a maximum flight distance greater than 5000 miles?",
    "sql": "SELECT aircraft.name FROM aircraft JOIN certificate ON aircraft.aid = certificate.aid WHERE certificate.eid = 567354612 AND aircraft.distance > 5000;",
    "table_names": [
      "aircraft",
      "certificate"
    ]
  },
  {
    "id": 127,
    "db_id": "flight_1",
    "question": "What is the name of the aircraft that has certificates issued to the largest number of different eid holders?",
    "sql": "SELECT name FROM aircraft WHERE aid IN (SELECT aid FROM certificate GROUP BY aid ORDER BY COUNT(DISTINCT eid) DESC LIMIT 1)",
    "table_names": [
      "aircraft",
      "certificate"
    ]
  },
  {
    "id": 128,
    "db_id": "flight_1",
    "question": "Which aircrafts with a certified pilot having employee ID 142519864 have a flying distance greater than 5000?",
    "sql": "SELECT a.name FROM aircraft a JOIN certificate c ON a.aid = c.aid WHERE c.eid = 142519864 AND a.distance > 5000;",
    "table_names": [
      "aircraft",
      "certificate"
    ]
  },
  {
    "id": 129,
    "db_id": "flight_1",
    "question": "Which employees have certifications for aircraft models capable of flying a distance greater than 6000 units?",
    "sql": "SELECT DISTINCT c.eid FROM certificate c INNER JOIN aircraft a ON c.aid = a.aid WHERE a.distance > 6000;",
    "table_names": [
      "aircraft",
      "certificate"
    ]
  },
  {
    "id": 130,
    "db_id": "flight_1",
    "question": "Who is the employee with the highest salary among those who have received certificate number 15?",
    "sql": "SELECT e.name FROM employee e JOIN certificate c ON e.eid = c.eid WHERE c.aid = 15 ORDER BY e.salary DESC LIMIT 1;",
    "table_names": [
      "employee",
      "certificate"
    ]
  },
  {
    "id": 131,
    "db_id": "flight_1",
    "question": "What is the highest salary of employees who have obtained certificate number 14?",
    "sql": "SELECT MAX(e.salary) FROM employee e INNER JOIN certificate c ON e.eid = c.eid WHERE c.aid = 14;",
    "table_names": [
      "employee",
      "certificate"
    ]
  },
  {
    "id": 132,
    "db_id": "allergy_1",
    "question": "Which students from Pittsburgh (PIT) have an allergy to nuts?",
    "sql": "SELECT Student.Fname, Student.LName FROM Student INNER JOIN Has_Allergy ON Student.StuID = Has_Allergy.StuID WHERE Has_Allergy.Allergy='Nuts' AND Student.city_code='PIT';",
    "table_names": [
      "Has_Allergy",
      "Student"
    ]
  },
  {
    "id": 133,
    "db_id": "allergy_1",
    "question": "Which students with an allergy to nuts live in the city PIT?",
    "sql": "SELECT Student.Fname, Student.LName FROM Student JOIN Has_Allergy ON Student.StuID = Has_Allergy.StuID WHERE Has_Allergy.Allergy = 'Nuts' AND Student.city_code = 'PIT';",
    "table_names": [
      "Has_Allergy",
      "Student"
    ]
  },
  {
    "id": 134,
    "db_id": "allergy_1",
    "question": "How many distinct students from city code 'PHL' have an allergy to either 'Nuts' or 'Soy'?",
    "sql": "SELECT COUNT(DISTINCT Has_Allergy.StuID) FROM Has_Allergy JOIN Student ON Has_Allergy.StuID = Student.StuID WHERE Student.city_code = 'PHL' AND Has_Allergy.Allergy IN ('Nuts','Soy');",
    "table_names": [
      "Has_Allergy",
      "Student"
    ]
  },
  {
    "id": 135,
    "db_id": "allergy_1",
    "question": "List the unique first and last names of students who are allergic to nuts and are younger than 20.",
    "sql": "SELECT DISTINCT s.Fname, s.LName FROM Student s INNER JOIN Has_Allergy a ON s.StuID = a.StuID WHERE a.Allergy = 'Nuts' AND s.Age < 20;",
    "table_names": [
      "Has_Allergy",
      "Student"
    ]
  },
  {
    "id": 136,
    "db_id": "allergy_1",
    "question": "How many students have both animal and food allergies?",
    "sql": "SELECT COUNT(DISTINCT StuID) FROM Has_Allergy WHERE Allergy IN (SELECT Allergy FROM Allergy_Type WHERE AllergyType = 'animal') AND StuID IN (SELECT StuID FROM Has_Allergy WHERE Allergy IN (SELECT Allergy FROM Allergy_Type WHERE AllergyType = 'food'));",
    "table_names": [
      "Allergy_Type",
      "Has_Allergy"
    ]
  },
  {
    "id": 137,
    "db_id": "allergy_1",
    "question": "How many students have both animal and food allergies?",
    "sql": "SELECT COUNT(DISTINCT ha.StuID) FROM Has_Allergy ha JOIN Allergy_Type at ON ha.Allergy = at.Allergy WHERE at.AllergyType = 'food' AND ha.StuID IN (SELECT StuID FROM Has_Allergy ha2 JOIN Allergy_Type at2 ON ha2.Allergy = at2.Allergy WHERE at2.AllergyType = 'animal');",
    "table_names": [
      "Allergy_Type",
      "Has_Allergy"
    ]
  },
  {
    "id": 138,
    "db_id": "allergy_1",
    "question": "List all students who have both animal and environmental allergies.",
    "sql": "SELECT DISTINCT h.StuID FROM Has_Allergy h JOIN Allergy_Type a ON h.Allergy = a.Allergy WHERE a.AllergyType = 'animal' AND h.StuID IN (SELECT StuID FROM Has_Allergy h2 JOIN Allergy_Type a2 ON h2.Allergy = a2.Allergy WHERE a2.AllergyType = 'environmental');",
    "table_names": [
      "Allergy_Type",
      "Has_Allergy"
    ]
  },
  {
    "id": 139,
    "db_id": "allergy_1",
    "question": "How many students are allergic to both a food-type allergen and an animal-type allergen?",
    "sql": "SELECT COUNT(DISTINCT H1.StuID) FROM Has_Allergy H1 JOIN Allergy_Type AT1 ON H1.Allergy = AT1.Allergy JOIN Has_Allergy H2 ON H1.StuID = H2.StuID JOIN Allergy_Type AT2 ON H2.Allergy = AT2.Allergy WHERE AT1.AllergyType = 'food' AND AT2.AllergyType = 'animal';",
    "table_names": [
      "Allergy_Type",
      "Has_Allergy"
    ]
  },
  {
    "id": 140,
    "db_id": "allergy_1",
    "question": "What are the first and last names of students who have a nut allergy and live in the city with the code 'PIT'?",
    "sql": "SELECT s.Fname, s.LName FROM Student s INNER JOIN Has_Allergy ha ON s.StuID = ha.StuID WHERE ha.Allergy = 'Nuts' AND s.city_code = 'PIT';",
    "table_names": [
      "Has_Allergy",
      "Student"
    ]
  },
  {
    "id": 141,
    "db_id": "allergy_1",
    "question": "How many students from city 'HKG' have an allergy to shellfish?",
    "sql": "SELECT COUNT(DISTINCT s.StuID) FROM Student s JOIN Has_Allergy a ON s.StuID = a.StuID WHERE a.Allergy = 'Shellfish' AND s.city_code = 'HKG';",
    "table_names": [
      "Has_Allergy",
      "Student"
    ]
  },
  {
    "id": 142,
    "db_id": "allergy_1",
    "question": "How many distinct students from PIT city have an allergy to either Shellfish or Nuts?",
    "sql": "SELECT COUNT(DISTINCT Has_Allergy.StuID) FROM Has_Allergy JOIN Student ON Has_Allergy.StuID = Student.StuID WHERE Student.city_code = 'PIT' AND Has_Allergy.Allergy IN ('Shellfish', 'Nuts');",
    "table_names": [
      "Has_Allergy",
      "Student"
    ]
  },
  {
    "id": 143,
    "db_id": "allergy_1",
    "question": "List the full names and city codes of students who have allergies to both 'Nuts' and 'Soy'.",
    "sql": "SELECT s.Fname, s.LName, s.city_code FROM Student s JOIN Has_Allergy a ON s.StuID = a.StuID WHERE a.Allergy IN('Nuts', 'Soy') GROUP BY s.StuID HAVING COUNT(DISTINCT a.Allergy) = 2;",
    "table_names": [
      "Has_Allergy",
      "Student"
    ]
  },
  {
    "id": 144,
    "db_id": "allergy_1",
    "question": "Who are the students living in city HKG that have an allergy to Soy?",
    "sql": "SELECT DISTINCT s.Fname, s.LName FROM Student s JOIN Has_Allergy a ON s.StuID = a.StuID WHERE a.Allergy = 'Soy' AND s.city_code = 'HKG';",
    "table_names": [
      "Has_Allergy",
      "Student"
    ]
  },
  {
    "id": 145,
    "db_id": "allergy_1",
    "question": "How many students from city 'PIT' have allergies to either 'Shellfish' or 'Anchovies'?",
    "sql": "SELECT COUNT(*) FROM Student s JOIN Has_Allergy a ON s.StuID = a.StuID WHERE s.city_code = 'PIT' AND a.Allergy IN ('Shellfish', 'Anchovies');",
    "table_names": [
      "Has_Allergy",
      "Student"
    ]
  },
  {
    "id": 146,
    "db_id": "allergy_1",
    "question": "How many students from the city coded 'PIT' have a nut allergy?",
    "sql": "SELECT COUNT(DISTINCT s.StuID) FROM Student s JOIN Has_Allergy h ON s.StuID = h.StuID WHERE s.city_code = 'PIT' AND h.Allergy = 'Nuts';",
    "table_names": [
      "Has_Allergy",
      "Student"
    ]
  },
  {
    "id": 147,
    "db_id": "allergy_1",
    "question": "List the names of students who live in PIT city and have an allergy to Soy.",
    "sql": "SELECT S.LName, S.Fname FROM Student S JOIN Has_Allergy H ON S.StuID = H.StuID WHERE S.city_code = 'PIT' AND H.Allergy = 'Soy';",
    "table_names": [
      "Has_Allergy",
      "Student"
    ]
  },
  {
    "id": 148,
    "db_id": "tracking_orders",
    "question": "Which customer from Germany has the highest total spending amount? Provide their first name, last name, and the total spent.",
    "sql": "SELECT customers.first_name, customers.last_name, SUM(invoices.total) AS total_spent FROM customers JOIN invoices ON customers.id = invoices.customer_id WHERE customers.country = 'Germany' GROUP BY customers.first_name, customers.last_name ORDER BY total_spent DESC LIMIT 1;",
    "table_names": [
      "customers",
      "invoices"
    ]
  },
  {
    "id": 149,
    "db_id": "tracking_orders",
    "question": "Which customer in Germany has spent the most money and what is their total spending amount?",
    "sql": "SELECT c.first_name, c.last_name, SUM(i.total) AS total_spent FROM customers c JOIN invoices i ON c.id = i.customer_id WHERE c.country = 'Germany' GROUP BY c.id ORDER BY total_spent DESC LIMIT 1;",
    "table_names": [
      "customers",
      "invoices"
    ]
  },
  {
    "id": 150,
    "db_id": "tracking_orders",
    "question": "Which customer from the USA has spent the most on invoices in total, and what is their full name and total amount spent?",
    "sql": "SELECT customers.first_name, customers.last_name, SUM(invoices.total) AS total_spent FROM customers JOIN invoices ON customers.id = invoices.customer_id WHERE customers.country = 'USA' GROUP BY customers.id ORDER BY total_spent DESC LIMIT 1;",
    "table_names": [
      "customers",
      "invoices"
    ]
  },
  {
    "id": 151,
    "db_id": "tracking_orders",
    "question": "Which customer from Germany has spent the most total, and how much have they spent?",
    "sql": "SELECT c.first_name, c.last_name, SUM(i.total) as total_invoice_amount FROM customers c JOIN invoices i ON c.id = i.customer_id WHERE c.country = 'Germany' GROUP BY c.id ORDER BY total_invoice_amount DESC LIMIT 1;",
    "table_names": [
      "customers",
      "invoices"
    ]
  },
  {
    "id": 152,
    "db_id": "tracking_orders",
    "question": "What is the total amount invoiced to all customers from Germany?",
    "sql": "SELECT SUM(invoices.total) FROM invoices JOIN customers ON invoices.customer_id = customers.id WHERE customers.country = 'Germany';",
    "table_names": [
      "customers",
      "invoices"
    ]
  },
  {
    "id": 153,
    "db_id": "tracking_orders",
    "question": "Which customer from Germany spent the highest total amount according to their invoices?",
    "sql": "SELECT c.first_name, c.last_name, SUM(i.total) AS total_spent FROM customers c JOIN invoices i ON c.id = i.customer_id WHERE c.country = 'Germany' GROUP BY c.id ORDER BY total_spent DESC LIMIT 1;",
    "table_names": [
      "customers",
      "invoices"
    ]
  },
  {
    "id": 156,
    "db_id": "tracking_orders",
    "question": "What was the total invoice amount for all customers from France in the year 2008?",
    "sql": "SELECT SUM(i.total) FROM customers c INNER JOIN invoices i ON c.id = i.customer_id WHERE c.country = 'France' AND i.invoice_date BETWEEN '2008-01-01' AND '2008-12-31';",
    "table_names": [
      "customers",
      "invoices"
    ]
  },
  {
    "id": 157,
    "db_id": "tracking_orders",
    "question": "What is the total amount spent by all customers located in Germany?",
    "sql": "SELECT SUM(invoices.total) FROM invoices JOIN customers ON invoices.customer_id = customers.id WHERE customers.country = 'Germany';",
    "table_names": [
      "customers",
      "invoices"
    ]
  },
  {
    "id": 158,
    "db_id": "store_1",
    "question": "What are the titles of 'Deep Purple' albums that contain the word 'Live' in their titles?",
    "sql": "SELECT albums.title FROM albums JOIN artists ON albums.artist_id = artists.id WHERE artists.name = 'Deep Purple' AND albums.title LIKE '%Live%';",
    "table_names": [
      "artists",
      "albums"
    ]
  },
  {
    "id": 159,
    "db_id": "store_1",
    "question": "Who is the artist of the album titled 'Physical Graffiti [Disc 1]'?",
    "sql": "SELECT artists.name FROM artists JOIN albums ON artists.id = albums.artist_id WHERE albums.title = 'Physical Graffiti [Disc 1]';",
    "table_names": [
      "artists",
      "albums"
    ]
  },
  {
    "id": 160,
    "db_id": "store_1",
    "question": "Who is the artist that released the album titled 'Supernatural'?",
    "sql": "SELECT a.name FROM artists a JOIN albums al ON a.id = al.artist_id WHERE al.title = 'Supernatural';",
    "table_names": [
      "artists",
      "albums"
    ]
  },
  {
    "id": 161,
    "db_id": "store_1",
    "question": "Who is the artist of the album titled 'Nevermind'?",
    "sql": "SELECT artists.name FROM artists JOIN albums ON artists.id = albums.artist_id WHERE albums.title = 'Nevermind';",
    "table_names": [
      "artists",
      "albums"
    ]
  },
  {
    "id": 162,
    "db_id": "store_1",
    "question": "Which albums by Led Zeppelin contain 'BBC Sessions' in the title?",
    "sql": "SELECT albums.title FROM albums JOIN artists ON albums.artist_id = artists.id WHERE artists.name = 'Led Zeppelin' AND albums.title LIKE '%BBC Sessions%';",
    "table_names": [
      "artists",
      "albums"
    ]
  },
  {
    "id": 163,
    "db_id": "store_1",
    "question": "List all album titles by Deep Purple that contain the word 'Live'.",
    "sql": "SELECT a.title FROM albums a JOIN artists ar ON a.artist_id = ar.id WHERE ar.name = 'Deep Purple' AND a.title LIKE '%Live%';",
    "table_names": [
      "artists",
      "albums"
    ]
  },
  {
    "id": 164,
    "db_id": "store_1",
    "question": "What are the first and last names of customers whose support representative is a Sales Support Agent based in Calgary?",
    "sql": "SELECT c.first_name, c.last_name FROM customers c JOIN employees e ON c.support_rep_id = e.id WHERE e.title = 'Sales Support Agent' AND e.city = 'Calgary';",
    "table_names": [
      "employees",
      "customers"
    ]
  },
  {
    "id": 165,
    "db_id": "store_1",
    "question": "Who is the employee serving as a support representative for the customer named Mark Philips, and what is this employee's job title?",
    "sql": "SELECT e.first_name, e.last_name, e.title FROM employees e WHERE e.id = (SELECT support_rep_id FROM customers WHERE first_name = 'Mark' AND last_name = 'Philips');",
    "table_names": [
      "employees",
      "customers"
    ]
  },
  {
    "id": 166,
    "db_id": "store_1",
    "question": "Who are the employees with the title 'Sales Support Agent' who serve customers located in Germany?",
    "sql": "SELECT e.first_name || ' ' || e.last_name FROM employees e JOIN customers c ON e.id = c.support_rep_id WHERE c.country = 'Germany' AND e.title = 'Sales Support Agent';",
    "table_names": [
      "employees",
      "customers"
    ]
  },
  {
    "id": 167,
    "db_id": "store_1",
    "question": "How many customers have support representatives who report directly to Andrew Adams?",
    "sql": "SELECT COUNT(c.id) FROM customers c JOIN employees e ON c.support_rep_id = e.id WHERE e.reports_to = (SELECT id FROM employees WHERE first_name = 'Andrew' AND last_name = 'Adams');",
    "table_names": [
      "employees",
      "customers"
    ]
  },
  {
    "id": 168,
    "db_id": "tracking_orders",
    "question": "Which customer from Brazil has spent the highest total amount across all invoices?",
    "sql": "SELECT customers.first_name, customers.last_name, SUM(invoices.total) as total_spent FROM customers JOIN invoices ON customers.id = invoices.customer_id WHERE customers.country = 'Brazil' GROUP BY customers.id ORDER BY total_spent DESC LIMIT 1;",
    "table_names": [
      "customers",
      "invoices"
    ]
  },
  {
    "id": 169,
    "db_id": "tracking_orders",
    "question": "Which customer from Germany has spent the highest total amount, and how many invoices did they have?",
    "sql": "SELECT c.first_name, c.last_name, COUNT(i.id) AS num_invoices, SUM(i.total) AS total_spending FROM customers c JOIN invoices i ON c.id = i.customer_id WHERE c.country = 'Germany' GROUP BY c.id ORDER BY total_spending DESC LIMIT 1;",
    "table_names": [
      "customers",
      "invoices"
    ]
  },
  {
    "id": 170,
    "db_id": "tracking_orders",
    "question": "Which German customer's invoices have the highest average total and what is the average invoice total amount?",
    "sql": "SELECT c.first_name, c.last_name, ROUND(AVG(i.total), 2) AS avg_invoice_total FROM customers c JOIN invoices i ON c.id = i.customer_id WHERE c.country = 'Germany' GROUP BY c.first_name, c.last_name ORDER BY avg_invoice_total DESC LIMIT 1;",
    "table_names": [
      "customers",
      "invoices"
    ]
  },
  {
    "id": 171,
    "db_id": "tracking_orders",
    "question": "What is the total invoice amount for all customers located in the USA in the year 2009?",
    "sql": "SELECT SUM(invoices.total) FROM invoices JOIN customers ON invoices.customer_id = customers.id WHERE customers.country = 'USA' AND strftime('%Y', invoices.invoice_date) = '2009';",
    "table_names": [
      "customers",
      "invoices"
    ]
  },
  {
    "id": 183,
    "db_id": "store_1",
    "question": "How many tracks are contained in the playlist named 'Music'?",
    "sql": "SELECT COUNT(track_id) FROM playlist_tracks WHERE playlist_id IN (SELECT id FROM playlists WHERE name = 'Music');",
    "table_names": [
      "playlists",
      "playlist_tracks"
    ]
  },
  {
    "id": 186,
    "db_id": "journal_committee",
    "question": "List the names of editors older than 30 years who have done 'Photo' type work in journal committees.",
    "sql": "SELECT e.Name FROM editor e JOIN journal_committee jc ON e.Editor_ID = jc.Editor_ID WHERE jc.Work_Type = 'Photo' AND e.Age > 30;",
    "table_names": [
      "editor",
      "journal_committee"
    ]
  },
  {
    "id": 187,
    "db_id": "journal_committee",
    "question": "Which editors under the age of 30 have worked on Photo assignments?",
    "sql": "SELECT editor.Name FROM editor JOIN journal_committee ON editor.Editor_ID = journal_committee.Editor_ID WHERE journal_committee.Work_Type = 'Photo' AND editor.Age < 30;",
    "table_names": [
      "editor",
      "journal_committee"
    ]
  },
  {
    "id": 188,
    "db_id": "journal_committee",
    "question": "What is the average age of editors who have worked on journals performing 'Photo' type tasks?",
    "sql": "SELECT AVG(editor.Age) FROM editor JOIN journal_committee ON editor.Editor_ID = journal_committee.Editor_ID WHERE journal_committee.Work_Type = 'Photo';",
    "table_names": [
      "editor",
      "journal_committee"
    ]
  },
  {
    "id": 189,
    "db_id": "journal_committee",
    "question": "What is the total sales amount from journals related to the theme 'Cleveland Browns' in which the committee's work type was 'Photo'?",
    "sql": "SELECT SUM(journal.Sales) FROM journal INNER JOIN journal_committee ON journal.Journal_ID = journal_committee.Journal_ID WHERE journal_committee.Work_Type = 'Photo' AND journal.Theme LIKE '%Cleveland Browns%';",
    "table_names": [
      "journal",
      "journal_committee"
    ]
  },
  {
    "id": 190,
    "db_id": "journal_committee",
    "question": "What is the total sales from journals published between November 1, 2001, and December 31, 2001, where the work type listed in the journal committee is 'Photo'?",
    "sql": "SELECT SUM(j.Sales) FROM journal j INNER JOIN journal_committee jc ON j.Journal_ID = jc.Journal_ID WHERE jc.Work_Type = 'Photo' AND j.Date BETWEEN 'November 1, 2001' AND 'December 31, 2001';",
    "table_names": [
      "journal",
      "journal_committee"
    ]
  },
  {
    "id": 191,
    "db_id": "customers_card_transactions",
    "question": "What are the first and last names of customers who have more than one VIP account?",
    "sql": "SELECT customer_first_name, customer_last_name FROM Customers WHERE customer_id IN (SELECT customer_id FROM Accounts WHERE other_account_details = 'VIP' GROUP BY customer_id HAVING COUNT(account_id) > 1)",
    "table_names": [
      "Accounts",
      "Customers"
    ]
  },
  {
    "id": 192,
    "db_id": "customers_card_transactions",
    "question": "What is the email address of the customer who owns the account named '546'?",
    "sql": "SELECT C.customer_email FROM Customers C JOIN Accounts A ON C.customer_id = A.customer_id WHERE A.account_name = '546';",
    "table_names": [
      "Accounts",
      "Customers"
    ]
  },
  {
    "id": 193,
    "db_id": "customers_card_transactions",
    "question": "Who is the customer with the highest number of VIP accounts, and how many VIP accounts does this customer have?",
    "sql": "SELECT customer_first_name, customer_last_name, COUNT(account_id) FROM Customers INNER JOIN Accounts ON Customers.customer_id = Accounts.customer_id WHERE other_account_details = 'VIP' GROUP BY Customers.customer_id ORDER BY COUNT(account_id) DESC LIMIT 1;",
    "table_names": [
      "Accounts",
      "Customers"
    ]
  },
  {
    "id": 194,
    "db_id": "customers_card_transactions",
    "question": "Who has the highest number of accounts and what is that number?",
    "sql": "SELECT c.customer_first_name, c.customer_last_name, COUNT(a.account_id) as number_of_accounts FROM Accounts a JOIN Customers c ON a.customer_id = c.customer_id GROUP BY c.customer_id ORDER BY number_of_accounts DESC LIMIT 1;",
    "table_names": [
      "Accounts",
      "Customers"
    ]
  },
  {
    "id": 195,
    "db_id": "customers_card_transactions",
    "question": "What is the name of the customer who holds more than one VIP account?",
    "sql": "SELECT customer_first_name, customer_last_name FROM Customers WHERE customer_id IN (SELECT customer_id FROM Accounts WHERE other_account_details = 'VIP' GROUP BY customer_id HAVING COUNT(account_id) > 1);",
    "table_names": [
      "Accounts",
      "Customers"
    ]
  },
  {
    "id": 196,
    "db_id": "customers_card_transactions",
    "question": "List the first and last names of customers who own more than one VIP account.",
    "sql": "SELECT customer_first_name, customer_last_name FROM Customers WHERE customer_id IN (SELECT customer_id FROM Accounts WHERE other_account_details = 'VIP' GROUP BY customer_id HAVING COUNT(account_id) > 1);",
    "table_names": [
      "Accounts",
      "Customers"
    ]
  },
  {
    "id": 197,
    "db_id": "customers_card_transactions",
    "question": "What is the email address of the customer who owns a VIP account named '557'?",
    "sql": "SELECT c.customer_email FROM Customers c JOIN Accounts a ON c.customer_id = a.customer_id WHERE a.account_name = '557' AND a.other_account_details = 'VIP';",
    "table_names": [
      "Accounts",
      "Customers"
    ]
  },
  {
    "id": 198,
    "db_id": "customers_card_transactions",
    "question": "Which customers have more than one VIP account and what are their full names?",
    "sql": "SELECT c.customer_first_name, c.customer_last_name FROM Customers c INNER JOIN Accounts a ON c.customer_id = a.customer_id WHERE a.other_account_details = 'VIP' GROUP BY c.customer_id HAVING COUNT(a.account_id) > 1;",
    "table_names": [
      "Accounts",
      "Customers"
    ]
  },
  {
    "id": 199,
    "db_id": "customers_card_transactions",
    "question": "How many customers residing in NH have VIP accounts?",
    "sql": "SELECT COUNT(DISTINCT c.customer_id) FROM Customers c INNER JOIN Accounts a ON c.customer_id = a.customer_id WHERE a.other_account_details = 'VIP' AND c.customer_address LIKE '%NH%';",
    "table_names": [
      "Accounts",
      "Customers"
    ]
  },
  {
    "id": 200,
    "db_id": "customers_card_transactions",
    "question": "Which customer has the highest number of VIP accounts, and how many do they have?",
    "sql": "SELECT Customers.customer_first_name, Customers.customer_last_name, COUNT(Accounts.account_id) AS account_count FROM Customers JOIN Accounts ON Customers.customer_id = Accounts.customer_id WHERE Accounts.other_account_details = 'VIP' GROUP BY Customers.customer_id ORDER BY account_count DESC LIMIT 1;",
    "table_names": [
      "Accounts",
      "Customers"
    ]
  },
  {
    "id": 201,
    "db_id": "customers_card_transactions",
    "question": "What are the names and email addresses of customers who live in Kentucky and hold VIP accounts?",
    "sql": "SELECT Customers.customer_first_name, Customers.customer_last_name, Customers.customer_email FROM Customers JOIN Accounts ON Customers.customer_id = Accounts.customer_id WHERE Accounts.other_account_details = 'VIP' AND Customers.customer_address LIKE '%KY%'",
    "table_names": [
      "Accounts",
      "Customers"
    ]
  },
  {
    "id": 202,
    "db_id": "customers_card_transactions",
    "question": "What are the names of customers and their account names who have VIP accounts and reside in Kentucky (KY)?",
    "sql": "SELECT Customers.customer_first_name, Customers.customer_last_name, Accounts.account_name FROM Customers JOIN Accounts ON Customers.customer_id = Accounts.customer_id WHERE Accounts.other_account_details = 'VIP' AND Customers.customer_address LIKE '%KY%';",
    "table_names": [
      "Accounts",
      "Customers"
    ]
  },
  {
    "id": 203,
    "db_id": "customers_card_transactions",
    "question": "What are the names of customers and their credit card numbers who live in Kentucky?",
    "sql": "SELECT customer_first_name, customer_last_name, card_number FROM Customers INNER JOIN Customers_Cards ON Customers.customer_id = Customers_Cards.customer_id WHERE Customers_Cards.card_type_code = 'Credit' AND Customers.customer_address LIKE '%KY%';",
    "table_names": [
      "Customers",
      "Customers_Cards"
    ]
  },
  {
    "id": 204,
    "db_id": "customers_card_transactions",
    "question": "How many distinct debit cards belong to customers who live in New Hampshire?",
    "sql": "SELECT COUNT(DISTINCT cc.card_id) FROM Customers c INNER JOIN Customers_Cards cc ON c.customer_id = cc.customer_id WHERE c.customer_address LIKE '%NH%' AND cc.card_type_code = 'Debit';",
    "table_names": [
      "Customers",
      "Customers_Cards"
    ]
  },
  {
    "id": 205,
    "db_id": "customers_card_transactions",
    "question": "Which customer has the highest number of credit cards, and how many credit cards does this customer have?",
    "sql": "SELECT c.customer_first_name, c.customer_last_name, COUNT(cc.card_id) AS total_cards FROM Customers c JOIN Customers_Cards cc ON c.customer_id = cc.customer_id WHERE cc.card_type_code = 'Credit' GROUP BY c.customer_first_name, c.customer_last_name ORDER BY total_cards DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Customers_Cards"
    ]
  },
  {
    "id": 206,
    "db_id": "customers_card_transactions",
    "question": "What are the first and last names of customers who have a debit card issued after January 1, 2014, and expiring on or before March 20, 2018?",
    "sql": "SELECT customer_first_name, customer_last_name FROM Customers WHERE customer_id IN (SELECT customer_id FROM Customers_Cards WHERE card_type_code = 'Debit' AND date_valid_from >= '2014-01-01' AND date_valid_to <= '2018-03-20');",
    "table_names": [
      "Customers",
      "Customers_Cards"
    ]
  },
  {
    "id": 207,
    "db_id": "customers_card_transactions",
    "question": "What is the full name and email of customers who were issued a credit card before 2010?",
    "sql": "SELECT customer_first_name, customer_last_name, customer_email FROM Customers WHERE customer_id IN (SELECT customer_id FROM Customers_Cards WHERE card_type_code='Credit' AND date_valid_from < '2010-01-01')",
    "table_names": [
      "Customers",
      "Customers_Cards"
    ]
  },
  {
    "id": 208,
    "db_id": "customers_card_transactions",
    "question": "How many valid debit cards are associated with customers with the last name 'Effertz'?",
    "sql": "SELECT COUNT(DISTINCT cc.card_id) FROM Customers c JOIN Customers_Cards cc ON c.customer_id = cc.customer_id WHERE c.customer_last_name = 'Effertz' AND cc.card_type_code = 'Debit';",
    "table_names": [
      "Customers",
      "Customers_Cards"
    ]
  },
  {
    "id": 209,
    "db_id": "customers_card_transactions",
    "question": "Which customer holds the credit card that expires the earliest, and what is the card number and expiration date?",
    "sql": "SELECT customer_first_name, customer_last_name, card_number, date_valid_to FROM Customers INNER JOIN Customers_Cards ON Customers.customer_id = Customers_Cards.customer_id WHERE card_type_code = 'Credit' ORDER BY date_valid_to ASC LIMIT 1;",
    "table_names": [
      "Customers",
      "Customers_Cards"
    ]
  },
  {
    "id": 210,
    "db_id": "customers_card_transactions",
    "question": "What is the email address of the customer who has a credit card issued before January 1, 2010?",
    "sql": "SELECT customer_email FROM Customers WHERE customer_id IN (SELECT customer_id FROM Customers_Cards WHERE card_type_code = 'Credit' AND date_valid_from < '2010-01-01');",
    "table_names": [
      "Customers",
      "Customers_Cards"
    ]
  },
  {
    "id": 211,
    "db_id": "customers_card_transactions",
    "question": "What are the first and last names of customers whose credit cards expired between March 1, 2018, and March 20, 2018?",
    "sql": "SELECT customer_first_name, customer_last_name FROM Customers WHERE customer_id IN (SELECT customer_id FROM Customers_Cards WHERE card_type_code = 'Credit' AND date_valid_to BETWEEN '2018-03-01' AND '2018-03-20');",
    "table_names": [
      "Customers",
      "Customers_Cards"
    ]
  },
  {
    "id": 212,
    "db_id": "customers_card_transactions",
    "question": "List the first and last names of customers who have had a credit card issued before the year 2010.",
    "sql": "SELECT c.customer_first_name, c.customer_last_name FROM Customers c JOIN Customers_Cards cc ON c.customer_id = cc.customer_id WHERE cc.card_type_code = 'Credit' AND cc.date_valid_from < '2010-01-01';",
    "table_names": [
      "Customers",
      "Customers_Cards"
    ]
  },
  {
    "id": 213,
    "db_id": "customers_card_transactions",
    "question": "List the email addresses of customers who hold both a Debit and a Credit card.",
    "sql": "SELECT customer_email FROM Customers WHERE customer_id IN (SELECT customer_id FROM Customers_Cards WHERE card_type_code = 'Credit') AND customer_id IN (SELECT customer_id FROM Customers_Cards WHERE card_type_code = 'Debit');",
    "table_names": [
      "Customers",
      "Customers_Cards"
    ]
  },
  {
    "id": 214,
    "db_id": "customers_card_transactions",
    "question": "Which customers have credit cards that expired between March 10, 2018, and March 20, 2018?",
    "sql": "SELECT customer_first_name, customer_last_name FROM Customers WHERE customer_id IN (SELECT customer_id FROM Customers_Cards WHERE card_type_code = 'Credit' AND date_valid_to BETWEEN '2018-03-10' AND '2018-03-20');",
    "table_names": [
      "Customers",
      "Customers_Cards"
    ]
  },
  {
    "id": 215,
    "db_id": "customers_card_transactions",
    "question": "What is the total refund amount made by customer id 10 using debit cards?",
    "sql": "SELECT SUM(ft.transaction_amount) FROM Financial_Transactions ft JOIN Customers_Cards cc ON ft.card_id = cc.card_id WHERE cc.customer_id = 10 AND cc.card_type_code = 'Debit' AND ft.transaction_type = 'Refund';",
    "table_names": [
      "Customers_Cards",
      "Financial_Transactions"
    ]
  },
  {
    "id": 216,
    "db_id": "customers_card_transactions",
    "question": "What is the total amount of refunds made using credit cards?",
    "sql": "SELECT SUM(ft.transaction_amount) FROM Financial_Transactions ft JOIN Customers_Cards cc ON ft.card_id = cc.card_id WHERE cc.card_type_code = 'Credit' AND ft.transaction_type = 'Refund';",
    "table_names": [
      "Customers_Cards",
      "Financial_Transactions"
    ]
  },
  {
    "id": 217,
    "db_id": "race_track",
    "question": "Which tracks opened after 1990 hosted races held in May?",
    "sql": "SELECT track.Name FROM race JOIN track ON race.Track_ID = track.Track_ID WHERE race.Date LIKE '%May%' AND track.Year_Opened > 1990;",
    "table_names": [
      "race",
      "track"
    ]
  },
  {
    "id": 218,
    "db_id": "race_track",
    "question": "What year was the track hosting the 'Rolex 24 At Daytona' race opened?",
    "sql": "SELECT track.Year_Opened FROM race JOIN track ON race.Track_ID = track.Track_ID WHERE race.Name = 'Rolex 24 At Daytona';",
    "table_names": [
      "race",
      "track"
    ]
  },
  {
    "id": 219,
    "db_id": "race_track",
    "question": "Which track hosting a 'GT' class race has the highest seating capacity?",
    "sql": "SELECT t.Name FROM track t JOIN race r ON t.Track_ID = r.Track_ID WHERE r.Class = 'GT' ORDER BY t.Seating DESC LIMIT 1;",
    "table_names": [
      "race",
      "track"
    ]
  },
  {
    "id": 220,
    "db_id": "race_track",
    "question": "List the names of the tracks where races were held in May and have seating capacity greater than 70,000.",
    "sql": "SELECT track.Name FROM track JOIN race ON track.Track_ID = race.Track_ID WHERE race.Date LIKE '%May%' AND track.Seating > 70000;",
    "table_names": [
      "race",
      "track"
    ]
  },
  {
    "id": 221,
    "db_id": "race_track",
    "question": "Which is the oldest track to host a race exclusively with GT cars?",
    "sql": "SELECT track.Name FROM track JOIN race ON track.Track_ID = race.Track_ID WHERE race.Class = 'GT' ORDER BY track.Year_Opened ASC LIMIT 1;",
    "table_names": [
      "race",
      "track"
    ]
  },
  {
    "id": 222,
    "db_id": "race_track",
    "question": "What is the name of the track where the race 'Sahlen's Six Hours of the Glen' took place?",
    "sql": "SELECT track.Name FROM race JOIN track ON race.Track_ID = track.Track_ID WHERE race.Name = \"Sahlen's Six Hours of the Glen\"",
    "table_names": [
      "race",
      "track"
    ]
  },
  {
    "id": 223,
    "db_id": "race_track",
    "question": "What is the name and opening year of the racetrack hosting the 'RumBum.com 250' race?",
    "sql": "SELECT track.Name, track.Year_Opened FROM track JOIN race ON track.Track_ID = race.Track_ID WHERE race.Name = 'RumBum.com 250';",
    "table_names": [
      "race",
      "track"
    ]
  },
  {
    "id": 224,
    "db_id": "race_track",
    "question": "What is the name of the track where 'RumBum.com 250' race was held?",
    "sql": "SELECT track.Name FROM track JOIN race ON race.Track_ID = track.Track_ID WHERE race.Name = 'RumBum.com 250';",
    "table_names": [
      "race",
      "track"
    ]
  },
  {
    "id": 225,
    "db_id": "race_track",
    "question": "In which year was the track hosting 'Sahlen's Six Hours of the Glen' opened?",
    "sql": "SELECT track.Year_Opened FROM race JOIN track ON race.Track_ID = track.Track_ID WHERE race.Name = \"Sahlen's Six Hours of the Glen\";",
    "table_names": [
      "race",
      "track"
    ]
  },
  {
    "id": 226,
    "db_id": "race_track",
    "question": "Which is the oldest track that hosted a race with the class 'GT'?",
    "sql": "SELECT track.Name FROM race JOIN track ON race.Track_ID = track.Track_ID WHERE race.Class = 'GT' ORDER BY track.Year_Opened ASC LIMIT 1",
    "table_names": [
      "race",
      "track"
    ]
  },
  {
    "id": 227,
    "db_id": "race_track",
    "question": "In what year was the track opened where the 'RumBum.com 250' race took place?",
    "sql": "SELECT t.Year_Opened FROM track t JOIN race r ON t.Track_ID = r.Track_ID WHERE r.Name = 'RumBum.com 250';",
    "table_names": [
      "race",
      "track"
    ]
  },
  {
    "id": 228,
    "db_id": "race_track",
    "question": "What is the name of the race track with the largest seating capacity that hosted a race classified only as 'GT'?",
    "sql": "SELECT track.Name FROM track JOIN race ON track.Track_ID = race.Track_ID WHERE race.Class = 'GT' ORDER BY track.Seating DESC LIMIT 1",
    "table_names": [
      "race",
      "track"
    ]
  },
  {
    "id": 229,
    "db_id": "coffee_shop",
    "question": "Find the addresses of all shops that had happy hours in May with 10 or more staff in charge and also have a shop score greater than 35.",
    "sql": "SELECT s.Address FROM shop s INNER JOIN happy_hour h ON s.Shop_ID = h.Shop_ID WHERE h.Month = 'May' AND h.Num_of_shaff_in_charge >= 10 AND s.Score > 35;",
    "table_names": [
      "shop",
      "happy_hour"
    ]
  },
  {
    "id": 230,
    "db_id": "coffee_shop",
    "question": "What are the addresses of shops opened in 2010 that had a happy hour in May with at least 5 staff members in charge?",
    "sql": "SELECT s.Address FROM shop s JOIN happy_hour hh ON s.Shop_ID = hh.Shop_ID WHERE hh.Month = 'May' AND s.Open_Year = '2010' AND hh.Num_of_shaff_in_charge >= 5;",
    "table_names": [
      "shop",
      "happy_hour"
    ]
  },
  {
    "id": 231,
    "db_id": "chinook_1",
    "question": "What are the titles of albums created by the artist named Metallica?",
    "sql": "SELECT Album.Title FROM Album JOIN Artist ON Album.ArtistId = Artist.ArtistId WHERE Artist.Name = 'Metallica';",
    "table_names": [
      "Album",
      "Artist"
    ]
  },
  {
    "id": 232,
    "db_id": "chinook_1",
    "question": "List all album titles by the artist Led Zeppelin.",
    "sql": "SELECT Title FROM Album WHERE ArtistId = (SELECT ArtistId FROM Artist WHERE Name = 'Led Zeppelin');",
    "table_names": [
      "Album",
      "Artist"
    ]
  },
  {
    "id": 233,
    "db_id": "chinook_1",
    "question": "How many albums did Metallica release according to the database?",
    "sql": "SELECT COUNT(*) FROM Album WHERE ArtistId IN (SELECT ArtistId FROM Artist WHERE Name = 'Metallica');",
    "table_names": [
      "Album",
      "Artist"
    ]
  },
  {
    "id": 234,
    "db_id": "chinook_1",
    "question": "Which albums by the band Metallica contain the word 'Garage' in their title?",
    "sql": "SELECT Title FROM Album WHERE ArtistId = (SELECT ArtistId FROM Artist WHERE Name = 'Metallica') AND Title LIKE '%Garage%';",
    "table_names": [
      "Album",
      "Artist"
    ]
  },
  {
    "id": 235,
    "db_id": "chinook_1",
    "question": "Which artist has the greatest number of albums listed, and how many albums do they have?",
    "sql": "SELECT Artist.Name, COUNT(Album.AlbumId) as NumAlbums FROM Artist JOIN Album ON Artist.ArtistId = Album.ArtistId GROUP BY Artist.ArtistId ORDER BY NumAlbums DESC LIMIT 1;",
    "table_names": [
      "Album",
      "Artist"
    ]
  },
  {
    "id": 236,
    "db_id": "chinook_1",
    "question": "Which artist created the album 'Ride The Lightning' and also produced the album 'St. Anger'?",
    "sql": "SELECT Artist.Name FROM Album JOIN Artist ON Album.ArtistId = Artist.ArtistId WHERE Album.Title IN ('Ride The Lightning', 'St. Anger') GROUP BY Artist.Name HAVING COUNT(DISTINCT Album.Title) = 2;",
    "table_names": [
      "Album",
      "Artist"
    ]
  },
  {
    "id": 237,
    "db_id": "chinook_1",
    "question": "Which artist created the album titled 'Nevermind'?",
    "sql": "SELECT Artist.Name FROM Album JOIN Artist ON Album.ArtistId = Artist.ArtistId WHERE Album.Title = 'Nevermind';",
    "table_names": [
      "Album",
      "Artist"
    ]
  },
  {
    "id": 238,
    "db_id": "chinook_1",
    "question": "What is the title of the first album listed for the band Pearl Jam?",
    "sql": "SELECT Album.Title FROM Album INNER JOIN Artist ON Album.ArtistId = Artist.ArtistId WHERE Artist.Name = 'Pearl Jam' ORDER BY Album.AlbumId ASC LIMIT 1",
    "table_names": [
      "Album",
      "Artist"
    ]
  },
  {
    "id": 251,
    "db_id": "chinook_1",
    "question": "What are the names of the employees who are the support representatives for customers located in Brazil?",
    "sql": "SELECT e.FirstName, e.LastName FROM Employee e WHERE e.EmployeeId IN (SELECT SupportRepId FROM Customer WHERE Country = 'Brazil')",
    "table_names": [
      "Customer",
      "Employee"
    ]
  },
  {
    "id": 252,
    "db_id": "chinook_1",
    "question": "Who is the sales support representative directly managing customers from Paris, France?",
    "sql": "SELECT Employee.FirstName, Employee.LastName FROM Customer JOIN Employee ON Customer.SupportRepId = Employee.EmployeeId WHERE Customer.Country = 'France' AND Customer.City = 'Paris';",
    "table_names": [
      "Customer",
      "Employee"
    ]
  },
  {
    "id": 253,
    "db_id": "chinook_1",
    "question": "How many customers from Brazil are assigned to a Sales Support Agent?",
    "sql": "SELECT COUNT(Customer.CustomerId) FROM Customer JOIN Employee ON Customer.SupportRepId = Employee.EmployeeId WHERE Employee.Title = 'Sales Support Agent' AND Customer.Country = 'Brazil';",
    "table_names": [
      "Customer",
      "Employee"
    ]
  },
  {
    "id": 254,
    "db_id": "chinook_1",
    "question": "What is the name of the Sales Support Agent who is responsible for supporting the most number of customers from Brazil?",
    "sql": "SELECT Employee.FirstName, Employee.LastName FROM Customer JOIN Employee ON Customer.SupportRepId = Employee.EmployeeId WHERE Customer.Country = 'Brazil' AND Employee.Title = 'Sales Support Agent' GROUP BY Employee.EmployeeId ORDER BY COUNT(Customer.CustomerId) DESC LIMIT 1;",
    "table_names": [
      "Customer",
      "Employee"
    ]
  },
  {
    "id": 255,
    "db_id": "chinook_1",
    "question": "Who is the customer that made the largest single invoice purchase from Germany?",
    "sql": "SELECT c.FirstName, c.LastName FROM Customer c WHERE c.CustomerId = (SELECT CustomerId FROM Invoice WHERE Total = (SELECT MAX(Total) FROM Invoice WHERE BillingCountry = 'Germany'));",
    "table_names": [
      "Customer",
      "Invoice"
    ]
  },
  {
    "id": 256,
    "db_id": "chinook_1",
    "question": "Which countries have invoices billed to customers working at 'Apple Inc.' or 'Microsoft Corporation'?",
    "sql": "SELECT DISTINCT Invoice.BillingCountry FROM Invoice INNER JOIN Customer ON Invoice.CustomerId = Customer.CustomerId WHERE Customer.Company = 'Apple Inc.' OR Customer.Company = 'Microsoft Corporation';",
    "table_names": [
      "Customer",
      "Invoice"
    ]
  },
  {
    "id": 257,
    "db_id": "chinook_1",
    "question": "What is the average invoice total for customers from Brazil?",
    "sql": "SELECT AVG(i.Total) FROM Customer AS c JOIN Invoice AS i ON c.CustomerId = i.CustomerId WHERE c.Country = 'Brazil';",
    "table_names": [
      "Customer",
      "Invoice"
    ]
  },
  {
    "id": 281,
    "db_id": "insurance_fnol",
    "question": "How many distinct customers have requested either 'Change a policy' or 'Upgrade a policy' services?",
    "sql": "SELECT COUNT(DISTINCT fnol.Customer_ID) FROM First_Notification_of_Loss fnol JOIN Services svc ON fnol.Service_ID = svc.Service_ID WHERE svc.Service_name IN ('Change a policy', 'Upgrade a policy');",
    "table_names": [
      "Services",
      "First_Notification_of_Loss"
    ]
  },
  {
    "id": 282,
    "db_id": "insurance_fnol",
    "question": "What is the name of the service associated with the FNOL_ID 1722?",
    "sql": "SELECT Service_name FROM Services WHERE Service_ID = (SELECT Service_ID FROM First_Notification_of_Loss WHERE FNOL_ID = 1722);",
    "table_names": [
      "Services",
      "First_Notification_of_Loss"
    ]
  },
  {
    "id": 283,
    "db_id": "insurance_policies",
    "question": "What is the total settlement amount for all the claims with FNOL_ID equal to 4226?",
    "sql": "SELECT SUM(Settlement_Amount) FROM Settlements WHERE Claim_ID IN (SELECT Claim_ID FROM Claims WHERE FNOL_ID = 4226);",
    "table_names": [
      "Claims",
      "Settlements"
    ]
  },
  {
    "id": 284,
    "db_id": "insurance_policies",
    "question": "What is the total settlement amount for claims with effective dates between January 1, 1970 and January 1, 1980?",
    "sql": "SELECT SUM(s.Settlement_Amount) FROM Settlements s JOIN Claims c ON s.Claim_ID = c.Claim_ID WHERE c.Effective_Date BETWEEN '1970-01-01' AND '1980-01-01';",
    "table_names": [
      "Claims",
      "Settlements"
    ]
  },
  {
    "id": 285,
    "db_id": "insurance_fnol",
    "question": "How many policies does customer Jay Chou have?",
    "sql": "SELECT Customers.Customer_name, COUNT(Customers_Policies.Policy_ID) AS Number_of_Policies FROM Customers INNER JOIN Customers_Policies ON Customers.Customer_ID = Customers_Policies.Customer_ID WHERE Customers.Customer_ID = 996 GROUP BY Customers.Customer_name",
    "table_names": [
      "Customers",
      "Customers_Policies"
    ]
  },
  {
    "id": 286,
    "db_id": "insurance_fnol",
    "question": "List the names of customers who opened their policies before August 2016, and closed them within March 2018.",
    "sql": "SELECT Customer_name FROM Customers WHERE Customer_ID IN (SELECT Customer_ID FROM Customers_Policies WHERE Date_Opened < '2016-08-01' AND Date_Closed BETWEEN '2018-03-01' AND '2018-03-31');",
    "table_names": [
      "Customers",
      "Customers_Policies"
    ]
  },
  {
    "id": 287,
    "db_id": "insurance_fnol",
    "question": "Which customers have policy ID 583 with a closing date after March 1, 2018?",
    "sql": "SELECT Customer_name FROM Customers WHERE Customer_ID IN (SELECT Customer_ID FROM Customers_Policies WHERE Policy_ID = 583 AND Date_Closed > '2018-03-01');",
    "table_names": [
      "Customers",
      "Customers_Policies"
    ]
  },
  {
    "id": 288,
    "db_id": "insurance_fnol",
    "question": "Which customer has the highest number of policies?",
    "sql": "SELECT Customers.Customer_name, COUNT(Customers_Policies.Policy_ID) AS policy_count FROM Customers INNER JOIN Customers_Policies ON Customers.Customer_ID = Customers_Policies.Customer_ID GROUP BY Customers.Customer_ID ORDER BY policy_count DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Customers_Policies"
    ]
  },
  {
    "id": 289,
    "db_id": "insurance_fnol",
    "question": "Which customers have more than one notification of loss recorded?",
    "sql": "SELECT Customer_name FROM Customers WHERE Customer_ID IN (SELECT Customer_ID FROM First_Notification_of_Loss GROUP BY Customer_ID HAVING COUNT(FNOL_ID) > 1);",
    "table_names": [
      "Customers",
      "First_Notification_of_Loss"
    ]
  },
  {
    "id": 290,
    "db_id": "insurance_fnol",
    "question": "How many distinct policies have received notifications of loss from customer Jay Chou?",
    "sql": "SELECT COUNT(DISTINCT Policy_ID) FROM First_Notification_of_Loss WHERE Customer_ID = (SELECT Customer_ID FROM Customers WHERE Customer_name = 'Jay Chou');",
    "table_names": [
      "Customers",
      "First_Notification_of_Loss"
    ]
  },
  {
    "id": 291,
    "db_id": "insurance_fnol",
    "question": "Which customer has more than two policies?",
    "sql": "SELECT Customer_name FROM Customers WHERE Customer_ID IN (SELECT Customer_ID FROM Customers_Policies GROUP BY Customer_ID HAVING COUNT(Policy_ID) > 2);",
    "table_names": [
      "Customers",
      "Customers_Policies"
    ]
  },
  {
    "id": 292,
    "db_id": "insurance_fnol",
    "question": "Which customers have opened more than two policies?",
    "sql": "SELECT Customer_name FROM Customers WHERE Customer_ID IN (SELECT Customer_ID FROM Customers_Policies GROUP BY Customer_ID HAVING COUNT(Policy_ID) > 2);",
    "table_names": [
      "Customers",
      "Customers_Policies"
    ]
  },
  {
    "id": 293,
    "db_id": "medicine_enzyme_interaction",
    "question": "Which FDA-approved medicines are activators of any enzymes?",
    "sql": "SELECT m.name FROM medicine m JOIN medicine_enzyme_interaction mei ON m.id = mei.medicine_id WHERE m.FDA_approved = 'Yes' AND mei.interaction_type = 'activitor';",
    "table_names": [
      "medicine",
      "medicine_enzyme_interaction"
    ]
  },
  {
    "id": 294,
    "db_id": "medicine_enzyme_interaction",
    "question": "Which FDA-approved medicines act as inhibitors for enzyme with ID 2?",
    "sql": "SELECT m.name FROM medicine m JOIN medicine_enzyme_interaction mei ON m.id = mei.medicine_id WHERE mei.enzyme_id = 2 AND mei.interaction_type = 'inhibitor' AND m.FDA_approved = 'Yes';",
    "table_names": [
      "medicine",
      "medicine_enzyme_interaction"
    ]
  },
  {
    "id": 295,
    "db_id": "medicine_enzyme_interaction",
    "question": "List the names of FDA-approved medicines that act as activitors in enzyme interactions.",
    "sql": "SELECT m.name FROM medicine m JOIN medicine_enzyme_interaction mei ON m.id = mei.medicine_id WHERE mei.interaction_type = 'activitor' AND m.FDA_approved = 'Yes';",
    "table_names": [
      "medicine",
      "medicine_enzyme_interaction"
    ]
  },
  {
    "id": 296,
    "db_id": "medicine_enzyme_interaction",
    "question": "Which FDA-approved medicines act as inhibitors of enzyme with enzyme_id '2'?",
    "sql": "SELECT m.name FROM medicine m INNER JOIN medicine_enzyme_interaction mei ON m.id = mei.medicine_id WHERE mei.interaction_type = 'inhibitor' AND mei.enzyme_id = 2 AND m.FDA_approved = 'Yes';",
    "table_names": [
      "medicine",
      "medicine_enzyme_interaction"
    ]
  },
  {
    "id": 297,
    "db_id": "medicine_enzyme_interaction",
    "question": "What enzymes located in the Cytosol have medicines interacting with them as activators?",
    "sql": "SELECT e.name FROM enzyme e JOIN medicine_enzyme_interaction mei ON e.id = mei.enzyme_id WHERE e.Location = 'Cytosol' AND mei.interaction_type = 'activitor' GROUP BY e.name",
    "table_names": [
      "enzyme",
      "medicine_enzyme_interaction"
    ]
  },
  {
    "id": 298,
    "db_id": "medicine_enzyme_interaction",
    "question": "Which enzymes located in the cytosol have at least one medicine acting as an activator?",
    "sql": "SELECT e.name FROM enzyme e JOIN medicine_enzyme_interaction mei ON e.id = mei.enzyme_id WHERE mei.interaction_type = 'activitor' AND e.Location = 'Cytosol';",
    "table_names": [
      "enzyme",
      "medicine_enzyme_interaction"
    ]
  },
  {
    "id": 299,
    "db_id": "medicine_enzyme_interaction",
    "question": "Which enzymes located in the mitochondrion are inhibited by medicine with ID 2?",
    "sql": "SELECT enzyme.name FROM enzyme JOIN medicine_enzyme_interaction ON enzyme.id = medicine_enzyme_interaction.enzyme_id WHERE enzyme.Location = 'Mitochondrion' AND medicine_enzyme_interaction.interaction_type = 'inhibitor' AND medicine_enzyme_interaction.medicine_id = 2;",
    "table_names": [
      "enzyme",
      "medicine_enzyme_interaction"
    ]
  },
  {
    "id": 300,
    "db_id": "medicine_enzyme_interaction",
    "question": "Which cytosolic enzymes related to Porphyria are activated by medicines according to the data provided?",
    "sql": "SELECT enzyme.name FROM enzyme JOIN medicine_enzyme_interaction ON enzyme.id = medicine_enzyme_interaction.enzyme_id WHERE medicine_enzyme_interaction.interaction_type = 'activitor' AND enzyme.Location = 'Cytosol' AND enzyme.Porphyria <> 'none';",
    "table_names": [
      "enzyme",
      "medicine_enzyme_interaction"
    ]
  },
  {
    "id": 301,
    "db_id": "medicine_enzyme_interaction",
    "question": "Which medicines have an 'activitor' interaction type with enzymes and are FDA approved?",
    "sql": "SELECT m.name FROM medicine m JOIN medicine_enzyme_interaction mei ON m.id = mei.medicine_id WHERE mei.interaction_type = 'activitor' AND m.FDA_approved = 'Yes';",
    "table_names": [
      "medicine",
      "medicine_enzyme_interaction"
    ]
  },
  {
    "id": 302,
    "db_id": "medicine_enzyme_interaction",
    "question": "Which FDA-approved medicines have an inhibitor interaction with enzyme 2?",
    "sql": "SELECT m.name FROM medicine m JOIN medicine_enzyme_interaction mei ON m.id = mei.medicine_id WHERE mei.interaction_type = 'inhibitor' AND mei.enzyme_id = 2 AND m.FDA_approved = 'Yes';",
    "table_names": [
      "medicine",
      "medicine_enzyme_interaction"
    ]
  },
  {
    "id": 303,
    "db_id": "medicine_enzyme_interaction",
    "question": "Which enzyme located in the Cytosol is activated by medicine with ID 20?",
    "sql": "SELECT enzyme.name FROM enzyme INNER JOIN medicine_enzyme_interaction ON enzyme.id = medicine_enzyme_interaction.enzyme_id WHERE medicine_enzyme_interaction.medicine_id = 20 AND enzyme.Location = 'Cytosol' AND medicine_enzyme_interaction.interaction_type = 'activitor';",
    "table_names": [
      "enzyme",
      "medicine_enzyme_interaction"
    ]
  },
  {
    "id": 304,
    "db_id": "medicine_enzyme_interaction",
    "question": "Which enzyme located in the Cytosol has an activator interaction with medicine id 20?",
    "sql": "SELECT e.name FROM enzyme e JOIN medicine_enzyme_interaction mei ON e.id = mei.enzyme_id WHERE mei.interaction_type = 'activitor' AND mei.medicine_id = 20 AND e.Location = 'Cytosol';",
    "table_names": [
      "enzyme",
      "medicine_enzyme_interaction"
    ]
  },
  {
    "id": 305,
    "db_id": "medicine_enzyme_interaction",
    "question": "How many distinct enzymes have an activitor type interaction with FDA-approved medicines?",
    "sql": "SELECT COUNT(DISTINCT me.enzyme_id) FROM medicine_enzyme_interaction me JOIN medicine m ON me.medicine_id = m.id WHERE m.FDA_approved='Yes' AND me.interaction_type='activitor';",
    "table_names": [
      "medicine",
      "medicine_enzyme_interaction"
    ]
  },
  {
    "id": 306,
    "db_id": "medicine_enzyme_interaction",
    "question": "Which FDA-approved medicines act as activators on enzyme id 4?",
    "sql": "SELECT m.name FROM medicine m JOIN medicine_enzyme_interaction mei ON m.id = mei.medicine_id WHERE mei.enzyme_id = 4 AND mei.interaction_type = 'activitor' AND m.FDA_approved = 'Yes';",
    "table_names": [
      "medicine",
      "medicine_enzyme_interaction"
    ]
  },
  {
    "id": 307,
    "db_id": "university_basketball",
    "question": "Which universities founded before 1800 have basketball teams with an overall winning percentage greater than 80% across all games, and what is their total record for all games?",
    "sql": "SELECT u.School, bm.All_Games FROM basketball_match bm JOIN university u ON bm.School_ID = u.School_ID WHERE u.Founded < 1800 AND bm.All_Games_Percent > 0.8;",
    "table_names": [
      "basketball_match",
      "university"
    ]
  },
  {
    "id": 308,
    "db_id": "university_basketball",
    "question": "Which university has the smallest enrollment and what is its basketball team's name, overall record, and enrollment number?",
    "sql": "SELECT u.School, b.Team_Name, b.All_Games, u.Enrollment FROM basketball_match b INNER JOIN university u ON b.School_ID = u.School_ID WHERE u.Enrollment = (SELECT MIN(Enrollment) FROM university);",
    "table_names": [
      "basketball_match",
      "university"
    ]
  },
  {
    "id": 309,
    "db_id": "university_basketball",
    "question": "List the names of universities along with their basketball team's overall season performance and nicknames where student enrollment exceeds 20,000 students and the team's ACC regular season winning percentage is greater than '.600'.",
    "sql": "SELECT u.School, b.All_Games, u.Nickname FROM basketball_match AS b JOIN university AS u ON b.School_ID = u.School_ID WHERE u.Enrollment > 20000 AND b.ACC_Percent > '.600';",
    "table_names": [
      "basketball_match",
      "university"
    ]
  },
  {
    "id": 310,
    "db_id": "university_basketball",
    "question": "What are the names of universities, their basketball teams, and enrollments for schools with basketball overall game win percentages greater than 80% and student enrollment above 15,000?",
    "sql": "SELECT u.School, b.Team_Name, u.Enrollment FROM basketball_match b INNER JOIN university u ON b.School_ID = u.School_ID WHERE b.All_Games_Percent > 0.8 AND u.Enrollment > 15000;",
    "table_names": [
      "basketball_match",
      "university"
    ]
  },
  {
    "id": 311,
    "db_id": "university_basketball",
    "question": "Which universities founded before the year 1800 had basketball teams with overall game winning percentages greater than 80%, and what are their team records?",
    "sql": "SELECT university.School, university.Location, basketball_match.All_Games FROM basketball_match INNER JOIN university ON basketball_match.School_ID = university.School_ID WHERE basketball_match.All_Games_Percent > 0.8 AND university.Founded < 1800;",
    "table_names": [
      "basketball_match",
      "university"
    ]
  },
  {
    "id": 312,
    "db_id": "university_basketball",
    "question": "Which basketball teams are associated with universities founded before 1800 that have an overall games winning percentage higher than 0.8?",
    "sql": "SELECT b.Team_Name FROM basketball_match b JOIN university u ON b.School_ID = u.School_ID WHERE u.Founded < 1800 AND CAST(b.All_Games_Percent AS FLOAT) > 0.8;",
    "table_names": [
      "basketball_match",
      "university"
    ]
  },
  {
    "id": 313,
    "db_id": "university_basketball",
    "question": "What are the names and locations of public universities that have basketball teams with an ACC winning percentage higher than 70%?",
    "sql": "SELECT u.School, u.Location FROM basketball_match b JOIN university u ON b.School_ID = u.School_ID WHERE CAST(REPLACE(b.ACC_Percent, '.', '0.') AS FLOAT) > 0.7 AND u.Affiliation LIKE 'Public%'",
    "table_names": [
      "basketball_match",
      "university"
    ]
  },
  {
    "id": 314,
    "db_id": "university_basketball",
    "question": "Which university's basketball team had an ACC road record of 6â2 and an overall game winning percentage greater than 80%?",
    "sql": "SELECT u.School FROM university u JOIN basketball_match bm ON u.School_ID = bm.School_ID WHERE bm.ACC_Road = '6â2' AND bm.All_Games_Percent > 0.8",
    "table_names": [
      "basketball_match",
      "university"
    ]
  },
  {
    "id": 315,
    "db_id": "university_basketball",
    "question": "What is the name and enrollment of the university whose basketball team has the highest ACC regular season winning percentage?",
    "sql": "SELECT u.School, u.Enrollment FROM basketball_match AS b JOIN university AS u ON b.School_ID = u.School_ID WHERE b.ACC_Percent = (SELECT MAX(ACC_Percent) FROM basketball_match);",
    "table_names": [
      "basketball_match",
      "university"
    ]
  },
  {
    "id": 316,
    "db_id": "university_basketball",
    "question": "What is the location of the university whose basketball team is named 'Virginia Tech'?",
    "sql": "SELECT u.Location FROM basketball_match b JOIN university u ON b.School_ID = u.School_ID WHERE b.Team_Name = 'Virginia Tech';",
    "table_names": [
      "basketball_match",
      "university"
    ]
  },
  {
    "id": 317,
    "db_id": "phone_1",
    "question": "List the companies and corresponding chip models, along with their launch years, for phones that have 'Full' accreditation and chip models with ROM greater than 64 MiB.",
    "sql": "SELECT p.Company_name, cm.Model_name, cm.Launch_year FROM phone p INNER JOIN chip_model cm ON p.chip_model = cm.Model_name WHERE cm.ROM_MiB > 64 AND p.Accreditation_type = 'Full';",
    "table_names": [
      "chip_model",
      "phone"
    ]
  },
  {
    "id": 318,
    "db_id": "phone_1",
    "question": "Which companies have phones accredited that use chips with '802.11b' WiFi support and ROM of at least 128 MiB, and what are the names of the chip models?",
    "sql": "SELECT p.Company_name, c.Model_name FROM phone p JOIN chip_model c ON p.chip_model = c.Model_name WHERE c.WiFi = '802.11b' AND c.ROM_MiB >= 128;",
    "table_names": [
      "chip_model",
      "phone"
    ]
  },
  {
    "id": 319,
    "db_id": "phone_1",
    "question": "Which company makes phone models that are equipped with WiFi capability, and on average, has the largest ROM?",
    "sql": "SELECT phone.Company_name, AVG(chip_model.ROM_MiB) FROM phone JOIN chip_model ON phone.chip_model = chip_model.Model_name WHERE chip_model.WiFi != 'No' GROUP BY phone.Company_name ORDER BY AVG(chip_model.ROM_MiB) DESC LIMIT 1;",
    "table_names": [
      "chip_model",
      "phone"
    ]
  },
  {
    "id": 320,
    "db_id": "phone_1",
    "question": "Which companies have phones accredited as 'Full' that support screen modes with 4 or more hardware colours?",
    "sql": "SELECT phone.Company_name FROM phone JOIN screen_mode ON phone.screen_mode = screen_mode.Graphics_mode WHERE screen_mode.Hardware_colours >= 4 AND phone.Accreditation_type = 'Full';",
    "table_names": [
      "screen_mode",
      "phone"
    ]
  },
  {
    "id": 321,
    "db_id": "phone_1",
    "question": "Which companies have phone models using screen modes with at least 4 hardware colours and memory usage of 10KB or less?",
    "sql": "SELECT DISTINCT phone.Company_name FROM phone JOIN screen_mode ON phone.screen_mode = screen_mode.Graphics_mode WHERE screen_mode.Hardware_colours >= 4 AND screen_mode.used_kb <= 10",
    "table_names": [
      "screen_mode",
      "phone"
    ]
  },
  {
    "id": 322,
    "db_id": "phone_1",
    "question": "Which companies have phone models using chip models launched by 2004 that support WiFi standard 802.11b?",
    "sql": "SELECT Company_name FROM phone WHERE chip_model IN (SELECT Model_name FROM chip_model WHERE WiFi = '802.11b' AND Launch_year <= 2004);",
    "table_names": [
      "chip_model",
      "phone"
    ]
  },
  {
    "id": 324,
    "db_id": "phone_1",
    "question": "List the company name, hardware model name, char cells, pixel resolution, and number of hardware colors for phones accredited with the 'joyn Hot Fixes' level and using graphic screen modes.",
    "sql": "SELECT phone.Company_name, phone.Hardware_Model_name, screen_mode.Char_cells, screen_mode.Pixels, screen_mode.Hardware_colours FROM phone JOIN screen_mode ON phone.screen_mode = screen_mode.Graphics_mode WHERE phone.Accreditation_level = 'joyn Hot Fixes' AND screen_mode.Type = 'Graphics';",
    "table_names": [
      "screen_mode",
      "phone"
    ]
  },
  {
    "id": 325,
    "db_id": "phone_1",
    "question": "What are the hardware model names and pixel resolutions of Samsung Electronics phones that use Graphics type screen modes?",
    "sql": "SELECT p.Hardware_Model_name, s.Pixels FROM phone p JOIN screen_mode s ON CAST(p.screen_mode AS FLOAT) = s.Graphics_mode WHERE p.Company_name = 'Samsung Electronics Co Ltd' AND s.Type = 'Graphics';",
    "table_names": [
      "screen_mode",
      "phone"
    ]
  },
  {
    "id": 326,
    "db_id": "phone_1",
    "question": "List the companies along with the chip model names and launch years for phones that use chip models supporting WiFi '802.11b' and have at least 128 MiB ROM. Order the result by the chip launch year ascending.",
    "sql": "SELECT p.Company_name, c.Model_name, c.Launch_year FROM phone p JOIN chip_model c ON p.chip_model = c.Model_name WHERE c.WiFi = '802.11b' AND c.ROM_MiB >= 128 ORDER BY c.Launch_year ASC;",
    "table_names": [
      "chip_model",
      "phone"
    ]
  },
  {
    "id": 327,
    "db_id": "phone_1",
    "question": "List the names of companies which use phone models equipped with a chip model supporting WiFi standard '802.11b' and launched in or after 2004.",
    "sql": "SELECT DISTINCT phone.Company_name FROM phone INNER JOIN chip_model ON phone.chip_model = chip_model.Model_name WHERE chip_model.WiFi = '802.11b' AND chip_model.Launch_year >= 2004;",
    "table_names": [
      "chip_model",
      "phone"
    ]
  },
  {
    "id": 328,
    "db_id": "phone_1",
    "question": "Which companies produce phones that have a screen mode supporting more than 2 hardware colors and possess a 'Full' accreditation type?",
    "sql": "SELECT phone.Company_name FROM phone JOIN screen_mode ON phone.screen_mode = screen_mode.Graphics_mode WHERE screen_mode.Hardware_colours > 2 AND phone.Accreditation_type = 'Full';",
    "table_names": [
      "screen_mode",
      "phone"
    ]
  },
  {
    "id": 329,
    "db_id": "match_season",
    "question": "Which team selected the player from the 2007 MLS SuperDraft, and what was their playing position? Also, provide details about any players from the same team in the player table, including their years played and their total win-loss record.",
    "sql": "SELECT ms.Team, ms.Player, ms.Position, p.Years_Played, p.Total_WL FROM match_season AS ms JOIN player AS p ON ms.Team = p.Team WHERE ms.Draft_Class = '2007 MLS SuperDraft';",
    "table_names": [
      "match_season",
      "player"
    ]
  },
  {
    "id": 330,
    "db_id": "match_season",
    "question": "Which team that has defenders drafted from college teams has the maximum number of players associated in the player table?",
    "sql": "SELECT ms.Team, COUNT(p.Player) FROM match_season ms JOIN player p ON ms.Team = p.Team WHERE ms.Position = 'Defender' GROUP BY ms.Team ORDER BY COUNT(p.Player) DESC LIMIT 1;",
    "table_names": [
      "match_season",
      "player"
    ]
  },
  {
    "id": 331,
    "db_id": "match_season",
    "question": "Who was the first player drafted to play for Columbus Crew according to their season data?",
    "sql": "SELECT ms.Player, ms.Season FROM match_season ms JOIN team t ON ms.Team = t.Team_id WHERE t.Name = 'Columbus Crew' ORDER BY ms.Season ASC LIMIT 1;",
    "table_names": [
      "team",
      "match_season"
    ]
  },
  {
    "id": 332,
    "db_id": "match_season",
    "question": "Which team drafted a player from Maryland college in the 2009 MLS SuperDraft season?",
    "sql": "SELECT team.Name FROM team JOIN match_season ON team.Team_id = match_season.Team WHERE match_season.College = 'Maryland' AND match_season.Season = 2009;",
    "table_names": [
      "team",
      "match_season"
    ]
  },
  {
    "id": 333,
    "db_id": "match_season",
    "question": "Which country and its capital does the player awarded in the 2003 season belong to?",
    "sql": "SELECT c.Country_name, c.Capital FROM country c JOIN match_season m ON c.Country_id = m.Country WHERE m.Season = 2003.0;",
    "table_names": [
      "country",
      "match_season"
    ]
  },
  {
    "id": 334,
    "db_id": "match_season",
    "question": "What was the name, position, and native language of the player, along with his country name, who played during the 2003 season?",
    "sql": "SELECT c.Country_name, c.Official_native_language, ms.Player, ms.Position FROM country c JOIN match_season ms ON c.Country_id = ms.Country WHERE ms.Season = 2003;",
    "table_names": [
      "country",
      "match_season"
    ]
  },
  {
    "id": 335,
    "db_id": "match_season",
    "question": "What is the name, position, country, and country's capital for the soccer player drafted in the year 2003?",
    "sql": "SELECT m.Player, m.Position, c.Country_name, c.Capital FROM match_season m JOIN country c ON m.Country = c.Country_id WHERE m.Season = 2003;",
    "table_names": [
      "country",
      "match_season"
    ]
  },
  {
    "id": 336,
    "db_id": "match_season",
    "question": "What player is a forward and comes from the country whose capital is Dublin?",
    "sql": "SELECT ms.Player, c.Country_name FROM match_season ms JOIN country c ON ms.Country = c.Country_id WHERE ms.Position = 'Forward' AND c.Capital = 'Dublin';",
    "table_names": [
      "country",
      "match_season"
    ]
  },
  {
    "id": 337,
    "db_id": "match_season",
    "question": "Which country's official native language has the highest number of midfielders playing across all seasons?",
    "sql": "SELECT country.Country_name, country.Official_native_language, COUNT(match_season.Player) AS num_players FROM country JOIN match_season ON country.Country_id = match_season.Country WHERE match_season.Position = 'Midfielder' GROUP BY country.Country_name ORDER BY num_players DESC LIMIT 1;",
    "table_names": [
      "country",
      "match_season"
    ]
  },
  {
    "id": 338,
    "db_id": "match_season",
    "question": "Which country has produced the most players playing as defenders, and how many defenders does it have?",
    "sql": "SELECT c.Country_name, COUNT(ms.Player) AS Number_of_players FROM country c JOIN match_season ms ON c.Country_id = ms.Country WHERE ms.Position = 'Defender' GROUP BY c.Country_name ORDER BY Number_of_players DESC LIMIT 1;",
    "table_names": [
      "country",
      "match_season"
    ]
  },
  {
    "id": 339,
    "db_id": "match_season",
    "question": "Who is the player from the country whose capital is Dublin that participated in the 2001 season?",
    "sql": "SELECT ms.Player FROM match_season ms JOIN country c ON ms.Country = c.Country_id WHERE c.Capital = 'Dublin' AND ms.Season = 2001;",
    "table_names": [
      "country",
      "match_season"
    ]
  },
  {
    "id": 340,
    "db_id": "match_season",
    "question": "Which player comes from the country whose capital is Jakarta and what is his playing position?",
    "sql": "SELECT ms.Player, ms.Position FROM match_season ms JOIN country c ON ms.Country = c.Country_id WHERE c.Capital = 'Jakarta';",
    "table_names": [
      "country",
      "match_season"
    ]
  },
  {
    "id": 341,
    "db_id": "match_season",
    "question": "What is the official native language of the country whose capital is the homeland of the midfielder drafted in 2004 MLS SuperDraft from Furman?",
    "sql": "SELECT Official_native_language FROM country WHERE Country_id = (SELECT Country FROM match_season WHERE Draft_Class = '2004 MLS SuperDraft' AND College = 'Furman' AND Position = 'Midfielder');",
    "table_names": [
      "country",
      "match_season"
    ]
  },
  {
    "id": 342,
    "db_id": "match_season",
    "question": "What is the capital city of the country from which the forward player who had a draft pick number less than 15 in the 2003 season originates?",
    "sql": "SELECT country.Capital FROM country JOIN match_season ON country.Country_id = match_season.Country WHERE match_season.Position = 'Forward' AND match_season.Draft_Pick_Number < 15 AND match_season.Season = 2003",
    "table_names": [
      "country",
      "match_season"
    ]
  },
  {
    "id": 343,
    "db_id": "match_season",
    "question": "In the 2004 season, which team's player occupied the position of Midfielder?",
    "sql": "SELECT t.Name FROM team t JOIN match_season m ON t.Team_id = m.Team WHERE m.Position = 'Midfielder' AND m.Season = 2004.0;",
    "table_names": [
      "team",
      "match_season"
    ]
  },
  {
    "id": 344,
    "db_id": "match_season",
    "question": "Which team has the highest number of players from UCLA according to the available data?",
    "sql": "SELECT t.Name, COUNT(ms.Player) AS Players_From_UCLA FROM team t JOIN match_season ms ON t.Team_id = ms.Team WHERE ms.College = 'UCLA' GROUP BY t.Name ORDER BY Players_From_UCLA DESC LIMIT 1",
    "table_names": [
      "team",
      "match_season"
    ]
  },
  {
    "id": 345,
    "db_id": "match_season",
    "question": "What was the name of the team Kyle Martino played for in the 2002 season?",
    "sql": "SELECT t.Name FROM team t JOIN match_season ms ON t.Team_id = ms.Team WHERE ms.Player = 'Kyle Martino Category:Articles with hCards' AND ms.Season = 2002.0;",
    "table_names": [
      "team",
      "match_season"
    ]
  },
  {
    "id": 346,
    "db_id": "match_season",
    "question": "What are the names of teams that had defenders who attended UCLA?",
    "sql": "SELECT t.Name FROM team t JOIN match_season ms ON t.Team_id = ms.Team WHERE ms.Position = 'Defender' AND ms.College = 'UCLA';",
    "table_names": [
      "team",
      "match_season"
    ]
  },
  {
    "id": 347,
    "db_id": "match_season",
    "question": "How many distinct players came from colleges Virginia and Maryland across all teams?",
    "sql": "SELECT COUNT(DISTINCT ms.Player) FROM match_season ms JOIN team t ON ms.Team = t.Team_id WHERE ms.College = 'Virginia' OR ms.College = 'Maryland';",
    "table_names": [
      "team",
      "match_season"
    ]
  },
  {
    "id": 348,
    "db_id": "match_season",
    "question": "Which teams drafted defenders from Maryland college?",
    "sql": "SELECT team.Name FROM team JOIN match_season ON team.Team_id = match_season.Team WHERE match_season.College = 'Maryland' AND match_season.Position = 'Defender';",
    "table_names": [
      "team",
      "match_season"
    ]
  },
  {
    "id": 349,
    "db_id": "match_season",
    "question": "Which team does Lim Yong-Kyu (288) play for?",
    "sql": "SELECT team.Name FROM team JOIN player ON team.Team_id = player.Team WHERE player.Player = 'Lim Yong-Kyu (288)';",
    "table_names": [
      "team",
      "player"
    ]
  },
  {
    "id": 350,
    "db_id": "match_season",
    "question": "What is the name of the team that the player 'Lim Yong-Kyu (288)' played for?",
    "sql": "SELECT team.Name FROM team INNER JOIN player ON team.Team_id = player.Team WHERE player.Player = 'Lim Yong-Kyu (288)';",
    "table_names": [
      "team",
      "player"
    ]
  },
  {
    "id": 351,
    "db_id": "match_season",
    "question": "What is the name of the player who played in the 2003 season and what is the capital city of the country the player represents?",
    "sql": "SELECT ms.Player, c.Capital FROM match_season ms INNER JOIN country c ON ms.Country = c.Country_id WHERE ms.Season = 2003;",
    "table_names": [
      "country",
      "match_season"
    ]
  },
  {
    "id": 352,
    "db_id": "match_season",
    "question": "What is the country name of the player who played in season 2003?",
    "sql": "SELECT country.Country_name FROM country JOIN match_season ON country.Country_id = match_season.Country WHERE match_season.Season = 2003.0;",
    "table_names": [
      "country",
      "match_season"
    ]
  },
  {
    "id": 353,
    "db_id": "match_season",
    "question": "Which college did the player drafted by team number 5 in the 2009 MLS SuperDraft attend, and what is the singles win-loss record of the player who played between 2009-2011 for team number 6?",
    "sql": "SELECT ms.College, p.Singles_WL FROM match_season ms JOIN player p ON p.Team = 6 WHERE ms.Draft_Class = '2009 MLS SuperDraft' AND ms.Team = 5 AND p.Years_Played LIKE '%2009%' AND p.Years_Played LIKE '%2011%';",
    "table_names": [
      "match_season",
      "player"
    ]
  },
  {
    "id": 354,
    "db_id": "match_season",
    "question": "Find the names, colleges, and singles win-loss records of midfield players who played for team number 3 and are associated with the 2011 year.",
    "sql": "SELECT ms.Player, ms.College, p.Singles_WL FROM match_season ms JOIN player p ON ms.Team = p.Team WHERE ms.Position = 'Midfielder' AND ms.Team = 3 AND p.Years_Played LIKE '%2011%';",
    "table_names": [
      "match_season",
      "player"
    ]
  },
  {
    "id": 355,
    "db_id": "match_season",
    "question": "What are the names of teams that drafted midfielders from Virginia college?",
    "sql": "SELECT team.Name FROM team JOIN match_season ON team.Team_id = match_season.Team WHERE match_season.Position = 'Midfielder' AND match_season.College = 'Virginia';",
    "table_names": [
      "team",
      "match_season"
    ]
  },
  {
    "id": 356,
    "db_id": "match_season",
    "question": "Which team had the highest number of players playing as defenders across all seasons?",
    "sql": "SELECT team.Name, COUNT(match_season.Player) AS total_players FROM team JOIN match_season ON team.Team_id = match_season.Team WHERE match_season.Position = 'Defender' GROUP BY team.Name ORDER BY total_players DESC LIMIT 1;",
    "table_names": [
      "team",
      "match_season"
    ]
  },
  {
    "id": 357,
    "db_id": "match_season",
    "question": "Which players from countries with 'English' as an official language were drafted in the top 5 picks, and what positions did they play?",
    "sql": "SELECT ms.Player, ms.Position FROM match_season ms JOIN country c ON ms.Country = c.Country_id WHERE c.Official_native_language LIKE '%English%' AND ms.Draft_Pick_Number <= 5",
    "table_names": [
      "country",
      "match_season"
    ]
  },
  {
    "id": 358,
    "db_id": "match_season",
    "question": "Which country has the most players who played as midfielders, and what is the count of those midfielder players from that country?",
    "sql": "SELECT c.Country_name, COUNT(m.Player) AS Number_of_Players FROM country AS c JOIN match_season AS m ON c.Country_id = m.Country WHERE m.Position = 'Midfielder' GROUP BY c.Country_name ORDER BY Number_of_Players DESC LIMIT 1;",
    "table_names": [
      "country",
      "match_season"
    ]
  },
  {
    "id": 359,
    "db_id": "climbing",
    "question": "Who climbed the tallest mountain located entirely in Kenya?",
    "sql": "SELECT c.Name FROM climber AS c JOIN mountain AS m ON c.Mountain_ID = m.Mountain_ID WHERE m.Height = (SELECT MAX(Height) FROM mountain WHERE Country = 'Kenya');",
    "table_names": [
      "mountain",
      "climber"
    ]
  },
  {
    "id": 360,
    "db_id": "climbing",
    "question": "Who achieved the highest points among climbers who climbed mountains located in Kenya?",
    "sql": "SELECT c.Name FROM climber AS c JOIN mountain AS m ON c.Mountain_ID = m.Mountain_ID WHERE c.Points = (SELECT MAX(Points) FROM climber WHERE Mountain_ID IN (SELECT Mountain_ID FROM mountain WHERE Country = 'Kenya'));",
    "table_names": [
      "mountain",
      "climber"
    ]
  },
  {
    "id": 361,
    "db_id": "climbing",
    "question": "What is the name of the highest mountain climbed by a climber from the United Kingdom?",
    "sql": "SELECT mountain.Name FROM mountain JOIN climber ON mountain.Mountain_ID = climber.Mountain_ID WHERE climber.Country = 'United Kingdom' ORDER BY mountain.Height DESC LIMIT 1;",
    "table_names": [
      "mountain",
      "climber"
    ]
  },
  {
    "id": 362,
    "db_id": "climbing",
    "question": "Who scored the highest points among climbers that climbed mountains in the 'Mount Kenya' range?",
    "sql": "SELECT c.Name FROM climber c JOIN mountain m ON c.Mountain_ID = m.Mountain_ID WHERE m.Range = 'Mount Kenya' ORDER BY c.Points DESC LIMIT 1;",
    "table_names": [
      "mountain",
      "climber"
    ]
  },
  {
    "id": 363,
    "db_id": "climbing",
    "question": "What is the name of the mountain climbed by the highest-scoring climber from the United Kingdom?",
    "sql": "SELECT m.Name FROM mountain AS m JOIN climber AS c ON m.Mountain_ID = c.Mountain_ID WHERE c.Points = (SELECT MAX(Points) FROM climber WHERE Country = 'United Kingdom');",
    "table_names": [
      "mountain",
      "climber"
    ]
  },
  {
    "id": 364,
    "db_id": "climbing",
    "question": "What is the name of the mountain and the range climbed by the climber who achieved the lowest points?",
    "sql": "SELECT mountain.Name, mountain.Range FROM mountain JOIN climber ON mountain.Mountain_ID = climber.Mountain_ID WHERE climber.Points = (SELECT MIN(Points) FROM climber);",
    "table_names": [
      "mountain",
      "climber"
    ]
  },
  {
    "id": 365,
    "db_id": "climbing",
    "question": "Who were the climbers that climbed mountains located fully or partly in Uganda that have a height greater than 4900 meters?",
    "sql": "SELECT climber.Name FROM climber JOIN mountain ON climber.Mountain_ID = mountain.Mountain_ID WHERE mountain.Country LIKE '%Uganda%' AND mountain.Height > 4900;",
    "table_names": [
      "mountain",
      "climber"
    ]
  },
  {
    "id": 366,
    "db_id": "climbing",
    "question": "What is the name and height of the highest mountain climbed by climbers from West Germany?",
    "sql": "SELECT mountain.Name, mountain.Height FROM mountain JOIN climber ON mountain.Mountain_ID = climber.Mountain_ID WHERE climber.Country = 'West Germany' ORDER BY mountain.Height DESC LIMIT 1;",
    "table_names": [
      "mountain",
      "climber"
    ]
  },
  {
    "id": 367,
    "db_id": "climbing",
    "question": "Which climbers from West Germany have climbed mountains higher than 5000 meters?",
    "sql": "SELECT climber.Name FROM climber JOIN mountain ON climber.Mountain_ID = mountain.Mountain_ID WHERE mountain.Height > 5000 AND climber.Country = 'West Germany'",
    "table_names": [
      "mountain",
      "climber"
    ]
  },
  {
    "id": 368,
    "db_id": "climbing",
    "question": "Which climber achieved the fastest ascent on the mountain with the highest prominence in Tanzania, and what is their country of origin?",
    "sql": "SELECT climber.Name, climber.Country FROM climber JOIN mountain ON climber.Mountain_ID = mountain.Mountain_ID WHERE mountain.Country = 'Tanzania' ORDER BY climber.Time ASC LIMIT 1;",
    "table_names": [
      "mountain",
      "climber"
    ]
  },
  {
    "id": 369,
    "db_id": "climbing",
    "question": "Who is the highest scoring climber on a mountain located in Kenya?",
    "sql": "SELECT climber.Name FROM climber JOIN mountain ON climber.Mountain_ID = mountain.Mountain_ID WHERE mountain.Country = 'Kenya' ORDER BY climber.Points DESC LIMIT 1;",
    "table_names": [
      "mountain",
      "climber"
    ]
  },
  {
    "id": 370,
    "db_id": "climbing",
    "question": "Who is the fastest climber on mountains located in Kenya?",
    "sql": "SELECT c.Name FROM climber c JOIN mountain m ON c.Mountain_ID = m.Mountain_ID WHERE m.Country LIKE '%Kenya%' ORDER BY c.Time ASC LIMIT 1;",
    "table_names": [
      "mountain",
      "climber"
    ]
  },
  {
    "id": 371,
    "db_id": "body_builder",
    "question": "What is the name and birth place of the body builder who achieved the highest total score?",
    "sql": "SELECT p.Name, p.Birth_Place FROM body_builder b JOIN people p ON b.People_ID = p.People_ID WHERE b.Total = (SELECT MAX(Total) FROM body_builder);",
    "table_names": [
      "body_builder",
      "people"
    ]
  },
  {
    "id": 372,
    "db_id": "body_builder",
    "question": "Who has achieved the highest Clean & Jerk score and what is their name?",
    "sql": "SELECT p.Name FROM body_builder b JOIN people p ON b.People_ID = p.People_ID WHERE b.Clean_Jerk = (SELECT MAX(Clean_Jerk) FROM body_builder);",
    "table_names": [
      "body_builder",
      "people"
    ]
  },
  {
    "id": 373,
    "db_id": "body_builder",
    "question": "List the names, weights, and total weightlifting scores of bodybuilders whose weight exceeds 90 kg and whose combined snatch and clean & jerk scores total over 300 kg.",
    "sql": "SELECT p.Name, p.Weight, b.Total FROM body_builder b JOIN people p ON b.People_ID = p.People_ID WHERE p.Weight > 90 AND b.Total > 300;",
    "table_names": [
      "body_builder",
      "people"
    ]
  },
  {
    "id": 374,
    "db_id": "body_builder",
    "question": "Which body builder weighing over 90 kg achieved the highest total score and what is the total?",
    "sql": "SELECT p.Name, b.Total FROM body_builder b JOIN people p ON b.People_ID = p.People_ID WHERE p.Weight > 90 AND b.Total = (SELECT MAX(Total) FROM body_builder WHERE People_ID IN (SELECT People_ID FROM people WHERE Weight > 90));",
    "table_names": [
      "body_builder",
      "people"
    ]
  },
  {
    "id": 375,
    "db_id": "body_builder",
    "question": "What is the name and birthplace of the bodybuilder who achieved the highest total lift?",
    "sql": "SELECT p.Name, p.Birth_Place FROM body_builder b JOIN people p ON b.People_ID = p.People_ID WHERE b.Total = (SELECT MAX(Total) FROM body_builder)",
    "table_names": [
      "body_builder",
      "people"
    ]
  },
  {
    "id": 376,
    "db_id": "body_builder",
    "question": "Who among body builders born in Michigan achieved the highest total score, and what was that total?",
    "sql": "SELECT people.Name, body_builder.Total FROM people JOIN body_builder ON people.People_ID = body_builder.People_ID WHERE people.Birth_Place LIKE '%Michigan%' ORDER BY body_builder.Total DESC LIMIT 1;",
    "table_names": [
      "body_builder",
      "people"
    ]
  },
  {
    "id": 377,
    "db_id": "body_builder",
    "question": "What is the name and birthplace of the bodybuilder who has the lowest total score?",
    "sql": "SELECT p.Name, p.Birth_Place FROM body_builder b JOIN people p ON b.People_ID = p.People_ID WHERE b.Total = (SELECT MIN(Total) FROM body_builder);",
    "table_names": [
      "body_builder",
      "people"
    ]
  },
  {
    "id": 378,
    "db_id": "body_builder",
    "question": "Which bodybuilders have achieved a total lifting amount equal to or greater than 315 kg, and what are their birthplaces?",
    "sql": "SELECT people.Name, people.Birth_Place FROM body_builder INNER JOIN people ON body_builder.People_ID = people.People_ID WHERE body_builder.Total >= 315;",
    "table_names": [
      "body_builder",
      "people"
    ]
  },
  {
    "id": 379,
    "db_id": "body_builder",
    "question": "Which body builder has the highest total lifts and what is their name?",
    "sql": "SELECT p.Name FROM body_builder b JOIN people p ON b.People_ID = p.People_ID WHERE b.Total = (SELECT MAX(Total) FROM body_builder);",
    "table_names": [
      "body_builder",
      "people"
    ]
  },
  {
    "id": 380,
    "db_id": "body_builder",
    "question": "What is the birth place of the body builder with the highest total lifting weight?",
    "sql": "SELECT p.Birth_Place FROM body_builder b JOIN people p ON b.People_ID = p.People_ID WHERE b.Total = (SELECT MAX(Total) FROM body_builder);",
    "table_names": [
      "body_builder",
      "people"
    ]
  },
  {
    "id": 381,
    "db_id": "body_builder",
    "question": "Who are the body builders who achieved a Clean & Jerk weight greater than 175 kg and what is their corresponding body weight?",
    "sql": "SELECT P.Name, P.Weight FROM body_builder AS B JOIN people AS P ON B.People_ID = P.People_ID WHERE B.Clean_Jerk > 175.0;",
    "table_names": [
      "body_builder",
      "people"
    ]
  },
  {
    "id": 382,
    "db_id": "election_representative",
    "question": "Which Democratic representatives won elections with at least 9 seats?",
    "sql": "SELECT representative.Name FROM election INNER JOIN representative ON election.Representative_ID = representative.Representative_ID WHERE election.Seats >= 9 AND representative.Party = 'Democratic';",
    "table_names": [
      "election",
      "representative"
    ]
  },
  {
    "id": 383,
    "db_id": "election_representative",
    "question": "Which representative secured the highest percentage of votes in any election?",
    "sql": "SELECT r.Name FROM election e JOIN representative r ON e.Representative_ID = r.Representative_ID WHERE e.Vote_Percent = (SELECT MAX(Vote_Percent) FROM election);",
    "table_names": [
      "election",
      "representative"
    ]
  },
  {
    "id": 384,
    "db_id": "election_representative",
    "question": "What is the name and political party of the representative who secured the highest number of seats in a single election?",
    "sql": "SELECT representative.Name, representative.Party FROM election INNER JOIN representative ON election.Representative_ID = representative.Representative_ID WHERE election.Seats = (SELECT MAX(Seats) FROM election);",
    "table_names": [
      "election",
      "representative"
    ]
  },
  {
    "id": 385,
    "db_id": "election_representative",
    "question": "Which representatives secured at least 10 seats in elections, and what was their political party, sorted by election date from earliest to latest?",
    "sql": "SELECT r.Name, r.Party FROM election e JOIN representative r ON e.Representative_ID = r.Representative_ID WHERE e.Seats >= 10 ORDER BY e.Date ASC;",
    "table_names": [
      "election",
      "representative"
    ]
  },
  {
    "id": 386,
    "db_id": "election_representative",
    "question": "Which representative secured second place in the 1949 election, and from which state did this representative come from?",
    "sql": "SELECT r.Name, r.State FROM election e JOIN representative r ON e.Representative_ID = r.Representative_ID WHERE e.Date = '1949' AND e.Place = 2;",
    "table_names": [
      "election",
      "representative"
    ]
  },
  {
    "id": 387,
    "db_id": "election_representative",
    "question": "Who was the Democratic representative with the highest vote percentage in elections listed?",
    "sql": "SELECT r.Name FROM representative r JOIN election e ON r.Representative_ID = e.Representative_ID WHERE r.Party = 'Democratic' ORDER BY e.Vote_Percent DESC LIMIT 1;",
    "table_names": [
      "election",
      "representative"
    ]
  },
  {
    "id": 388,
    "db_id": "election_representative",
    "question": "Who was the representative elected in the election with the greatest number of seats?",
    "sql": "SELECT r.Name FROM election e JOIN representative r ON e.Representative_ID = r.Representative_ID WHERE e.Seats = (SELECT MAX(Seats) FROM election);",
    "table_names": [
      "election",
      "representative"
    ]
  },
  {
    "id": 389,
    "db_id": "apartment_rentals",
    "question": "What are the apartment numbers of duplex apartments that have confirmed bookings ending after January 1, 2017?",
    "sql": "SELECT apt.apt_number FROM Apartments apt JOIN Apartment_Bookings bk ON apt.apt_id = bk.apt_id WHERE apt.apt_type_code = 'Duplex' AND bk.booking_status_code = 'Confirmed' AND bk.booking_end_date > '2017-01-01'",
    "table_names": [
      "Apartments",
      "Apartment_Bookings"
    ]
  },
  {
    "id": 390,
    "db_id": "apartment_rentals",
    "question": "How many distinct guests have confirmed bookings for apartments that have at least 5 bedrooms?",
    "sql": "SELECT COUNT(DISTINCT ab.guest_id) FROM Apartments a INNER JOIN Apartment_Bookings ab ON a.apt_id = ab.apt_id WHERE a.bedroom_count >= 5 AND ab.booking_status_code = 'Confirmed';",
    "table_names": [
      "Apartments",
      "Apartment_Bookings"
    ]
  },
  {
    "id": 391,
    "db_id": "apartment_rentals",
    "question": "What are the apartment numbers booked with 'Confirmed' status that have at least 3 bathrooms?",
    "sql": "SELECT apt_number FROM Apartments WHERE apt_id IN (SELECT apt_id FROM Apartment_Bookings WHERE booking_status_code = 'Confirmed') AND bathroom_count >= 3;",
    "table_names": [
      "Apartments",
      "Apartment_Bookings"
    ]
  },
  {
    "id": 392,
    "db_id": "apartment_rentals",
    "question": "List the apartment numbers which have exactly 4 bedrooms and have confirmed bookings.",
    "sql": "SELECT a.apt_number FROM Apartments AS a JOIN Apartment_Bookings AS ab ON a.apt_id = ab.apt_id WHERE a.bedroom_count = 4 AND ab.booking_status_code = 'Confirmed';",
    "table_names": [
      "Apartments",
      "Apartment_Bookings"
    ]
  },
  {
    "id": 393,
    "db_id": "apartment_rentals",
    "question": "How many unique guests have confirmed bookings in apartments that are of the type 'Flat'?",
    "sql": "SELECT COUNT(DISTINCT ab.guest_id) FROM Apartments a JOIN Apartment_Bookings ab ON a.apt_id = ab.apt_id WHERE a.apt_type_code = 'Flat' AND ab.booking_status_code = 'Confirmed';",
    "table_names": [
      "Apartments",
      "Apartment_Bookings"
    ]
  },
  {
    "id": 394,
    "db_id": "apartment_rentals",
    "question": "What apartment numbers have at least 2 bathrooms and a confirmed booking ending on or after November 1, 2017?",
    "sql": "SELECT apt.apt_number FROM Apartments AS apt JOIN Apartment_Bookings AS booking ON apt.apt_id = booking.apt_id WHERE apt.bathroom_count >= 2 AND booking.booking_status_code = 'Confirmed' AND booking.booking_end_date >= '2017-11-01';",
    "table_names": [
      "Apartments",
      "Apartment_Bookings"
    ]
  },
  {
    "id": 395,
    "db_id": "apartment_rentals",
    "question": "What are the apartment numbers and types of all apartments that had confirmed bookings ending in the month of September 2017?",
    "sql": "SELECT a.apt_number, a.apt_type_code FROM Apartments a JOIN Apartment_Bookings b ON a.apt_id = b.apt_id WHERE b.booking_status_code = 'Confirmed' AND b.booking_end_date BETWEEN '2017-09-01' AND '2017-09-30';",
    "table_names": [
      "Apartments",
      "Apartment_Bookings"
    ]
  },
  {
    "id": 396,
    "db_id": "apartment_rentals",
    "question": "Which apartment number of type 'Duplex' has a confirmed booking with the earliest booking start date?",
    "sql": "SELECT apt.apt_number FROM Apartments apt JOIN Apartment_Bookings ab ON apt.apt_id = ab.apt_id WHERE apt.apt_type_code = 'Duplex' AND ab.booking_status_code = 'Confirmed' ORDER BY ab.booking_start_date ASC LIMIT 1;",
    "table_names": [
      "Apartments",
      "Apartment_Bookings"
    ]
  },
  {
    "id": 397,
    "db_id": "apartment_rentals",
    "question": "Find the apartment numbers for apartments that have more than one bathroom and more than three bedrooms, and have confirmed bookings that end after October 1, 2017.",
    "sql": "SELECT apt_number FROM Apartments WHERE apt_id IN (SELECT apt_id FROM Apartment_Bookings WHERE booking_status_code = 'Confirmed' AND booking_end_date > '2017-10-01') AND bathroom_count > 1 AND bedroom_count > 3;",
    "table_names": [
      "Apartments",
      "Apartment_Bookings"
    ]
  },
  {
    "id": 398,
    "db_id": "apartment_rentals",
    "question": "How many unique guests have confirmed bookings for apartments with two or more bathrooms?",
    "sql": "SELECT COUNT(DISTINCT ab.guest_id) FROM Apartments a JOIN Apartment_Bookings ab ON a.apt_id = ab.apt_id WHERE a.bathroom_count >= 2 AND ab.booking_status_code = 'Confirmed';",
    "table_names": [
      "Apartments",
      "Apartment_Bookings"
    ]
  },
  {
    "id": 399,
    "db_id": "apartment_rentals",
    "question": "What is the booking status of the Duplex apartment numbered 'Apt. 859', and when does its latest booking end?",
    "sql": "SELECT ab.booking_status_code, ab.booking_end_date FROM Apartments a JOIN Apartment_Bookings ab ON a.apt_id = ab.apt_id WHERE a.apt_type_code = 'Duplex' AND a.apt_number = 'Apt. 859' ORDER BY ab.booking_end_date DESC LIMIT 1;",
    "table_names": [
      "Apartments",
      "Apartment_Bookings"
    ]
  },
  {
    "id": 400,
    "db_id": "apartment_rentals",
    "question": "How many different buildings have apartments with 8 or more rooms that have confirmed bookings?",
    "sql": "SELECT COUNT(DISTINCT a.building_id) FROM Apartments a JOIN Apartment_Bookings ab ON a.apt_id = ab.apt_id WHERE ab.booking_status_code = 'Confirmed' AND a.room_count >= 8;",
    "table_names": [
      "Apartments",
      "Apartment_Bookings"
    ]
  },
  {
    "id": 401,
    "db_id": "apartment_rentals",
    "question": "Which guests have confirmed bookings for apartment number 8 with an end date after January 1, 2017?",
    "sql": "SELECT g.guest_first_name, g.guest_last_name FROM Guests g JOIN Apartment_Bookings ab ON g.guest_id = ab.guest_id WHERE ab.booking_status_code = 'Confirmed' AND ab.apt_id = 8 AND ab.booking_end_date>'2017-01-01';",
    "table_names": [
      "Guests",
      "Apartment_Bookings"
    ]
  },
  {
    "id": 402,
    "db_id": "apartment_rentals",
    "question": "How many different apartments have confirmed bookings by female guests?",
    "sql": "SELECT COUNT(DISTINCT ab.apt_id) FROM Apartment_Bookings ab JOIN Guests g ON ab.guest_id = g.guest_id WHERE g.gender_code = 'Female' AND ab.booking_status_code = 'Confirmed';",
    "table_names": [
      "Guests",
      "Apartment_Bookings"
    ]
  },
  {
    "id": 403,
    "db_id": "apartment_rentals",
    "question": "Who are the guests that have confirmed bookings ending in or after November 2017?",
    "sql": "SELECT guest_first_name, guest_last_name FROM Guests WHERE guest_id IN (SELECT guest_id FROM Apartment_Bookings WHERE booking_status_code = 'Confirmed' AND booking_end_date >= '2017-11-01');",
    "table_names": [
      "Guests",
      "Apartment_Bookings"
    ]
  },
  {
    "id": 404,
    "db_id": "apartment_rentals",
    "question": "List the first and last names of guests who have confirmed bookings ending after October 1, 2017.",
    "sql": "SELECT guest_first_name, guest_last_name FROM Guests WHERE guest_id IN (SELECT guest_id FROM Apartment_Bookings WHERE booking_status_code = 'Confirmed' AND booking_end_date > '2017-10-01');",
    "table_names": [
      "Guests",
      "Apartment_Bookings"
    ]
  },
  {
    "id": 405,
    "db_id": "apartment_rentals",
    "question": "What are the first and last names of the guests who have confirmed apartment bookings ending before October 1, 2017?",
    "sql": "SELECT guest_first_name, guest_last_name FROM Guests WHERE guest_id IN (SELECT guest_id FROM Apartment_Bookings WHERE booking_status_code = 'Confirmed' AND booking_end_date < '2017-10-01');",
    "table_names": [
      "Guests",
      "Apartment_Bookings"
    ]
  },
  {
    "id": 406,
    "db_id": "apartment_rentals",
    "question": "List the full names of all guests whose apartment bookings were confirmed and ended before October 1, 2017.",
    "sql": "SELECT g.guest_first_name, g.guest_last_name FROM Guests g JOIN Apartment_Bookings b ON g.guest_id = b.guest_id WHERE b.booking_status_code = 'Confirmed' AND b.booking_end_date < '2017-10-01';",
    "table_names": [
      "Guests",
      "Apartment_Bookings"
    ]
  },
  {
    "id": 407,
    "db_id": "apartment_rentals",
    "question": "What is the apartment type of apartments that provide a Swimming Pool facility and have more than 3 bedrooms?",
    "sql": "SELECT apt_type_code FROM Apartments WHERE apt_id IN (SELECT apt_id FROM Apartment_Facilities WHERE facility_code='Swimming Pool') AND bedroom_count>3",
    "table_names": [
      "Apartments",
      "Apartment_Facilities"
    ]
  },
  {
    "id": 408,
    "db_id": "apartment_rentals",
    "question": "Which apartment has 'Boardband' facility and exactly 8 rooms?",
    "sql": "SELECT a.apt_number FROM Apartments a JOIN Apartment_Facilities af ON a.apt_id = af.apt_id WHERE af.facility_code = 'Boardband' AND a.room_count = '8';",
    "table_names": [
      "Apartments",
      "Apartment_Facilities"
    ]
  },
  {
    "id": 409,
    "db_id": "apartment_rentals",
    "question": "How many unique buildings have apartments with at least 2 bathrooms and facilities of either a Gym or a Swimming Pool?",
    "sql": "SELECT COUNT(DISTINCT Apartments.building_id) FROM Apartments JOIN Apartment_Facilities ON Apartments.apt_id = Apartment_Facilities.apt_id WHERE Apartments.bathroom_count >= 2 AND Apartment_Facilities.facility_code IN ('Gym', 'Swimming Pool');",
    "table_names": [
      "Apartments",
      "Apartment_Facilities"
    ]
  },
  {
    "id": 410,
    "db_id": "apartment_rentals",
    "question": "What is the average number of bedrooms in apartments with Boardband facility?",
    "sql": "SELECT AVG(bedroom_count) FROM Apartments WHERE apt_id IN (SELECT apt_id FROM Apartment_Facilities WHERE facility_code = 'Boardband');",
    "table_names": [
      "Apartments",
      "Apartment_Facilities"
    ]
  },
  {
    "id": 411,
    "db_id": "apartment_rentals",
    "question": "What apartment number, building, and manager's name is associated with the apartment having the maximum number of bathrooms?",
    "sql": "SELECT apt.apt_number, ab.building_full_name, ab.building_manager FROM Apartments apt JOIN Apartment_Buildings ab ON apt.building_id = ab.building_id WHERE apt.bathroom_count = (SELECT MAX(bathroom_count) FROM Apartments)",
    "table_names": [
      "Apartment_Buildings",
      "Apartments"
    ]
  },
  {
    "id": 412,
    "db_id": "apartment_rentals",
    "question": "List the names of apartment buildings with a duplex description that have apartments with exactly 8 rooms, along with their apartment numbers.",
    "sql": "SELECT ab.building_full_name, a.apt_number FROM Apartment_Buildings ab JOIN Apartments a ON ab.building_id = a.building_id WHERE ab.building_description = 'Duplex' AND a.room_count = '8';",
    "table_names": [
      "Apartment_Buildings",
      "Apartments"
    ]
  },
  {
    "id": 413,
    "db_id": "apartment_rentals",
    "question": "What is the apartment number of a Duplex-type apartment in Columbus Square building with exactly 2 bathrooms?",
    "sql": "SELECT apt.apt_number FROM Apartments AS apt JOIN Apartment_Buildings AS bld ON apt.building_id = bld.building_id WHERE bld.building_short_name = 'Columbus Square' AND apt.bathroom_count = 2 AND apt.apt_type_code = 'Duplex';",
    "table_names": [
      "Apartment_Buildings",
      "Apartments"
    ]
  },
  {
    "id": 414,
    "db_id": "apartment_rentals",
    "question": "What is the name and apartment number of the building that contains an apartment with the highest number of bathrooms, and who is the manager of that building?",
    "sql": "SELECT ab.building_full_name, a.apt_number, ab.building_manager FROM Apartment_Buildings ab JOIN Apartments a ON ab.building_id = a.building_id WHERE a.bathroom_count = (SELECT MAX(bathroom_count) FROM Apartments);",
    "table_names": [
      "Apartment_Buildings",
      "Apartments"
    ]
  },
  {
    "id": 415,
    "db_id": "apartment_rentals",
    "question": "What is the full name of the apartment building managed by Sydni that has a duplex apartment type with at least 2 bathrooms?",
    "sql": "SELECT Apartment_Buildings.building_full_name FROM Apartment_Buildings JOIN Apartments ON Apartment_Buildings.building_id = Apartments.building_id WHERE Apartments.apt_type_code = 'Duplex' AND Apartments.bathroom_count >= 2 AND Apartment_Buildings.building_manager = 'Sydni';",
    "table_names": [
      "Apartment_Buildings",
      "Apartments"
    ]
  },
  {
    "id": 416,
    "db_id": "apartment_rentals",
    "question": "What is the full name of the apartment building managed by Sydni that has a duplex apartment with at least 2 bathrooms?",
    "sql": "SELECT b.building_full_name FROM Apartment_Buildings b JOIN Apartments a ON b.building_id = a.building_id WHERE a.apt_type_code = 'Duplex' AND a.bathroom_count >= 2 AND b.building_manager = 'Sydni';",
    "table_names": [
      "Apartment_Buildings",
      "Apartments"
    ]
  },
  {
    "id": 417,
    "db_id": "apartment_rentals",
    "question": "How many studio apartments offer either a gym or cable TV facility?",
    "sql": "SELECT COUNT(*) FROM Apartments AS a JOIN Apartment_Facilities AS f ON a.apt_id = f.apt_id WHERE a.apt_type_code = 'Studio' AND f.facility_code IN ('Gym', 'Cable TV');",
    "table_names": [
      "Apartments",
      "Apartment_Facilities"
    ]
  },
  {
    "id": 418,
    "db_id": "apartment_rentals",
    "question": "What apartment numbers have gym access and more than 5 bedrooms?",
    "sql": "SELECT a.apt_number FROM Apartments a JOIN Apartment_Facilities af ON a.apt_id = af.apt_id WHERE af.facility_code = 'Gym' AND a.bedroom_count > 5;",
    "table_names": [
      "Apartments",
      "Apartment_Facilities"
    ]
  },
  {
    "id": 419,
    "db_id": "apartment_rentals",
    "question": "Which apartments of type 'Duplex' were confirmed booked entirely within the years 2016 and 2017?",
    "sql": "SELECT a.apt_number FROM Apartments a JOIN Apartment_Bookings b ON a.apt_id = b.apt_id WHERE a.apt_type_code = 'Duplex' AND b.booking_status_code = 'Confirmed' AND b.booking_start_date >= '2016-01-01' AND b.booking_end_date <= '2017-12-31';",
    "table_names": [
      "Apartments",
      "Apartment_Bookings"
    ]
  },
  {
    "id": 420,
    "db_id": "apartment_rentals",
    "question": "List apartment numbers of apartments having 3 bathrooms where the booking status is recorded as provisional.",
    "sql": "SELECT A.apt_number FROM Apartments A JOIN Apartment_Bookings B ON A.apt_id = B.apt_id WHERE A.bathroom_count = 3 AND B.booking_status_code = 'Provisional';",
    "table_names": [
      "Apartments",
      "Apartment_Bookings"
    ]
  },
  {
    "id": 421,
    "db_id": "apartment_rentals",
    "question": "How many available apartments with 2 or more bathrooms exist for each apartment type?",
    "sql": "SELECT apt_type_code, COUNT(*) as total_available FROM Apartments a JOIN View_Unit_Status v ON a.apt_id = v.apt_id WHERE v.available_yn = 1 AND a.bathroom_count >= 2 GROUP BY apt_type_code;",
    "table_names": [
      "Apartments",
      "View_Unit_Status"
    ]
  },
  {
    "id": 429,
    "db_id": "soccer_1",
    "question": "What is the name of the league that belongs to Germany, according to the database details?",
    "sql": "SELECT League.name FROM League JOIN Country ON League.country_id = Country.id WHERE Country.name = 'Germany';",
    "table_names": [
      "League",
      "Country"
    ]
  },
  {
    "id": 430,
    "db_id": "soccer_1",
    "question": "What is the name of the league in the country whose name is Portugal?",
    "sql": "SELECT League.name FROM League JOIN Country ON League.country_id = Country.id WHERE Country.name = 'Portugal';",
    "table_names": [
      "League",
      "Country"
    ]
  },
  {
    "id": 439,
    "db_id": "performance_attendance",
    "question": "Which role played the highest total number of pieces across all performances?",
    "sql": "SELECT m.Role, SUM(ma.Num_of_Pieces) AS Total_Pieces FROM member m JOIN member_attendance ma ON m.Member_ID = ma.Member_ID GROUP BY m.Role ORDER BY Total_Pieces DESC LIMIT 1;",
    "table_names": [
      "member",
      "member_attendance"
    ]
  },
  {
    "id": 480,
    "db_id": "debate",
    "question": "Which debaters defeated William B. Maclay when he was arguing the affirmative side?",
    "sql": "SELECT p.Name FROM people p JOIN debate_people d ON p.People_ID = d.Negative WHERE d.If_Affirmative_Win = 'F' AND d.Affirmative = (SELECT People_ID FROM people WHERE Name = 'William B. Maclay');",
    "table_names": [
      "people",
      "debate_people"
    ]
  },
  {
    "id": 481,
    "db_id": "debate",
    "question": "List the names of Democratic representatives who successfully affirmed a debate.",
    "sql": "SELECT p.Name FROM people AS p WHERE p.People_ID IN (SELECT dp.Affirmative FROM debate_people AS dp WHERE dp.If_Affirmative_Win = 'T') AND p.Party = 'Democratic';",
    "table_names": [
      "people",
      "debate_people"
    ]
  },
  {
    "id": 482,
    "db_id": "debate",
    "question": "List the names of the participants who won debates as the negative side against Republican affirmative opponents.",
    "sql": "SELECT p.Name FROM people p JOIN debate_people d ON p.People_ID = d.Negative WHERE d.If_Affirmative_Win = 'F' AND d.Affirmative IN (SELECT People_ID FROM people WHERE Party = 'Republican');",
    "table_names": [
      "people",
      "debate_people"
    ]
  },
  {
    "id": 483,
    "db_id": "insurance_and_eClaims",
    "question": "Which customers have had 'Uniformed' policies ending between January 1st, 2018 and February 1st, 2018?",
    "sql": "SELECT Customer_Details FROM Customers WHERE Customer_ID IN (SELECT Customer_ID FROM Policies WHERE Policy_Type_Code = 'Uniformed' AND End_Date BETWEEN '2018-01-01' AND '2018-02-01')",
    "table_names": [
      "Customers",
      "Policies"
    ]
  },
  {
    "id": 484,
    "db_id": "insurance_and_eClaims",
    "question": "Which customer has the highest number of policies with policy type 'Uniformed'?",
    "sql": "SELECT Customers.Customer_Details, COUNT(Policies.Policy_ID) AS policy_count FROM Customers JOIN Policies ON Customers.Customer_ID = Policies.Customer_ID WHERE Policies.Policy_Type_Code = 'Uniformed' GROUP BY Customers.Customer_ID ORDER BY policy_count DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Policies"
    ]
  },
  {
    "id": 485,
    "db_id": "insurance_and_eClaims",
    "question": "Which type of disputed claim has the highest total amount claimed among those having at least one medical document submitted?",
    "sql": "SELECT ch.Claim_Type_Code, SUM(ch.Amount_Claimed) AS Total_Amount_Claimed FROM Claim_Headers ch JOIN Claims_Documents cd ON ch.Claim_Header_ID = cd.Claim_ID WHERE cd.Document_Type_Code = 'Medical' AND ch.Claim_Status_Code = 'Disputed' GROUP BY ch.Claim_Type_Code ORDER BY Total_Amount_Claimed DESC LIMIT 1;",
    "table_names": [
      "Claim_Headers",
      "Claims_Documents"
    ]
  },
  {
    "id": 486,
    "db_id": "insurance_and_eClaims",
    "question": "What is the Claim Header ID, status, and settlement date for the earliest Child Birth related claim having a Medical document type and an amount paid greater than 200?",
    "sql": "SELECT ch.Claim_Header_ID, ch.Claim_Status_Code, ch.Date_of_Settlement FROM Claim_Headers ch INNER JOIN Claims_Documents cd ON ch.Claim_Header_ID = cd.Claim_ID WHERE cd.Document_Type_Code = 'Medical' AND ch.Claim_Type_Code = 'Child Birth' AND ch.Amount_Piad > 200 ORDER BY ch.Date_of_Settlement LIMIT 1;",
    "table_names": [
      "Claim_Headers",
      "Claims_Documents"
    ]
  },
  {
    "id": 487,
    "db_id": "insurance_and_eClaims",
    "question": "List the names of all customers who hold the policy type 'Uniformed' and have policy end dates later than January 1, 2018?",
    "sql": "SELECT Customer_Details FROM Customers WHERE Customer_ID IN (SELECT Customer_ID FROM Policies WHERE Policy_Type_Code = 'Uniformed' AND End_Date > '2018-01-01');",
    "table_names": [
      "Customers",
      "Policies"
    ]
  },
  {
    "id": 488,
    "db_id": "insurance_and_eClaims",
    "question": "List all customers who held a 'Uniformed' type policy starting anytime between January 1st, 2017, and December 31st, 2018.",
    "sql": "SELECT Customers.Customer_Details FROM Customers INNER JOIN Policies ON Customers.Customer_ID = Policies.Customer_ID WHERE Policies.Policy_Type_Code = 'Uniformed' AND Policies.Start_Date BETWEEN '2017-01-01' AND '2018-12-31';",
    "table_names": [
      "Customers",
      "Policies"
    ]
  },
  {
    "id": 489,
    "db_id": "insurance_and_eClaims",
    "question": "How many distinct claims have a recorded outcome as 'Disputed' at the 'Close' claim processing stage?",
    "sql": "SELECT COUNT(DISTINCT cp.Claim_ID) FROM Claims_Processing cp JOIN Claims_Processing_Stages cps ON cp.Claim_Stage_ID = cps.Claim_Stage_ID WHERE cps.Claim_Status_Name = 'Close' AND cp.Claim_Outcome_Code = 'Disputed';",
    "table_names": [
      "Claims_Processing_Stages",
      "Claims_Processing"
    ]
  },
  {
    "id": 490,
    "db_id": "insurance_and_eClaims",
    "question": "How many distinct claims currently have the outcome 'Settled' and are at the claim stage status named 'Open'?",
    "sql": "SELECT COUNT(DISTINCT cp.Claim_ID) FROM Claims_Processing cp JOIN Claims_Processing_Stages cs ON cp.Claim_Stage_ID = cs.Claim_Stage_ID WHERE cp.Claim_Outcome_Code = 'Settled' AND cs.Claim_Status_Name = 'Open';",
    "table_names": [
      "Claims_Processing_Stages",
      "Claims_Processing"
    ]
  },
  {
    "id": 491,
    "db_id": "insurance_and_eClaims",
    "question": "Which customers had policies of type 'Uniformed' that ended after January 1, 2018?",
    "sql": "SELECT Customer_Details FROM Customers WHERE Customer_ID IN (SELECT Customer_ID FROM Policies WHERE Policy_Type_Code = 'Uniformed' AND End_Date > '2018-01-01');",
    "table_names": [
      "Customers",
      "Policies"
    ]
  },
  {
    "id": 492,
    "db_id": "insurance_and_eClaims",
    "question": "Who are the customers that started a 'Uniformed' policy before the year 2017?",
    "sql": "SELECT Customers.Customer_Details FROM Customers INNER JOIN Policies ON Customers.Customer_ID = Policies.Customer_ID WHERE Policies.Policy_Type_Code = 'Uniformed' AND Policies.Start_Date < '2017-01-01 00:00:00';",
    "table_names": [
      "Customers",
      "Policies"
    ]
  },
  {
    "id": 493,
    "db_id": "insurance_and_eClaims",
    "question": "How many distinct policy types has the customer named Dr. Diana Rath purchased?",
    "sql": "SELECT COUNT(DISTINCT p.Policy_Type_Code) FROM Customers c JOIN Policies p ON c.Customer_ID = p.Customer_ID WHERE c.Customer_Details = 'Dr. Diana Rath';",
    "table_names": [
      "Customers",
      "Policies"
    ]
  },
  {
    "id": 494,
    "db_id": "insurance_and_eClaims",
    "question": "List the names of customers who purchased a 'Deputy' policy after January 1st, 2017.",
    "sql": "SELECT Customer_Details FROM Customers WHERE Customer_ID IN (SELECT Customer_ID FROM Policies WHERE Policy_Type_Code = 'Deputy' AND Start_Date > '2017-01-01 00:00:00');",
    "table_names": [
      "Customers",
      "Policies"
    ]
  },
  {
    "id": 495,
    "db_id": "customer_complaints",
    "question": "How many customers have 'Dr.' as a prefix in their Customer_Details, and what is the Staff_ID of the staff member named 'Julius'?",
    "sql": "SELECT (SELECT COUNT(*) FROM Customers WHERE Customer_Details LIKE 'Dr.%') AS CustomersWithDrPrefix, (SELECT Staff_ID FROM Staff WHERE Staff_Details = 'Julius') AS StaffIdOfJulius;",
    "table_names": [
      "Customers",
      "Staff"
    ]
  },
  {
    "id": 496,
    "db_id": "customer_complaints",
    "question": "List the Customer_ID and Customer_Details of all customers whose Customer_ID is greater than the Staff_ID of staff member 'Margaretta'.",
    "sql": "SELECT Customer_ID, Customer_Details FROM Customers WHERE Customer_ID > (SELECT Staff_ID FROM Staff WHERE Staff_Details = 'Margaretta');",
    "table_names": [
      "Customers",
      "Staff"
    ]
  },
  {
    "id": 497,
    "db_id": "insurance_and_eClaims",
    "question": "Which customers have initiated policies with the 'Deputy' policy type after January 1st, 2018?",
    "sql": "SELECT c.Customer_Details FROM Customers c JOIN Policies p ON c.Customer_ID = p.Customer_ID WHERE p.Policy_Type_Code = 'Deputy' AND DATE(p.Start_Date) > '2018-01-01';",
    "table_names": [
      "Customers",
      "Policies"
    ]
  },
  {
    "id": 498,
    "db_id": "insurance_and_eClaims",
    "question": "Which customers have more than one distinct type of policy?",
    "sql": "SELECT Customer_Details FROM Customers WHERE Customer_ID IN (SELECT Customer_ID FROM Policies GROUP BY Customer_ID HAVING COUNT(DISTINCT Policy_Type_Code) > 1);",
    "table_names": [
      "Customers",
      "Policies"
    ]
  },
  {
    "id": 499,
    "db_id": "insurance_and_eClaims",
    "question": "Who are the customers that have a 'Uniformed' policy type which ended in January 2018?",
    "sql": "SELECT Customer_Details FROM Customers WHERE Customer_ID IN (SELECT Customer_ID FROM Policies WHERE Policy_Type_Code = 'Uniformed' AND End_Date BETWEEN '2018-01-01' AND '2018-01-31')",
    "table_names": [
      "Customers",
      "Policies"
    ]
  },
  {
    "id": 500,
    "db_id": "insurance_and_eClaims",
    "question": "Which customers have a 'Uniformed' policy type that expired after the date '2018-01-01'?",
    "sql": "SELECT Customer_Details FROM Customers WHERE Customer_ID IN (SELECT Customer_ID FROM Policies WHERE Policy_Type_Code = 'Uniformed' AND End_Date > '2018-01-01 00:00:00');",
    "table_names": [
      "Customers",
      "Policies"
    ]
  },
  {
    "id": 501,
    "db_id": "customers_card_transactions",
    "question": "Who is the customer from Mississippi with the earliest opened account, what is the account name, and when was it opened?",
    "sql": "SELECT Customers.customer_first_name, Customers.customer_last_name, Customers.state_county_province, Accounts.account_name, Accounts.date_account_opened FROM Customers JOIN Accounts ON Customers.customer_id = Accounts.customer_id WHERE Customers.state_county_province = 'Mississippi' ORDER BY Accounts.date_account_opened ASC LIMIT 1;",
    "table_names": [
      "Customers",
      "Accounts"
    ]
  },
  {
    "id": 502,
    "db_id": "customers_card_transactions",
    "question": "How many VIP accounts does the customer from South Dakota have, and what is the customer's full name?",
    "sql": "SELECT c.customer_first_name, c.customer_last_name, COUNT(a.account_id) AS vip_account_count FROM Customers c JOIN Accounts a ON c.customer_id = a.customer_id WHERE c.state_county_province = 'SouthDakota' AND a.other_account_details = 'VIP' GROUP BY c.customer_id, c.customer_first_name, c.customer_last_name;",
    "table_names": [
      "Customers",
      "Accounts"
    ]
  },
  {
    "id": 503,
    "db_id": "customers_card_transactions",
    "question": "What are the first name, last name, and city of customers from South Dakota who have VIP accounts?",
    "sql": "SELECT c.customer_first_name, c.customer_last_name, c.town_city FROM Customers c JOIN Accounts a ON c.customer_id = a.customer_id WHERE a.other_account_details = 'VIP' AND c.state_county_province = 'SouthDakota';",
    "table_names": [
      "Customers",
      "Accounts"
    ]
  },
  {
    "id": 504,
    "db_id": "customers_card_transactions",
    "question": "Which customer has the highest number of VIP accounts, and how many VIP accounts does the customer have?",
    "sql": "SELECT c.customer_first_name, c.customer_last_name, COUNT(a.account_id) AS total_accounts FROM Customers c JOIN Accounts a ON c.customer_id = a.customer_id WHERE a.other_account_details = 'VIP' GROUP BY c.customer_id ORDER BY total_accounts DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Accounts"
    ]
  },
  {
    "id": 505,
    "db_id": "customers_card_transactions",
    "question": "Which customer has the highest number of VIP accounts and how many VIP accounts does that customer have?",
    "sql": "SELECT Customers.customer_first_name, Customers.customer_last_name, COUNT(Accounts.account_id) AS num_VIP_accounts FROM Customers LEFT JOIN Accounts ON Customers.customer_id = Accounts.customer_id WHERE Accounts.other_account_details = 'VIP' GROUP BY Customers.customer_id ORDER BY num_VIP_accounts DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Accounts"
    ]
  },
  {
    "id": 506,
    "db_id": "customers_card_transactions",
    "question": "Which customer holds the highest number of VIP accounts?",
    "sql": "SELECT Customers.customer_first_name, Customers.customer_last_name, COUNT(Accounts.account_id) AS num_accounts FROM Customers JOIN Accounts ON Customers.customer_id = Accounts.customer_id WHERE Accounts.other_account_details='VIP' GROUP BY Customers.customer_id ORDER BY num_accounts DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Accounts"
    ]
  },
  {
    "id": 507,
    "db_id": "customers_card_transactions",
    "question": "Which USA customer owns the highest number of VIP accounts?",
    "sql": "SELECT Customers.customer_first_name, Customers.customer_last_name, COUNT(Accounts.account_id) AS account_count FROM Customers INNER JOIN Accounts ON Customers.customer_id = Accounts.customer_id WHERE Customers.country = 'USA' AND Accounts.other_account_details = 'VIP' GROUP BY Customers.customer_id ORDER BY account_count DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Accounts"
    ]
  },
  {
    "id": 508,
    "db_id": "customers_card_transactions",
    "question": "Which customer has the highest number of accounts and how many accounts do they have?",
    "sql": "SELECT c.customer_first_name, c.customer_last_name, COUNT(a.account_id) as account_count FROM Customers c JOIN Accounts a ON c.customer_id = a.customer_id GROUP BY c.customer_id ORDER BY account_count DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Accounts"
    ]
  },
  {
    "id": 509,
    "db_id": "customers_card_transactions",
    "question": "Which customer has the highest number of accounts and what is their state of residence?",
    "sql": "SELECT c.customer_first_name, c.customer_last_name, c.state_county_province, COUNT(a.account_id) AS account_count FROM Customers c JOIN Accounts a ON c.customer_id = a.customer_id GROUP BY c.customer_id ORDER BY account_count DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Accounts"
    ]
  },
  {
    "id": 510,
    "db_id": "customers_card_transactions",
    "question": "How many unique regular accounts are there among customers from Mississippi?",
    "sql": "SELECT COUNT(DISTINCT a.account_id) FROM Accounts a JOIN Customers c ON a.customer_id = c.customer_id WHERE c.state_county_province = 'Mississippi' AND a.other_account_details = 'Regular';",
    "table_names": [
      "Customers",
      "Accounts"
    ]
  },
  {
    "id": 511,
    "db_id": "customers_card_transactions",
    "question": "How many VIP accounts are held by customers from Mississippi?",
    "sql": "SELECT COUNT(*) FROM Accounts a JOIN Customers c ON a.customer_id = c.customer_id WHERE c.state_county_province = 'Mississippi' AND a.other_account_details = 'VIP';",
    "table_names": [
      "Customers",
      "Accounts"
    ]
  },
  {
    "id": 512,
    "db_id": "customers_card_transactions",
    "question": "Which customer from Kentucky opened the earliest VIP account?",
    "sql": "SELECT c.customer_first_name, c.customer_last_name FROM Customers c JOIN Accounts a ON c.customer_id = a.customer_id WHERE c.state_county_province = 'Kentucky' AND a.other_account_details = 'VIP' ORDER BY a.date_account_opened ASC LIMIT 1;",
    "table_names": [
      "Customers",
      "Accounts"
    ]
  },
  {
    "id": 513,
    "db_id": "customers_card_transactions",
    "question": "Who is the customer from the USA that holds the largest number of VIP accounts and how many VIP accounts does this customer have?",
    "sql": "SELECT customer_first_name, customer_last_name, COUNT(account_id) FROM Customers INNER JOIN Accounts ON Customers.customer_id = Accounts.customer_id WHERE country = 'USA' AND other_account_details = 'VIP' GROUP BY Customers.customer_id ORDER BY COUNT(account_id) DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Accounts"
    ]
  },
  {
    "id": 514,
    "db_id": "customers_card_transactions",
    "question": "Which customer has the highest number of VIP accounts and how many VIP accounts does this customer have?",
    "sql": "SELECT c.customer_first_name, c.customer_last_name, COUNT(a.account_id) AS number_of_accounts FROM Customers c JOIN Accounts a ON c.customer_id = a.customer_id WHERE a.other_account_details = 'VIP' GROUP BY c.customer_id, c.customer_first_name, c.customer_last_name ORDER BY number_of_accounts DESC LIMIT 1",
    "table_names": [
      "Customers",
      "Accounts"
    ]
  },
  {
    "id": 515,
    "db_id": "customers_card_transactions",
    "question": "What is the latest opened regular account name of customers from Mississippi?",
    "sql": "SELECT Accounts.account_name FROM Accounts JOIN Customers ON Accounts.customer_id = Customers.customer_id WHERE Customers.state_county_province = 'Mississippi' AND Accounts.other_account_details = 'Regular' ORDER BY Accounts.date_account_opened DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Accounts"
    ]
  },
  {
    "id": 516,
    "db_id": "customers_card_transactions",
    "question": "Who is the earliest registered customer from Kentucky that holds a VIP account, and on what date was this account opened?",
    "sql": "SELECT c.customer_first_name, c.customer_last_name, a.account_name, a.date_account_opened FROM Customers c JOIN Accounts a ON c.customer_id = a.customer_id WHERE a.other_account_details = 'VIP' AND c.state_county_province = 'Kentucky' ORDER BY a.date_account_opened LIMIT 1;",
    "table_names": [
      "Customers",
      "Accounts"
    ]
  },
  {
    "id": 517,
    "db_id": "customers_card_transactions",
    "question": "Who is the customer with the highest number of VIP accounts and how many such accounts do they have?",
    "sql": "SELECT c.customer_first_name, c.customer_last_name, COUNT(a.account_id) AS account_count FROM Customers c JOIN Accounts a ON c.customer_id = a.customer_id WHERE a.other_account_details = 'VIP' GROUP BY c.customer_id ORDER BY account_count DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Accounts"
    ]
  },
  {
    "id": 518,
    "db_id": "customers_card_transactions",
    "question": "How many distinct Regular accounts are owned by customers residing in Mississippi?",
    "sql": "SELECT COUNT(DISTINCT a.account_id) FROM Accounts a JOIN Customers c ON a.customer_id = c.customer_id WHERE c.state_county_province = 'Mississippi' AND a.other_account_details = 'Regular';",
    "table_names": [
      "Customers",
      "Accounts"
    ]
  },
  {
    "id": 519,
    "db_id": "customers_card_transactions",
    "question": "What is the total amount refunded for all accounts belonging to customer with ID 8?",
    "sql": "SELECT SUM(ft.transaction_amount) FROM Accounts a JOIN Financial_Transactions ft ON a.account_id = ft.account_id WHERE a.customer_id = 8 AND ft.transaction_type = 'Refund';",
    "table_names": [
      "Accounts",
      "Financial_Transactions"
    ]
  },
  {
    "id": 520,
    "db_id": "customers_card_transactions",
    "question": "What is the total amount of payment transactions made by customer with customer_id 8?",
    "sql": "SELECT SUM(ft.transaction_amount) FROM Financial_Transactions ft JOIN Accounts a ON ft.account_id = a.account_id WHERE a.customer_id = 8 AND ft.transaction_type = 'Payment';",
    "table_names": [
      "Accounts",
      "Financial_Transactions"
    ]
  },
  {
    "id": 521,
    "db_id": "customers_card_transactions",
    "question": "What is the total amount refunded for the account with account_name '337'?",
    "sql": "SELECT SUM(ft.transaction_amount) as total_refunds FROM Financial_Transactions ft JOIN Accounts acc ON ft.account_id = acc.account_id WHERE acc.account_name = '337' AND ft.transaction_type = 'Refund';",
    "table_names": [
      "Accounts",
      "Financial_Transactions"
    ]
  },
  {
    "id": 522,
    "db_id": "customers_card_transactions",
    "question": "What is the total amount refunded to the customer with ID 8 across all their accounts?",
    "sql": "SELECT SUM(ft.transaction_amount) FROM Financial_Transactions ft JOIN Accounts a ON ft.account_id = a.account_id WHERE a.customer_id = 8 AND ft.transaction_type = 'Refund';",
    "table_names": [
      "Accounts",
      "Financial_Transactions"
    ]
  },
  {
    "id": 523,
    "db_id": "customers_card_transactions",
    "question": "What is the total amount refunded to customer id 8 from all associated accounts?",
    "sql": "SELECT SUM(ft.transaction_amount) FROM Financial_Transactions ft JOIN Accounts a ON ft.account_id = a.account_id WHERE a.customer_id = 8 AND ft.transaction_type = 'Refund';",
    "table_names": [
      "Accounts",
      "Financial_Transactions"
    ]
  },
  {
    "id": 524,
    "db_id": "customers_card_transactions",
    "question": "What is the total payment amount from all accounts belonging to customer ID 8?",
    "sql": "SELECT SUM(ft.transaction_amount) FROM Accounts a JOIN Financial_Transactions ft ON a.account_id = ft.account_id WHERE a.customer_id = 8 AND ft.transaction_type = 'Payment';",
    "table_names": [
      "Accounts",
      "Financial_Transactions"
    ]
  },
  {
    "id": 525,
    "db_id": "customers_and_invoices",
    "question": "What was the total payments received for invoices issued in March 2018?",
    "sql": "SELECT SUM(ft.transaction_amount) FROM Financial_Transactions ft JOIN Invoices i ON ft.invoice_number = i.invoice_number WHERE ft.transaction_type = 'Payment' AND i.invoice_date >= '2018-03-01' AND i.invoice_date < '2018-04-01';",
    "table_names": [
      "Invoices",
      "Financial_Transactions"
    ]
  },
  {
    "id": 526,
    "db_id": "customers_and_invoices",
    "question": "What is the total amount of refunds for all invoices generated between March 1, 2018, and March 15, 2018?",
    "sql": "SELECT SUM(transaction_amount) FROM Financial_Transactions WHERE transaction_type = 'Refund' AND invoice_number IN (SELECT invoice_number FROM Invoices WHERE invoice_date BETWEEN '2018-03-01' AND '2018-03-15');",
    "table_names": [
      "Invoices",
      "Financial_Transactions"
    ]
  },
  {
    "id": 527,
    "db_id": "tracking_orders",
    "question": "How many unique orders from customer with customer_id '10' have invoices issued in March 2018?",
    "sql": "SELECT COUNT(DISTINCT Orders.order_id) FROM Orders JOIN Invoices ON Orders.order_id = Invoices.order_id WHERE Orders.customer_id = 10 AND Invoices.invoice_date BETWEEN '2018-03-01' AND '2018-03-31';",
    "table_names": [
      "Orders",
      "Invoices"
    ]
  },
  {
    "id": 528,
    "db_id": "tracking_orders",
    "question": "How many distinct customers placed orders which have invoices dated between March 1, 2018 and March 20, 2018?",
    "sql": "SELECT COUNT(DISTINCT o.customer_id) FROM Orders o INNER JOIN Invoices i ON o.order_id = i.order_id WHERE i.invoice_date BETWEEN '2018-03-01' AND '2018-03-20';",
    "table_names": [
      "Orders",
      "Invoices"
    ]
  },
  {
    "id": 529,
    "db_id": "tracking_orders",
    "question": "How many orders had invoices issued between March 1, 2018, and March 15, 2018?",
    "sql": "SELECT COUNT(*) FROM Orders WHERE order_id IN (SELECT order_id FROM Invoices WHERE invoice_date BETWEEN '2018-03-01' AND '2018-03-15');",
    "table_names": [
      "Orders",
      "Invoices"
    ]
  },
  {
    "id": 530,
    "db_id": "tracking_orders",
    "question": "How many unique customers placed orders after January 1, 2017, that later had invoices issued?",
    "sql": "SELECT COUNT(DISTINCT o.customer_id) FROM Orders o JOIN Invoices i ON o.order_id = i.order_id WHERE o.date_order_placed >= '2017-01-01';",
    "table_names": [
      "Orders",
      "Invoices"
    ]
  },
  {
    "id": 531,
    "db_id": "tracking_orders",
    "question": "Which customers from Mississippi made orders, and how many orders has each placed?",
    "sql": "SELECT Customers.customer_first_name, Customers.customer_last_name, Customers.email_address, COUNT(Orders.order_id) AS total_orders FROM Customers JOIN Orders ON Customers.customer_id = Orders.customer_id WHERE Customers.state_county_province = 'Mississippi' GROUP BY Customers.customer_id, Customers.customer_first_name, Customers.customer_last_name, Customers.email_address;",
    "table_names": [
      "Customers",
      "Orders"
    ]
  },
  {
    "id": 532,
    "db_id": "tracking_orders",
    "question": "How many orders have been placed after the year 2015 by customers from Mississippi?",
    "sql": "SELECT COUNT(*) FROM Orders o JOIN Customers c ON o.customer_id = c.customer_id WHERE c.state_county_province = 'Mississippi' AND YEAR(o.date_order_placed) > 2015;",
    "table_names": [
      "Customers",
      "Orders"
    ]
  },
  {
    "id": 533,
    "db_id": "tracking_orders",
    "question": "What is the total sales revenue for all Electronics products with Red color?",
    "sql": "SELECT SUM(oi.product_quantity * p.unit_price) AS total_sales FROM Order_Items oi JOIN Products p ON oi.product_id = p.product_id WHERE p.production_type_code = 'Electronics' AND p.product_color = 'Red';",
    "table_names": [
      "Products",
      "Order_Items"
    ]
  },
  {
    "id": 534,
    "db_id": "tracking_orders",
    "question": "What's the total revenue generated from all ordered DVD products with the color 'Yellow'?",
    "sql": "SELECT SUM(oi.product_quantity * p.unit_price) AS total_revenue FROM Order_Items oi JOIN Products p ON oi.product_id = p.product_id WHERE p.production_type_code = 'DVDs' AND p.product_color = 'Yellow';",
    "table_names": [
      "Products",
      "Order_Items"
    ]
  },
  {
    "id": 535,
    "db_id": "tracking_orders",
    "question": "What is the total value of 'Food' products in order_id 13?",
    "sql": "SELECT SUM(oi.product_quantity * p.unit_price) AS total_order_value FROM Order_Items oi JOIN Products p ON oi.product_id = p.product_id WHERE oi.order_id = 13 AND p.production_type_code = 'Food';",
    "table_names": [
      "Products",
      "Order_Items"
    ]
  },
  {
    "id": 536,
    "db_id": "tracking_orders",
    "question": "Which order IDs contain products categorized as 'DVDs' with 'Yellow' color having a quantity of at least 5?",
    "sql": "SELECT oi.order_id FROM Order_Items oi JOIN Products p ON oi.product_id = p.product_id WHERE p.production_type_code = 'DVDs' AND p.product_color = 'Yellow' AND oi.product_quantity >= 5;",
    "table_names": [
      "Products",
      "Order_Items"
    ]
  },
  {
    "id": 537,
    "db_id": "tracking_orders",
    "question": "What is the total revenue generated by all DVD products with Yellow color?",
    "sql": "SELECT SUM(oi.product_quantity * p.unit_price) AS total_revenue FROM Order_Items oi JOIN Products p ON oi.product_id = p.product_id WHERE p.product_color = 'Yellow' AND p.production_type_code = 'DVDs';",
    "table_names": [
      "Products",
      "Order_Items"
    ]
  },
  {
    "id": 538,
    "db_id": "tracking_orders",
    "question": "What is the total sales amount generated from orders of products classified as 'DVDs'?",
    "sql": "SELECT SUM(oi.product_quantity * p.unit_price) AS total_sales FROM Order_Items oi JOIN Products p ON oi.product_id = p.product_id WHERE p.production_type_code = 'DVDs';",
    "table_names": [
      "Products",
      "Order_Items"
    ]
  },
  {
    "id": 539,
    "db_id": "wedding",
    "question": "What are the names of the male and female individuals who got married in the most recent wedding year?",
    "sql": "SELECT p1.Name, p2.Name, w.Year FROM wedding w JOIN people p1 ON w.Male_ID = p1.People_ID JOIN people p2 ON w.Female_ID = p2.People_ID WHERE w.Year = (SELECT MAX(Year) FROM wedding);",
    "table_names": [
      "people",
      "wedding"
    ]
  },
  {
    "id": 540,
    "db_id": "wedding",
    "question": "List the names of all males from United States who got married on or after 2015.",
    "sql": "SELECT Name FROM people WHERE People_ID IN (SELECT Male_ID FROM wedding WHERE Year >= 2015) AND Country = 'United States';",
    "table_names": [
      "people",
      "wedding"
    ]
  },
  {
    "id": 541,
    "db_id": "wedding",
    "question": "What is the name of the church that hosted the earliest recorded wedding?",
    "sql": "SELECT church.Name FROM church INNER JOIN wedding ON church.Church_ID = wedding.Church_ID WHERE wedding.Year = (SELECT MIN(Year) FROM wedding);",
    "table_names": [
      "church",
      "wedding"
    ]
  },
  {
    "id": 542,
    "db_id": "theme_gallery",
    "question": "What is the average ticket price of exhibitions created by artists from the United States who are older than 45?",
    "sql": "SELECT AVG(e.Ticket_Price) FROM exhibition e JOIN artist a ON e.Artist_ID = a.Artist_ID WHERE a.Country = 'United States' AND a.Age > 45;",
    "table_names": [
      "artist",
      "exhibition"
    ]
  },
  {
    "id": 543,
    "db_id": "theme_gallery",
    "question": "What is the average ticket price of exhibitions by artists from the United States who joined before 1995?",
    "sql": "SELECT AVG(e.Ticket_Price) FROM exhibition e JOIN artist a ON e.Artist_ID = a.Artist_ID WHERE a.Country = 'United States' AND a.Year_Join < 1995;",
    "table_names": [
      "artist",
      "exhibition"
    ]
  },
  {
    "id": 544,
    "db_id": "theme_gallery",
    "question": "What is the average ticket price of the exhibitions organized by artists from the United States who are older than 45?",
    "sql": "SELECT AVG(e.Ticket_Price) FROM exhibition e JOIN artist a ON e.Artist_ID = a.Artist_ID WHERE a.Country = 'United States' AND a.Age > 45;",
    "table_names": [
      "artist",
      "exhibition"
    ]
  },
  {
    "id": 545,
    "db_id": "theme_gallery",
    "question": "What are the themes of exhibitions held by artists from the United States who are older than 50 years and had ticket prices below 15?",
    "sql": "SELECT e.Theme FROM exhibition e JOIN artist a ON e.Artist_ID = a.Artist_ID WHERE a.Country = 'United States' AND a.Age > 50 AND e.Ticket_Price < 15;",
    "table_names": [
      "artist",
      "exhibition"
    ]
  },
  {
    "id": 546,
    "db_id": "theme_gallery",
    "question": "Who was the artist that participated in the earliest exhibition that had a ticket price greater than 15?",
    "sql": "SELECT a.Name FROM artist a JOIN exhibition e ON a.Artist_ID = e.Artist_ID WHERE e.Year IN (SELECT MIN(Year) FROM exhibition WHERE Ticket_Price > 15);",
    "table_names": [
      "artist",
      "exhibition"
    ]
  },
  {
    "id": 547,
    "db_id": "theme_gallery",
    "question": "What is the average ticket price of exhibitions hosted by artists from the United States who are older than 45?",
    "sql": "SELECT AVG(e.Ticket_Price) FROM exhibition e JOIN artist a ON e.Artist_ID = a.Artist_ID WHERE a.Country = 'United States' AND a.Age > 45;",
    "table_names": [
      "artist",
      "exhibition"
    ]
  },
  {
    "id": 548,
    "db_id": "theme_gallery",
    "question": "What are the themes of exhibitions hosted by artists from the United States with ticket prices under 15?",
    "sql": "SELECT e.Theme FROM exhibition e JOIN artist a ON e.Artist_ID = a.Artist_ID WHERE a.Country = 'United States' AND e.Ticket_Price < 15;",
    "table_names": [
      "artist",
      "exhibition"
    ]
  },
  {
    "id": 549,
    "db_id": "theme_gallery",
    "question": "What themes of exhibitions were created by United States artists with a ticket price below $15?",
    "sql": "SELECT e.Theme FROM exhibition e INNER JOIN artist a ON e.Artist_ID = a.Artist_ID WHERE a.Country = 'United States' AND e.Ticket_Price < 15;",
    "table_names": [
      "artist",
      "exhibition"
    ]
  },
  {
    "id": 550,
    "db_id": "theme_gallery",
    "question": "What is the theme of the exhibition that had the highest total attendance?",
    "sql": "SELECT e.Theme FROM exhibition e JOIN exhibition_record er ON e.Exhibition_ID = er.Exhibition_ID GROUP BY e.Exhibition_ID ORDER BY SUM(er.Attendance) DESC LIMIT 1;",
    "table_names": [
      "exhibition",
      "exhibition_record"
    ]
  },
  {
    "id": 551,
    "db_id": "theme_gallery",
    "question": "What was the theme and year of the exhibition that recorded the highest attendance on a single day?",
    "sql": "SELECT e.Theme, e.Year FROM exhibition e JOIN exhibition_record er ON e.Exhibition_ID = er.Exhibition_ID WHERE er.Attendance = (SELECT MAX(Attendance) FROM exhibition_record);",
    "table_names": [
      "exhibition",
      "exhibition_record"
    ]
  },
  {
    "id": 552,
    "db_id": "theme_gallery",
    "question": "Who was the artist involved in the exhibition with the highest ticket price?",
    "sql": "SELECT artist.Name FROM artist INNER JOIN exhibition ON artist.Artist_ID = exhibition.Artist_ID WHERE exhibition.Ticket_Price = (SELECT MAX(Ticket_Price) FROM exhibition);",
    "table_names": [
      "artist",
      "exhibition"
    ]
  },
  {
    "id": 553,
    "db_id": "theme_gallery",
    "question": "What is the average ticket price for exhibitions by artists from the United States who joined before 1995?",
    "sql": "SELECT AVG(e.Ticket_Price) FROM exhibition e JOIN artist a ON e.Artist_ID = a.Artist_ID WHERE a.Country = 'United States' AND a.Year_Join < 1995;",
    "table_names": [
      "artist",
      "exhibition"
    ]
  },
  {
    "id": 554,
    "db_id": "theme_gallery",
    "question": "What is the theme of the exhibition with the highest total attendance among those for which the ticket price is greater than 15?",
    "sql": "SELECT e.Theme, SUM(er.Attendance) as Total_Attendance FROM exhibition e INNER JOIN exhibition_record er ON e.Exhibition_ID = er.Exhibition_ID WHERE e.Ticket_Price > 15 GROUP BY e.Theme ORDER BY Total_Attendance DESC LIMIT 1;",
    "table_names": [
      "exhibition",
      "exhibition_record"
    ]
  },
  {
    "id": 555,
    "db_id": "theme_gallery",
    "question": "Which exhibition theme had the highest total attendance, and in which year did this exhibition take place?",
    "sql": "SELECT exhibition.Theme, exhibition.Year, SUM(exhibition_record.Attendance) AS Total_Attendance FROM exhibition INNER JOIN exhibition_record ON exhibition.Exhibition_ID = exhibition_record.Exhibition_ID GROUP BY exhibition.Exhibition_ID ORDER BY Total_Attendance DESC LIMIT 1;",
    "table_names": [
      "exhibition",
      "exhibition_record"
    ]
  },
  {
    "id": 556,
    "db_id": "epinions_1",
    "question": "What is the title of the item that has the highest-ranked review?",
    "sql": "SELECT title FROM item WHERE i_id = (SELECT i_id FROM review WHERE rank = (SELECT MIN(rank) FROM review));",
    "table_names": [
      "item",
      "review"
    ]
  },
  {
    "id": 557,
    "db_id": "epinions_1",
    "question": "What is the average rating given by the user named Mark?",
    "sql": "SELECT AVG(r.rating) FROM review r INNER JOIN useracct u ON r.u_id = u.u_id WHERE u.name = 'Mark';",
    "table_names": [
      "review",
      "useracct"
    ]
  },
  {
    "id": 558,
    "db_id": "epinions_1",
    "question": "What item received the highest rating from user with id 2?",
    "sql": "SELECT item.title FROM item JOIN review ON item.i_id = review.i_id WHERE review.rating = (SELECT MAX(rating) FROM review WHERE u_id = 2);",
    "table_names": [
      "item",
      "review"
    ]
  },
  {
    "id": 559,
    "db_id": "epinions_1",
    "question": "What item received the highest rating by user with ID 2?",
    "sql": "SELECT title FROM item WHERE i_id IN (SELECT i_id FROM review WHERE rating = (SELECT MAX(rating) FROM review WHERE u_id = 2));",
    "table_names": [
      "item",
      "review"
    ]
  },
  {
    "id": 560,
    "db_id": "epinions_1",
    "question": "What is the average rating given to the items named 'orange' and 'apple'?",
    "sql": "SELECT AVG(r.rating) FROM review r JOIN item i ON r.i_id = i.i_id WHERE i.title IN ('orange', 'apple');",
    "table_names": [
      "item",
      "review"
    ]
  },
  {
    "id": 561,
    "db_id": "epinions_1",
    "question": "Which item received the highest number of reviews?",
    "sql": "SELECT item.title FROM item JOIN review ON item.i_id = review.i_id GROUP BY item.i_id ORDER BY COUNT(review.a_id) DESC LIMIT 1;",
    "table_names": [
      "item",
      "review"
    ]
  },
  {
    "id": 562,
    "db_id": "epinions_1",
    "question": "Who left the highest-ranked review among those who gave a rating higher than 6?",
    "sql": "SELECT useracct.name FROM useracct INNER JOIN review ON useracct.u_id = review.u_id WHERE review.rank = (SELECT MIN(rank) FROM review WHERE rating > 6);",
    "table_names": [
      "review",
      "useracct"
    ]
  },
  {
    "id": 563,
    "db_id": "epinions_1",
    "question": "What is the average rating of items titled 'orange' and 'apple'?",
    "sql": "SELECT AVG(r.rating) FROM review r JOIN item i ON r.i_id = i.i_id WHERE i.title IN ('orange', 'apple');",
    "table_names": [
      "item",
      "review"
    ]
  },
  {
    "id": 564,
    "db_id": "epinions_1",
    "question": "What is the name of the item which received the highest rating among items with ranks from 3 to 7?",
    "sql": "SELECT title FROM item WHERE i_id = (SELECT i_id FROM review WHERE rating = (SELECT MAX(rating) FROM review WHERE rank BETWEEN 3 AND 7) AND rank BETWEEN 3 AND 7 LIMIT 1);",
    "table_names": [
      "item",
      "review"
    ]
  },
  {
    "id": 565,
    "db_id": "epinions_1",
    "question": "What is the average rating score assigned by Mark?",
    "sql": "SELECT AVG(rating) FROM review WHERE u_id = (SELECT u_id FROM useracct WHERE name = 'Mark');",
    "table_names": [
      "review",
      "useracct"
    ]
  },
  {
    "id": 566,
    "db_id": "epinions_1",
    "question": "What is the average rating given by Mark for reviews ranked 5 or better?",
    "sql": "SELECT AVG(rating) FROM review WHERE u_id = (SELECT u_id FROM useracct WHERE name = 'Mark') AND rank <= 5;",
    "table_names": [
      "review",
      "useracct"
    ]
  },
  {
    "id": 567,
    "db_id": "epinions_1",
    "question": "What is the average rating given by user named Mark?",
    "sql": "SELECT AVG(rating) FROM review WHERE u_id = (SELECT u_id FROM useracct WHERE name = 'Mark');",
    "table_names": [
      "review",
      "useracct"
    ]
  },
  {
    "id": 568,
    "db_id": "epinions_1",
    "question": "Who is trusted by a user who is strongly trusted (trust>=8) by a user that Helen trusts highly (trust>=7)?",
    "sql": "SELECT ua2.name FROM useracct ua1 JOIN trust t1 ON ua1.u_id = t1.source_u_id JOIN trust t2 ON t1.target_u_id = t2.source_u_id JOIN useracct ua2 ON t2.target_u_id = ua2.u_id WHERE ua1.name = 'Helen' AND t1.trust >= 7 AND t2.trust >= 8",
    "table_names": [
      "useracct",
      "trust"
    ]
  },
  {
    "id": 569,
    "db_id": "epinions_1",
    "question": "What is the average trust score given by the user named Helen?",
    "sql": "SELECT AVG(tr.trust) FROM trust tr JOIN useracct ua ON tr.source_u_id = ua.u_id WHERE ua.name = 'Helen';",
    "table_names": [
      "useracct",
      "trust"
    ]
  },
  {
    "id": 570,
    "db_id": "epinions_1",
    "question": "Which users does Helen trust with a trust score greater than 6?",
    "sql": "SELECT name FROM useracct WHERE u_id IN (SELECT target_u_id FROM trust WHERE source_u_id = (SELECT u_id FROM useracct WHERE name = 'Helen') AND trust > 6);",
    "table_names": [
      "useracct",
      "trust"
    ]
  },
  {
    "id": 571,
    "db_id": "epinions_1",
    "question": "What are the names of items that have an average rating of at least 7?",
    "sql": "SELECT title FROM item WHERE i_id IN (SELECT i_id FROM review GROUP BY i_id HAVING AVG(rating) >= 7);",
    "table_names": [
      "item",
      "review"
    ]
  },
  {
    "id": 572,
    "db_id": "epinions_1",
    "question": "What is the average rating given by the user named Mark?",
    "sql": "SELECT AVG(r.rating) FROM review r JOIN useracct u ON r.u_id = u.u_id WHERE u.name = 'Mark';",
    "table_names": [
      "review",
      "useracct"
    ]
  },
  {
    "id": 573,
    "db_id": "epinions_1",
    "question": "Which user has given the highest average rating across all their reviews?",
    "sql": "SELECT u.name FROM useracct u JOIN review r ON u.u_id = r.u_id GROUP BY u.name ORDER BY AVG(r.rating) DESC LIMIT 1;",
    "table_names": [
      "review",
      "useracct"
    ]
  },
  {
    "id": 574,
    "db_id": "epinions_1",
    "question": "What is the average rating of items that are fruits?",
    "sql": "SELECT AVG(rating) FROM review WHERE i_id IN (SELECT i_id FROM item WHERE title IN ('pear', 'orange', 'apple', 'avocado'));",
    "table_names": [
      "item",
      "review"
    ]
  },
  {
    "id": 575,
    "db_id": "riding_club",
    "question": "What are the names of players coached by Jean Luc BouchÃ© starting after the year 2010?",
    "sql": "SELECT p.Player_name FROM player p JOIN player_coach pc ON p.Player_ID = pc.Player_ID WHERE pc.Coach_ID = (SELECT Player_ID FROM player WHERE Player_name = 'Jean Luc BouchÃ©') AND pc.Starting_year > 2010;",
    "table_names": [
      "player",
      "player_coach"
    ]
  },
  {
    "id": 576,
    "db_id": "riding_club",
    "question": "Who is the highest ranked coach coaching at a club from the USA which started before the year 2008?",
    "sql": "SELECT c.Coach_name FROM coach c JOIN club cl ON c.Club_ID = cl.Club_ID WHERE cl.Region = 'USA' AND cl.Start_year < 2008 ORDER BY c.Rank LIMIT 1;",
    "table_names": [
      "club",
      "coach"
    ]
  },
  {
    "id": 577,
    "db_id": "riding_club",
    "question": "Who is the coach whose rank matches the club that won the most gold medals?",
    "sql": "SELECT c.Coach_name FROM coach c JOIN match_result m ON c.Rank = m.Rank WHERE m.Gold = (SELECT MAX(Gold) FROM match_result);",
    "table_names": [
      "coach",
      "match_result"
    ]
  },
  {
    "id": 578,
    "db_id": "gymnast",
    "question": "Who is the gymnast with the highest total points?",
    "sql": "SELECT people.Name FROM gymnast JOIN people ON gymnast.Gymnast_ID = people.People_ID WHERE gymnast.Total_Points = (SELECT MAX(Total_Points) FROM gymnast);",
    "table_names": [
      "gymnast",
      "people"
    ]
  },
  {
    "id": 579,
    "db_id": "gymnast",
    "question": "What is the name of the gymnast from Bonao who scored higher than 9.6 on Rings?",
    "sql": "SELECT p.Name FROM gymnast g JOIN people p ON g.Gymnast_ID = p.People_ID WHERE g.Rings_Points > 9.6 AND p.Hometown = 'Bonao';",
    "table_names": [
      "gymnast",
      "people"
    ]
  },
  {
    "id": 580,
    "db_id": "gymnast",
    "question": "Among gymnasts from Santo Domingo, who achieved the highest score in the Vault event?",
    "sql": "SELECT p.Name FROM gymnast g JOIN people p ON g.Gymnast_ID = p.People_ID WHERE p.Hometown = 'Santo Domingo' ORDER BY g.Vault_Points DESC LIMIT 1",
    "table_names": [
      "gymnast",
      "people"
    ]
  },
  {
    "id": 581,
    "db_id": "gymnast",
    "question": "Which gymnast from Santo Domingo achieved the highest score in the Horizontal Bar event?",
    "sql": "SELECT p.Name FROM gymnast g JOIN people p ON g.Gymnast_ID = p.People_ID WHERE g.Horizontal_Bar_Points = (SELECT MAX(Horizontal_Bar_Points) FROM gymnast) AND p.Hometown = 'Santo Domingo';",
    "table_names": [
      "gymnast",
      "people"
    ]
  },
  {
    "id": 582,
    "db_id": "gymnast",
    "question": "Which gymnast from Santo Domingo achieved the highest total points?",
    "sql": "SELECT p.Name, g.Total_Points FROM gymnast g JOIN people p ON g.Gymnast_ID = p.People_ID WHERE p.Hometown = 'Santo Domingo' ORDER BY g.Total_Points DESC LIMIT 1;",
    "table_names": [
      "gymnast",
      "people"
    ]
  },
  {
    "id": 583,
    "db_id": "gymnast",
    "question": "What is the name of the gymnast who scored the highest points on the Vault?",
    "sql": "SELECT p.Name FROM gymnast g JOIN people p ON g.Gymnast_ID = p.People_ID WHERE g.Vault_Points = (SELECT MAX(Vault_Points) FROM gymnast)",
    "table_names": [
      "gymnast",
      "people"
    ]
  },
  {
    "id": 584,
    "db_id": "gymnast",
    "question": "Who is the gymnast from Santo Domingo who obtained the highest points in Horizontal Bar event and what was the score?",
    "sql": "SELECT p.Name, g.Horizontal_Bar_Points FROM gymnast g JOIN people p ON g.Gymnast_ID = p.People_ID WHERE p.Hometown = 'Santo Domingo' ORDER BY g.Horizontal_Bar_Points DESC LIMIT 1;",
    "table_names": [
      "gymnast",
      "people"
    ]
  },
  {
    "id": 585,
    "db_id": "gymnast",
    "question": "What is the name and Horizontal Bar Points of the youngest gymnast?",
    "sql": "SELECT p.Name, g.Horizontal_Bar_Points FROM gymnast g JOIN people p ON g.Gymnast_ID = p.People_ID WHERE p.Age = (SELECT MIN(Age) FROM people WHERE People_ID IN (SELECT Gymnast_ID FROM gymnast));",
    "table_names": [
      "gymnast",
      "people"
    ]
  },
  {
    "id": 586,
    "db_id": "gymnast",
    "question": "Which gymnasts from Santo Domingo scored higher than 9.6 in the vault event?",
    "sql": "SELECT p.Name FROM gymnast g JOIN people p ON g.Gymnast_ID = p.People_ID WHERE g.Vault_Points > 9.6 AND p.Hometown = 'Santo Domingo';",
    "table_names": [
      "gymnast",
      "people"
    ]
  },
  {
    "id": 587,
    "db_id": "gymnast",
    "question": "Who is the tallest gymnast with the highest total gymnastics points, and what is their total points score?",
    "sql": "SELECT p.Name, g.Total_Points FROM gymnast g INNER JOIN people p ON g.Gymnast_ID = p.People_ID WHERE p.Height > 1.75 ORDER BY g.Total_Points DESC LIMIT 1;",
    "table_names": [
      "gymnast",
      "people"
    ]
  },
  {
    "id": 588,
    "db_id": "gymnast",
    "question": "Who is the gymnast with the highest total points from Santo Domingo?",
    "sql": "SELECT people.Name FROM gymnast JOIN people ON gymnast.Gymnast_ID = people.People_ID WHERE gymnast.Total_Points = (SELECT MAX(Total_Points) FROM gymnast) AND people.Hometown = 'Santo Domingo';",
    "table_names": [
      "gymnast",
      "people"
    ]
  },
  {
    "id": 589,
    "db_id": "gymnast",
    "question": "Which hometown has the highest average total points among gymnasts, and what is the average?",
    "sql": "SELECT p.Hometown, AVG(g.Total_Points) AS Average_Total FROM gymnast g JOIN people p ON g.Gymnast_ID = p.People_ID GROUP BY p.Hometown ORDER BY Average_Total DESC LIMIT 1;",
    "table_names": [
      "gymnast",
      "people"
    ]
  },
  {
    "id": 590,
    "db_id": "gymnast",
    "question": "Who is the highest scoring gymnast originally from Santo Domingo and what is their total points?",
    "sql": "SELECT p.Name, g.Total_Points FROM gymnast g JOIN people p ON g.Gymnast_ID = p.People_ID WHERE p.Hometown = 'Santo Domingo' ORDER BY g.Total_Points DESC LIMIT 1;",
    "table_names": [
      "gymnast",
      "people"
    ]
  },
  {
    "id": 591,
    "db_id": "gymnast",
    "question": "Who is the youngest gymnast from Santo Domingo and what was their score on the Horizontal Bar?",
    "sql": "SELECT people.Name, gymnast.Horizontal_Bar_Points FROM people JOIN gymnast ON people.People_ID = gymnast.Gymnast_ID WHERE people.Hometown = 'Santo Domingo' ORDER BY people.Age ASC LIMIT 1;",
    "table_names": [
      "gymnast",
      "people"
    ]
  },
  {
    "id": 592,
    "db_id": "gymnast",
    "question": "Who achieved the highest score on the Horizontal Bar exercise and which hometown do they come from?",
    "sql": "SELECT p.Name, p.Hometown FROM gymnast g JOIN people p ON g.Gymnast_ID = p.People_ID WHERE g.Horizontal_Bar_Points = (SELECT MAX(Horizontal_Bar_Points) FROM gymnast);",
    "table_names": [
      "gymnast",
      "people"
    ]
  },
  {
    "id": 593,
    "db_id": "gymnast",
    "question": "Which gymnast from Santo Domingo achieved the highest points in the Horizontal Bar event?",
    "sql": "SELECT people.Name FROM gymnast INNER JOIN people ON gymnast.Gymnast_ID = people.People_ID WHERE gymnast.Horizontal_Bar_Points = (SELECT MAX(Horizontal_Bar_Points) FROM gymnast) AND people.Hometown = 'Santo Domingo';",
    "table_names": [
      "gymnast",
      "people"
    ]
  },
  {
    "id": 594,
    "db_id": "gymnast",
    "question": "Who is the gymnast with the highest total points from Santo Domingo, and what is their total score?",
    "sql": "SELECT p.Name, g.Total_Points FROM gymnast g INNER JOIN people p ON g.Gymnast_ID = p.People_ID WHERE p.Hometown = 'Santo Domingo' ORDER BY g.Total_Points DESC LIMIT 1;",
    "table_names": [
      "gymnast",
      "people"
    ]
  },
  {
    "id": 595,
    "db_id": "gymnast",
    "question": "What is the hometown of the gymnast who scored highest in Rings Points?",
    "sql": "SELECT p.Hometown FROM people p JOIN gymnast g ON p.People_ID = g.Gymnast_ID ORDER BY g.Rings_Points DESC LIMIT 1;",
    "table_names": [
      "gymnast",
      "people"
    ]
  },
  {
    "id": 596,
    "db_id": "gymnast",
    "question": "Who is the highest scoring gymnast from Santo Domingo and what was their total score?",
    "sql": "SELECT p.Name, g.Total_Points FROM gymnast g JOIN people p ON g.Gymnast_ID = p.People_ID WHERE p.Hometown = 'Santo Domingo' ORDER BY g.Total_Points DESC LIMIT 1;",
    "table_names": [
      "gymnast",
      "people"
    ]
  },
  {
    "id": 597,
    "db_id": "gymnast",
    "question": "Who scored the highest points in the vault exercise and what is their hometown?",
    "sql": "SELECT p.Name, p.Hometown FROM gymnast g JOIN people p ON g.Gymnast_ID = p.People_ID WHERE g.Vault_Points = (SELECT MAX(Vault_Points) FROM gymnast);",
    "table_names": [
      "gymnast",
      "people"
    ]
  },
  {
    "id": 598,
    "db_id": "gymnast",
    "question": "Who is the gymnast that scored the highest in the Vault event and what is their name?",
    "sql": "SELECT people.Name FROM gymnast JOIN people ON gymnast.Gymnast_ID = people.People_ID WHERE gymnast.Vault_Points = (SELECT MAX(Vault_Points) FROM gymnast)",
    "table_names": [
      "gymnast",
      "people"
    ]
  },
  {
    "id": 599,
    "db_id": "gymnast",
    "question": "Who is the gymnast from Santo Domingo with the highest total points, and what is their total score?",
    "sql": "SELECT p.Name, g.Total_Points FROM gymnast g JOIN people p ON g.Gymnast_ID = p.People_ID WHERE p.Hometown = 'Santo Domingo' ORDER BY g.Total_Points DESC LIMIT 1;",
    "table_names": [
      "gymnast",
      "people"
    ]
  },
  {
    "id": 600,
    "db_id": "small_bank_1",
    "question": "What is the average savings balance of customers whose names start with the letter 'W'?",
    "sql": "SELECT AVG(balance) FROM SAVINGS WHERE custid IN (SELECT custid FROM ACCOUNTS WHERE name LIKE 'W%');",
    "table_names": [
      "ACCOUNTS",
      "SAVINGS"
    ]
  },
  {
    "id": 601,
    "db_id": "small_bank_1",
    "question": "Which account holders have savings balances below the average savings balance?",
    "sql": "SELECT A.name FROM ACCOUNTS A JOIN SAVINGS S ON A.custid = S.custid WHERE S.balance < (SELECT AVG(balance) FROM SAVINGS);",
    "table_names": [
      "ACCOUNTS",
      "SAVINGS"
    ]
  },
  {
    "id": 602,
    "db_id": "small_bank_1",
    "question": "What is the average balance of customers whose names start with the letter 'W'?",
    "sql": "SELECT AVG(balance) FROM CHECKING WHERE custid IN (SELECT custid FROM ACCOUNTS WHERE name LIKE 'W%');",
    "table_names": [
      "ACCOUNTS",
      "CHECKING"
    ]
  },
  {
    "id": 603,
    "db_id": "small_bank_1",
    "question": "What is the average balance of customers whose names start with the letter 'W'?",
    "sql": "SELECT AVG(c.balance) FROM CHECKING c JOIN ACCOUNTS a ON c.custid = a.custid WHERE a.name LIKE 'W%';",
    "table_names": [
      "ACCOUNTS",
      "CHECKING"
    ]
  },
  {
    "id": 604,
    "db_id": "small_bank_1",
    "question": "What is the average checking balance of customers whose names start with 'W'?",
    "sql": "SELECT AVG(balance) FROM CHECKING WHERE custid IN (SELECT custid FROM ACCOUNTS WHERE name LIKE 'W%');",
    "table_names": [
      "ACCOUNTS",
      "CHECKING"
    ]
  },
  {
    "id": 605,
    "db_id": "small_bank_1",
    "question": "What is the average checking account balance for customers whose names start with the letter 'W'?",
    "sql": "SELECT AVG(balance) FROM CHECKING WHERE custid IN (SELECT custid FROM ACCOUNTS WHERE name LIKE 'W%');",
    "table_names": [
      "ACCOUNTS",
      "CHECKING"
    ]
  },
  {
    "id": 606,
    "db_id": "small_bank_1",
    "question": "What is the average balance of accounts held by customers whose names start with the letter 'W'?",
    "sql": "SELECT AVG(balance) FROM CHECKING WHERE custid IN (SELECT custid FROM ACCOUNTS WHERE name LIKE 'W%');",
    "table_names": [
      "ACCOUNTS",
      "CHECKING"
    ]
  },
  {
    "id": 607,
    "db_id": "small_bank_1",
    "question": "What is the average checking account balance for customers named Brown, Wang, and Weeks?",
    "sql": "SELECT AVG(C.balance) FROM CHECKING C JOIN ACCOUNTS A ON C.custid = A.custid WHERE A.name IN ('Brown', 'Wang', 'Weeks');",
    "table_names": [
      "ACCOUNTS",
      "CHECKING"
    ]
  },
  {
    "id": 608,
    "db_id": "small_bank_1",
    "question": "Which customers have savings account balances lower than the average balance in all saving accounts?",
    "sql": "SELECT a.name FROM ACCOUNTS a INNER JOIN SAVINGS s ON a.custid = s.custid WHERE s.balance < (SELECT AVG(balance) FROM SAVINGS);",
    "table_names": [
      "ACCOUNTS",
      "SAVINGS"
    ]
  },
  {
    "id": 609,
    "db_id": "small_bank_1",
    "question": "Which customers have savings balances greater than the average balance?",
    "sql": "SELECT A.name FROM ACCOUNTS A JOIN SAVINGS S ON A.custid = S.custid WHERE S.balance > (SELECT AVG(balance) FROM SAVINGS)",
    "table_names": [
      "ACCOUNTS",
      "SAVINGS"
    ]
  },
  {
    "id": 610,
    "db_id": "small_bank_1",
    "question": "What is the total balance of customers in the checking account who have a name beginning with 'W'?",
    "sql": "SELECT SUM(CHECKING.balance) FROM CHECKING INNER JOIN ACCOUNTS ON CHECKING.custid = ACCOUNTS.custid WHERE ACCOUNTS.name LIKE 'W%';",
    "table_names": [
      "ACCOUNTS",
      "CHECKING"
    ]
  },
  {
    "id": 611,
    "db_id": "small_bank_1",
    "question": "What is the average checking balance of the customers whose names start with the letter 'W'?",
    "sql": "SELECT AVG(balance) FROM CHECKING WHERE custid IN (SELECT custid FROM ACCOUNTS WHERE name LIKE 'W%');",
    "table_names": [
      "ACCOUNTS",
      "CHECKING"
    ]
  },
  {
    "id": 612,
    "db_id": "small_bank_1",
    "question": "How many customers have more than 50,000 in their savings account and more than 5,000 in their checking account?",
    "sql": "SELECT COUNT(*) FROM SAVINGS S INNER JOIN CHECKING C ON S.custid = C.custid WHERE S.balance > 50000 AND C.balance > 5000;",
    "table_names": [
      "SAVINGS",
      "CHECKING"
    ]
  },
  {
    "id": 613,
    "db_id": "small_bank_1",
    "question": "How many customers have more than 50,000 in savings and at least 5,000 in their checking accounts?",
    "sql": "SELECT COUNT(*) FROM SAVINGS S INNER JOIN CHECKING C ON S.custid = C.custid WHERE S.balance > 50000 AND C.balance >= 5000;",
    "table_names": [
      "SAVINGS",
      "CHECKING"
    ]
  },
  {
    "id": 614,
    "db_id": "small_bank_1",
    "question": "Which customer has the highest savings balance?",
    "sql": "SELECT name FROM ACCOUNTS WHERE custid = (SELECT custid FROM SAVINGS ORDER BY balance DESC LIMIT 1);",
    "table_names": [
      "ACCOUNTS",
      "SAVINGS"
    ]
  },
  {
    "id": 615,
    "db_id": "small_bank_1",
    "question": "What is the average balance of accounts owned by Brown, Wang, and Granger?",
    "sql": "SELECT AVG(S.balance) FROM SAVINGS S JOIN ACCOUNTS A ON S.custid = A.custid WHERE A.name IN ('Brown', 'Wang', 'Granger');",
    "table_names": [
      "ACCOUNTS",
      "SAVINGS"
    ]
  },
  {
    "id": 616,
    "db_id": "browser_web",
    "question": "Which web client accelerators are compatible with browser ID 1 since the year 2000 and provide satellite connections?",
    "sql": "SELECT W.name FROM Web_client_accelerator W INNER JOIN accelerator_compatible_browser A ON W.id = A.accelerator_id WHERE A.browser_id = 1 AND A.compatible_since_year >= 2000 AND W.Connection LIKE '%Satellite%';",
    "table_names": [
      "Web_client_accelerator",
      "accelerator_compatible_browser"
    ]
  },
  {
    "id": 617,
    "db_id": "browser_web",
    "question": "Which browsers have accelerator compatibility since before the year 2000 and currently hold a market share greater than 10%?",
    "sql": "SELECT b.name FROM browser AS b JOIN accelerator_compatible_browser AS acb ON b.id = acb.browser_id WHERE acb.compatible_since_year < 2000 AND b.market_share > 10.00;",
    "table_names": [
      "browser",
      "accelerator_compatible_browser"
    ]
  },
  {
    "id": 618,
    "db_id": "browser_web",
    "question": "What are the names of web client accelerators that support Mac operating systems and have compatibility with the browser having browser_id 1?",
    "sql": "SELECT wca.name FROM Web_client_accelerator AS wca INNER JOIN accelerator_compatible_browser AS acb ON wca.id = acb.accelerator_id WHERE acb.browser_id = 1 AND wca.Operating_system LIKE '%Mac%';",
    "table_names": [
      "Web_client_accelerator",
      "accelerator_compatible_browser"
    ]
  },
  {
    "id": 619,
    "db_id": "wrestler",
    "question": "Can you identify the wrestler who had a reign shorter than 50 days and was eliminated by Batista?",
    "sql": "SELECT w.Name FROM wrestler w JOIN Elimination e ON w.Wrestler_ID = e.Wrestler_ID WHERE e.Eliminated_By = 'Batista' AND w.Days_held < 50;",
    "table_names": [
      "wrestler",
      "Elimination"
    ]
  },
  {
    "id": 620,
    "db_id": "wrestler",
    "question": "Which wrestler from Tokyo, Japan was eliminated using the Silver Spoon DDT?",
    "sql": "SELECT wrestler.Name FROM wrestler JOIN Elimination ON wrestler.Wrestler_ID = Elimination.Wrestler_ID WHERE wrestler.Location = 'Tokyo , Japan' AND Elimination.Elimination_Move = 'Silver Spoon DDT';",
    "table_names": [
      "wrestler",
      "Elimination"
    ]
  },
  {
    "id": 621,
    "db_id": "wrestler",
    "question": "Among wrestlers from Team Batista who held the title for more than 100 days, who was eliminated earliest?",
    "sql": "SELECT w.Name FROM wrestler w INNER JOIN Elimination e ON w.Wrestler_ID = e.Wrestler_ID WHERE e.Team = 'Team Batista' AND w.Days_held > 100 ORDER BY e.Time ASC LIMIT 1;",
    "table_names": [
      "wrestler",
      "Elimination"
    ]
  },
  {
    "id": 622,
    "db_id": "wrestler",
    "question": "Which wrestler from Team Batista was eliminated by a Spear move?",
    "sql": "SELECT w.Name FROM wrestler w JOIN Elimination e ON w.Wrestler_ID = e.Wrestler_ID WHERE e.Team = 'Team Batista' AND e.Elimination_Move = 'Spear';",
    "table_names": [
      "wrestler",
      "Elimination"
    ]
  },
  {
    "id": 623,
    "db_id": "wrestler",
    "question": "Name the wrestler who was eliminated by Batista and has held the wrestling title more than once.",
    "sql": "SELECT wrestler.Name FROM wrestler INNER JOIN Elimination ON wrestler.Wrestler_ID = Elimination.Wrestler_ID WHERE Elimination.Eliminated_By = 'Batista' AND wrestler.Reign > 1;",
    "table_names": [
      "wrestler",
      "Elimination"
    ]
  },
  {
    "id": 624,
    "db_id": "wrestler",
    "question": "Which wrestler from Team Batista held their title for more than 100 days and was eliminated by a 'Rope hung DDT'?",
    "sql": "SELECT wrestler.Name FROM wrestler JOIN Elimination ON wrestler.Wrestler_ID = Elimination.Wrestler_ID WHERE Elimination.Team = 'Team Batista' AND wrestler.Days_held > 100 AND Elimination.Elimination_Move = 'Rope hung DDT';",
    "table_names": [
      "wrestler",
      "Elimination"
    ]
  },
  {
    "id": 625,
    "db_id": "wrestler",
    "question": "Which wrestler was eliminated by the 'Spear' move, and how many days had they held their reign?",
    "sql": "SELECT wrestler.Name, wrestler.Days_held FROM wrestler JOIN Elimination ON wrestler.Wrestler_ID = Elimination.Wrestler_ID WHERE Elimination.Elimination_Move = 'Spear';",
    "table_names": [
      "wrestler",
      "Elimination"
    ]
  },
  {
    "id": 626,
    "db_id": "wrestler",
    "question": "Which wrestlers on Team Batista had title reigns longer than 500 days?",
    "sql": "SELECT w.Name FROM wrestler w JOIN Elimination e ON w.Wrestler_ID = e.Wrestler_ID WHERE e.Team = 'Team Batista' AND w.Days_held > 500;",
    "table_names": [
      "wrestler",
      "Elimination"
    ]
  },
  {
    "id": 627,
    "db_id": "wrestler",
    "question": "Which wrestler eliminated by Batista had the longest championship reign, and how many days did this wrestler hold the title?",
    "sql": "SELECT w.Name, w.Days_held FROM wrestler w INNER JOIN Elimination e ON w.Wrestler_ID = e.Wrestler_ID WHERE e.Eliminated_By='Batista' ORDER BY w.Days_held DESC LIMIT 1;",
    "table_names": [
      "wrestler",
      "Elimination"
    ]
  },
  {
    "id": 628,
    "db_id": "wrestler",
    "question": "Which wrestlers having more than one reign were eliminated by Batista?",
    "sql": "SELECT w.Name FROM wrestler w JOIN Elimination e ON w.Wrestler_ID = e.Wrestler_ID WHERE e.Eliminated_By = 'Batista' AND w.Reign > 1;",
    "table_names": [
      "wrestler",
      "Elimination"
    ]
  },
  {
    "id": 629,
    "db_id": "school_finance",
    "question": "Which school received the highest donation amount?",
    "sql": "SELECT s.School_name FROM School s JOIN endowment e ON s.School_id = e.School_id WHERE e.amount = (SELECT MAX(amount) FROM endowment);",
    "table_names": [
      "School",
      "endowment"
    ]
  },
  {
    "id": 630,
    "db_id": "school_finance",
    "question": "Which school has received endowments with the highest average donation amount?",
    "sql": "SELECT School_name FROM School WHERE School_id = (SELECT School_id FROM endowment GROUP BY School_id ORDER BY AVG(amount) DESC LIMIT 1)",
    "table_names": [
      "School",
      "endowment"
    ]
  },
  {
    "id": 631,
    "db_id": "school_finance",
    "question": "Which school, on average, invested the most above their budget according to available data?",
    "sql": "SELECT School.School_name, AVG(budget.Budgeted), AVG(budget.Invested) FROM School JOIN budget ON School.School_id = budget.School_id GROUP BY School.School_name ORDER BY AVG(budget.Invested - budget.Budgeted) DESC LIMIT 1;",
    "table_names": [
      "School",
      "budget"
    ]
  },
  {
    "id": 632,
    "db_id": "school_finance",
    "question": "What is the average invested budget for schools classified as 'AAA' for football?",
    "sql": "SELECT AVG(b.Invested) FROM budget b JOIN School s ON b.School_id = s.School_id WHERE s.IHSAA_Football_Class = 'AAA';",
    "table_names": [
      "School",
      "budget"
    ]
  },
  {
    "id": 633,
    "db_id": "school_finance",
    "question": "List the names of schools that have received endowments from more than one donator and have an enrollment greater than 600 students.",
    "sql": "SELECT School_name FROM School WHERE School_id IN (SELECT School_id FROM endowment GROUP BY School_id HAVING COUNT(*) > 1) AND Enrollment > 600;",
    "table_names": [
      "School",
      "endowment"
    ]
  },
  {
    "id": 634,
    "db_id": "school_finance",
    "question": "Which school located in Marshall County had the highest total budget investment over all recorded years?",
    "sql": "SELECT s.School_name, SUM(b.Invested) as Total_Invested FROM School s JOIN budget b ON s.School_id = b.School_id WHERE s.County LIKE '%Marshall%' GROUP BY s.School_name ORDER BY Total_Invested DESC LIMIT 1;",
    "table_names": [
      "School",
      "budget"
    ]
  },
  {
    "id": 635,
    "db_id": "protein_institute",
    "question": "What is the tallest building associated with a private institution, and what is its height in feet?",
    "sql": "SELECT b.Name, b.Height_feet FROM building b INNER JOIN Institution i ON b.building_id = i.building_id WHERE i.Type='Private' ORDER BY b.Height_feet DESC LIMIT 1;",
    "table_names": [
      "building",
      "Institution"
    ]
  },
  {
    "id": 636,
    "db_id": "protein_institute",
    "question": "Which institution located in a building with more than 30 floors is the most recently founded?",
    "sql": "SELECT Institution, Founded FROM Institution WHERE building_id IN (SELECT building_id FROM building WHERE Floors > 30) ORDER BY Founded DESC LIMIT 1;",
    "table_names": [
      "building",
      "Institution"
    ]
  },
  {
    "id": 637,
    "db_id": "protein_institute",
    "question": "What is the name and team of the institution located at the tallest building?",
    "sql": "SELECT Institution, Team FROM Institution WHERE building_id = (SELECT building_id FROM building WHERE Height_feet = (SELECT MAX(Height_feet) FROM building));",
    "table_names": [
      "building",
      "Institution"
    ]
  },
  {
    "id": 638,
    "db_id": "protein_institute",
    "question": "What is the name of the tallest building associated with a private type institution?",
    "sql": "SELECT building.Name FROM building JOIN Institution ON building.building_id = Institution.building_id WHERE Institution.Type = 'Private' ORDER BY building.Height_feet DESC LIMIT 1;",
    "table_names": [
      "building",
      "Institution"
    ]
  },
  {
    "id": 639,
    "db_id": "protein_institute",
    "question": "Which organism has the protein with the lowest sequence identity to human proteins, what's the name of the protein, and which institution is researching it?",
    "sql": "SELECT p.common_name, p.protein_name, i.Institution FROM protein p JOIN Institution i ON p.Institution_id = i.Institution_id WHERE p.sequence_identity_to_human_protein = (SELECT MIN(sequence_identity_to_human_protein) FROM protein);",
    "table_names": [
      "Institution",
      "protein"
    ]
  },
  {
    "id": 640,
    "db_id": "protein_institute",
    "question": "Which protein associated with a private institution has the highest sequence identity to human protein, and what is its divergence from the human lineage along with the common name of the species and the institution name?",
    "sql": "SELECT p.common_name, p.protein_name, p.divergence_from_human_lineage, i.Institution FROM protein p JOIN Institution i ON p.Institution_id = i.Institution_id WHERE i.Type = 'Private' AND p.sequence_identity_to_human_protein = (SELECT MAX(sequence_identity_to_human_protein) FROM protein p2 JOIN Institution i2 ON p2.Institution_id = i2.Institution_id WHERE i2.Type = 'Private');",
    "table_names": [
      "Institution",
      "protein"
    ]
  },
  {
    "id": 641,
    "db_id": "protein_institute",
    "question": "What is the name of the institution located in Illinois and the common name of the organism whose protein has less than 35% sequence identity to human protein?",
    "sql": "SELECT Institution.Institution, protein.common_name FROM Institution INNER JOIN protein ON Institution.Institution_id = protein.Institution_id WHERE Institution.Location LIKE '%Illinois%' AND protein.sequence_identity_to_human_protein < '35%';",
    "table_names": [
      "Institution",
      "protein"
    ]
  },
  {
    "id": 642,
    "db_id": "protein_institute",
    "question": "What institution and team name are associated with a protein that has exactly 30% sequence identity to human protein, and what is the common name and sequence length of this protein?",
    "sql": "SELECT Institution.Institution, Institution.Team, protein.common_name, protein.sequence_length FROM Institution JOIN protein ON Institution.Institution_id = protein.Institution_id WHERE protein.sequence_identity_to_human_protein = '30%';",
    "table_names": [
      "Institution",
      "protein"
    ]
  },
  {
    "id": 643,
    "db_id": "cinema",
    "question": "What are the names of cinemas opened in or before 2010 that have film showings priced below $10?",
    "sql": "SELECT cinema.Name FROM cinema JOIN schedule ON cinema.Cinema_ID = schedule.Cinema_ID WHERE schedule.Price < 10 AND cinema.Openning_year <= 2010;",
    "table_names": [
      "cinema",
      "schedule"
    ]
  },
  {
    "id": 644,
    "db_id": "cinema",
    "question": "What is the title of the film that has the highest number of show times per day with a price less than $10?",
    "sql": "SELECT f.Title FROM film f JOIN schedule s ON f.Film_ID = s.Film_ID WHERE s.Show_times_per_day = (SELECT MAX(Show_times_per_day) FROM schedule) AND s.Price < 10",
    "table_names": [
      "film",
      "schedule"
    ]
  },
  {
    "id": 645,
    "db_id": "cinema",
    "question": "What is the title and director of the film scheduled for 4 showtimes per day at cinema ID 6?",
    "sql": "SELECT Title, Directed_by FROM film WHERE Film_ID IN (SELECT Film_ID FROM schedule WHERE Cinema_ID = 6 AND Show_times_per_day = 4);",
    "table_names": [
      "film",
      "schedule"
    ]
  },
  {
    "id": 646,
    "db_id": "cinema",
    "question": "What is the total number of showings per day for films directed by Bill Schreiner with a ticket price of 12.99?",
    "sql": "SELECT SUM(s.Show_times_per_day) FROM schedule s JOIN film f ON s.Film_ID = f.Film_ID WHERE f.Directed_by = 'Bill Schreiner' AND s.Price = 12.99;",
    "table_names": [
      "film",
      "schedule"
    ]
  },
  {
    "id": 647,
    "db_id": "products_for_hire",
    "question": "What is the average discount coupon amount received by good female customers?",
    "sql": "SELECT AVG(dc.coupon_amount) FROM Discount_Coupons dc JOIN Customers c ON dc.coupon_id = c.coupon_id WHERE c.good_or_bad_customer = 'good' AND c.gender_mf = '0';",
    "table_names": [
      "Discount_Coupons",
      "Customers"
    ]
  },
  {
    "id": 648,
    "db_id": "products_for_hire",
    "question": "Which good customer has the highest average payable amount among their bookings that were returned damaged?",
    "sql": "SELECT c.first_name, c.last_name, AVG(b.amount_payable) AS avg_payable FROM Customers c INNER JOIN Bookings b ON c.customer_id = b.customer_id WHERE c.good_or_bad_customer = 'good' AND b.returned_damaged_yn = '1' GROUP BY c.customer_id ORDER BY avg_payable DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Bookings"
    ]
  },
  {
    "id": 649,
    "db_id": "products_for_hire",
    "question": "What is the total amount paid using cash for bookings that are in Provisional status?",
    "sql": "SELECT SUM(p.amount_paid) FROM Payments p JOIN Bookings b ON p.booking_id = b.booking_id WHERE b.booking_status_code = 'Provisional' AND p.payment_type_code = 'Cash';",
    "table_names": [
      "Bookings",
      "Payments"
    ]
  },
  {
    "id": 650,
    "db_id": "products_for_hire",
    "question": "Which product has generated the highest total revenue from bookings that were returned late?",
    "sql": "SELECT pfh.product_name, SUM(pb.booked_amount) AS total_revenue FROM Products_for_Hire pfh JOIN Products_Booked pb ON pfh.product_id = pb.product_id WHERE pb.returned_late_yn = '1' GROUP BY pfh.product_name ORDER BY total_revenue DESC LIMIT 1;",
    "table_names": [
      "Products_for_Hire",
      "Products_Booked"
    ]
  },
  {
    "id": 651,
    "db_id": "products_for_hire",
    "question": "Which available product in the category 'Cutlery' has the highest daily hire cost, and what is that cost?",
    "sql": "SELECT ph.product_name, ph.daily_hire_cost FROM Products_for_Hire ph JOIN View_Product_Availability vpa ON ph.product_id = vpa.product_id WHERE ph.product_type_code = 'Cutlery' AND vpa.available_yn = '1' ORDER BY ph.daily_hire_cost DESC LIMIT 1;",
    "table_names": [
      "Products_for_Hire",
      "View_Product_Availability"
    ]
  },
  {
    "id": 652,
    "db_id": "products_for_hire",
    "question": "What is the total number of booked Cutlery products that were returned late?",
    "sql": "SELECT SUM(pb.booked_count) FROM Products_Booked pb JOIN Products_for_Hire ph ON pb.product_id = ph.product_id WHERE ph.product_type_code = 'Cutlery' AND pb.returned_late_yn = '1';",
    "table_names": [
      "Products_for_Hire",
      "Products_Booked"
    ]
  },
  {
    "id": 653,
    "db_id": "products_for_hire",
    "question": "What is the average coupon amount issued to female customers who are rated as good customers?",
    "sql": "SELECT AVG(dc.coupon_amount) FROM Discount_Coupons dc INNER JOIN Customers c ON dc.coupon_id = c.coupon_id WHERE c.good_or_bad_customer = 'good' AND c.gender_mf = '0';",
    "table_names": [
      "Discount_Coupons",
      "Customers"
    ]
  },
  {
    "id": 654,
    "db_id": "phone_market",
    "question": "What is the total value of all TMobile phones currently in stock across all markets?",
    "sql": "SELECT SUM(pm.Num_of_stock * p.Price) FROM phone_market pm INNER JOIN phone p ON pm.Phone_ID = CAST(p.Phone_ID AS TEXT) WHERE p.Carrier='TMobile';",
    "table_names": [
      "phone",
      "phone_market"
    ]
  },
  {
    "id": 655,
    "db_id": "phone_market",
    "question": "What is the total number of stock available in all markets for phones carried by TMobile that have at least 64 GB of memory?",
    "sql": "SELECT SUM(pm.Num_of_stock) FROM phone_market pm JOIN phone p ON pm.Phone_ID = CAST(p.Phone_ID AS TEXT) WHERE p.Carrier = 'TMobile' AND p.Memory_in_G >= 64;",
    "table_names": [
      "phone",
      "phone_market"
    ]
  },
  {
    "id": 656,
    "db_id": "phone_market",
    "question": "What is the total number of phones in stock for phones with carrier 'TMobile' and memory of at least 64 GB?",
    "sql": "SELECT SUM(pm.Num_of_stock) FROM phone_market pm JOIN phone p ON pm.Phone_ID = CAST(p.Phone_ID AS TEXT) WHERE p.Carrier = 'TMobile' AND p.Memory_in_G >= 64;",
    "table_names": [
      "phone",
      "phone_market"
    ]
  },
  {
    "id": 657,
    "db_id": "gas_company",
    "question": "List the names of companies linked to a station that ranked within the top 4 for the year and had profits over 25 billion dollars.",
    "sql": "SELECT c.Company FROM company c JOIN station_company sc ON c.Company_ID = sc.Company_ID WHERE sc.Rank_of_the_Year < 5 AND c.Profits_billion > 25;",
    "table_names": [
      "company",
      "station_company"
    ]
  },
  {
    "id": 658,
    "db_id": "gas_company",
    "question": "Which company has the highest rank of the year in the 'station_company' table, what is its headquarters location, and what are its sales in billions?",
    "sql": "SELECT c.Company, c.Headquarters, c.Sales_billion FROM company c JOIN station_company sc ON c.Company_ID = sc.Company_ID WHERE sc.Rank_of_the_Year = (SELECT MIN(Rank_of_the_Year) FROM station_company);",
    "table_names": [
      "company",
      "station_company"
    ]
  },
  {
    "id": 659,
    "db_id": "gas_company",
    "question": "Which oil and gas companies have stations ranked in the top 3 during the year, and where are their headquarters?",
    "sql": "SELECT c.Company, c.Headquarters FROM company c JOIN station_company sc ON c.Company_ID = sc.Company_ID WHERE sc.Rank_of_the_Year <= 3 AND c.Main_Industry = 'Oil and gas';",
    "table_names": [
      "company",
      "station_company"
    ]
  },
  {
    "id": 660,
    "db_id": "gas_company",
    "question": "What is the name and headquarters location of the company associated with the station that has the highest rank of the year according to the station_company table?",
    "sql": "SELECT c.Company, c.Headquarters FROM company c JOIN station_company s ON c.Company_ID = s.Company_ID WHERE s.Rank_of_the_Year = (SELECT MIN(Rank_of_the_Year) FROM station_company);",
    "table_names": [
      "company",
      "station_company"
    ]
  },
  {
    "id": 661,
    "db_id": "party_people",
    "question": "Who are the current members associated with the party that was led by minister Ebenezer Ako-Adjei (MP)?",
    "sql": "SELECT m.Member_Name FROM member m JOIN party p ON m.Party_ID = p.Party_ID WHERE p.Minister = 'Ebenezer Ako-Adjei (MP)' AND m.In_office LIKE '%present%';",
    "table_names": [
      "party",
      "member"
    ]
  },
  {
    "id": 662,
    "db_id": "party_people",
    "question": "Which members from parties led by Ebenezer Ako-Adjei (MP) are currently in office?",
    "sql": "SELECT m.Member_Name FROM member AS m JOIN party AS p ON m.Party_ID = p.Party_ID WHERE p.Minister = 'Ebenezer Ako-Adjei (MP)' AND m.In_office LIKE '%present%';",
    "table_names": [
      "party",
      "member"
    ]
  },
  {
    "id": 663,
    "db_id": "party_people",
    "question": "Who are the members associated with the party whose minister was Ebenezer Ako-Adjei between 1959 and 1960?",
    "sql": "SELECT member.Member_Name FROM member INNER JOIN party ON member.Party_ID = party.Party_ID WHERE party.Minister = 'Ebenezer Ako-Adjei (MP)' AND party.Took_office = '1959';",
    "table_names": [
      "party",
      "member"
    ]
  },
  {
    "id": 664,
    "db_id": "party_people",
    "question": "Which members are currently in office representing the party named '3'?",
    "sql": "SELECT member.Member_Name FROM member JOIN party ON member.Party_ID = party.Party_ID WHERE member.In_office LIKE '%present%' AND party.Party_name = '3';",
    "table_names": [
      "party",
      "member"
    ]
  },
  {
    "id": 665,
    "db_id": "party_people",
    "question": "Which members associated with the party led by Ebenezer Ako-Adjei (MP), named '3', are currently in office?",
    "sql": "SELECT m.Member_Name FROM member m JOIN party p ON m.Party_ID = p.Party_ID WHERE p.Minister = 'Ebenezer Ako-Adjei (MP)' AND p.Party_name = '3' AND m.In_office LIKE '%present%';",
    "table_names": [
      "party",
      "member"
    ]
  },
  {
    "id": 666,
    "db_id": "party_people",
    "question": "What is the name of the party associated with Hon John Anderson?",
    "sql": "SELECT party.Party_name FROM party JOIN member ON party.Party_ID = member.Party_ID WHERE member.Member_Name = 'Hon John Anderson';",
    "table_names": [
      "party",
      "member"
    ]
  },
  {
    "id": 667,
    "db_id": "party_people",
    "question": "Who was the minister who took office in 1960 for the region label Astralwerks?",
    "sql": "SELECT p.Minister FROM party p JOIN region r ON p.Region_ID = r.Region_ID WHERE r.Label = 'Astralwerks' AND p.Took_office = '1960';",
    "table_names": [
      "region",
      "party"
    ]
  },
  {
    "id": 668,
    "db_id": "party_people",
    "question": "In which region did minister Ebenezer Ako-Adjei (MP) represent the Sinefine Party?",
    "sql": "SELECT region.Region_name FROM region INNER JOIN party ON region.Region_ID = party.Region_ID WHERE party.Minister = 'Ebenezer Ako-Adjei (MP)' AND party.Party_name = 'Sinefine Party';",
    "table_names": [
      "region",
      "party"
    ]
  },
  {
    "id": 669,
    "db_id": "party_people",
    "question": "Who are the current members associated with the party from Region ID 5?",
    "sql": "SELECT m.Member_Name FROM member m JOIN party p ON m.Party_ID = p.Party_ID WHERE p.Region_ID = 5 AND m.In_office LIKE '%present%';",
    "table_names": [
      "party",
      "member"
    ]
  },
  {
    "id": 670,
    "db_id": "party_people",
    "question": "Who are the members currently in office belonging to the Convention Peoples Party?",
    "sql": "SELECT member.Member_Name FROM member JOIN party ON member.Party_ID = party.Party_ID WHERE party.Party_name = 'Convention Peoples Party' AND member.In_office LIKE '%present%';",
    "table_names": [
      "party",
      "member"
    ]
  },
  {
    "id": 671,
    "db_id": "party_people",
    "question": "What is the party name associated with the member Hon Kevin Andrews?",
    "sql": "SELECT p.Party_name FROM party p JOIN member m ON p.Party_ID = m.Party_ID WHERE m.Member_Name = 'Hon Kevin Andrews';",
    "table_names": [
      "party",
      "member"
    ]
  },
  {
    "id": 672,
    "db_id": "party_people",
    "question": "How many distinct members are currently in office and have been affiliated with parties whose minister was Ebenezer Ako-Adjei (MP)?",
    "sql": "SELECT COUNT(DISTINCT m.Member_ID) FROM member m JOIN party p ON m.Party_ID = p.Party_ID WHERE p.Minister = 'Ebenezer Ako-Adjei (MP)' AND m.In_office LIKE '%present%';",
    "table_names": [
      "party",
      "member"
    ]
  },
  {
    "id": 673,
    "db_id": "party_people",
    "question": "What is the party name of the minister Kojo Botsio (MP) who hosted the Budget Meeting?",
    "sql": "SELECT party.Party_name FROM party JOIN party_events ON party.Party_ID = party_events.Party_ID WHERE party_events.Event_Name = 'Budget Meeting' AND party.Minister = 'Kojo Botsio (MP)';",
    "table_names": [
      "party",
      "party_events"
    ]
  },
  {
    "id": 674,
    "db_id": "party_people",
    "question": "Which parties have hosted a 'Budget Meeting'?",
    "sql": "SELECT DISTINCT p.Party_name FROM party p JOIN party_events pe ON p.Party_ID = pe.Party_ID WHERE pe.Event_Name = 'Budget Meeting';",
    "table_names": [
      "party",
      "party_events"
    ]
  },
  {
    "id": 675,
    "db_id": "party_people",
    "question": "Who is currently in office and in charge of a 'Budget Meeting' event?",
    "sql": "SELECT m.Member_Name FROM member m JOIN party_events e ON m.Member_ID = e.Member_in_charge_ID WHERE e.Event_Name = 'Budget Meeting' AND m.In_office LIKE '%present%';",
    "table_names": [
      "member",
      "party_events"
    ]
  },
  {
    "id": 676,
    "db_id": "party_people",
    "question": "Which members currently in office are in charge of budget meetings?",
    "sql": "SELECT m.Member_Name FROM member m JOIN party_events pe ON m.Member_ID = pe.Member_in_charge_ID WHERE pe.Event_Name = 'Budget Meeting' AND m.In_office LIKE '%present%';",
    "table_names": [
      "member",
      "party_events"
    ]
  },
  {
    "id": 677,
    "db_id": "party_people",
    "question": "Which political party organized an Election Meeting in the region with Region_ID equal to 1?",
    "sql": "SELECT party.Party_name FROM party JOIN party_events ON party.Party_ID = party_events.Party_ID WHERE party_events.Event_Name = 'Election Meeting' AND party.Region_ID = 1;",
    "table_names": [
      "party",
      "party_events"
    ]
  },
  {
    "id": 678,
    "db_id": "party_people",
    "question": "Which ministers belong to the party 'Convention Peoples Party' and participated in the event named 'Election Meeting'?",
    "sql": "SELECT DISTINCT p.Minister FROM party p JOIN party_events pe ON p.Party_ID = pe.Party_ID WHERE pe.Event_Name = 'Election Meeting' AND p.Party_name = 'Convention Peoples Party';",
    "table_names": [
      "party",
      "party_events"
    ]
  },
  {
    "id": 679,
    "db_id": "party_people",
    "question": "Who is currently serving as a member and also in charge of a 'Budget Meeting' event?",
    "sql": "SELECT m.Member_Name FROM member m JOIN party_events pe ON m.Member_ID = pe.Member_in_charge_ID WHERE pe.Event_Name = 'Budget Meeting' AND m.In_office LIKE '%present%';",
    "table_names": [
      "member",
      "party_events"
    ]
  },
  {
    "id": 680,
    "db_id": "party_people",
    "question": "Who is responsible for the 'Budget Meeting' event in the same party as Anthony Albanese?",
    "sql": "SELECT Member_Name FROM member WHERE Member_ID = (SELECT Member_in_charge_ID FROM party_events WHERE Event_Name = 'Budget Meeting' AND Party_ID = (SELECT Party_ID FROM member WHERE Member_Name = 'Anthony Albanese'));",
    "table_names": [
      "member",
      "party_events"
    ]
  },
  {
    "id": 681,
    "db_id": "pilot_record",
    "question": "What is the nationality of the pilot who has the earliest record, and in what team does the pilot play?",
    "sql": "SELECT nationality, Team FROM pilot WHERE Pilot_ID = (SELECT Pilot_ID FROM pilot_record ORDER BY Date ASC LIMIT 1);",
    "table_names": [
      "pilot",
      "pilot_record"
    ]
  },
  {
    "id": 682,
    "db_id": "pilot_record",
    "question": "What is the name of the United States pilot who flew aircraft with Aircraft_ID 4?",
    "sql": "SELECT p.Pilot_name FROM pilot p JOIN pilot_record pr ON p.Pilot_ID = pr.Pilot_ID WHERE p.Nationality = 'United States' AND pr.Aircraft_ID = 4;",
    "table_names": [
      "pilot",
      "pilot_record"
    ]
  },
  {
    "id": 683,
    "db_id": "pilot_record",
    "question": "Which pilots from the United States have flown aircraft with Aircraft_ID 1?",
    "sql": "SELECT pilot.Pilot_name FROM pilot JOIN pilot_record ON pilot.Pilot_ID = pilot_record.Pilot_ID WHERE pilot.Nationality = 'United States' AND pilot_record.Aircraft_ID = 1;",
    "table_names": [
      "pilot",
      "pilot_record"
    ]
  },
  {
    "id": 684,
    "db_id": "cre_Doc_Tracking_DB",
    "question": "How many employees have roles described as either 'Editor' or 'Photo'?",
    "sql": "SELECT COUNT(*) FROM Employees e JOIN Roles r ON e.role_code = r.role_code WHERE r.role_description IN ('Editor', 'Photo');",
    "table_names": [
      "Roles",
      "Employees"
    ]
  },
  {
    "id": 685,
    "db_id": "cre_Doc_Tracking_DB",
    "question": "What are the names of employees whose roles are described as 'Editor'?",
    "sql": "SELECT employee_name FROM Employees WHERE role_code = (SELECT role_code FROM Roles WHERE role_description = 'Editor');",
    "table_names": [
      "Roles",
      "Employees"
    ]
  },
  {
    "id": 686,
    "db_id": "cre_Doc_Tracking_DB",
    "question": "What are the names of employees who have the role description 'Editor'?",
    "sql": "SELECT employee_name FROM Employees WHERE role_code = (SELECT role_code FROM Roles WHERE role_description = 'Editor');",
    "table_names": [
      "Roles",
      "Employees"
    ]
  },
  {
    "id": 687,
    "db_id": "cre_Doc_Control_Systems",
    "question": "How many Paper type documents have the status description 'mailed'?",
    "sql": "SELECT COUNT(*) FROM Documents AS d JOIN Ref_Document_Status AS r ON d.document_status_code = r.document_status_code WHERE d.document_type_code = 'Paper' AND r.document_status_description = 'mailed';",
    "table_names": [
      "Ref_Document_Status",
      "Documents"
    ]
  },
  {
    "id": 688,
    "db_id": "cre_Doc_Control_Systems",
    "question": "Which shipping agent has the most documents currently in 'working' status, and how many documents does it have?",
    "sql": "SELECT sa.shipping_agent_name, COUNT(d.document_id) as total_documents FROM Documents d JOIN Ref_Shipping_Agents sa ON d.shipping_agent_code = sa.shipping_agent_code WHERE d.document_status_code = 'working' GROUP BY sa.shipping_agent_name ORDER BY total_documents DESC LIMIT 1;",
    "table_names": [
      "Ref_Shipping_Agents",
      "Documents"
    ]
  },
  {
    "id": 689,
    "db_id": "cre_Doc_Control_Systems",
    "question": "How many documents currently have a 'working' status and were shipped by Fedex?",
    "sql": "SELECT COUNT(*) FROM Documents d JOIN Ref_Shipping_Agents s ON d.shipping_agent_code = s.shipping_agent_code WHERE d.document_status_code = 'working' AND s.shipping_agent_name = 'Fedex';",
    "table_names": [
      "Ref_Shipping_Agents",
      "Documents"
    ]
  },
  {
    "id": 690,
    "db_id": "cre_Doc_Control_Systems",
    "question": "What is the shipping agent description for the agent handling the most recent 'Hard Drive' document that is marked as 'working'?",
    "sql": "SELECT rsa.shipping_agent_description FROM Ref_Shipping_Agents rsa JOIN Documents d ON rsa.shipping_agent_code = d.shipping_agent_code WHERE d.document_type_code = 'Hard Drive' AND d.document_status_code = 'working' ORDER BY d.receipt_date DESC LIMIT 1;",
    "table_names": [
      "Ref_Shipping_Agents",
      "Documents"
    ]
  },
  {
    "id": 691,
    "db_id": "cre_Doc_Control_Systems",
    "question": "How many distinct documents are mailed to addresses in Ireland (IE) after the year 2000?",
    "sql": "SELECT COUNT(DISTINCT dm.document_id) FROM Documents_Mailed dm JOIN Addresses a ON dm.mailed_to_address_id = a.address_id WHERE a.address_details = 'IE' AND dm.mailing_date > '2000-01-01';",
    "table_names": [
      "Addresses",
      "Documents_Mailed"
    ]
  },
  {
    "id": 692,
    "db_id": "cre_Doc_Control_Systems",
    "question": "Which is the latest 'working' document sent through 'Fedex' shipping agent and what is its receipt date?",
    "sql": "SELECT d.document_id, d.receipt_date FROM Documents d JOIN Ref_Shipping_Agents s ON d.shipping_agent_code = s.shipping_agent_code WHERE s.shipping_agent_name = 'Fedex' AND d.document_status_code = 'working' ORDER BY d.receipt_date DESC LIMIT 1;",
    "table_names": [
      "Ref_Shipping_Agents",
      "Documents"
    ]
  },
  {
    "id": 693,
    "db_id": "cre_Doc_Control_Systems",
    "question": "What is the document ID and its receipt date of the oldest 'Hard Drive' type document shipped via 'Fedex'?",
    "sql": "SELECT d.document_id, d.receipt_date FROM Documents d JOIN Ref_Shipping_Agents sa ON d.shipping_agent_code = sa.shipping_agent_code WHERE sa.shipping_agent_name = 'Fedex' AND d.document_type_code = 'Hard Drive' ORDER BY d.receipt_date ASC LIMIT 1;",
    "table_names": [
      "Ref_Shipping_Agents",
      "Documents"
    ]
  },
  {
    "id": 694,
    "db_id": "cre_Doc_Control_Systems",
    "question": "What is the name of the employee who circulated the document with the highest draft number?",
    "sql": "SELECT e.employee_name FROM Employees e INNER JOIN Circulation_History ch ON e.employee_id = ch.employee_id WHERE ch.draft_number = (SELECT MAX(draft_number) FROM Circulation_History);",
    "table_names": [
      "Employees",
      "Circulation_History"
    ]
  },
  {
    "id": 695,
    "db_id": "cre_Doc_Control_Systems",
    "question": "What is the number of distinct documents circulated by employees with the role code 'ED'?",
    "sql": "SELECT COUNT(DISTINCT ch.document_id) FROM Employees e JOIN Circulation_History ch ON e.employee_id = ch.employee_id WHERE e.role_code = 'ED';",
    "table_names": [
      "Employees",
      "Circulation_History"
    ]
  },
  {
    "id": 696,
    "db_id": "cre_Doc_Control_Systems",
    "question": "Who is the employee responsible for the circulation history entry with the highest draft number?",
    "sql": "SELECT employee_name FROM Employees WHERE employee_id IN (SELECT employee_id FROM Circulation_History WHERE draft_number = (SELECT MAX(draft_number) FROM Circulation_History));",
    "table_names": [
      "Employees",
      "Circulation_History"
    ]
  },
  {
    "id": 697,
    "db_id": "company_1",
    "question": "What is the name of the department that has more than one location?",
    "sql": "SELECT Dname FROM department WHERE Dnumber IN (SELECT Dnumber FROM dept_locations GROUP BY Dnumber HAVING COUNT(Dlocation) > 1);",
    "table_names": [
      "department",
      "dept_locations"
    ]
  },
  {
    "id": 698,
    "db_id": "local_govt_in_alabama",
    "question": "How many events related to 'Property Change' ended with a 'Fail' status?",
    "sql": "SELECT COUNT(*) FROM Events e JOIN Services s ON e.Service_ID = s.Service_ID WHERE s.Service_Type_Code = 'Property Change' AND e.Event_Details = 'Fail';",
    "table_names": [
      "Services",
      "Events"
    ]
  },
  {
    "id": 699,
    "db_id": "local_govt_in_alabama",
    "question": "How many distinct participants have participated in successful events related to the service with Service_ID 5?",
    "sql": "SELECT COUNT(DISTINCT pe.Participant_ID) FROM Events e JOIN Participants_in_Events pe ON e.Event_ID = pe.Event_ID WHERE e.Service_ID = 5 AND e.Event_Details = 'Success';",
    "table_names": [
      "Events",
      "Participants_in_Events"
    ]
  },
  {
    "id": 700,
    "db_id": "local_govt_in_alabama",
    "question": "What is the name of the organizer who participated in an event that also had Dedrick Ebert as a participant?",
    "sql": "SELECT Participant_Details FROM Participants WHERE Participant_ID IN (SELECT Participant_ID FROM Participants_in_Events WHERE Event_ID IN (SELECT Event_ID FROM Participants_in_Events WHERE Participant_ID = (SELECT Participant_ID FROM Participants WHERE Participant_Details = 'Dedrick Ebert')) AND Participant_Type_Code = 'Organizer');",
    "table_names": [
      "Participants",
      "Participants_in_Events"
    ]
  },
  {
    "id": 701,
    "db_id": "local_govt_in_alabama",
    "question": "Which organizers have participated in the same events as participant Justyn Lebsack?",
    "sql": "SELECT DISTINCT p.Participant_Details FROM Participants p JOIN Participants_in_Events pe ON p.Participant_ID = pe.Participant_ID WHERE pe.Event_ID IN (SELECT pe2.Event_ID FROM Participants_in_Events pe2 JOIN Participants p2 ON pe2.Participant_ID = p2.Participant_ID WHERE p2.Participant_Details = 'Justyn Lebsack') AND p.Participant_Type_Code = 'Organizer';",
    "table_names": [
      "Participants",
      "Participants_in_Events"
    ]
  },
  {
    "id": 702,
    "db_id": "local_govt_in_alabama",
    "question": "How many events associated with the 'Marriage' service type failed?",
    "sql": "SELECT COUNT(E.Event_ID) FROM Events E JOIN Services S ON E.Service_ID = S.Service_ID WHERE S.Service_Type_Code = 'Marriage' AND E.Event_Details = 'Fail';",
    "table_names": [
      "Services",
      "Events"
    ]
  },
  {
    "id": 703,
    "db_id": "local_govt_in_alabama",
    "question": "How many unique participants were involved in successful events that belong to Service_ID 5?",
    "sql": "SELECT COUNT(DISTINCT p.Participant_ID) FROM Events e JOIN Participants_in_Events p ON e.Event_ID = p.Event_ID WHERE e.Service_ID = 5 AND e.Event_Details = 'Success';",
    "table_names": [
      "Events",
      "Participants_in_Events"
    ]
  },
  {
    "id": 728,
    "db_id": "machine_repair",
    "question": "Among technicians from team 'NYY', who repaired the highest number of distinct machines?",
    "sql": "SELECT t.Name FROM technician t JOIN repair_assignment r ON t.technician_id = r.technician_id WHERE t.Team = 'NYY' GROUP BY t.Name ORDER BY COUNT(DISTINCT r.Machine_ID) DESC LIMIT 1;",
    "table_names": [
      "technician",
      "repair_assignment"
    ]
  },
  {
    "id": 729,
    "db_id": "machine_repair",
    "question": "Which technician has repaired the highest number of distinct machines?",
    "sql": "SELECT Name FROM technician WHERE technician_id IN (SELECT technician_id FROM repair_assignment GROUP BY technician_id ORDER BY COUNT(DISTINCT Machine_ID) DESC LIMIT 1);",
    "table_names": [
      "technician",
      "repair_assignment"
    ]
  },
  {
    "id": 730,
    "db_id": "machine_repair",
    "question": "Which technician from the CLE team has handled the highest number of unique repairs?",
    "sql": "SELECT t.Name FROM technician t JOIN repair_assignment r ON t.technician_id = r.technician_id WHERE t.Team = 'CLE' GROUP BY t.Name ORDER BY COUNT(DISTINCT r.repair_ID) DESC LIMIT 1;",
    "table_names": [
      "technician",
      "repair_assignment"
    ]
  },
  {
    "id": 731,
    "db_id": "machine_repair",
    "question": "Which technician has repaired more than two different machines?",
    "sql": "SELECT Name FROM technician WHERE technician_id IN (SELECT technician_id FROM repair_assignment GROUP BY technician_id HAVING COUNT(DISTINCT Machine_ID) > 2);",
    "table_names": [
      "technician",
      "repair_assignment"
    ]
  },
  {
    "id": 732,
    "db_id": "entrepreneur",
    "question": "Which companies are founded by entrepreneurs taller than 1.8 meters that requested more than 100,000 money?",
    "sql": "SELECT e.Company FROM entrepreneur e JOIN people p ON e.People_ID = p.People_ID WHERE p.Height > 1.8 AND e.Money_Requested > 100000;",
    "table_names": [
      "entrepreneur",
      "people"
    ]
  },
  {
    "id": 733,
    "db_id": "entrepreneur",
    "question": "Which entrepreneur supported by investor Duncan Bannatyne requested the highest amount of money, what is the entrepreneur's name, their company name, and how much did they request?",
    "sql": "SELECT p.Name, e.Company, e.Money_Requested FROM entrepreneur e JOIN people p ON e.People_ID = p.People_ID WHERE e.Investor = 'Duncan Bannatyne' ORDER BY e.Money_Requested DESC LIMIT 1;",
    "table_names": [
      "entrepreneur",
      "people"
    ]
  },
  {
    "id": 734,
    "db_id": "entrepreneur",
    "question": "What is the name of the entrepreneur who received investment from Duncan Bannatyne and whose height is greater than 1.9 meters?",
    "sql": "SELECT p.Name FROM entrepreneur e JOIN people p ON e.People_ID = p.People_ID WHERE e.Investor = 'Duncan Bannatyne' AND p.Height > 1.9;",
    "table_names": [
      "entrepreneur",
      "people"
    ]
  },
  {
    "id": 735,
    "db_id": "entrepreneur",
    "question": "What is the name and height of the tallest entrepreneur who requested more than 100,000, and what company do they represent?",
    "sql": "SELECT p.Name, p.Height, e.Company FROM entrepreneur e INNER JOIN people p ON e.People_ID = p.People_ID WHERE e.Money_Requested > 100000 ORDER BY p.Height DESC LIMIT 1;",
    "table_names": [
      "entrepreneur",
      "people"
    ]
  },
  {
    "id": 736,
    "db_id": "entrepreneur",
    "question": "Which entrepreneur with a height greater than 1.85 meters requested the highest amount of money, and what is the company name?",
    "sql": "SELECT p.Name, e.Company, e.Money_Requested FROM entrepreneur e JOIN people p ON e.People_ID = p.People_ID WHERE p.Height > 1.85 ORDER BY e.Money_Requested DESC LIMIT 1;",
    "table_names": [
      "entrepreneur",
      "people"
    ]
  },
  {
    "id": 737,
    "db_id": "entrepreneur",
    "question": "Which entrepreneurs taller than 1.85 meters have requested more than 100,000 pounds, what are their names, companies, and how much money did each request?",
    "sql": "SELECT p.Name, e.Company, e.Money_Requested FROM entrepreneur e JOIN people p ON e.People_ID = p.People_ID WHERE p.Height > 1.85 AND e.Money_Requested > 100000.0;",
    "table_names": [
      "entrepreneur",
      "people"
    ]
  },
  {
    "id": 738,
    "db_id": "entrepreneur",
    "question": "Which entrepreneur with body weight greater than 70 kg requested the highest amount of money, and what company do they own?",
    "sql": "SELECT p.Name, e.Company FROM entrepreneur e JOIN people p ON e.People_ID = p.People_ID WHERE p.Weight > 70 ORDER BY e.Money_Requested DESC LIMIT 1;",
    "table_names": [
      "entrepreneur",
      "people"
    ]
  },
  {
    "id": 739,
    "db_id": "entrepreneur",
    "question": "Which companies are founded by entrepreneurs taller than 1.85 meters and requested more than 100,000?",
    "sql": "SELECT e.Company FROM entrepreneur e JOIN people p ON e.People_ID = p.People_ID WHERE p.Height > 1.85 AND e.Money_Requested > 100000;",
    "table_names": [
      "entrepreneur",
      "people"
    ]
  },
  {
    "id": 740,
    "db_id": "entrepreneur",
    "question": "What are the names of companies whose entrepreneurs have a height exceeding 1.85 meters and requested more than 100000?",
    "sql": "SELECT e.Company FROM entrepreneur e JOIN people p ON e.People_ID = p.People_ID WHERE p.Height > 1.85 AND e.Money_Requested > 100000;",
    "table_names": [
      "entrepreneur",
      "people"
    ]
  },
  {
    "id": 741,
    "db_id": "entrepreneur",
    "question": "Which entrepreneur with a height greater than 1.85 meters requested the highest amount of investment, and what was the name of their company and amount requested?",
    "sql": "SELECT p.Name, e.Company, e.Money_Requested FROM entrepreneur e INNER JOIN people p ON e.People_ID = p.People_ID WHERE p.Height > 1.85 ORDER BY e.Money_Requested DESC LIMIT 1;",
    "table_names": [
      "entrepreneur",
      "people"
    ]
  },
  {
    "id": 742,
    "db_id": "entrepreneur",
    "question": "Which entrepreneurs requested more than 100,000 from investors and have a height greater than 1.85 meters? List their names and respective companies.",
    "sql": "SELECT p.Name, e.Company FROM entrepreneur e INNER JOIN people p ON e.People_ID = p.People_ID WHERE e.Money_Requested > 100000 AND p.Height > 1.85;",
    "table_names": [
      "entrepreneur",
      "people"
    ]
  },
  {
    "id": 743,
    "db_id": "entrepreneur",
    "question": "Can you list the names of entrepreneurs, their companies, and the money requested for those who asked for more than 80000 and whose height is above 1.85 meters?",
    "sql": "SELECT p.Name, e.Company, e.Money_Requested FROM entrepreneur e INNER JOIN people p ON e.People_ID = p.People_ID WHERE e.Money_Requested > 80000 AND p.Height > 1.85;",
    "table_names": [
      "entrepreneur",
      "people"
    ]
  },
  {
    "id": 744,
    "db_id": "entrepreneur",
    "question": "Which companies have entrepreneurs taller than 1.85 meters who requested more than 100,000 dollars?",
    "sql": "SELECT e.Company FROM entrepreneur e JOIN people p ON e.People_ID = p.People_ID WHERE p.Height > 1.85 AND e.Money_Requested > 100000;",
    "table_names": [
      "entrepreneur",
      "people"
    ]
  },
  {
    "id": 745,
    "db_id": "entrepreneur",
    "question": "Which entrepreneurs have a height taller than 1.85 meters and requested at least 100000 in investment? Include their names and company names.",
    "sql": "SELECT p.Name, e.Company FROM entrepreneur e JOIN people p ON e.People_ID = p.People_ID WHERE p.Height > 1.85 AND e.Money_Requested >= 100000;",
    "table_names": [
      "entrepreneur",
      "people"
    ]
  },
  {
    "id": 746,
    "db_id": "entrepreneur",
    "question": "Which entrepreneurs have requested more than 60000 in investment and have a height greater than 1.85 meters, and what companies are they associated with?",
    "sql": "SELECT p.Name, e.Company FROM entrepreneur e JOIN people p ON e.People_ID = p.People_ID WHERE e.Money_Requested > 60000 AND p.Height > 1.85;",
    "table_names": [
      "entrepreneur",
      "people"
    ]
  },
  {
    "id": 747,
    "db_id": "entrepreneur",
    "question": "Which companies requested funding of at least 100000 and were founded by entrepreneurs taller than 1.85 meters?",
    "sql": "SELECT entrepreneur.Company FROM entrepreneur JOIN people ON entrepreneur.People_ID = people.People_ID WHERE people.Height > 1.85 AND entrepreneur.Money_Requested >= 100000;",
    "table_names": [
      "entrepreneur",
      "people"
    ]
  },
  {
    "id": 748,
    "db_id": "entrepreneur",
    "question": "What are the names and corresponding companies of entrepreneurs who requested more than 70000.0 in funding and have a height greater than 1.85 meters?",
    "sql": "SELECT p.Name, e.Company FROM entrepreneur e JOIN people p ON e.People_ID = p.People_ID WHERE e.Money_Requested > 70000.0 AND p.Height > 1.85;",
    "table_names": [
      "entrepreneur",
      "people"
    ]
  },
  {
    "id": 749,
    "db_id": "entrepreneur",
    "question": "Which entrepreneurs have requested money above the average request and have a height of at least 1.85 meters?",
    "sql": "SELECT p.Name FROM entrepreneur AS e JOIN people AS p ON e.People_ID = p.People_ID WHERE e.Money_Requested > (SELECT AVG(Money_Requested) FROM entrepreneur) AND p.Height >= 1.85;",
    "table_names": [
      "entrepreneur",
      "people"
    ]
  },
  {
    "id": 750,
    "db_id": "perpetrator",
    "question": "How many victims were killed in total by perpetrators taller than 6.5 feet in China and Japan?",
    "sql": "SELECT SUM(p.Killed) AS Total_Killed FROM perpetrator p JOIN people pe ON p.People_ID = pe.People_ID WHERE pe.Height > 6.5 AND p.Country IN ('China', 'Japan');",
    "table_names": [
      "perpetrator",
      "people"
    ]
  },
  {
    "id": 751,
    "db_id": "perpetrator",
    "question": "Who was the perpetrator of a mass event in China resulting in 30 or more deaths, and how many people were killed and injured?",
    "sql": "SELECT p.Name, per.Killed, per.Injured FROM perpetrator per INNER JOIN people p ON per.People_ID = p.People_ID WHERE per.Country = 'China' AND per.Killed >= 30;",
    "table_names": [
      "perpetrator",
      "people"
    ]
  },
  {
    "id": 752,
    "db_id": "perpetrator",
    "question": "Which perpetrators taller than 6.5 feet were responsible for incidents with more than 25 people killed, and what countries and years were these incidents in?",
    "sql": "SELECT p.Name, pr.Country, pr.Year FROM perpetrator pr JOIN people p ON pr.People_ID = p.People_ID WHERE pr.Killed > 25 AND p.Height > 6.5;",
    "table_names": [
      "perpetrator",
      "people"
    ]
  },
  {
    "id": 753,
    "db_id": "perpetrator",
    "question": "What is the name and country of the perpetrator responsible for the incident with the highest number of people killed?",
    "sql": "SELECT people.Name, perpetrator.Country FROM perpetrator JOIN people ON perpetrator.People_ID = people.People_ID WHERE perpetrator.Killed = (SELECT MAX(Killed) FROM perpetrator);",
    "table_names": [
      "perpetrator",
      "people"
    ]
  },
  {
    "id": 754,
    "db_id": "perpetrator",
    "question": "Who is the perpetrator with the highest number of killings and what are their physical attributes and the country of the incident?",
    "sql": "SELECT p.Name, p.Height, p.Weight, e.Country, e.Killed FROM perpetrator e JOIN people p ON e.People_ID = p.People_ID WHERE e.Killed = (SELECT MAX(Killed) FROM perpetrator);",
    "table_names": [
      "perpetrator",
      "people"
    ]
  },
  {
    "id": 755,
    "db_id": "perpetrator",
    "question": "What is the name and the country of the perpetrator who had killed at least 30 people and has a height of at least 6.5 feet?",
    "sql": "SELECT people.Name, perpetrator.Country FROM perpetrator JOIN people ON perpetrator.People_ID = people.People_ID WHERE perpetrator.Killed >= 30 AND people.Height >= 6.5;",
    "table_names": [
      "perpetrator",
      "people"
    ]
  },
  {
    "id": 756,
    "db_id": "perpetrator",
    "question": "What are the names, locations, countries and years of incidents involving perpetrators responsible for killing more than 25 people, listed by highest number of fatalities?",
    "sql": "SELECT people.Name, perpetrator.Location, perpetrator.Country, perpetrator.Year FROM perpetrator JOIN people ON perpetrator.People_ID = people.People_ID WHERE perpetrator.Killed > 25 ORDER BY perpetrator.Killed DESC LIMIT 3;",
    "table_names": [
      "perpetrator",
      "people"
    ]
  },
  {
    "id": 757,
    "db_id": "perpetrator",
    "question": "Who is the tallest perpetrator involved in the incident with the greatest number of killed victims, what was the country, date of the incident, and how many died?",
    "sql": "SELECT people.Name, perpetrator.Country, perpetrator.Date, perpetrator.Killed FROM perpetrator INNER JOIN people ON perpetrator.People_ID = people.People_ID WHERE people.Height > 6.5 ORDER BY perpetrator.Killed DESC LIMIT 1;",
    "table_names": [
      "perpetrator",
      "people"
    ]
  },
  {
    "id": 758,
    "db_id": "perpetrator",
    "question": "List the name and height of perpetrators taller than 6.5 feet who committed incidents resulting in more than 25 deaths, along with the incident year and country.",
    "sql": "SELECT p.Name, p.Height, pe.Year, pe.Country FROM perpetrator pe JOIN people p ON pe.People_ID = p.People_ID WHERE pe.Killed > 25 AND p.Height > 6.5;",
    "table_names": [
      "perpetrator",
      "people"
    ]
  },
  {
    "id": 785,
    "db_id": "candidate_poll",
    "question": "What is the highest support rate from the 'Newsweek Poll' for candidates who are taller than 195 cm?",
    "sql": "SELECT candidate.Support_rate FROM candidate JOIN people ON candidate.People_ID = people.People_ID WHERE people.Height > 195 AND candidate.Poll_Source = 'Newsweek Poll' ORDER BY candidate.Support_rate DESC LIMIT 1;",
    "table_names": [
      "candidate",
      "people"
    ]
  },
  {
    "id": 786,
    "db_id": "candidate_poll",
    "question": "What is the average height of candidates who had a support rate greater than 0.2 in the Newsweek Poll?",
    "sql": "SELECT AVG(p.Height) FROM candidate c JOIN people p ON c.People_ID = p.People_ID WHERE c.Support_rate > 0.2 AND c.Poll_Source = 'Newsweek Poll';",
    "table_names": [
      "candidate",
      "people"
    ]
  },
  {
    "id": 787,
    "db_id": "candidate_poll",
    "question": "What is the average height of candidates who have a Support_rate equal or greater than 20% according to the Newsweek Poll?",
    "sql": "SELECT AVG(p.Height) FROM candidate AS c JOIN people AS p ON c.People_ID = p.People_ID WHERE c.Support_rate >= 0.2 AND c.Poll_Source = 'Newsweek Poll';",
    "table_names": [
      "candidate",
      "people"
    ]
  },
  {
    "id": 788,
    "db_id": "candidate_poll",
    "question": "What is the name of the candidate with the highest support rate as per the Newsweek Poll?",
    "sql": "SELECT p.Name FROM candidate c JOIN people p ON c.People_ID = p.People_ID WHERE c.Support_rate = (SELECT MAX(Support_rate) FROM candidate WHERE Poll_Source = 'Newsweek Poll');",
    "table_names": [
      "candidate",
      "people"
    ]
  },
  {
    "id": 789,
    "db_id": "candidate_poll",
    "question": "What is the average support rate from polls for candidates whose height is greater than 195 cm?",
    "sql": "SELECT AVG(c.Support_rate) FROM candidate c JOIN people p ON c.People_ID = p.People_ID WHERE p.Height > 195.0;",
    "table_names": [
      "candidate",
      "people"
    ]
  },
  {
    "id": 790,
    "db_id": "candidate_poll",
    "question": "What is the average support rate of candidates whose height is greater than 195 cm?",
    "sql": "SELECT AVG(c.Support_rate) FROM candidate c JOIN people p ON c.People_ID = p.People_ID WHERE p.Height > 195;",
    "table_names": [
      "candidate",
      "people"
    ]
  },
  {
    "id": 791,
    "db_id": "candidate_poll",
    "question": "Who received the highest support rate according to the 'Newsweek Poll' and what was the support rate?",
    "sql": "SELECT p.Name, c.Support_rate FROM candidate c JOIN people p ON c.People_ID = p.People_ID WHERE c.Support_rate = (SELECT MAX(Support_rate) FROM candidate WHERE Poll_Source = 'Newsweek Poll');",
    "table_names": [
      "candidate",
      "people"
    ]
  },
  {
    "id": 792,
    "db_id": "candidate_poll",
    "question": "What is the name, gender, and date of birth of the candidate who received the highest polling support rate?",
    "sql": "SELECT p.Name, p.Sex, p.Date_of_Birth FROM candidate c JOIN people p ON c.People_ID = p.People_ID WHERE c.Support_rate = (SELECT MAX(Support_rate) FROM candidate);",
    "table_names": [
      "candidate",
      "people"
    ]
  },
  {
    "id": 793,
    "db_id": "candidate_poll",
    "question": "Among candidates taller than 195 cm, who had the highest recorded support rate, and what was that rate?",
    "sql": "SELECT p.Name, MAX(c.Support_rate) AS Highest_Support_Rate FROM candidate c JOIN people p ON c.People_ID = p.People_ID WHERE p.Height > 195 GROUP BY p.Name ORDER BY Highest_Support_Rate DESC LIMIT 1;",
    "table_names": [
      "candidate",
      "people"
    ]
  },
  {
    "id": 794,
    "db_id": "candidate_poll",
    "question": "What is the average weight of individuals who have a support rate of at least 20% according to the 'Newsweek Poll'?",
    "sql": "SELECT AVG(p.Weight) FROM candidate c INNER JOIN people p ON c.People_ID = p.People_ID WHERE c.Support_rate >= 0.2 AND c.Poll_Source = 'Newsweek Poll';",
    "table_names": [
      "candidate",
      "people"
    ]
  },
  {
    "id": 795,
    "db_id": "candidate_poll",
    "question": "What are the support rates and poll sources for all candidates taller than 195cm, as measured in the poll conducted from Nov 9â10, 2006?",
    "sql": "SELECT candidate.Support_rate, candidate.Poll_Source FROM candidate JOIN people ON candidate.People_ID = people.People_ID WHERE people.Height > 195.0 AND candidate.Date = 'Nov 9â10, 2006';",
    "table_names": [
      "candidate",
      "people"
    ]
  },
  {
    "id": 796,
    "db_id": "candidate_poll",
    "question": "Who is the tallest candidate among those who received the highest support rate in polls?",
    "sql": "SELECT p.Name, p.Height FROM candidate c JOIN people p ON c.People_ID = p.People_ID WHERE c.Support_rate = (SELECT MAX(Support_rate) FROM candidate);",
    "table_names": [
      "candidate",
      "people"
    ]
  },
  {
    "id": 797,
    "db_id": "movie_1",
    "question": "Which movie director has the highest average rating across all their movies?",
    "sql": "SELECT m.director, AVG(r.stars) AS avg_rating FROM Movie m JOIN Rating r ON m.mID = r.mID GROUP BY m.director ORDER BY avg_rating DESC LIMIT 1;",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 798,
    "db_id": "movie_1",
    "question": "Which movie directed by Steven Spielberg has the highest average rating, and what is that average rating?",
    "sql": "SELECT M.title, AVG(R.stars) as Average_Rating FROM Movie M JOIN Rating R ON M.mID = R.mID WHERE M.director = 'Steven Spielberg' GROUP BY M.title ORDER BY Average_Rating DESC LIMIT 1;",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 799,
    "db_id": "movie_1",
    "question": "What is the average rating for the movies directed by Steven Spielberg?",
    "sql": "SELECT AVG(Rating.stars) FROM Movie JOIN Rating ON Movie.mID = Rating.mID WHERE Movie.director = 'Steven Spielberg';",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 800,
    "db_id": "movie_1",
    "question": "Among Steven Spielberg's movies, which film has the highest average viewer rating?",
    "sql": "SELECT Movie.title, AVG(Rating.stars) AS avg_rating FROM Movie INNER JOIN Rating ON Movie.mID = Rating.mID WHERE Movie.director = 'Steven Spielberg' GROUP BY Movie.title ORDER BY avg_rating DESC LIMIT 1;",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 801,
    "db_id": "movie_1",
    "question": "Who gave a movie the highest rating on a known date and what was the name of this reviewer?",
    "sql": "SELECT Reviewer.name FROM Reviewer INNER JOIN Rating ON Reviewer.rID = Rating.rID WHERE Rating.stars = (SELECT MAX(stars) FROM Rating WHERE ratingDate IS NOT NULL) AND Rating.ratingDate IS NOT NULL;",
    "table_names": [
      "Reviewer",
      "Rating"
    ]
  },
  {
    "id": 802,
    "db_id": "movie_1",
    "question": "Which reviewers gave the highest star rating to the movie with mID 108?",
    "sql": "SELECT Reviewer.name FROM Reviewer JOIN Rating ON Reviewer.rID = Rating.rID WHERE Rating.mID = 108 AND Rating.stars = (SELECT MAX(stars) FROM Rating WHERE mID = 108);",
    "table_names": [
      "Reviewer",
      "Rating"
    ]
  },
  {
    "id": 803,
    "db_id": "movie_1",
    "question": "Which movies received the highest possible rating among ratings that have a rating date recorded, and what are their release years?",
    "sql": "SELECT Movie.title, Movie.year FROM Movie INNER JOIN Rating ON Movie.mID = Rating.mID WHERE Rating.stars = (SELECT MAX(stars) FROM Rating WHERE ratingDate IS NOT NULL) AND Rating.ratingDate IS NOT NULL;",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 804,
    "db_id": "movie_1",
    "question": "List the directors who have directed movies that received a 5-star rating.",
    "sql": "SELECT Movie.director FROM Movie JOIN Rating ON Movie.mID = Rating.mID WHERE Rating.stars = 5 GROUP BY Movie.director HAVING COUNT(DISTINCT Movie.mID) > 0",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 805,
    "db_id": "movie_1",
    "question": "Which director has the highest average movie rating?",
    "sql": "SELECT M.director, AVG(R.stars) AS avg_stars FROM Movie M JOIN Rating R ON M.mID = R.mID WHERE M.director IS NOT NULL GROUP BY M.director ORDER BY avg_stars DESC LIMIT 1;",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 806,
    "db_id": "movie_1",
    "question": "Who is the movie director with the highest average rating across all rated movies?",
    "sql": "SELECT Movie.director, AVG(Rating.stars) as avg_rating FROM Movie JOIN Rating ON Movie.mID = Rating.mID WHERE Movie.director IS NOT NULL GROUP BY Movie.director ORDER BY avg_rating DESC LIMIT 1;",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 807,
    "db_id": "movie_1",
    "question": "Which director of movies made on or after 1980 has the highest average movie rating?",
    "sql": "SELECT Movie.director, AVG(Rating.stars) AS avg_rating FROM Movie JOIN Rating ON Movie.mID = Rating.mID WHERE Movie.year >= 1980 GROUP BY Movie.director ORDER BY avg_rating DESC LIMIT 1;",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 808,
    "db_id": "movie_1",
    "question": "What directors directed movies that received an average rating greater than 3 stars from at least two rating entries?",
    "sql": "SELECT director FROM Movie WHERE mID IN (SELECT mID FROM Rating GROUP BY mID HAVING AVG(stars) > 3 AND COUNT(stars) >= 2);",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 809,
    "db_id": "movie_1",
    "question": "Who is the director after 1980 whose movies received the most ratings in total?",
    "sql": "SELECT Movie.director, COUNT(Rating.stars) AS total_ratings FROM Movie JOIN Rating ON Movie.mID = Rating.mID WHERE Movie.year > 1980 GROUP BY Movie.director ORDER BY total_ratings DESC LIMIT 1;",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 810,
    "db_id": "movie_1",
    "question": "Who directed the movie that has the highest average rating based on given ratings?",
    "sql": "SELECT director FROM Movie WHERE mID = (SELECT mID FROM Rating GROUP BY mID ORDER BY AVG(stars) DESC LIMIT 1);",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 811,
    "db_id": "movie_1",
    "question": "What is the average star rating given by reviewers who reviewed movie ID 108 and have a rating date available?",
    "sql": "SELECT AVG(stars) FROM Rating WHERE rID IN (SELECT DISTINCT rID FROM Rating WHERE mID = 108 AND ratingDate IS NOT NULL);",
    "table_names": [
      "Reviewer",
      "Rating"
    ]
  },
  {
    "id": 812,
    "db_id": "movie_1",
    "question": "Who are the reviewers that rated movie with ID 108 with fewer stars than the average rating of this movie?",
    "sql": "SELECT Reviewer.name FROM Reviewer JOIN Rating ON Reviewer.rID = Rating.rID WHERE Rating.mID = 108 AND Rating.stars < (SELECT AVG(stars) FROM Rating WHERE mID = 108);",
    "table_names": [
      "Reviewer",
      "Rating"
    ]
  },
  {
    "id": 813,
    "db_id": "movie_1",
    "question": "What movies have directors that are also listed as reviewers?",
    "sql": "SELECT M.title FROM Movie M JOIN Reviewer R ON M.director = R.name;",
    "table_names": [
      "Movie",
      "Reviewer"
    ]
  },
  {
    "id": 814,
    "db_id": "movie_1",
    "question": "List the movie titles and release years directed by the person whose name also appears in the reviewer list.",
    "sql": "SELECT title, year FROM Movie WHERE director IN (SELECT name FROM Reviewer);",
    "table_names": [
      "Movie",
      "Reviewer"
    ]
  },
  {
    "id": 815,
    "db_id": "movie_1",
    "question": "What is the average rating for movies directed by James Cameron?",
    "sql": "SELECT AVG(R.stars) FROM Movie M JOIN Rating R ON M.mID = R.mID WHERE M.director = 'James Cameron';",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 816,
    "db_id": "movie_1",
    "question": "Which movie director has the highest average star rating?",
    "sql": "SELECT Movie.director, AVG(Rating.stars) AS average_rating FROM Movie JOIN Rating ON Movie.mID = Rating.mID GROUP BY Movie.director ORDER BY average_rating DESC LIMIT 1;",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 817,
    "db_id": "movie_1",
    "question": "What is the average star rating for the movie 'Raiders of the Lost Ark'?",
    "sql": "SELECT AVG(stars) FROM Rating WHERE mID = (SELECT mID FROM Movie WHERE title = 'Raiders of the Lost Ark');",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 818,
    "db_id": "movie_1",
    "question": "Which movies received more than two ratings with an average star rating higher than 3?",
    "sql": "SELECT title FROM Movie WHERE mID IN (SELECT mID FROM Rating GROUP BY mID HAVING AVG(stars) > 3 AND COUNT(stars) > 2);",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 819,
    "db_id": "movie_1",
    "question": "Which director has movies with the highest average rating overall?",
    "sql": "SELECT Movie.director, AVG(Rating.stars) AS avg_rating FROM Movie JOIN Rating ON Movie.mID = Rating.mID WHERE Movie.director IS NOT NULL GROUP BY Movie.director ORDER BY avg_rating DESC LIMIT 1;",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 820,
    "db_id": "movie_1",
    "question": "Which director's movies have the highest average star ratings?",
    "sql": "SELECT director, AVG(stars) AS avg_rating FROM Movie JOIN Rating ON Movie.mID = Rating.mID WHERE director IS NOT NULL GROUP BY director ORDER BY avg_rating DESC LIMIT 1;",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 821,
    "db_id": "movie_1",
    "question": "Which director has the highest average rating for movies released since 1980?",
    "sql": "SELECT Movie.director, AVG(Rating.stars) AS avg_rating FROM Movie JOIN Rating ON Movie.mID = Rating.mID WHERE Movie.year >= 1980 GROUP BY Movie.director ORDER BY avg_rating DESC LIMIT 1;",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 822,
    "db_id": "movie_1",
    "question": "What are the titles of movies whose average ratings exceed 3.5, ordered by year from newest to oldest?",
    "sql": "SELECT title FROM Movie WHERE mID IN (SELECT mID FROM Rating GROUP BY mID HAVING AVG(stars) > 3.5) ORDER BY year DESC;",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 823,
    "db_id": "movie_1",
    "question": "Which director has directed the highest average rated movies where ratings were at least 3 stars?",
    "sql": "SELECT Movie.director, AVG(Rating.stars) AS average_rating FROM Movie INNER JOIN Rating ON Movie.mID = Rating.mID WHERE Rating.stars >= 3 GROUP BY Movie.director ORDER BY average_rating DESC LIMIT 1;",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 824,
    "db_id": "movie_1",
    "question": "What is the average rating given to movies directed by James Cameron?",
    "sql": "SELECT AVG(R.stars) AS avg_rating FROM Movie M JOIN Rating R ON M.mID = R.mID WHERE M.director = 'James Cameron';",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 825,
    "db_id": "movie_1",
    "question": "What are the titles of movies that have ratings without a recorded rating date?",
    "sql": "SELECT title FROM Movie WHERE mID IN (SELECT mID FROM Rating WHERE ratingDate IS NULL);",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 826,
    "db_id": "movie_1",
    "question": "What is the average star rating of all movies directed by Steven Spielberg?",
    "sql": "SELECT AVG(R.stars) FROM Rating R JOIN Movie M ON R.mID = M.mID WHERE M.director = 'Steven Spielberg';",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 827,
    "db_id": "movie_1",
    "question": "Which movies have an average star rating higher than the average rating of the movie 'Gone with the Wind'?",
    "sql": "SELECT title FROM Movie WHERE mID IN (SELECT mID FROM Rating GROUP BY mID HAVING AVG(stars) > (SELECT AVG(stars) FROM Rating WHERE mID = (SELECT mID FROM Movie WHERE title = 'Gone with the Wind')));",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 828,
    "db_id": "movie_1",
    "question": "What is the average star rating for movies directed by Steven Spielberg?",
    "sql": "SELECT AVG(Rating.stars) FROM Rating JOIN Movie ON Rating.mID = Movie.mID WHERE Movie.director = 'Steven Spielberg';",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 829,
    "db_id": "movie_1",
    "question": "Among directors who made films after 1980, which director has the highest average star rating?",
    "sql": "SELECT M.director, AVG(R.stars) AS AvgRating FROM Movie M INNER JOIN Rating R ON M.mID = R.mID WHERE M.year > 1980 GROUP BY M.director ORDER BY AvgRating DESC LIMIT 1;",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 830,
    "db_id": "movie_1",
    "question": "Who directed the movie that received the highest number of stars in ratings given specifically on '2011-01-20'?",
    "sql": "SELECT Movie.director FROM Movie JOIN Rating ON Movie.mID = Rating.mID WHERE Rating.stars = (SELECT MAX(stars) FROM Rating WHERE ratingDate = '2011-01-20') AND Rating.ratingDate = '2011-01-20';",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 831,
    "db_id": "movie_1",
    "question": "List the titles of movies directed by Steven Spielberg that received more than 2 stars.",
    "sql": "SELECT Movie.title FROM Movie JOIN Rating ON Movie.mID = Rating.mID WHERE Movie.director = 'Steven Spielberg' AND Rating.stars > 2;",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 832,
    "db_id": "movie_1",
    "question": "What is the average star rating of movies directed by Steven Spielberg?",
    "sql": "SELECT AVG(R.stars) FROM Movie M JOIN Rating R ON M.mID = R.mID WHERE M.director = 'Steven Spielberg';",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 833,
    "db_id": "movie_1",
    "question": "Which reviewer gave the highest average star rating for movies rated between January 1, 2011, and January 20, 2011?",
    "sql": "SELECT Reviewer.name, AVG(Rating.stars) as avg_rating FROM Reviewer JOIN Rating ON Reviewer.rID = Rating.rID WHERE Rating.ratingDate BETWEEN '2011-01-01' AND '2011-01-20' GROUP BY Reviewer.name ORDER BY avg_rating DESC LIMIT 1;",
    "table_names": [
      "Reviewer",
      "Rating"
    ]
  },
  {
    "id": 834,
    "db_id": "movie_1",
    "question": "What are the names of reviewers who have given ratings higher than 3 stars without a specific rating date?",
    "sql": "SELECT name FROM Reviewer WHERE rID IN (SELECT rID FROM Rating WHERE stars > 3 AND ratingDate IS NULL);",
    "table_names": [
      "Reviewer",
      "Rating"
    ]
  },
  {
    "id": 835,
    "db_id": "movie_1",
    "question": "Which reviewer has the highest average rating among those providing two or more ratings with valid rating dates?",
    "sql": "SELECT Reviewer.name, AVG(Rating.stars) AS average_rating FROM Reviewer JOIN Rating ON Reviewer.rID = Rating.rID WHERE Rating.ratingDate IS NOT NULL GROUP BY Reviewer.name HAVING COUNT(Rating.stars) >= 2 ORDER BY average_rating DESC LIMIT 1;",
    "table_names": [
      "Reviewer",
      "Rating"
    ]
  },
  {
    "id": 836,
    "db_id": "movie_1",
    "question": "Which reviewer gave the highest rating for the movie with ID 108?",
    "sql": "SELECT Reviewer.name FROM Reviewer JOIN Rating ON Reviewer.rID = Rating.rID WHERE Rating.mID = 108 AND Rating.stars = (SELECT MAX(stars) FROM Rating WHERE mID = 108);",
    "table_names": [
      "Reviewer",
      "Rating"
    ]
  },
  {
    "id": 837,
    "db_id": "movie_1",
    "question": "What is the name of reviewers who have given movie ratings of 4 or more stars without specifying the rating date?",
    "sql": "SELECT Reviewer.name FROM Reviewer INNER JOIN Rating ON Reviewer.rID = Rating.rID WHERE Rating.stars >= 4 AND Rating.ratingDate IS NULL;",
    "table_names": [
      "Reviewer",
      "Rating"
    ]
  },
  {
    "id": 838,
    "db_id": "movie_1",
    "question": "Which reviewers have given an average rating of at least 3.5 to movies, considering only the ratings made between January 10, 2011 and January 30, 2011?",
    "sql": "SELECT Reviewer.name, AVG(Rating.stars) as avg_rating FROM Reviewer JOIN Rating ON Reviewer.rID = Rating.rID WHERE Rating.ratingDate >= '2011-01-10' AND Rating.ratingDate <= '2011-01-30' GROUP BY Reviewer.name HAVING AVG(Rating.stars) >= 3.5;",
    "table_names": [
      "Reviewer",
      "Rating"
    ]
  },
  {
    "id": 839,
    "db_id": "movie_1",
    "question": "Which reviewers gave multiple ratings between January 10, 2011 and January 25, 2011, and what was their average star rating during this period?",
    "sql": "SELECT Reviewer.name, AVG(Rating.stars) AS AvgRating FROM Reviewer JOIN Rating ON Reviewer.rID = Rating.rID WHERE Rating.ratingDate BETWEEN '2011-01-10' AND '2011-01-25' GROUP BY Reviewer.name HAVING COUNT(Rating.stars) > 1;",
    "table_names": [
      "Reviewer",
      "Rating"
    ]
  },
  {
    "id": 840,
    "db_id": "movie_1",
    "question": "Who are the reviewers who gave the highest possible rating to the movie with mID 101?",
    "sql": "SELECT Reviewer.name FROM Reviewer JOIN Rating ON Reviewer.rID = Rating.rID WHERE Rating.stars = (SELECT MAX(stars) FROM Rating WHERE mID = 101) AND Rating.mID = 101;",
    "table_names": [
      "Reviewer",
      "Rating"
    ]
  },
  {
    "id": 841,
    "db_id": "movie_1",
    "question": "Which movies have ratings without a rating date?",
    "sql": "SELECT Movie.title FROM Movie JOIN Rating ON Movie.mID = Rating.mID WHERE Rating.ratingDate IS NULL;",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 842,
    "db_id": "movie_1",
    "question": "What is the average rating of movies directed by Steven Spielberg?",
    "sql": "SELECT AVG(R.stars) FROM Movie M JOIN Rating R ON M.mID = R.mID WHERE M.director = 'Steven Spielberg';",
    "table_names": [
      "Movie",
      "Rating"
    ]
  },
  {
    "id": 843,
    "db_id": "county_public_safety",
    "question": "What is the average percentage of Black residents in cities located within counties that have a crime rate higher than 150.0?",
    "sql": "SELECT AVG(c.Black) FROM city c JOIN county_public_safety cps ON c.County_ID = cps.County_ID WHERE cps.Crime_rate > 150.0;",
    "table_names": [
      "county_public_safety",
      "city"
    ]
  },
  {
    "id": 844,
    "db_id": "county_public_safety",
    "question": "What is the average crime rate in counties that have cities with a Black population percentage greater than 10%?",
    "sql": "SELECT AVG(cp.Crime_rate) FROM county_public_safety cp JOIN city c ON cp.County_ID = c.County_ID WHERE c.Black > 10.0;",
    "table_names": [
      "county_public_safety",
      "city"
    ]
  },
  {
    "id": 845,
    "db_id": "county_public_safety",
    "question": "What is the name and case burden of the county which has the city with the highest percentage of Asian population?",
    "sql": "SELECT cps.Name, cps.Case_burden FROM county_public_safety cps JOIN city c ON cps.County_ID = c.County_ID WHERE c.Asian = (SELECT MAX(Asian) FROM city);",
    "table_names": [
      "county_public_safety",
      "city"
    ]
  },
  {
    "id": 846,
    "db_id": "county_public_safety",
    "question": "Which county served by RCMP has the highest crime rate among counties with at least one city having a Black population percentage over 20%?",
    "sql": "SELECT county_public_safety.Name, county_public_safety.Crime_rate FROM county_public_safety INNER JOIN city ON county_public_safety.County_ID = city.County_ID WHERE city.Black > 20 AND county_public_safety.Police_force = 'RCMP' ORDER BY county_public_safety.Crime_rate DESC LIMIT 1;",
    "table_names": [
      "county_public_safety",
      "city"
    ]
  },
  {
    "id": 847,
    "db_id": "county_public_safety",
    "question": "Which county has the highest crime rate among those counties that contain at least one city with a Hispanic population greater than 99.3%?",
    "sql": "SELECT county_public_safety.Name AS County_Name, county_public_safety.Crime_rate FROM county_public_safety JOIN city ON county_public_safety.County_ID = city.County_ID WHERE city.Hispanic > 99.3 ORDER BY county_public_safety.Crime_rate DESC LIMIT 1;",
    "table_names": [
      "county_public_safety",
      "city"
    ]
  },
  {
    "id": 848,
    "db_id": "county_public_safety",
    "question": "Which county has the highest percentage of Black population in any of its cities, and what is its police force?",
    "sql": "SELECT cps.Name AS County_Name, cps.Police_force, MAX(city.Black) AS Highest_Black_Pop_Percentage FROM county_public_safety cps JOIN city ON cps.County_ID = city.County_ID GROUP BY cps.County_ID ORDER BY Highest_Black_Pop_Percentage DESC LIMIT 1;",
    "table_names": [
      "county_public_safety",
      "city"
    ]
  },
  {
    "id": 849,
    "db_id": "county_public_safety",
    "question": "Which cities have a Black population greater than 10% and are located in counties that use RCMP as their police force?",
    "sql": "SELECT c.Name FROM county_public_safety cps JOIN city c ON cps.County_ID = c.County_ID WHERE cps.Police_force = 'RCMP' AND c.Black > 10;",
    "table_names": [
      "county_public_safety",
      "city"
    ]
  },
  {
    "id": 850,
    "db_id": "county_public_safety",
    "question": "Among the counties located in the East, which county has the highest crime rate and contains at least one city with the Hispanic population higher than 99.3%?",
    "sql": "SELECT cps.Name, cps.Crime_rate FROM county_public_safety AS cps JOIN city AS c ON cps.County_ID = c.County_ID WHERE c.Hispanic > 99.3 AND cps.Location = 'East' ORDER BY cps.Crime_rate DESC LIMIT 1;",
    "table_names": [
      "county_public_safety",
      "city"
    ]
  },
  {
    "id": 851,
    "db_id": "county_public_safety",
    "question": "What is the average crime rate in counties that contain cities with a Black population greater than 20%?",
    "sql": "SELECT AVG(cps.Crime_rate) FROM county_public_safety cps JOIN city c ON cps.County_ID = c.County_ID WHERE c.Black > 20.0;",
    "table_names": [
      "county_public_safety",
      "city"
    ]
  },
  {
    "id": 852,
    "db_id": "county_public_safety",
    "question": "Which counties have cities with a Black population percentage greater than 20% and a crime rate higher than 150.0?",
    "sql": "SELECT cps.Name FROM county_public_safety cps JOIN city c ON cps.County_ID = c.County_ID WHERE c.Black > 20.0 AND cps.Crime_rate > 150.0;",
    "table_names": [
      "county_public_safety",
      "city"
    ]
  },
  {
    "id": 853,
    "db_id": "county_public_safety",
    "question": "Which counties have a crime rate higher than 160 and include cities with less than 75% White population?",
    "sql": "SELECT cp.Name FROM county_public_safety cp JOIN city c ON cp.County_ID = c.County_ID WHERE c.White < 75 AND cp.Crime_rate > 160;",
    "table_names": [
      "county_public_safety",
      "city"
    ]
  },
  {
    "id": 854,
    "db_id": "county_public_safety",
    "question": "What is the average crime rate of counties containing cities with Hispanic population percentage higher than 99.3?",
    "sql": "SELECT AVG(cp.Crime_rate) FROM county_public_safety cp JOIN city c ON cp.County_ID = c.County_ID WHERE c.Hispanic > 99.3;",
    "table_names": [
      "county_public_safety",
      "city"
    ]
  },
  {
    "id": 880,
    "db_id": "party_host",
    "question": "What are the names and ages of hosts who are the main in-charge of parties that also have at least one host who is not the main in-charge?",
    "sql": "SELECT Name, Age FROM host WHERE Host_ID IN (SELECT Host_ID FROM party_host WHERE Party_ID IN (SELECT Party_ID FROM party_host WHERE Is_Main_in_Charge = 'F') AND Is_Main_in_Charge = 'T');",
    "table_names": [
      "host",
      "party_host"
    ]
  },
  {
    "id": 881,
    "db_id": "party_host",
    "question": "How many different nationalities do hosts have who are listed as the main person in charge of parties?",
    "sql": "SELECT COUNT(DISTINCT host.Nationality) FROM host JOIN party_host ON host.Host_ID = party_host.Host_ID WHERE party_host.Is_Main_in_Charge = 'T';",
    "table_names": [
      "host",
      "party_host"
    ]
  },
  {
    "id": 882,
    "db_id": "storm_record",
    "question": "What region had the highest number of cities affected by any storm, and how many cities were affected?",
    "sql": "SELECT r.Region_name, ar.Number_city_affected FROM region r JOIN affected_region ar ON r.Region_id = ar.Region_id WHERE ar.Number_city_affected = (SELECT MAX(Number_city_affected) FROM affected_region);",
    "table_names": [
      "region",
      "affected_region"
    ]
  },
  {
    "id": 883,
    "db_id": "storm_record",
    "question": "List the names of regions where storms affected more than 20 cities.",
    "sql": "SELECT region.Region_name FROM region JOIN affected_region ON region.Region_id = affected_region.Region_id WHERE affected_region.Number_city_affected > 20;",
    "table_names": [
      "region",
      "affected_region"
    ]
  },
  {
    "id": 884,
    "db_id": "storm_record",
    "question": "Which region has the highest total number of cities affected across all storms?",
    "sql": "SELECT r.Region_name FROM region r JOIN affected_region a ON r.Region_id = a.Region_id GROUP BY r.Region_name ORDER BY SUM(a.Number_city_affected) DESC LIMIT 1;",
    "table_names": [
      "region",
      "affected_region"
    ]
  },
  {
    "id": 885,
    "db_id": "storm_record",
    "question": "How many total cities have been affected by storms in Afghanistan?",
    "sql": "SELECT r.Region_name, SUM(ar.Number_city_affected) AS Total_Cities_Affected FROM region r JOIN affected_region ar ON r.Region_id = ar.Region_id WHERE r.Region_name = 'Afghanistan' GROUP BY r.Region_name;",
    "table_names": [
      "region",
      "affected_region"
    ]
  },
  {
    "id": 886,
    "db_id": "storm_record",
    "question": "Which storm affected the greatest number of cities and exactly how many cities were affected by it?",
    "sql": "SELECT s.Name, SUM(a.Number_city_affected) FROM storm s JOIN affected_region a ON s.Storm_ID = a.Storm_ID GROUP BY s.Name ORDER BY SUM(a.Number_city_affected) DESC LIMIT 1;",
    "table_names": [
      "storm",
      "affected_region"
    ]
  },
  {
    "id": 887,
    "db_id": "storm_record",
    "question": "Which storm affected the highest total number of cities across all regions?",
    "sql": "SELECT s.Name FROM storm s JOIN affected_region ar ON s.Storm_ID = ar.Storm_ID GROUP BY s.Name ORDER BY SUM(ar.Number_city_affected) DESC LIMIT 1;",
    "table_names": [
      "storm",
      "affected_region"
    ]
  },
  {
    "id": 888,
    "db_id": "storm_record",
    "question": "What is the maximum number of cities affected by any storm having a maximum speed less than 980?",
    "sql": "SELECT MAX(a.Number_city_affected) FROM affected_region a JOIN storm s ON a.Storm_ID = s.Storm_ID WHERE s.Max_speed < 980;",
    "table_names": [
      "storm",
      "affected_region"
    ]
  },
  {
    "id": 889,
    "db_id": "storm_record",
    "question": "What is the name of the storm that affected the largest number of cities?",
    "sql": "SELECT storm.Name FROM storm JOIN affected_region ON storm.Storm_ID = affected_region.Storm_ID WHERE affected_region.Number_city_affected = (SELECT MAX(Number_city_affected) FROM affected_region);",
    "table_names": [
      "storm",
      "affected_region"
    ]
  },
  {
    "id": 890,
    "db_id": "storm_record",
    "question": "Which storms affected more than 20 cities and had a maximum speed below 970?",
    "sql": "SELECT storm.Name FROM storm JOIN affected_region ON storm.Storm_ID = affected_region.Storm_ID WHERE affected_region.Number_city_affected > 20 AND storm.Max_speed < 970;",
    "table_names": [
      "storm",
      "affected_region"
    ]
  },
  {
    "id": 891,
    "db_id": "storm_record",
    "question": "Which storm affected the highest number of cities according to the available data?",
    "sql": "SELECT s.Name FROM storm s JOIN affected_region ar ON s.Storm_ID = ar.Storm_ID WHERE ar.Number_city_affected = (SELECT MAX(Number_city_affected) FROM affected_region);",
    "table_names": [
      "storm",
      "affected_region"
    ]
  },
  {
    "id": 892,
    "db_id": "storm_record",
    "question": "Which storm affected the highest total number of cities, and how many deaths did this storm cause?",
    "sql": "SELECT s.Name, SUM(ar.Number_city_affected) as Total_affected_cities, s.Number_Deaths FROM storm s JOIN affected_region ar ON s.Storm_ID = ar.Storm_ID GROUP BY s.Storm_ID ORDER BY Total_affected_cities DESC LIMIT 1",
    "table_names": [
      "storm",
      "affected_region"
    ]
  },
  {
    "id": 893,
    "db_id": "storm_record",
    "question": "How many total cities were affected by storms which caused more than 5 deaths?",
    "sql": "SELECT SUM(ar.Number_city_affected) AS total_cities_affected FROM storm s JOIN affected_region ar ON s.Storm_ID = ar.Storm_ID WHERE s.Number_Deaths > 5;",
    "table_names": [
      "storm",
      "affected_region"
    ]
  },
  {
    "id": 894,
    "db_id": "storm_record",
    "question": "What is the name of the storm that affected the maximum number of cities?",
    "sql": "SELECT s.Name FROM storm s JOIN affected_region ar ON s.Storm_ID = ar.Storm_ID WHERE ar.Number_city_affected = (SELECT MAX(Number_city_affected) FROM affected_region);",
    "table_names": [
      "storm",
      "affected_region"
    ]
  },
  {
    "id": 895,
    "db_id": "storm_record",
    "question": "What is the total number of cities affected by storms that had a maximum speed of less than 980?",
    "sql": "SELECT SUM(af.Number_city_affected) FROM affected_region af JOIN storm s ON af.Storm_ID = s.Storm_ID WHERE s.Max_speed < 980;",
    "table_names": [
      "storm",
      "affected_region"
    ]
  },
  {
    "id": 896,
    "db_id": "storm_record",
    "question": "Among Afghanistan, Albania, and Czech Republic, which region experienced the greatest total number of cities affected by storms?",
    "sql": "SELECT r.Region_name, SUM(ar.Number_city_affected) AS Total_affected_cities FROM region r JOIN affected_region ar ON r.Region_id = ar.Region_id WHERE r.Region_name IN ('Afghanistan', 'Albania', 'Czech Republic') GROUP BY r.Region_name ORDER BY Total_affected_cities DESC LIMIT 1;",
    "table_names": [
      "region",
      "affected_region"
    ]
  },
  {
    "id": 897,
    "db_id": "storm_record",
    "question": "Which region had the highest number of cities affected in a single storm event?",
    "sql": "SELECT r.Region_name FROM region r JOIN affected_region ar ON r.Region_id = ar.Region_id WHERE ar.Number_city_affected = (SELECT MAX(Number_city_affected) FROM affected_region)",
    "table_names": [
      "region",
      "affected_region"
    ]
  },
  {
    "id": 898,
    "db_id": "election",
    "question": "What is the name of the county with the highest population that has at least one delegate first elected before the year 2000?",
    "sql": "SELECT c.County_name, SUM(c.Population) as Total_Population FROM county c JOIN election e ON c.Zip_code = CONCAT('D', LPAD(e.District, 2, '0')) WHERE e.First_Elected < 2000 GROUP BY c.County_name HAVING COUNT(e.Election_ID) >= 1 ORDER BY Total_Population DESC LIMIT 1;",
    "table_names": [
      "county",
      "election"
    ]
  },
  {
    "id": 899,
    "db_id": "election",
    "question": "What is the total population of counties represented by delegates who are members of the 'Appropriations' committee?",
    "sql": "SELECT SUM(county.Population) FROM county JOIN election ON county.Zip_code = CONCAT('D', LPAD(election.District, 2, '0')) WHERE election.Committee = 'Appropriations';",
    "table_names": [
      "county",
      "election"
    ]
  },
  {
    "id": 900,
    "db_id": "election",
    "question": "What is the average population of counties whose zip codes correspond to election districts represented by delegates first elected before the year 2000?",
    "sql": "SELECT AVG(c.Population) FROM county c JOIN election e ON c.Zip_code = CONCAT('D', LPAD(e.District, 2, '0')) WHERE e.First_Elected < 2000;",
    "table_names": [
      "county",
      "election"
    ]
  },
  {
    "id": 901,
    "db_id": "election",
    "question": "What are the names of the Committees for Elections representing counties with a population greater than 80,000 and delegates first elected before the year 2000?",
    "sql": "SELECT election.Committee FROM election JOIN county ON election.District = county.County_Id WHERE county.Population > 80000 AND election.First_Elected < 2000;",
    "table_names": [
      "county",
      "election"
    ]
  },
  {
    "id": 902,
    "db_id": "election",
    "question": "What is the average population of counties whose zip code matches election districts that have delegates in the Appropriations committee?",
    "sql": "SELECT AVG(c.Population) FROM county c JOIN election e ON c.Zip_code = CONCAT('D', LPAD(e.District, 2, '0')) WHERE e.Committee = 'Appropriations';",
    "table_names": [
      "county",
      "election"
    ]
  },
  {
    "id": 903,
    "db_id": "election",
    "question": "Which county has the highest total population among counties that belong to election districts represented by delegates from party 1?",
    "sql": "SELECT county.County_name, SUM(county.Population) AS total_population FROM county JOIN election ON county.Zip_code = CONCAT('D', LPAD(election.District, 2, '0')) WHERE election.Party = 1 GROUP BY county.County_name ORDER BY total_population DESC LIMIT 1;",
    "table_names": [
      "county",
      "election"
    ]
  },
  {
    "id": 904,
    "db_id": "election",
    "question": "Which counties with population greater than 20,000 are represented by delegates first elected before the year 2000, and what committees are these delegates part of?",
    "sql": "SELECT county.County_name, election.Committee FROM county JOIN election ON county.Zip_code = CONCAT('D', LPAD(election.District, 2, '0')) WHERE county.Population > 20000 AND election.First_Elected < 2000;",
    "table_names": [
      "county",
      "election"
    ]
  },
  {
    "id": 905,
    "db_id": "election",
    "question": "Which county has the highest total population among counties represented by delegates whose committee is 'Appropriations'?",
    "sql": "SELECT c.County_name, SUM(c.Population) AS Total_Population FROM county c JOIN election e ON c.Zip_code = CONCAT('D', LPAD(e.District, 2, '0')) WHERE e.Committee LIKE '%Appropriations%' GROUP BY c.County_name ORDER BY Total_Population DESC LIMIT 1;",
    "table_names": [
      "county",
      "election"
    ]
  },
  {
    "id": 906,
    "db_id": "election",
    "question": "Who was the delegate serving on the 'Ways and Means' committee elected from the party whose Attorney General candidate was Andrew Cuomo in the 2006 election, and in which year were they first elected?",
    "sql": "SELECT election.Delegate, election.First_Elected FROM election JOIN party ON election.Party = party.Party_ID WHERE party.Attorney_General = 'Andrew Cuomo' AND party.Year = 2006 AND election.Committee = 'Ways and Means';",
    "table_names": [
      "party",
      "election"
    ]
  },
  {
    "id": 907,
    "db_id": "election",
    "question": "Who was the delegate representing the 'Working Families' party in 2006 that served on the Ways and Means committee?",
    "sql": "SELECT e.Delegate FROM election e JOIN party p ON e.Party = p.Party_ID WHERE p.Party = 'Working Families' AND p.Year = 2006.0 AND e.Committee = 'Ways and Means';",
    "table_names": [
      "party",
      "election"
    ]
  },
  {
    "id": 908,
    "db_id": "election",
    "question": "What are the names and committees of delegates associated with the political party that nominated Jeanine Pirro as attorney general in the 2006 election?",
    "sql": "SELECT e.Delegate, e.Committee FROM election e JOIN party p ON e.Party = p.Party_ID WHERE p.Year = 2006 AND p.Attorney_General = 'Jeanine Pirro';",
    "table_names": [
      "party",
      "election"
    ]
  },
  {
    "id": 909,
    "db_id": "election",
    "question": "Who are the delegates first elected in 1994 belonging to the party whose governor candidate was Eliot Spitzer? Provide their names, year first elected, and committee.",
    "sql": "SELECT e.Delegate, e.First_Elected, e.Committee FROM election e INNER JOIN party p ON e.Party = p.Party_ID WHERE p.Governor = 'Eliot Spitzer' AND e.First_Elected = 1994.0",
    "table_names": [
      "party",
      "election"
    ]
  },
  {
    "id": 910,
    "db_id": "election",
    "question": "List the delegates, along with their committees and the year first elected, who belong to the party for which Andrew Cuomo was Attorney General and were first elected before the year 2000.",
    "sql": "SELECT e.Delegate, e.Committee, e.First_Elected FROM election e JOIN party p ON e.Party = p.Party_ID WHERE p.Attorney_General = 'Andrew Cuomo' AND e.First_Elected < 2000;",
    "table_names": [
      "party",
      "election"
    ]
  },
  {
    "id": 911,
    "db_id": "election",
    "question": "Who was the delegate serving on the 'Ways and Means' committee representing a party whose Attorney General candidate was Andrew Cuomo in the year 2006?",
    "sql": "SELECT election.Delegate FROM election JOIN party ON election.Party = party.Party_ID WHERE party.Year = 2006 AND party.Attorney_General = 'Andrew Cuomo' AND election.Committee = 'Ways and Means';",
    "table_names": [
      "party",
      "election"
    ]
  },
  {
    "id": 912,
    "db_id": "election",
    "question": "Who was the delegate serving on the 'Ways and Means' committee representing the party whose governor candidate was Eliot Spitzer in 2006?",
    "sql": "SELECT e.Delegate FROM election e JOIN party p ON e.Party = p.Party_ID WHERE p.Year = 2006 AND p.Governor = 'Eliot Spitzer' AND e.Committee = 'Ways and Means';",
    "table_names": [
      "party",
      "election"
    ]
  },
  {
    "id": 913,
    "db_id": "election",
    "question": "Who were the delegates on the Appropriations committee and who was the governor candidate from their party in the year 2002?",
    "sql": "SELECT e.Delegate, e.First_Elected, p.Governor FROM election e JOIN party p ON e.Party = p.Party_ID WHERE e.Committee = 'Appropriations' AND p.Year = 2002.0;",
    "table_names": [
      "party",
      "election"
    ]
  },
  {
    "id": 914,
    "db_id": "election",
    "question": "Who is the delegate representing the county with Zip code D09 and what is the name and population of this county?",
    "sql": "SELECT county.County_name, county.Population, election.Delegate FROM county JOIN election ON county.Zip_code = 'D09' AND election.District = county.County_Id;",
    "table_names": [
      "county",
      "election"
    ]
  },
  {
    "id": 915,
    "db_id": "election",
    "question": "List the delegates serving on the Appropriations committee who represent districts corresponding to counties with populations greater than 50,000.",
    "sql": "SELECT election.Delegate FROM county INNER JOIN election ON county.Zip_code = CONCAT('D', LPAD(election.District, 2, '0')) WHERE county.Population > 50000 AND election.Committee LIKE '%Appropriations%';",
    "table_names": [
      "county",
      "election"
    ]
  },
  {
    "id": 916,
    "db_id": "election",
    "question": "Who are the delegates from the Democratic party who served on the Appropriations committee in the election year 2006?",
    "sql": "SELECT e.Delegate FROM election e JOIN party p ON e.Party = p.Party_ID WHERE p.Party = 'Democratic' AND e.Committee = 'Appropriations' AND p.Year = 2006.0;",
    "table_names": [
      "party",
      "election"
    ]
  },
  {
    "id": 917,
    "db_id": "election",
    "question": "List the delegates and their respective committees for elections held since the year 2000 whose affiliated party had Eliot Spitzer as Attorney General candidate.",
    "sql": "SELECT e.Delegate, e.Committee FROM election e JOIN party p ON e.Party = p.Party_ID WHERE e.First_Elected >= 2000 AND p.Attorney_General = 'Eliot Spitzer';",
    "table_names": [
      "party",
      "election"
    ]
  },
  {
    "id": 918,
    "db_id": "election",
    "question": "What is the average population of the counties represented by delegates first elected before the year 2000?",
    "sql": "SELECT AVG(county.Population) FROM county JOIN election ON county.Zip_code = CONCAT('D', LPAD(election.District, 2, '0')) WHERE election.First_Elected < 2000;",
    "table_names": [
      "county",
      "election"
    ]
  },
  {
    "id": 919,
    "db_id": "election",
    "question": "Which county has the highest total population among counties represented by delegates serving in the 'Appropriations' committee?",
    "sql": "SELECT c.County_name, SUM(c.Population) as Total_Population FROM county c JOIN election e ON c.Zip_code = CONCAT('D', LPAD(e.District, 2, '0')) WHERE e.Committee = 'Appropriations' GROUP BY c.County_name ORDER BY Total_Population DESC LIMIT 1;",
    "table_names": [
      "county",
      "election"
    ]
  },
  {
    "id": 920,
    "db_id": "election",
    "question": "How many delegates in the 2006 Democratic Party were elected before 2006?",
    "sql": "SELECT COUNT(e.Delegate) FROM election e JOIN party p ON e.Party = p.Party_ID WHERE p.Party = 'Democratic' AND p.Year = 2006 AND e.First_Elected < p.Year;",
    "table_names": [
      "party",
      "election"
    ]
  },
  {
    "id": 921,
    "db_id": "election",
    "question": "Which delegates serving on the Appropriations committee belong to parties whose candidate for governor was Eliot Spitzer?",
    "sql": "SELECT DISTINCT e.Delegate FROM election e JOIN party p ON e.Party = p.Party_ID WHERE p.Governor = 'Eliot Spitzer' AND e.Committee = 'Appropriations';",
    "table_names": [
      "party",
      "election"
    ]
  },
  {
    "id": 922,
    "db_id": "election",
    "question": "In the year that Eliot Spitzer ran for governor, who was the delegate from district 3, and what was their committee?",
    "sql": "SELECT e.Delegate, e.Committee FROM election e INNER JOIN party p ON e.Party = p.Party_ID WHERE p.Year = 2006 AND p.Governor = 'Eliot Spitzer' AND e.District = 3;",
    "table_names": [
      "party",
      "election"
    ]
  },
  {
    "id": 923,
    "db_id": "election",
    "question": "How many distinct delegates from the 'Democratic' party in the 2006 election were first elected to office before the year 2000?",
    "sql": "SELECT COUNT(DISTINCT e.Delegate) FROM election e INNER JOIN party p ON e.Party = p.Party_ID WHERE p.Party = 'Democratic' AND p.Year = 2006.0 AND e.First_Elected < 2000.0;",
    "table_names": [
      "party",
      "election"
    ]
  },
  {
    "id": 924,
    "db_id": "election",
    "question": "Which delegates and their respective committees belong to the political parties that had Eliot Spitzer as nominee for Governor in the year 2006?",
    "sql": "SELECT e.Delegate, e.Committee FROM election e JOIN party p ON e.Party = p.Party_ID WHERE p.Governor = 'Eliot Spitzer' AND p.Year = 2006.0;",
    "table_names": [
      "party",
      "election"
    ]
  },
  {
    "id": 925,
    "db_id": "election",
    "question": "Who were the delegates serving on the Appropriations committee, and who was their party's Attorney General candidate in the year 2006?",
    "sql": "SELECT e.Delegate, p.Attorney_General FROM election e JOIN party p ON e.Party = p.Party_ID WHERE e.Committee = 'Appropriations' AND p.Year = 2006.0;",
    "table_names": [
      "party",
      "election"
    ]
  },
  {
    "id": 926,
    "db_id": "election",
    "question": "Who was the governor candidate from the party associated with the delegate serving on the 'Ways and Means' committee in the 2006 election?",
    "sql": "SELECT DISTINCT p.Governor FROM party p JOIN election e ON p.Party_ID = e.Party WHERE p.Year = 2006 AND e.Committee = 'Ways and Means';",
    "table_names": [
      "party",
      "election"
    ]
  },
  {
    "id": 927,
    "db_id": "election",
    "question": "Who was the delegate representing district 3, and who was the Attorney General candidate for the delegate's party in the 2006 election?",
    "sql": "SELECT e.Delegate, p.Attorney_General FROM election e JOIN party p ON e.Party = p.Party_ID WHERE e.District = 3 AND p.Year = 2006;",
    "table_names": [
      "party",
      "election"
    ]
  },
  {
    "id": 928,
    "db_id": "news_report",
    "question": "Which journalists older than 40 have worked as hosts?",
    "sql": "SELECT Name FROM journalist WHERE journalist_ID IN (SELECT journalist_ID FROM news_report WHERE Work_Type = 'Host') AND Age > 40;",
    "table_names": [
      "journalist",
      "news_report"
    ]
  },
  {
    "id": 929,
    "db_id": "news_report",
    "question": "Which journalists with more than 10 years of experience have reported news related to music events?",
    "sql": "SELECT journalist.Name FROM journalist JOIN news_report ON journalist.journalist_ID = news_report.journalist_ID WHERE news_report.Work_Type = 'Music' AND journalist.Years_working > 10;",
    "table_names": [
      "journalist",
      "news_report"
    ]
  },
  {
    "id": 931,
    "db_id": "restaurant_1",
    "question": "What is the average amount spent by students at restaurants with ratings higher than 3?",
    "sql": "SELECT AVG(VR.Spent) FROM Visits_Restaurant VR JOIN Restaurant R ON VR.ResID = R.ResID WHERE R.Rating > 3;",
    "table_names": [
      "Restaurant",
      "Visits_Restaurant"
    ]
  },
  {
    "id": 933,
    "db_id": "customer_deliveries",
    "question": "List the names of products with great condition that have been ordered together in the same regular orders as the 'dvds' product.",
    "sql": "SELECT product_name FROM Products WHERE product_id IN (SELECT DISTINCT product_id FROM Regular_Order_Products WHERE regular_order_id IN (SELECT regular_order_id FROM Regular_Order_Products WHERE product_id = (SELECT product_id FROM Products WHERE product_name = 'dvds')) AND product_description = 'great condition');",
    "table_names": [
      "Products",
      "Regular_Order_Products"
    ]
  },
  {
    "id": 934,
    "db_id": "cre_Doc_Control_Systems",
    "question": "What are the names and phone numbers of employees living in the state of Michigan?",
    "sql": "SELECT e.employee_name, e.employee_phone FROM Employees e JOIN Addresses a ON e.employee_address_id = a.address_id WHERE a.state_province_county = 'Michigan';",
    "table_names": [
      "Addresses",
      "Employees"
    ]
  },
  {
    "id": 935,
    "db_id": "customer_deliveries",
    "question": "What are the names of delivery routes that deliver to locations with address id 7?",
    "sql": "SELECT dr.route_name FROM Delivery_Routes dr JOIN Delivery_Route_Locations drl ON dr.route_id = drl.route_id WHERE drl.location_address_id = 7;",
    "table_names": [
      "Delivery_Routes",
      "Delivery_Route_Locations"
    ]
  },
  {
    "id": 936,
    "db_id": "customers_and_addresses",
    "question": "What is the city of the current house address for customer with ID 14 after March 1, 2018?",
    "sql": "SELECT A.city FROM Addresses A JOIN Customer_Addresses CA ON A.address_id = CA.address_id WHERE CA.customer_id = 14 AND CA.address_type = 'House' AND CA.date_to > '2018-03-01';",
    "table_names": [
      "Addresses",
      "Customer_Addresses"
    ]
  },
  {
    "id": 937,
    "db_id": "icfp_1",
    "question": "Find the title of the paper whose first author has an institution id of 1050.",
    "sql": "SELECT P.title FROM Papers P JOIN Authorship A ON P.paperID = A.paperID WHERE A.instID = 1050 AND A.authOrder = 1;",
    "table_names": [
      "Papers",
      "Authorship"
    ]
  },
  {
    "id": 938,
    "db_id": "icfp_1",
    "question": "Which papers have a primary (first-order) author affiliated with institution ID 1000?",
    "sql": "SELECT p.title FROM Papers p JOIN Authorship a ON p.paperID = a.paperID WHERE a.authOrder = 1 AND a.instID = 1000;",
    "table_names": [
      "Papers",
      "Authorship"
    ]
  },
  {
    "id": 965,
    "db_id": "loan_1",
    "question": "What is the total loan amount taken by customers who have a savings account?",
    "sql": "SELECT SUM(l.amount) FROM customer c JOIN loan l ON c.cust_ID = l.cust_ID WHERE c.acc_type = 'saving';",
    "table_names": [
      "customer",
      "loan"
    ]
  },
  {
    "id": 966,
    "db_id": "loan_1",
    "question": "What is the name and credit score of the customer from Utah who has a loan amount greater than 2500?",
    "sql": "SELECT customer.cust_name, customer.credit_score FROM customer INNER JOIN loan ON customer.cust_ID = loan.cust_ID WHERE loan.amount > 2500 AND customer.state = 'Utah';",
    "table_names": [
      "customer",
      "loan"
    ]
  },
  {
    "id": 967,
    "db_id": "loan_1",
    "question": "What is the total amount of loans borrowed by customers having a savings account from Utah?",
    "sql": "SELECT SUM(l.amount) FROM customer c JOIN loan l ON c.cust_ID = l.cust_ID WHERE c.state = 'Utah' AND c.acc_type = 'saving';",
    "table_names": [
      "customer",
      "loan"
    ]
  },
  {
    "id": 968,
    "db_id": "loan_1",
    "question": "What is the total loan amount for customers with an account balance higher than 1500 and a credit score of 100 or lower?",
    "sql": "SELECT SUM(l.amount) FROM customer AS c INNER JOIN loan AS l ON c.cust_ID = l.cust_ID WHERE c.acc_bal > 1500 AND c.credit_score <= 100;",
    "table_names": [
      "customer",
      "loan"
    ]
  },
  {
    "id": 969,
    "db_id": "loan_1",
    "question": "Which customer from Utah has taken an Auto loan?",
    "sql": "SELECT c.cust_name FROM customer c JOIN loan l ON c.cust_ID = l.cust_ID WHERE l.loan_type = 'Auto' AND c.state = 'Utah';",
    "table_names": [
      "customer",
      "loan"
    ]
  },
  {
    "id": 970,
    "db_id": "loan_1",
    "question": "What is the total loan amount for customers from Utah who have a savings account?",
    "sql": "SELECT SUM(loan.amount) FROM loan INNER JOIN customer ON loan.cust_ID = customer.cust_ID WHERE customer.state = 'Utah' AND customer.acc_type = 'saving';",
    "table_names": [
      "customer",
      "loan"
    ]
  },
  {
    "id": 971,
    "db_id": "loan_1",
    "question": "What is the total loan amount taken by customers from Utah?",
    "sql": "SELECT SUM(l.amount) AS total_loan_amount FROM customer AS c JOIN loan AS l ON c.cust_ID = l.cust_ID WHERE c.state = 'Utah';",
    "table_names": [
      "customer",
      "loan"
    ]
  },
  {
    "id": 972,
    "db_id": "loan_1",
    "question": "Who took a Business loan and has an account balance greater than 10000?",
    "sql": "SELECT customer.cust_name FROM customer JOIN loan ON customer.cust_ID = loan.cust_ID WHERE customer.acc_bal > 10000 AND loan.loan_type = 'Business';",
    "table_names": [
      "customer",
      "loan"
    ]
  },
  {
    "id": 973,
    "db_id": "loan_1",
    "question": "What is the total loan amount issued by branches located in New York City?",
    "sql": "SELECT SUM(l.amount) FROM loan l JOIN bank b ON l.branch_ID = b.branch_ID WHERE b.city = 'New York City';",
    "table_names": [
      "bank",
      "loan"
    ]
  },
  {
    "id": 974,
    "db_id": "loan_1",
    "question": "What is the total loan amount processed by branches in New York City?",
    "sql": "SELECT SUM(l.amount) FROM loan l JOIN bank b ON l.branch_ID = b.branch_ID WHERE b.city = 'New York City';",
    "table_names": [
      "bank",
      "loan"
    ]
  },
  {
    "id": 975,
    "db_id": "loan_1",
    "question": "What is the total loan amount borrowed by customers who have a credit score greater than 25 and belong to the state of Utah?",
    "sql": "SELECT SUM(l.amount) FROM loan l INNER JOIN customer c ON l.cust_ID = c.cust_ID WHERE c.credit_score > 25 AND c.state = 'Utah';",
    "table_names": [
      "customer",
      "loan"
    ]
  },
  {
    "id": 976,
    "db_id": "loan_1",
    "question": "What is the total loan amount for customers having a credit score greater than 25?",
    "sql": "SELECT SUM(loan.amount) FROM customer INNER JOIN loan ON customer.cust_ID = loan.cust_ID WHERE customer.credit_score > 25;",
    "table_names": [
      "customer",
      "loan"
    ]
  },
  {
    "id": 977,
    "db_id": "loan_1",
    "question": "What is the total loan amount taken by customers who have a saving account and a credit score greater than 50?",
    "sql": "SELECT SUM(loan.amount) FROM customer INNER JOIN loan ON customer.cust_ID = loan.cust_ID WHERE customer.acc_type = 'saving' AND customer.credit_score > 50;",
    "table_names": [
      "customer",
      "loan"
    ]
  },
  {
    "id": 978,
    "db_id": "loan_1",
    "question": "Who is the customer having an account balance greater than 5000 and a Business loan?",
    "sql": "SELECT customer.cust_name FROM customer JOIN loan ON customer.cust_ID = loan.cust_ID WHERE customer.acc_bal > 5000 AND loan.loan_type = 'Business';",
    "table_names": [
      "customer",
      "loan"
    ]
  },
  {
    "id": 979,
    "db_id": "loan_1",
    "question": "What is the total sum of loan amounts from all bank branches located in the state of New York?",
    "sql": "SELECT SUM(loan.amount) FROM loan JOIN bank ON loan.branch_ID = bank.branch_ID WHERE bank.state = 'New York';",
    "table_names": [
      "bank",
      "loan"
    ]
  },
  {
    "id": 980,
    "db_id": "loan_1",
    "question": "What is the total loan amount issued by all branches located in New York City?",
    "sql": "SELECT SUM(l.amount) FROM loan l INNER JOIN bank b ON l.branch_ID = b.branch_ID WHERE b.city = 'New York City'",
    "table_names": [
      "bank",
      "loan"
    ]
  },
  {
    "id": 981,
    "db_id": "loan_1",
    "question": "What is the total loan amount issued by branches located in New York City?",
    "sql": "SELECT SUM(loan.amount) FROM bank INNER JOIN loan ON bank.branch_ID = loan.branch_ID WHERE bank.city = 'New York City';",
    "table_names": [
      "bank",
      "loan"
    ]
  },
  {
    "id": 982,
    "db_id": "loan_1",
    "question": "What is the total amount of loans given out by bank branches located in the state of New York?",
    "sql": "SELECT SUM(amount) FROM loan WHERE branch_ID IN (SELECT branch_ID FROM bank WHERE state = 'New York');",
    "table_names": [
      "bank",
      "loan"
    ]
  },
  {
    "id": 983,
    "db_id": "loan_1",
    "question": "Which customer has an Auto loan and a credit score below 50?",
    "sql": "SELECT c.cust_name FROM customer c JOIN loan l ON c.cust_ID = l.cust_ID WHERE l.loan_type = 'Auto' AND c.credit_score < 50;",
    "table_names": [
      "customer",
      "loan"
    ]
  },
  {
    "id": 984,
    "db_id": "loan_1",
    "question": "What is the total amount of loans taken by customers from Utah?",
    "sql": "SELECT SUM(amount) FROM loan WHERE cust_ID IN (SELECT cust_ID FROM customer WHERE state = 'Utah');",
    "table_names": [
      "customer",
      "loan"
    ]
  },
  {
    "id": 985,
    "db_id": "loan_1",
    "question": "List the names and states of customers having loans with an amount greater than 2500, along with the loan type information.",
    "sql": "SELECT customer.cust_name, customer.state, loan.loan_type FROM customer INNER JOIN loan ON customer.cust_ID = loan.cust_ID WHERE loan.amount > 2500;",
    "table_names": [
      "customer",
      "loan"
    ]
  },
  {
    "id": 986,
    "db_id": "loan_1",
    "question": "Who is the customer from Utah having an Auto loan with an amount exceeding 2500?",
    "sql": "SELECT customer.cust_name FROM customer JOIN loan ON customer.cust_ID = loan.cust_ID WHERE customer.state = 'Utah' AND loan.loan_type = 'Auto' AND loan.amount > 2500;",
    "table_names": [
      "customer",
      "loan"
    ]
  },
  {
    "id": 987,
    "db_id": "loan_1",
    "question": "What types of loans have been issued by branches located in New York with over 300 customers?",
    "sql": "SELECT loan.loan_type FROM loan JOIN bank ON loan.branch_ID = bank.branch_ID WHERE bank.state = 'New York' AND bank.no_of_customers > 300;",
    "table_names": [
      "bank",
      "loan"
    ]
  },
  {
    "id": 988,
    "db_id": "loan_1",
    "question": "What is the total loan amount issued by branches located in the state of New York?",
    "sql": "SELECT SUM(l.amount) FROM loan l INNER JOIN bank b ON l.branch_ID = b.branch_ID WHERE b.state = 'New York';",
    "table_names": [
      "bank",
      "loan"
    ]
  },
  {
    "id": 989,
    "db_id": "loan_1",
    "question": "What is the average loan amount for all branches located in New York City?",
    "sql": "SELECT AVG(amount) FROM loan WHERE branch_ID IN (SELECT branch_ID FROM bank WHERE city = 'New York City');",
    "table_names": [
      "bank",
      "loan"
    ]
  },
  {
    "id": 990,
    "db_id": "loan_1",
    "question": "What is the total amount of business loans issued by branches in the state of New York?",
    "sql": "SELECT SUM(l.amount) FROM loan l JOIN bank b ON l.branch_ID = b.branch_ID WHERE b.state = 'New York' AND l.loan_type = 'Business';",
    "table_names": [
      "bank",
      "loan"
    ]
  },
  {
    "id": 991,
    "db_id": "loan_1",
    "question": "Which customer has a credit score lower than 50 and has a loan amount greater than 2500?",
    "sql": "SELECT customer.cust_name FROM customer JOIN loan ON customer.cust_ID = loan.cust_ID WHERE loan.amount > 2500 AND customer.credit_score < 50;",
    "table_names": [
      "customer",
      "loan"
    ]
  },
  {
    "id": 992,
    "db_id": "loan_1",
    "question": "What is the average loan amount for customers from branches located in Utah or Texas?",
    "sql": "SELECT AVG(l.amount) FROM loan l JOIN customer c ON l.cust_ID = c.cust_ID WHERE c.state IN ('Utah', 'Texas');",
    "table_names": [
      "customer",
      "loan"
    ]
  },
  {
    "id": 993,
    "db_id": "loan_1",
    "question": "Which customer from Utah has taken an Auto loan?",
    "sql": "SELECT customer.cust_name FROM customer JOIN loan ON customer.cust_ID = loan.cust_ID WHERE loan.loan_type = 'Auto' AND customer.state = 'Utah';",
    "table_names": [
      "customer",
      "loan"
    ]
  },
  {
    "id": 994,
    "db_id": "loan_1",
    "question": "What is the total loan amount for all customers from branches located in the same state as customer 'Mary'?",
    "sql": "SELECT SUM(l.amount) FROM loan l JOIN customer c ON l.branch_ID = c.branch_ID WHERE c.state = (SELECT state FROM customer WHERE cust_name = 'Mary')",
    "table_names": [
      "customer",
      "loan"
    ]
  },
  {
    "id": 995,
    "db_id": "behavior_monitoring",
    "question": "What are the first names, last names, and email addresses of students who have assessment notes dated before the year 1980?",
    "sql": "SELECT s.first_name, s.last_name, s.email_address FROM Students AS s JOIN Assessment_Notes AS an ON s.student_id = an.student_id WHERE YEAR(an.date_of_notes) < 1980;",
    "table_names": [
      "Students",
      "Assessment_Notes"
    ]
  },
  {
    "id": 996,
    "db_id": "behavior_monitoring",
    "question": "Among the teachers who live at address ID 15, who wrote the highest number of assessment notes, what is their email address, and how many notes did they write?",
    "sql": "SELECT Teachers.first_name, Teachers.last_name, Teachers.email_address, COUNT(Assessment_Notes.notes_id) AS notes_written FROM Teachers JOIN Assessment_Notes ON Teachers.teacher_id = Assessment_Notes.teacher_id WHERE Teachers.address_id = 15 GROUP BY Teachers.teacher_id ORDER BY notes_written DESC LIMIT 1;",
    "table_names": [
      "Teachers",
      "Assessment_Notes"
    ]
  },
  {
    "id": 997,
    "db_id": "behavior_monitoring",
    "question": "How many unique students who rented for the first time on or after October 1st, 2017, have been involved in a 'VIOLENCE' behavior incident?",
    "sql": "SELECT COUNT(DISTINCT s.student_id) FROM Students s JOIN Behavior_Incident bi ON s.student_id = bi.student_id WHERE bi.incident_type_code = 'VIOLENCE' AND s.date_first_rental >= '2017-10-01';",
    "table_names": [
      "Students",
      "Behavior_Incident"
    ]
  },
  {
    "id": 998,
    "db_id": "behavior_monitoring",
    "question": "Which teacher has supervised the highest number of 'AFTER' type detentions, and how many have they supervised?",
    "sql": "SELECT T.first_name, T.middle_name, T.last_name, COUNT(D.detention_id) AS num_detentions FROM Teachers T INNER JOIN Detention D ON T.teacher_id = D.teacher_id WHERE D.detention_type_code = 'AFTER' GROUP BY T.teacher_id ORDER BY num_detentions DESC LIMIT 1;",
    "table_names": [
      "Teachers",
      "Detention"
    ]
  },
  {
    "id": 1001,
    "db_id": "behavior_monitoring",
    "question": "What type of behavioral incident occurred the most frequently among students after January 1, 2018?",
    "sql": "SELECT ri.incident_type_description, COUNT(b.incident_id) AS total_incidents FROM Behavior_Incident b JOIN Ref_Incident_Type ri ON b.incident_type_code = ri.incident_type_code WHERE b.date_incident_start >= '2018-01-01' GROUP BY ri.incident_type_description ORDER BY total_incidents DESC LIMIT 1;",
    "table_names": [
      "Ref_Incident_Type",
      "Behavior_Incident"
    ]
  },
  {
    "id": 1002,
    "db_id": "behavior_monitoring",
    "question": "What is the detention ID and start datetime of the most recent lunch-time detention?",
    "sql": "SELECT dt.detention_id, dt.datetime_detention_start FROM Detention dt JOIN Ref_Detention_Type rdt ON dt.detention_type_code = rdt.detention_type_code WHERE rdt.detention_type_description = 'Lunch-time' ORDER BY dt.datetime_detention_start DESC LIMIT 1;",
    "table_names": [
      "Ref_Detention_Type",
      "Detention"
    ]
  },
  {
    "id": 1003,
    "db_id": "behavior_monitoring",
    "question": "Which student has the most assessment notes recorded, and how many notes are associated with this student?",
    "sql": "SELECT S.first_name, S.last_name, COUNT(AN.notes_id) AS note_count FROM Students S JOIN Assessment_Notes AN ON S.student_id = AN.student_id GROUP BY S.student_id ORDER BY note_count DESC LIMIT 1;",
    "table_names": [
      "Students",
      "Assessment_Notes"
    ]
  },
  {
    "id": 1004,
    "db_id": "behavior_monitoring",
    "question": "How many unique students received assessment notes from teachers who live at address ID 15?",
    "sql": "SELECT COUNT(DISTINCT an.student_id) FROM Assessment_Notes an JOIN Teachers t ON an.teacher_id = t.teacher_id WHERE t.address_id = 15;",
    "table_names": [
      "Teachers",
      "Assessment_Notes"
    ]
  },
  {
    "id": 1005,
    "db_id": "behavior_monitoring",
    "question": "Which students were involved in violent incidents and were recommended to transfer schools?",
    "sql": "SELECT first_name, last_name FROM Students WHERE student_id IN (SELECT student_id FROM Behavior_Incident WHERE incident_type_code = 'VIOLENCE' AND recommendations = 'Transfer schools');",
    "table_names": [
      "Students",
      "Behavior_Incident"
    ]
  },
  {
    "id": 1006,
    "db_id": "behavior_monitoring",
    "question": "Which teacher conducted the highest number of detentions, and how many detentions did this teacher supervise?",
    "sql": "SELECT T.first_name, T.last_name, COUNT(D.detention_id) AS detention_count FROM Teachers AS T JOIN Detention AS D ON T.teacher_id = D.teacher_id GROUP BY T.teacher_id ORDER BY detention_count DESC LIMIT 1;",
    "table_names": [
      "Teachers",
      "Detention"
    ]
  },
  {
    "id": 1014,
    "db_id": "behavior_monitoring",
    "question": "Among students who joined the university after September 1, 2017, who has the highest number of recorded behavior incidents?",
    "sql": "SELECT S.first_name, S.last_name, COUNT(B.incident_id) AS num_incidents FROM Students AS S JOIN Behavior_Incident AS B ON S.student_id = B.student_id WHERE S.date_first_rental >= '2017-09-01' GROUP BY S.student_id ORDER BY num_incidents DESC LIMIT 1;",
    "table_names": [
      "Students",
      "Behavior_Incident"
    ]
  },
  {
    "id": 1015,
    "db_id": "behavior_monitoring",
    "question": "Which teacher has supervised the highest number of 'AFTER' type detentions, and how many were there?",
    "sql": "SELECT T.first_name, T.last_name, COUNT(D.detention_id) AS detention_count FROM Teachers T JOIN Detention D ON T.teacher_id = D.teacher_id WHERE D.detention_type_code = 'AFTER' GROUP BY T.teacher_id ORDER BY detention_count DESC LIMIT 1;",
    "table_names": [
      "Teachers",
      "Detention"
    ]
  },
  {
    "id": 1016,
    "db_id": "assets_maintenance",
    "question": "Which asset make has the highest number of assets still under maintenance contracts active as of March 15, 2018?",
    "sql": "SELECT asset_make, COUNT(*) AS num_assets FROM Assets AS a JOIN Maintenance_Contracts AS m ON a.maintenance_contract_id = m.maintenance_contract_id WHERE m.contract_end_date >= '2018-03-15' GROUP BY asset_make ORDER BY num_assets DESC LIMIT 1;",
    "table_names": [
      "Maintenance_Contracts",
      "Assets"
    ]
  },
  {
    "id": 1017,
    "db_id": "assets_maintenance",
    "question": "What is the name of the maintenance contractor company responsible for maintaining the assets with make 'RU' that have 'Bad condition'?",
    "sql": "SELECT TPC.company_name FROM Third_Party_Companies TPC JOIN Assets A ON TPC.company_id = A.maintenance_contract_id WHERE A.asset_make = 'RU' AND A.other_asset_details = 'Bad condition';",
    "table_names": [
      "Third_Party_Companies",
      "Assets"
    ]
  },
  {
    "id": 1018,
    "db_id": "assets_maintenance",
    "question": "Which maintenance engineer has completed the highest number of visits with status 'Fixed', and how many did they complete?",
    "sql": "SELECT me.first_name, me.last_name, COUNT(ev.engineer_visit_id) AS num_visits FROM Maintenance_Engineers me JOIN Engineer_Visits ev ON me.engineer_id = ev.engineer_id WHERE ev.fault_status = 'Fixed' GROUP BY me.engineer_id ORDER BY num_visits DESC LIMIT 1;",
    "table_names": [
      "Maintenance_Engineers",
      "Engineer_Visits"
    ]
  },
  {
    "id": 1019,
    "db_id": "assets_maintenance",
    "question": "What is the total chargeable amount for fault type 'Package Wrong' on all chargeable parts?",
    "sql": "SELECT SUM(CAST(p.chargeable_amount AS INTEGER)) FROM Parts p JOIN Part_Faults pf ON p.part_id = pf.part_id WHERE pf.fault_description = 'Package Wrong' AND p.chargeable_yn = '1';",
    "table_names": [
      "Parts",
      "Part_Faults"
    ]
  },
  {
    "id": 1020,
    "db_id": "assets_maintenance",
    "question": "What is the total chargeable amount for all chargeable parts associated with asset_id 3?",
    "sql": "SELECT SUM(P.chargeable_amount) FROM Parts P INNER JOIN Asset_Parts AP ON P.part_id = AP.part_id WHERE AP.asset_id = 3 AND P.chargeable_yn = '1';",
    "table_names": [
      "Parts",
      "Asset_Parts"
    ]
  },
  {
    "id": 1021,
    "db_id": "assets_maintenance",
    "question": "How many distinct assets have fault log entries with parts that have the fault status 'Return' or 'Waiting'?",
    "sql": "SELECT COUNT(DISTINCT fl.asset_id) FROM Fault_Log fl INNER JOIN Fault_Log_Parts flp ON fl.fault_log_entry_id = flp.fault_log_entry_id WHERE flp.fault_status IN ('Return', 'Waiting');",
    "table_names": [
      "Fault_Log",
      "Fault_Log_Parts"
    ]
  },
  {
    "id": 1022,
    "db_id": "assets_maintenance",
    "question": "How many engineer visits with either 'Waiting' or 'Return' status are associated with faults logged for asset ID 3?",
    "sql": "SELECT COUNT(*) FROM Fault_Log FL JOIN Engineer_Visits EV ON FL.fault_log_entry_id = EV.fault_log_entry_id WHERE FL.asset_id = 3 AND EV.fault_status IN ('Waiting', 'Return');",
    "table_names": [
      "Fault_Log",
      "Engineer_Visits"
    ]
  },
  {
    "id": 1023,
    "db_id": "assets_maintenance",
    "question": "Which maintenance engineer has fixed the most number of faults?",
    "sql": "SELECT me.first_name, me.last_name, COUNT(ev.engineer_visit_id) FROM Maintenance_Engineers me JOIN Engineer_Visits ev ON me.engineer_id = ev.engineer_id WHERE ev.fault_status='Fixed' GROUP BY me.engineer_id ORDER BY COUNT(ev.engineer_visit_id) DESC LIMIT 1;",
    "table_names": [
      "Maintenance_Engineers",
      "Engineer_Visits"
    ]
  },
  {
    "id": 1024,
    "db_id": "assets_maintenance",
    "question": "Among chargeable parts, which part had the highest number of occurrences of fault 'MW'?",
    "sql": "SELECT p.part_name, COUNT(pf.part_fault_id) AS fault_count FROM Parts p INNER JOIN Part_Faults pf ON p.part_id = pf.part_id WHERE p.chargeable_yn = '1' AND pf.fault_short_name = 'MW' GROUP BY p.part_name ORDER BY fault_count DESC LIMIT 1;",
    "table_names": [
      "Parts",
      "Part_Faults"
    ]
  },
  {
    "id": 1025,
    "db_id": "assets_maintenance",
    "question": "Which engineers have visits with 'Return' fault status starting from the year 1990 onwards? Provide their first and last names.",
    "sql": "SELECT me.first_name, me.last_name FROM Maintenance_Engineers me JOIN Engineer_Visits ev ON me.engineer_id = ev.engineer_id WHERE ev.fault_status = 'Return' AND ev.visit_start_datetime >= '1990-01-01 00:00:00';",
    "table_names": [
      "Maintenance_Engineers",
      "Engineer_Visits"
    ]
  },
  {
    "id": 1026,
    "db_id": "assets_maintenance",
    "question": "How many distinct assets had a 'system error' fault description and at least one associated fault part status marked as 'Fixed'?",
    "sql": "SELECT COUNT(DISTINCT fl.asset_id) FROM Fault_Log fl JOIN Fault_Log_Parts flp ON fl.fault_log_entry_id = flp.fault_log_entry_id WHERE fl.fault_description = 'system error' AND flp.fault_status = 'Fixed';",
    "table_names": [
      "Fault_Log",
      "Fault_Log_Parts"
    ]
  },
  {
    "id": 1027,
    "db_id": "assets_maintenance",
    "question": "How many unique skills are required to fix part_fault_id 1 and 15?",
    "sql": "SELECT COUNT(DISTINCT s.skill_id) FROM Skills s JOIN Skills_Required_To_Fix sf ON s.skill_id = sf.skill_id WHERE sf.part_fault_id IN (1, 15);",
    "table_names": [
      "Skills",
      "Skills_Required_To_Fix"
    ]
  },
  {
    "id": 1028,
    "db_id": "assets_maintenance",
    "question": "Which supplier company's maintenance contract ended earliest?",
    "sql": "SELECT TPC.company_name FROM Third_Party_Companies TPC JOIN Maintenance_Contracts MC ON TPC.company_id = MC.maintenance_contract_company_id WHERE TPC.company_type = 'Supplier' ORDER BY MC.contract_end_date ASC LIMIT 1;",
    "table_names": [
      "Third_Party_Companies",
      "Maintenance_Contracts"
    ]
  },
  {
    "id": 1029,
    "db_id": "assets_maintenance",
    "question": "How many unique engineers have performed visits with a 'Return' fault status where the contact staff member was a manager?",
    "sql": "SELECT COUNT(DISTINCT ev.engineer_id) FROM Engineer_Visits ev JOIN Staff s ON ev.contact_staff_id = s.staff_id WHERE s.other_staff_details = 'Manager' AND ev.fault_status = 'Return';",
    "table_names": [
      "Staff",
      "Engineer_Visits"
    ]
  },
  {
    "id": 1030,
    "db_id": "assets_maintenance",
    "question": "List the asset details of assets that have a disposition date after March 15, 2018, and have experienced a fault description of 'system error'.",
    "sql": "SELECT Assets.asset_details FROM Assets JOIN Fault_Log ON Assets.asset_id = Fault_Log.asset_id WHERE Assets.asset_disposed_date > '2018-03-15' AND Fault_Log.fault_description = 'system error';",
    "table_names": [
      "Assets",
      "Fault_Log"
    ]
  },
  {
    "id": 1031,
    "db_id": "station_weather",
    "question": "Which trains have routes covering more than two stations?",
    "sql": "SELECT name FROM train WHERE id IN (SELECT train_id FROM route GROUP BY train_id HAVING COUNT(station_id) > 2);",
    "table_names": [
      "train",
      "route"
    ]
  },
  {
    "id": 1032,
    "db_id": "station_weather",
    "question": "What are the names of networks served by trains that also stop at the station 'Bushey', excluding 'Bushey' itself?",
    "sql": "SELECT DISTINCT s.network_name FROM station s JOIN route r ON s.id = r.station_id WHERE r.train_id IN (SELECT train_id FROM route WHERE station_id = (SELECT id FROM station WHERE network_name='Bushey')) AND s.network_name <> 'Bushey';",
    "table_names": [
      "station",
      "route"
    ]
  },
  {
    "id": 1033,
    "db_id": "station_weather",
    "question": "What is the average high temperature for stations in the Chiltern local authority with precipitation greater than 40.0?",
    "sql": "SELECT AVG(ww.high_temperature) FROM weekly_weather ww JOIN station s ON ww.station_id = s.id WHERE s.local_authority = 'Chiltern' AND ww.precipitation > 40.0;",
    "table_names": [
      "station",
      "weekly_weather"
    ]
  },
  {
    "id": 1034,
    "db_id": "station_weather",
    "question": "Which network operates at the station that has experienced the highest wind speed recorded during the week?",
    "sql": "SELECT s.network_name FROM station AS s JOIN weekly_weather AS w ON s.id = w.station_id WHERE w.wind_speed_mph = (SELECT MAX(wind_speed_mph) FROM weekly_weather);",
    "table_names": [
      "station",
      "weekly_weather"
    ]
  },
  {
    "id": 1035,
    "db_id": "station_weather",
    "question": "What is the average high temperature for each network operating stations in the local authority area of Chiltern?",
    "sql": "SELECT s.network_name, AVG(w.high_temperature) FROM station s JOIN weekly_weather w ON s.id = w.station_id WHERE s.local_authority = 'Chiltern' GROUP BY s.network_name;",
    "table_names": [
      "station",
      "weekly_weather"
    ]
  },
  {
    "id": 1042,
    "db_id": "college_1",
    "question": "What is the total number of credits of all courses taught by professor number 114?",
    "sql": "SELECT SUM(CRS_CREDIT) FROM CLASS INNER JOIN COURSE ON CLASS.CRS_CODE = COURSE.CRS_CODE WHERE CLASS.PROF_NUM = 114;",
    "table_names": [
      "CLASS",
      "COURSE"
    ]
  },
  {
    "id": 1043,
    "db_id": "college_1",
    "question": "What is the total number of credits for all courses taught by professor number 114?",
    "sql": "SELECT SUM(CRS_CREDIT) FROM CLASS AS cl JOIN COURSE AS co ON cl.CRS_CODE = co.CRS_CODE WHERE cl.PROF_NUM = 114;",
    "table_names": [
      "CLASS",
      "COURSE"
    ]
  },
  {
    "id": 1048,
    "db_id": "college_1",
    "question": "What are the names of departments that have senior students with a GPA greater than 3.0?",
    "sql": "SELECT DEPARTMENT.DEPT_NAME FROM DEPARTMENT INNER JOIN STUDENT ON DEPARTMENT.DEPT_CODE = STUDENT.DEPT_CODE WHERE STUDENT.STU_CLASS = 'Sr' AND STUDENT.STU_GPA > 3.0;",
    "table_names": [
      "DEPARTMENT",
      "STUDENT"
    ]
  },
  {
    "id": 1049,
    "db_id": "college_1",
    "question": "What is the department name and school code of the student with the highest GPA?",
    "sql": "SELECT d.DEPT_NAME, d.SCHOOL_CODE FROM DEPARTMENT d JOIN STUDENT s ON d.DEPT_CODE = s.DEPT_CODE WHERE s.STU_GPA = (SELECT MAX(STU_GPA) FROM STUDENT);",
    "table_names": [
      "DEPARTMENT",
      "STUDENT"
    ]
  },
  {
    "id": 1050,
    "db_id": "college_1",
    "question": "What is the total number of course credits for all courses offered by departments under the BUS school?",
    "sql": "SELECT SUM(C.CRS_CREDIT) FROM COURSE C JOIN DEPARTMENT D ON C.DEPT_CODE = D.DEPT_CODE WHERE D.SCHOOL_CODE = 'BUS';",
    "table_names": [
      "COURSE",
      "DEPARTMENT"
    ]
  },
  {
    "id": 1051,
    "db_id": "college_1",
    "question": "What is the total number of credits offered by courses from departments within the business school?",
    "sql": "SELECT SUM(CRS.CRS_CREDIT) FROM COURSE AS CRS JOIN DEPARTMENT AS DPT ON CRS.DEPT_CODE = DPT.DEPT_CODE WHERE DPT.SCHOOL_CODE = 'BUS';",
    "table_names": [
      "COURSE",
      "DEPARTMENT"
    ]
  },
  {
    "id": 1052,
    "db_id": "college_1",
    "question": "How many different classrooms are used for courses from the CIS department that have 4.0 credits?",
    "sql": "SELECT COUNT(DISTINCT CLASS.CLASS_ROOM) FROM CLASS JOIN COURSE ON CLASS.CRS_CODE = COURSE.CRS_CODE WHERE COURSE.DEPT_CODE = 'CIS' AND COURSE.CRS_CREDIT = 4.0;",
    "table_names": [
      "CLASS",
      "COURSE"
    ]
  },
  {
    "id": 1053,
    "db_id": "college_1",
    "question": "How many classes from the CIS department are scheduled on a Monday-Wednesday-Friday (MWF) pattern?",
    "sql": "SELECT COUNT(*) FROM CLASS JOIN COURSE ON CLASS.CRS_CODE = COURSE.CRS_CODE WHERE COURSE.DEPT_CODE = 'CIS' AND CLASS.CLASS_TIME LIKE '%MWF%';",
    "table_names": [
      "CLASS",
      "COURSE"
    ]
  },
  {
    "id": 1054,
    "db_id": "college_1",
    "question": "At what time does student number 324257 attend the ACCT-211 class?",
    "sql": "SELECT DISTINCT C.CLASS_TIME FROM CLASS C JOIN ENROLL E ON C.CLASS_CODE = E.CLASS_CODE WHERE E.STU_NUM = 324257 AND C.CRS_CODE = 'ACCT-211';",
    "table_names": [
      "CLASS",
      "ENROLL"
    ]
  },
  {
    "id": 1055,
    "db_id": "college_1",
    "question": "How many distinct students received a grade of 'C' in classes held in room 'KLR200'?",
    "sql": "SELECT COUNT(DISTINCT e.STU_NUM) FROM ENROLL e JOIN CLASS c ON e.CLASS_CODE = c.CLASS_CODE WHERE c.CLASS_ROOM = 'KLR200' AND e.ENROLL_GRADE = 'C';",
    "table_names": [
      "CLASS",
      "ENROLL"
    ]
  },
  {
    "id": 1058,
    "db_id": "college_1",
    "question": "What is the full name and GPA of the student who obtained a 'B' grade in class code '10014'?",
    "sql": "SELECT STU_FNAME, STU_LNAME, STU_GPA FROM STUDENT WHERE STU_NUM IN (SELECT STU_NUM FROM ENROLL WHERE CLASS_CODE = '10014' AND ENROLL_GRADE = 'B');",
    "table_names": [
      "ENROLL",
      "STUDENT"
    ]
  },
  {
    "id": 1059,
    "db_id": "college_1",
    "question": "What is the first and last name of the student who received a 'B' grade in class 10014?",
    "sql": "SELECT S.STU_FNAME, S.STU_LNAME FROM STUDENT S JOIN ENROLL E ON S.STU_NUM = E.STU_NUM WHERE E.CLASS_CODE = '10014' AND E.ENROLL_GRADE = 'B';",
    "table_names": [
      "ENROLL",
      "STUDENT"
    ]
  },
  {
    "id": 1072,
    "db_id": "college_1",
    "question": "Which business department has the highest average GPA among students?",
    "sql": "SELECT D.DEPT_NAME, AVG(S.STU_GPA) AS AVG_GPA FROM DEPARTMENT D JOIN STUDENT S ON D.DEPT_CODE = S.DEPT_CODE WHERE D.SCHOOL_CODE = 'BUS' GROUP BY D.DEPT_NAME ORDER BY AVG_GPA DESC LIMIT 1;",
    "table_names": [
      "DEPARTMENT",
      "STUDENT"
    ]
  },
  {
    "id": 1073,
    "db_id": "college_1",
    "question": "What is the name of the department for the student with the student number 324274?",
    "sql": "SELECT DEPT_NAME FROM DEPARTMENT WHERE DEPT_CODE = (SELECT DEPT_CODE FROM STUDENT WHERE STU_NUM = 324274);",
    "table_names": [
      "DEPARTMENT",
      "STUDENT"
    ]
  },
  {
    "id": 1074,
    "db_id": "college_1",
    "question": "Which departments have more than one student enrolled?",
    "sql": "SELECT DEPT_NAME FROM DEPARTMENT WHERE DEPT_CODE IN (SELECT DEPT_CODE FROM STUDENT GROUP BY DEPT_CODE HAVING COUNT(*) >= 2);",
    "table_names": [
      "DEPARTMENT",
      "STUDENT"
    ]
  },
  {
    "id": 1075,
    "db_id": "college_1",
    "question": "Which department within the School of Business has the highest average student GPA?",
    "sql": "SELECT D.DEPT_NAME, AVG(S.STU_GPA) AS AVG_GPA FROM DEPARTMENT D JOIN STUDENT S ON D.DEPT_CODE = S.DEPT_CODE WHERE D.SCHOOL_CODE = 'BUS' GROUP BY D.DEPT_NAME ORDER BY AVG_GPA DESC LIMIT 1;",
    "table_names": [
      "DEPARTMENT",
      "STUDENT"
    ]
  },
  {
    "id": 1076,
    "db_id": "college_1",
    "question": "Which department within the 'BUS' school has the highest number of students and how many students are enrolled in it?",
    "sql": "SELECT DEPARTMENT.DEPT_NAME, COUNT(STUDENT.STU_NUM) AS NUM_STUDENTS FROM DEPARTMENT JOIN STUDENT ON DEPARTMENT.DEPT_CODE = STUDENT.DEPT_CODE WHERE DEPARTMENT.SCHOOL_CODE = 'BUS' GROUP BY DEPARTMENT.DEPT_NAME ORDER BY NUM_STUDENTS DESC LIMIT 1;",
    "table_names": [
      "DEPARTMENT",
      "STUDENT"
    ]
  },
  {
    "id": 1077,
    "db_id": "college_1",
    "question": "What is the department name associated with students who are seniors and have a GPA above 3.5?",
    "sql": "SELECT DEPT.DEPT_NAME FROM DEPARTMENT AS DEPT JOIN STUDENT AS STU ON DEPT.DEPT_CODE = STU.DEPT_CODE WHERE STU.STU_CLASS = 'Sr' AND STU.STU_GPA > 3.5;",
    "table_names": [
      "DEPARTMENT",
      "STUDENT"
    ]
  },
  {
    "id": 1080,
    "db_id": "college_1",
    "question": "What is the average GPA of students who got a grade of 'B' in any class?",
    "sql": "SELECT AVG(STU_GPA) FROM STUDENT WHERE STU_NUM IN (SELECT STU_NUM FROM ENROLL WHERE ENROLL_GRADE = 'B');",
    "table_names": [
      "ENROLL",
      "STUDENT"
    ]
  },
  {
    "id": 1081,
    "db_id": "college_1",
    "question": "Which class codes did student Bowser receive a grade of C in?",
    "sql": "SELECT ENROLL.CLASS_CODE FROM ENROLL INNER JOIN STUDENT ON ENROLL.STU_NUM = STUDENT.STU_NUM WHERE STUDENT.STU_LNAME = 'Bowser' AND ENROLL.ENROLL_GRADE = 'C';",
    "table_names": [
      "ENROLL",
      "STUDENT"
    ]
  },
  {
    "id": 1082,
    "db_id": "college_1",
    "question": "What is the full name of the student who received an 'A' grade in class with class code '10018'?",
    "sql": "SELECT STU_FNAME, STU_LNAME FROM STUDENT WHERE STU_NUM IN (SELECT STU_NUM FROM ENROLL WHERE CLASS_CODE = '10018' AND ENROLL_GRADE = 'A')",
    "table_names": [
      "ENROLL",
      "STUDENT"
    ]
  },
  {
    "id": 1083,
    "db_id": "college_1",
    "question": "What is the full name of the student who got an 'A' grade in the class with class code '10018'?",
    "sql": "SELECT STU_FNAME, STU_LNAME FROM STUDENT WHERE STU_NUM IN (SELECT STU_NUM FROM ENROLL WHERE CLASS_CODE = '10018' AND ENROLL_GRADE = 'A');",
    "table_names": [
      "ENROLL",
      "STUDENT"
    ]
  },
  {
    "id": 1086,
    "db_id": "college_1",
    "question": "How many courses offered by departments within the BUS school have exactly 4 credit hours?",
    "sql": "SELECT COUNT(*) FROM COURSE AS C JOIN DEPARTMENT AS D ON C.DEPT_CODE = D.DEPT_CODE WHERE D.SCHOOL_CODE = 'BUS' AND C.CRS_CREDIT = 4.0;",
    "table_names": [
      "COURSE",
      "DEPARTMENT"
    ]
  },
  {
    "id": 1087,
    "db_id": "college_1",
    "question": "What is the total number of course credits offered by departments belonging to the 'BUS' school?",
    "sql": "SELECT SUM(c.CRS_CREDIT) FROM COURSE c JOIN DEPARTMENT d ON c.DEPT_CODE = d.DEPT_CODE WHERE d.SCHOOL_CODE = 'BUS';",
    "table_names": [
      "COURSE",
      "DEPARTMENT"
    ]
  },
  {
    "id": 1088,
    "db_id": "sports_competition",
    "question": "What are the names of the clubs that have players playing as 'Second Row' and scoring more than 15 points?",
    "sql": "SELECT club.name FROM club JOIN player ON club.Club_ID = player.Club_ID WHERE player.Position = 'Second Row' AND player.Points > 15;",
    "table_names": [
      "club",
      "player"
    ]
  },
  {
    "id": 1089,
    "db_id": "sports_competition",
    "question": "What is the name of the club in Japan that has a player in the position of 'Second Row'?",
    "sql": "SELECT club.name FROM club INNER JOIN player ON club.Club_ID = player.Club_ID WHERE player.Position = 'Second Row' AND club.Region = 'Japan';",
    "table_names": [
      "club",
      "player"
    ]
  },
  {
    "id": 1090,
    "db_id": "sports_competition",
    "question": "Which players belong to clubs located in the USA and have made more than 25 appearances?",
    "sql": "SELECT player.name FROM player INNER JOIN club ON player.Club_ID = club.Club_ID WHERE club.Region = 'USA' AND CAST(player.Apps AS FLOAT) > 25",
    "table_names": [
      "club",
      "player"
    ]
  },
  {
    "id": 1091,
    "db_id": "sports_competition",
    "question": "Which players scored more than 30 points and play for clubs located in either USA or Japan?",
    "sql": "SELECT player.name FROM player JOIN club ON player.Club_ID = club.Club_ID WHERE player.Points > 30 AND club.Region IN ('USA', 'Japan');",
    "table_names": [
      "club",
      "player"
    ]
  },
  {
    "id": 1092,
    "db_id": "sports_competition",
    "question": "What is the name of the player who belongs to the club in the UK region and has played more than 20 apps?",
    "sql": "SELECT player.name FROM player JOIN club ON player.Club_ID = club.Club_ID WHERE club.Region = 'UK' AND player.Apps > 20;",
    "table_names": [
      "club",
      "player"
    ]
  },
  {
    "id": 1093,
    "db_id": "sports_competition",
    "question": "Which region has the highest total points scored by players whose clubs started before 2005?",
    "sql": "SELECT club.Region, SUM(player.Points) AS Total_Points FROM player INNER JOIN club ON player.Club_ID = club.Club_ID WHERE club.Start_year < '2005' GROUP BY club.Region ORDER BY Total_Points DESC LIMIT 1;",
    "table_names": [
      "club",
      "player"
    ]
  },
  {
    "id": 1094,
    "db_id": "sports_competition",
    "question": "What is the total number of appearances (Apps) by players who play either 'Second Row' or 'Loose Forward' position in clubs from the 'USA' or 'Japan' regions?",
    "sql": "SELECT SUM(player.Apps) FROM player JOIN club ON player.Club_ID = club.Club_ID WHERE club.Region IN ('USA', 'Japan') AND player.Position IN ('Second Row', 'Loose Forward');",
    "table_names": [
      "club",
      "player"
    ]
  },
  {
    "id": 1095,
    "db_id": "sports_competition",
    "question": "Which players from clubs in the UK region have scored more points than the average points scored by all players?",
    "sql": "SELECT player.name FROM player JOIN club ON player.Club_ID = club.Club_ID WHERE club.Region = 'UK' AND player.Points > (SELECT AVG(Points) FROM player);",
    "table_names": [
      "club",
      "player"
    ]
  },
  {
    "id": 1096,
    "db_id": "manufacturer",
    "question": "Which furniture items have more than 5 components and cost more than 400 dollars?",
    "sql": "SELECT f.Name FROM furniture f JOIN furniture_manufacte fm ON f.Furniture_ID = fm.Furniture_ID WHERE fm.Price_in_Dollar > 400 AND f.Num_of_Component > 5;",
    "table_names": [
      "furniture",
      "furniture_manufacte"
    ]
  },
  {
    "id": 1097,
    "db_id": "manufacturer",
    "question": "What is the name of the manufacturer that sells furniture priced above 1000 dollars and has fewer than 10 shops?",
    "sql": "SELECT m.Name FROM manufacturer m JOIN furniture_manufacte f ON m.Manufacturer_ID = f.Manufacturer_ID WHERE f.Price_in_Dollar > 1000 AND m.Num_of_Shops < 10",
    "table_names": [
      "manufacturer",
      "furniture_manufacte"
    ]
  },
  {
    "id": 1098,
    "db_id": "manufacturer",
    "question": "Which manufacturers produce furniture priced above $400 and have more than 10 shops?",
    "sql": "SELECT m.Name FROM manufacturer AS m JOIN furniture_manufacte AS fm ON m.Manufacturer_ID = fm.Manufacturer_ID WHERE fm.Price_in_Dollar > 400 AND m.Num_of_Shops > 10;",
    "table_names": [
      "manufacturer",
      "furniture_manufacte"
    ]
  },
  {
    "id": 1099,
    "db_id": "manufacturer",
    "question": "Which furniture items have more than 5 components and are priced above 500 dollars by their manufacturers?",
    "sql": "SELECT furniture.Name FROM furniture JOIN furniture_manufacte ON furniture.Furniture_ID = furniture_manufacte.Furniture_ID WHERE furniture.Num_of_Component > 5 AND furniture_manufacte.Price_in_Dollar > 500;",
    "table_names": [
      "furniture",
      "furniture_manufacte"
    ]
  },
  {
    "id": 1100,
    "db_id": "manufacturer",
    "question": "List the names of furniture items having more than 5 components and priced above 1000 dollars.",
    "sql": "SELECT furniture.Name FROM furniture JOIN furniture_manufacte ON furniture.Furniture_ID = furniture_manufacte.Furniture_ID WHERE furniture.Num_of_Component > 5 AND furniture_manufacte.Price_in_Dollar > 1000;",
    "table_names": [
      "furniture",
      "furniture_manufacte"
    ]
  },
  {
    "id": 1125,
    "db_id": "music_1",
    "question": "Which Indian artists have songs with a higher rating than the song performed by Michel from the UK?",
    "sql": "SELECT a.artist_name FROM artist a JOIN song s ON a.artist_name = s.artist_name WHERE a.country = 'India' AND s.rating > (SELECT rating FROM song WHERE artist_name='Michel')",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1126,
    "db_id": "music_1",
    "question": "List the songs performed by female artists with a rating higher than 6 and a resolution of at least 320.",
    "sql": "SELECT s.song_name FROM song s JOIN artist a ON s.artist_name = a.artist_name WHERE a.gender = 'Female' AND s.rating > 6 AND s.resolution >= 320;",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1127,
    "db_id": "music_1",
    "question": "What mp4 formatted songs from India have a rating of 8 or higher?",
    "sql": "SELECT song.song_name FROM song INNER JOIN files ON song.f_id = files.f_id WHERE song.country = 'India' AND files.formats = 'mp4' AND song.rating >= 8;",
    "table_names": [
      "files",
      "song"
    ]
  },
  {
    "id": 1128,
    "db_id": "music_1",
    "question": "What is the name of the song that belongs to either 'tagore' or 'nazrul' genres and is available in 'mp3' format?",
    "sql": "SELECT s.song_name FROM song s JOIN files f ON s.f_id = f.f_id WHERE s.genre_is IN ('tagore', 'nazrul') AND f.formats = 'mp3';",
    "table_names": [
      "files",
      "song"
    ]
  },
  {
    "id": 1129,
    "db_id": "music_1",
    "question": "What is the artist name and file size of songs that belong to the pop genre and have a rating greater than or equal to 7?",
    "sql": "SELECT f.artist_name, f.file_size FROM files f JOIN song s ON f.f_id = s.f_id WHERE s.genre_is = 'pop' AND s.rating >= 7;",
    "table_names": [
      "files",
      "song"
    ]
  },
  {
    "id": 1130,
    "db_id": "music_1",
    "question": "What are the names of Bangla songs available in mp4 format having ratings greater than 7?",
    "sql": "SELECT s.song_name FROM song s JOIN files f ON s.f_id = f.f_id WHERE s.languages='bangla' AND f.formats='mp4' AND s.rating > 7;",
    "table_names": [
      "files",
      "song"
    ]
  },
  {
    "id": 1131,
    "db_id": "music_1",
    "question": "Which song has the highest rating among artists originating from Bangladesh?",
    "sql": "SELECT s.song_name FROM song s JOIN artist a ON s.artist_name = a.artist_name WHERE a.country = 'Bangladesh' AND s.rating = (SELECT MAX(rating) FROM song WHERE artist_name IN (SELECT artist_name FROM artist WHERE country = 'Bangladesh'));",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1132,
    "db_id": "music_1",
    "question": "Identify the titles of songs with resolution 720 or higher and ratings greater than 6 performed by female artists.",
    "sql": "SELECT DISTINCT s.song_name FROM song s JOIN artist a ON s.artist_name = a.artist_name WHERE a.gender = 'Female' AND s.rating > 6 AND s.resolution >=720;",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1133,
    "db_id": "music_1",
    "question": "What is the average rating of songs performed by female artists from Bangladesh?",
    "sql": "SELECT AVG(s.rating) FROM song s JOIN artist a ON s.artist_name = a.artist_name WHERE a.gender = 'Female' AND a.country = 'Bangladesh';",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1134,
    "db_id": "music_1",
    "question": "List the names of artists from India who sang Bangla songs with ratings greater than 7.",
    "sql": "SELECT artist.artist_name FROM artist JOIN song ON artist.artist_name = song.artist_name WHERE artist.country = 'India' AND song.rating > 7 AND song.languages = 'bangla';",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1135,
    "db_id": "music_1",
    "question": "Which female artist from India sang a song with rating greater than 7 and resolution of 320?",
    "sql": "SELECT artist.artist_name FROM artist INNER JOIN song ON artist.artist_name = song.artist_name WHERE artist.country = 'India' AND song.rating > 7 AND song.resolution = 320 AND artist.gender = 'Female';",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1136,
    "db_id": "music_1",
    "question": "List the name of songs which are rated above 6 and sung by female artists from Bangladesh.",
    "sql": "SELECT s.song_name FROM song s JOIN artist a ON s.artist_name = a.artist_name WHERE a.gender = 'Female' AND a.country = 'Bangladesh' AND s.rating > 6;",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1137,
    "db_id": "music_1",
    "question": "Which songs have a file size greater than 4.00 MB, are in mp3 format, and have a rating of 7 or above?",
    "sql": "SELECT song_name FROM song WHERE f_id IN (SELECT f_id FROM files WHERE file_size > '4.00 MB' AND formats = 'mp3') AND rating >= 7;",
    "table_names": [
      "files",
      "song"
    ]
  },
  {
    "id": 1138,
    "db_id": "music_1",
    "question": "What are the names of Bangla songs having a rating greater than 7 with associated file durations longer than 4 minutes?",
    "sql": "SELECT song_name FROM song WHERE f_id IN (SELECT f_id FROM files WHERE duration > '4:00') AND languages = 'bangla' AND rating > 7;",
    "table_names": [
      "files",
      "song"
    ]
  },
  {
    "id": 1139,
    "db_id": "music_1",
    "question": "What is the name of the song that has been sung by a female artist, has a rating above 6, and a resolution of 320p or higher?",
    "sql": "SELECT s.song_name FROM song s JOIN artist a ON s.artist_name = a.artist_name WHERE a.gender = 'Female' AND s.rating > 6 AND s.resolution >= 320;",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1140,
    "db_id": "music_1",
    "question": "What is the average rating of songs performed by female artists from India?",
    "sql": "SELECT AVG(s.rating) FROM song s INNER JOIN artist a ON s.artist_name = a.artist_name WHERE a.country = 'India' AND a.gender = 'Female';",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1141,
    "db_id": "music_1",
    "question": "What is the duration of the song from the blues genre released in the USA?",
    "sql": "SELECT files.duration FROM files JOIN song ON files.f_id = song.f_id WHERE song.genre_is = 'blues' AND song.country = 'USA';",
    "table_names": [
      "files",
      "song"
    ]
  },
  {
    "id": 1142,
    "db_id": "music_1",
    "question": "List the names of songs with a rating of 6 or higher that are stored as mp4 format files and have a duration longer than 4 minutes.",
    "sql": "SELECT song_name FROM song WHERE f_id IN (SELECT f_id FROM files WHERE formats='mp4' AND duration>'4:00') AND rating>=6;",
    "table_names": [
      "files",
      "song"
    ]
  },
  {
    "id": 1143,
    "db_id": "music_1",
    "question": "What is the average song rating for songs sung by female artists from Bangladesh?",
    "sql": "SELECT AVG(s.rating) FROM song s JOIN artist a ON s.artist_name = a.artist_name WHERE a.country='Bangladesh' AND a.gender='Female';",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1144,
    "db_id": "music_1",
    "question": "What is the average rating of songs sung by female artists from Bangladesh?",
    "sql": "SELECT AVG(s.rating) FROM song s JOIN artist a ON s.artist_name = a.artist_name WHERE a.gender = 'Female' AND a.country = 'Bangladesh';",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1145,
    "db_id": "music_1",
    "question": "Which songs performed by artists from India have a rating of 8 or higher?",
    "sql": "SELECT song.song_name FROM song JOIN artist ON song.artist_name = artist.artist_name WHERE artist.country = 'India' AND song.rating >= 8;",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1146,
    "db_id": "music_1",
    "question": "List the names of songs that are performed by female artists and have a rating above 6 and a resolution of at least 320.",
    "sql": "SELECT song.song_name FROM song JOIN artist ON song.artist_name = artist.artist_name WHERE artist.gender = 'Female' AND song.rating > 6 AND song.resolution >= 320;",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1147,
    "db_id": "music_1",
    "question": "How many distinct songs by artists from Bangladesh have a rating of 6 or higher?",
    "sql": "SELECT COUNT(DISTINCT s.song_name) FROM song s JOIN artist a ON s.artist_name = a.artist_name WHERE a.country = 'Bangladesh' AND s.rating >= 6;",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1148,
    "db_id": "music_1",
    "question": "Which female artist from Bangladesh has songs rated higher than 6?",
    "sql": "SELECT artist.artist_name FROM artist JOIN song ON artist.artist_name = song.artist_name WHERE artist.gender = 'Female' AND artist.country = 'Bangladesh' AND song.rating > 6;",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1149,
    "db_id": "music_1",
    "question": "What is the file size of the song with the highest rating from India?",
    "sql": "SELECT files.file_size FROM files JOIN song ON files.f_id = song.f_id WHERE song.country = 'India' AND song.rating = (SELECT MAX(rating) FROM song WHERE country = 'India');",
    "table_names": [
      "files",
      "song"
    ]
  },
  {
    "id": 1150,
    "db_id": "music_1",
    "question": "What are the names of songs with a rating greater than 6 from Bangladesh that have an mp4 file format?",
    "sql": "SELECT song.song_name FROM song JOIN files ON song.f_id = files.f_id WHERE files.formats = 'mp4' AND song.country = 'Bangladesh' AND song.rating > 6;",
    "table_names": [
      "files",
      "song"
    ]
  },
  {
    "id": 1151,
    "db_id": "music_1",
    "question": "What is the name of the song with a rating above 7 that is available in mp4 format with a file size greater than '4.00 MB'?",
    "sql": "SELECT s.song_name FROM song AS s JOIN files AS f ON s.f_id = f.f_id WHERE s.rating > 7 AND f.formats = 'mp4' AND f.file_size > '4.00 MB';",
    "table_names": [
      "files",
      "song"
    ]
  },
  {
    "id": 1152,
    "db_id": "music_1",
    "question": "What are the names and durations of songs that have ratings higher than 7, are in the Bangla language, and have an mp4 file format?",
    "sql": "SELECT song.song_name,files.duration FROM song JOIN files ON song.f_id = files.f_id WHERE song.languages='bangla' AND files.formats='mp4' AND rating > 7;",
    "table_names": [
      "files",
      "song"
    ]
  },
  {
    "id": 1153,
    "db_id": "music_1",
    "question": "Which songs have a rating higher than 7 and are available in mp4 format?",
    "sql": "SELECT song.song_name FROM song JOIN files ON song.f_id = files.f_id WHERE files.formats = 'mp4' AND song.rating > 7;",
    "table_names": [
      "files",
      "song"
    ]
  },
  {
    "id": 1154,
    "db_id": "music_1",
    "question": "What is the name of the Bengali song with the highest rating that is available in mp4 format?",
    "sql": "SELECT s.song_name FROM song s JOIN files f ON s.f_id = f.f_id WHERE s.rating = (SELECT MAX(rating) FROM song WHERE languages='bangla') AND f.formats='mp4';",
    "table_names": [
      "files",
      "song"
    ]
  },
  {
    "id": 1155,
    "db_id": "music_1",
    "question": "Which songs were sung by female artists from Bangladesh with a rating greater than 5?",
    "sql": "SELECT s.song_name FROM song s JOIN artist a ON s.artist_name = a.artist_name WHERE a.country = 'Bangladesh' AND a.gender = 'Female' AND s.rating > 5;",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1156,
    "db_id": "music_1",
    "question": "What is the rating of the bangla song performed by the female artist from India?",
    "sql": "SELECT song.rating FROM song JOIN artist ON song.artist_name = artist.artist_name WHERE artist.gender = 'Female' AND artist.country = 'India' AND song.languages = 'bangla';",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1157,
    "db_id": "music_1",
    "question": "List the names of songs with a rating greater than 7 that are stored in 'mp4' file format.",
    "sql": "SELECT song.song_name FROM song JOIN files ON song.f_id = files.f_id WHERE files.formats = 'mp4' AND song.rating > 7;",
    "table_names": [
      "files",
      "song"
    ]
  },
  {
    "id": 1158,
    "db_id": "music_1",
    "question": "What is the average rating of songs whose files are stored in mp4 format?",
    "sql": "SELECT AVG(rating) FROM song WHERE f_id IN (SELECT f_id FROM files WHERE formats='mp4');",
    "table_names": [
      "files",
      "song"
    ]
  },
  {
    "id": 1159,
    "db_id": "music_1",
    "question": "What is the name of the folk genre song available in mp4 format with a rating higher than 5?",
    "sql": "SELECT s.song_name FROM song s JOIN files f ON s.f_id = f.f_id WHERE s.genre_is = 'folk' AND f.formats = 'mp4' AND s.rating > 5",
    "table_names": [
      "files",
      "song"
    ]
  },
  {
    "id": 1160,
    "db_id": "music_1",
    "question": "What is the name and artist of the bangla song that has the highest rating?",
    "sql": "SELECT song_name, artist_name FROM song WHERE rating = (SELECT MAX(rating) FROM song WHERE languages = 'bangla') AND languages = 'bangla';",
    "table_names": [
      "files",
      "song"
    ]
  },
  {
    "id": 1161,
    "db_id": "music_1",
    "question": "Who are the artists from Bangladesh whose songs have a format of mp4 and a rating greater than 6?",
    "sql": "SELECT f.artist_name FROM files f JOIN song s ON f.f_id = s.f_id WHERE s.country='Bangladesh' AND f.formats='mp4' AND s.rating > 6;",
    "table_names": [
      "files",
      "song"
    ]
  },
  {
    "id": 1162,
    "db_id": "music_1",
    "question": "How many Bangla language songs with a rating above 6 are available in mp4 format?",
    "sql": "SELECT COUNT(*) FROM song JOIN files ON song.f_id = files.f_id WHERE files.formats = 'mp4' AND song.languages = 'bangla' AND song.rating > 6;",
    "table_names": [
      "files",
      "song"
    ]
  },
  {
    "id": 1163,
    "db_id": "music_1",
    "question": "What is the average rating of songs performed by female artists from Bangladesh?",
    "sql": "SELECT AVG(song.rating) FROM song INNER JOIN artist ON song.artist_name = artist.artist_name WHERE artist.gender = 'Female' AND artist.country = 'Bangladesh';",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1164,
    "db_id": "music_1",
    "question": "List the names of female artists from Bangladesh who have songs with ratings higher than 6.",
    "sql": "SELECT artist.artist_name FROM artist JOIN song ON artist.artist_name = song.artist_name WHERE artist.country = 'Bangladesh' AND song.rating > 6 AND artist.gender = 'Female';",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1165,
    "db_id": "music_1",
    "question": "What are the names of songs sung by female artists that have a rating above 6 and are in the Bangla language?",
    "sql": "SELECT s.song_name FROM song s JOIN artist a ON s.artist_name = a.artist_name WHERE a.gender='Female' AND s.rating > 6 AND s.languages='bangla';",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1166,
    "db_id": "music_1",
    "question": "What are the names of the artists and their corresponding songs that are in the bangla language, having a rating of at least 7, whose artists are not from India?",
    "sql": "SELECT artist.artist_name, song.song_name FROM artist INNER JOIN song ON artist.artist_name = song.artist_name WHERE artist.country != 'India' AND song.rating >= 7 AND song.languages = 'bangla';",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1167,
    "db_id": "music_1",
    "question": "What are the names of Bengali songs having a rating higher than 5, where the genre matches the preferred genres of female artists?",
    "sql": "SELECT song_name FROM song WHERE genre_is IN (SELECT preferred_genre FROM artist WHERE gender='Female') AND rating > 5 AND languages = 'bangla';",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1168,
    "db_id": "music_1",
    "question": "What are the names of songs performed by female artists from Bangladesh that have a higher rating than the song performed by Enrique?",
    "sql": "SELECT s.song_name FROM song s JOIN artist a ON s.artist_name = a.artist_name WHERE a.country = 'Bangladesh' AND a.gender = 'Female' AND s.rating > (SELECT rating FROM song WHERE artist_name = 'Enrique');",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1169,
    "db_id": "music_1",
    "question": "What is the average rating of the songs performed by female artists from Bangladesh?",
    "sql": "SELECT AVG(s.rating) FROM song s JOIN artist a ON s.artist_name = a.artist_name WHERE a.gender = 'Female' AND a.country = 'Bangladesh';",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1170,
    "db_id": "music_1",
    "question": "What is the average rating of songs performed by female artists from Bangladesh?",
    "sql": "SELECT AVG(s.rating) FROM artist a JOIN song s ON a.artist_name = s.artist_name WHERE a.country = 'Bangladesh' AND a.gender = 'Female';",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1171,
    "db_id": "music_1",
    "question": "Name the songs performed by female artists from Bangladesh that have a rating higher than 6.",
    "sql": "SELECT song.song_name FROM song INNER JOIN artist ON song.artist_name = artist.artist_name WHERE artist.country = 'Bangladesh' AND artist.gender = 'Female' AND song.rating > 6;",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1172,
    "db_id": "music_1",
    "question": "List the names of songs with a rating greater than 7 performed by female artists.",
    "sql": "SELECT song.song_name FROM song JOIN artist ON song.artist_name = artist.artist_name WHERE artist.gender = 'Female' AND song.rating > 7;",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1173,
    "db_id": "music_1",
    "question": "Which songs have file sizes larger than 4.00 MB and ratings higher than 7?",
    "sql": "SELECT song.song_name FROM song INNER JOIN files ON song.f_id = files.f_id WHERE files.file_size > '4.00 MB' AND song.rating > 7;",
    "table_names": [
      "files",
      "song"
    ]
  },
  {
    "id": 1174,
    "db_id": "music_1",
    "question": "List the names of Bangla songs with mp4 format having a rating higher than 7.",
    "sql": "SELECT s.song_name FROM song s JOIN files f ON s.f_id = f.f_id WHERE s.languages = 'bangla' AND f.formats = 'mp4' AND s.rating > 7;",
    "table_names": [
      "files",
      "song"
    ]
  },
  {
    "id": 1175,
    "db_id": "music_1",
    "question": "Which songs were sung by female artists from India and have a rating greater than 8?",
    "sql": "SELECT song_name FROM song WHERE artist_name IN (SELECT artist_name FROM artist WHERE gender='Female' AND country='India') AND rating > 8;",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1176,
    "db_id": "music_1",
    "question": "What are the names of artists from India who performed songs rated higher than 7 in the bangla language?",
    "sql": "SELECT artist.artist_name FROM artist JOIN song ON artist.artist_name = song.artist_name WHERE artist.country = 'India' AND song.rating > 7 AND song.languages = 'bangla';",
    "table_names": [
      "artist",
      "song"
    ]
  },
  {
    "id": 1227,
    "db_id": "mountain_photos",
    "question": "How many distinct RGB photos were taken with Sigma branded camera lenses?",
    "sql": "SELECT COUNT(DISTINCT p.id) FROM photos p JOIN camera_lens cl ON p.camera_lens_id = cl.id WHERE cl.brand = 'Sigma' AND p.color = 'RBG';",
    "table_names": [
      "camera_lens",
      "photos"
    ]
  },
  {
    "id": 1228,
    "db_id": "mountain_photos",
    "question": "What are the distinct brands of camera lenses that were used to take black and white photos?",
    "sql": "SELECT DISTINCT c.brand FROM camera_lens c JOIN photos p ON c.id = p.camera_lens_id WHERE p.color = 'Black/White';",
    "table_names": [
      "camera_lens",
      "photos"
    ]
  },
  {
    "id": 1229,
    "db_id": "mountain_photos",
    "question": "List the unique brands of camera lenses used to shoot Black/White photos with maximum aperture smaller than 2.5.",
    "sql": "SELECT cl.brand FROM camera_lens cl JOIN photos p ON cl.id = p.camera_lens_id WHERE p.color = 'Black/White' AND cl.max_aperture < 2.5 GROUP BY cl.brand;",
    "table_names": [
      "camera_lens",
      "photos"
    ]
  },
  {
    "id": 1231,
    "db_id": "mountain_photos",
    "question": "What are the names of the camera lenses used to take RBG colored photos at mountain ID 12?",
    "sql": "SELECT camera_lens.name FROM camera_lens JOIN photos ON camera_lens.id = photos.camera_lens_id WHERE photos.mountain_id = 12 AND photos.color = 'RBG';",
    "table_names": [
      "camera_lens",
      "photos"
    ]
  },
  {
    "id": 1232,
    "db_id": "program_share",
    "question": "What is the total share percentage of channels broadcasting program 1 at night?",
    "sql": "SELECT SUM(c.Share_in_percent) FROM channel c JOIN broadcast b ON c.Channel_ID = b.Channel_ID WHERE b.Program_ID = 1 AND b.Time_of_day = 'Night';",
    "table_names": [
      "channel",
      "broadcast"
    ]
  },
  {
    "id": 1233,
    "db_id": "program_share",
    "question": "How many different channel owners have programs broadcast during the night?",
    "sql": "SELECT COUNT(DISTINCT c.Owner) FROM channel c JOIN broadcast b ON c.Channel_ID = b.Channel_ID WHERE b.Time_of_day = 'Night';",
    "table_names": [
      "channel",
      "broadcast"
    ]
  },
  {
    "id": 1234,
    "db_id": "program_share",
    "question": "What is the average share percentage for channels broadcasting programs during the night?",
    "sql": "SELECT AVG(c.Share_in_percent) FROM channel c JOIN broadcast b ON c.Channel_ID = b.Channel_ID WHERE b.Time_of_day = 'Night';",
    "table_names": [
      "channel",
      "broadcast"
    ]
  },
  {
    "id": 1235,
    "db_id": "program_share",
    "question": "What is the average share percentage of CCTV-owned channels that broadcast in the morning time?",
    "sql": "SELECT AVG(c.Share_in_percent) FROM channel c JOIN broadcast b ON c.Channel_ID = b.Channel_ID WHERE b.Time_of_day='Morning' AND c.Owner='CCTV';",
    "table_names": [
      "channel",
      "broadcast"
    ]
  },
  {
    "id": 1236,
    "db_id": "program_share",
    "question": "Which media group owns the program originating from Shanghai that broadcasts at noon?",
    "sql": "SELECT p.Owner FROM program p JOIN broadcast b ON p.Program_ID = b.Program_ID WHERE b.Time_of_day = 'Noon' AND p.Origin = 'Shanghai' LIMIT 1;",
    "table_names": [
      "program",
      "broadcast"
    ]
  },
  {
    "id": 1237,
    "db_id": "program_share",
    "question": "What are the origins of the programs that are broadcasted during 'Noon'?",
    "sql": "SELECT Origin FROM program WHERE Program_ID IN (SELECT Program_ID FROM broadcast WHERE Time_of_day='Noon');",
    "table_names": [
      "program",
      "broadcast"
    ]
  },
  {
    "id": 1238,
    "db_id": "program_share",
    "question": "Which programs launched in or before 2005 have broadcasts during noon?",
    "sql": "SELECT DISTINCT p.Name FROM program p JOIN broadcast b ON p.Program_ID = b.Program_ID WHERE b.Time_of_day = 'Noon' AND p.Launch <= 2005;",
    "table_names": [
      "program",
      "broadcast"
    ]
  },
  {
    "id": 1239,
    "db_id": "program_share",
    "question": "Which distinct origins have programs that are broadcast at noon?",
    "sql": "SELECT DISTINCT p.Origin FROM program p JOIN broadcast b ON p.Program_ID = b.Program_ID WHERE b.Time_of_day = 'Noon';",
    "table_names": [
      "program",
      "broadcast"
    ]
  },
  {
    "id": 1240,
    "db_id": "program_share",
    "question": "List the names of programs originating from Shanghai that were broadcasted at Noon.",
    "sql": "SELECT p.Name FROM program p JOIN broadcast b ON p.Program_ID = b.Program_ID WHERE b.Time_of_day = 'Noon' AND p.Origin = 'Shanghai';",
    "table_names": [
      "program",
      "broadcast"
    ]
  },
  {
    "id": 1241,
    "db_id": "program_share",
    "question": "Which children's program launched from 2005 onwards is broadcasted on the most number of distinct channels during the morning?",
    "sql": "SELECT p.Name, COUNT(DISTINCT b.Channel_ID) AS Total_Channels FROM program p JOIN broadcast b ON p.Program_ID = b.Program_ID WHERE p.Launch >= 2005 AND b.Time_of_day = 'Morning' GROUP BY p.Name ORDER BY Total_Channels DESC LIMIT 1;",
    "table_names": [
      "program",
      "broadcast"
    ]
  },
  {
    "id": 1242,
    "db_id": "e_learning",
    "question": "What are the names of the male authors who have created courses with subject_id 2?",
    "sql": "SELECT CAT.personal_name, CAT.family_name FROM Course_Authors_and_Tutors CAT JOIN Courses C ON CAT.author_id = C.author_id WHERE C.subject_id = 2 AND CAT.gender_mf = '1';",
    "table_names": [
      "Course_Authors_and_Tutors",
      "Courses"
    ]
  },
  {
    "id": 1243,
    "db_id": "e_learning",
    "question": "What are the family names of female authors who teach courses with subject ID 1?",
    "sql": "SELECT family_name FROM Course_Authors_and_Tutors WHERE author_id IN (SELECT author_id FROM Courses WHERE subject_id = 1) AND gender_mf = '0';",
    "table_names": [
      "Course_Authors_and_Tutors",
      "Courses"
    ]
  },
  {
    "id": 1244,
    "db_id": "e_learning",
    "question": "How many courses are authored by male authors?",
    "sql": "SELECT COUNT(*) FROM Courses WHERE author_id IN (SELECT author_id FROM Course_Authors_and_Tutors WHERE gender_mf = '1');",
    "table_names": [
      "Course_Authors_and_Tutors",
      "Courses"
    ]
  },
  {
    "id": 1245,
    "db_id": "e_learning",
    "question": "Who is the author or tutor that has created the highest number of courses and how many courses did they create?",
    "sql": "SELECT ca.personal_name, ca.family_name, COUNT(c.course_id) AS num_courses FROM Course_Authors_and_Tutors ca JOIN Courses c ON ca.author_id = c.author_id GROUP BY ca.author_id ORDER BY num_courses DESC LIMIT 1;",
    "table_names": [
      "Course_Authors_and_Tutors",
      "Courses"
    ]
  },
  {
    "id": 1246,
    "db_id": "e_learning",
    "question": "Who is the author of the 'machine learning' course and what is their address?",
    "sql": "SELECT personal_name, family_name, address_line_1 FROM Course_Authors_and_Tutors WHERE author_id IN (SELECT author_id FROM Courses WHERE subject_id = 1 AND course_name = 'machine learning');",
    "table_names": [
      "Course_Authors_and_Tutors",
      "Courses"
    ]
  },
  {
    "id": 1247,
    "db_id": "e_learning",
    "question": "List the personal and family names of authors who have created courses belonging to subject_id 2.",
    "sql": "SELECT personal_name, family_name FROM Course_Authors_and_Tutors WHERE author_id IN (SELECT author_id FROM Courses WHERE subject_id = 2);",
    "table_names": [
      "Course_Authors_and_Tutors",
      "Courses"
    ]
  },
  {
    "id": 1248,
    "db_id": "e_learning",
    "question": "Who are the authors that have created more than one course?",
    "sql": "SELECT family_name, personal_name FROM Course_Authors_and_Tutors WHERE author_id IN (SELECT author_id FROM Courses GROUP BY author_id HAVING COUNT(course_id) > 1);",
    "table_names": [
      "Course_Authors_and_Tutors",
      "Courses"
    ]
  },
  {
    "id": 1249,
    "db_id": "e_learning",
    "question": "Can you provide the names of authors who have authored more than one course for subject_id 1?",
    "sql": "SELECT personal_name, family_name FROM Course_Authors_and_Tutors WHERE author_id IN (SELECT author_id FROM Courses WHERE subject_id = 1 GROUP BY author_id HAVING COUNT(course_id) > 1);",
    "table_names": [
      "Course_Authors_and_Tutors",
      "Courses"
    ]
  },
  {
    "id": 1250,
    "db_id": "e_learning",
    "question": "Who is the male author that has created the highest number of courses, and how many courses did he create?",
    "sql": "SELECT CAT.personal_name, CAT.family_name, COUNT(C.course_id) AS course_count FROM Course_Authors_and_Tutors AS CAT JOIN Courses AS C ON CAT.author_id = C.author_id WHERE CAT.gender_mf = '1' GROUP BY CAT.author_id ORDER BY course_count DESC LIMIT 1;",
    "table_names": [
      "Course_Authors_and_Tutors",
      "Courses"
    ]
  },
  {
    "id": 1251,
    "db_id": "e_learning",
    "question": "What are the names of courses under subject ID 1 that are authored by female authors?",
    "sql": "SELECT c.course_name FROM Courses c JOIN Course_Authors_and_Tutors a ON c.author_id = a.author_id WHERE a.gender_mf = '0' AND c.subject_id = 1;",
    "table_names": [
      "Course_Authors_and_Tutors",
      "Courses"
    ]
  },
  {
    "id": 1252,
    "db_id": "e_learning",
    "question": "How many courses belong to the subject 'Language'?",
    "sql": "SELECT COUNT(*) FROM Courses c JOIN Subjects s ON c.subject_id = s.subject_id WHERE s.subject_name = 'Language';",
    "table_names": [
      "Subjects",
      "Courses"
    ]
  },
  {
    "id": 1253,
    "db_id": "e_learning",
    "question": "How many courses are available that belong to either 'Computer Science' or 'Language' subjects?",
    "sql": "SELECT COUNT(*) FROM Courses INNER JOIN Subjects ON Courses.subject_id = Subjects.subject_id WHERE Subjects.subject_name = 'Computer Science' OR Subjects.subject_name = 'Language';",
    "table_names": [
      "Subjects",
      "Courses"
    ]
  },
  {
    "id": 1254,
    "db_id": "e_learning",
    "question": "How many courses are offered in total under the 'Computer Science' and 'Arts' subjects?",
    "sql": "SELECT COUNT(*) FROM Courses c JOIN Subjects s ON c.subject_id = s.subject_id WHERE s.subject_name = 'Computer Science' OR s.subject_name = 'Arts';",
    "table_names": [
      "Subjects",
      "Courses"
    ]
  },
  {
    "id": 1255,
    "db_id": "e_learning",
    "question": "How many language courses have the word 'French' in their course name?",
    "sql": "SELECT COUNT(*) FROM Courses WHERE subject_id = (SELECT subject_id FROM Subjects WHERE subject_name = 'Language') AND course_name LIKE '%French%';",
    "table_names": [
      "Subjects",
      "Courses"
    ]
  },
  {
    "id": 1256,
    "db_id": "e_learning",
    "question": "How many courses are there in total under the subjects 'Computer Science' or 'Language'?",
    "sql": "SELECT COUNT(*) FROM Courses c JOIN Subjects s ON c.subject_id = s.subject_id WHERE s.subject_name = 'Computer Science' OR s.subject_name = 'Language';",
    "table_names": [
      "Subjects",
      "Courses"
    ]
  },
  {
    "id": 1257,
    "db_id": "e_learning",
    "question": "How many courses are offered under the subject 'Computer Science'?",
    "sql": "SELECT COUNT(*) FROM Courses INNER JOIN Subjects ON Courses.subject_id = Subjects.subject_id WHERE Subjects.subject_name = 'Computer Science';",
    "table_names": [
      "Subjects",
      "Courses"
    ]
  },
  {
    "id": 1286,
    "db_id": "insurance_policies",
    "question": "For Claim_ID 621, how many settlements were made, and what is the total amount settled across all settlements?",
    "sql": "SELECT COUNT(*) AS Num_Settlements, SUM(Amount_Settled) AS Total_Settled FROM Settlements WHERE Claim_ID = 621",
    "table_names": [
      "Claims",
      "Settlements"
    ]
  },
  {
    "id": 1287,
    "db_id": "insurance_policies",
    "question": "What is the average amount settled in the Settlements table for all claims associated with policy ID 473 from the Claims table?",
    "sql": "SELECT AVG(s.Amount_Settled) FROM Settlements s JOIN Claims c ON s.Claim_ID = c.Claim_ID WHERE c.Policy_ID = 473;",
    "table_names": [
      "Claims",
      "Settlements"
    ]
  },
  {
    "id": 1288,
    "db_id": "insurance_policies",
    "question": "For policy number 744, which claim resulted in the highest combined settlement amount when considering both claim and settlement tables?",
    "sql": "SELECT Claims.Claim_ID, Claims.Amount_Settled + Settlements.Amount_Settled AS Total_Settled FROM Claims INNER JOIN Settlements ON Claims.Claim_ID = Settlements.Claim_ID WHERE Claims.Policy_ID = 744 ORDER BY Total_Settled DESC LIMIT 1;",
    "table_names": [
      "Claims",
      "Settlements"
    ]
  },
  {
    "id": 1289,
    "db_id": "insurance_policies",
    "question": "What is the average settled amount for all settlements related to claims with policy ID 473?",
    "sql": "SELECT AVG(s.Amount_Settled) FROM Claims c INNER JOIN Settlements s ON c.Claim_ID = s.Claim_ID WHERE c.Policy_ID = 473;",
    "table_names": [
      "Claims",
      "Settlements"
    ]
  },
  {
    "id": 1290,
    "db_id": "insurance_policies",
    "question": "What is the total amount settled from settlements in the year 2017 for claims associated with policy 744?",
    "sql": "SELECT SUM(s.Amount_Settled) FROM Settlements s INNER JOIN Claims c ON s.Claim_ID = c.Claim_ID WHERE c.Policy_ID = 744 AND s.Date_Claim_Settled BETWEEN '2017-01-01' AND '2017-12-31';",
    "table_names": [
      "Claims",
      "Settlements"
    ]
  },
  {
    "id": 1291,
    "db_id": "insurance_policies",
    "question": "What is the total amount settled in 2018 for all settlements related to claims under Policy ID 744?",
    "sql": "SELECT SUM(s.Amount_Settled) FROM Settlements s JOIN Claims c ON s.Claim_ID = c.Claim_ID WHERE c.Policy_ID = 744 AND YEAR(s.Date_Claim_Settled) = 2018;",
    "table_names": [
      "Claims",
      "Settlements"
    ]
  },
  {
    "id": 1292,
    "db_id": "insurance_policies",
    "question": "What is the total amount settled in the year 2017 from the settlements table, for all claims associated with policy ID 473?",
    "sql": "SELECT SUM(s.Amount_Settled) FROM Settlements s JOIN Claims c ON s.Claim_ID = c.Claim_ID WHERE c.Policy_ID = 473 AND s.Date_Claim_Settled BETWEEN '2017-01-01' AND '2017-12-31';",
    "table_names": [
      "Claims",
      "Settlements"
    ]
  },
  {
    "id": 1293,
    "db_id": "insurance_policies",
    "question": "What is the total amount settled for claims settled during 2018, that also had settlements with claimed amounts greater than 50,000?",
    "sql": "SELECT SUM(Claims.Amount_Settled) AS Total_Settled_Amount FROM Claims INNER JOIN Settlements ON Claims.Claim_ID = Settlements.Claim_ID WHERE Claims.Date_Claim_Settled BETWEEN '2018-01-01' AND '2018-12-31' AND Settlements.Amount_Claimed > 50000;",
    "table_names": [
      "Claims",
      "Settlements"
    ]
  },
  {
    "id": 1294,
    "db_id": "insurance_policies",
    "question": "Which customers hold 'Property' type policies with an expiration date after December 31, 2017?",
    "sql": "SELECT Customers.Customer_Details FROM Customers JOIN Customer_Policies ON Customers.Customer_ID = Customer_Policies.Customer_ID WHERE Customer_Policies.Policy_Type_Code = 'Property' AND Customer_Policies.End_Date > '2017-12-31';",
    "table_names": [
      "Customers",
      "Customer_Policies"
    ]
  },
  {
    "id": 1295,
    "db_id": "insurance_policies",
    "question": "What is the Policy ID of the Travel policy owned by Mrs. Hanna Willms that ended after December 1st, 2017?",
    "sql": "SELECT CP.Policy_ID FROM Customer_Policies CP JOIN Customers C ON CP.Customer_ID = C.Customer_ID WHERE C.Customer_Details = 'Mrs. Hanna Willms' AND CP.Policy_Type_Code = 'Travel' AND CP.End_Date > '2017-12-01';",
    "table_names": [
      "Customers",
      "Customer_Policies"
    ]
  },
  {
    "id": 1296,
    "db_id": "insurance_policies",
    "question": "What is the most recent car insurance policy ID of customer Dr. Diana Rath?",
    "sql": "SELECT cp.Policy_ID FROM Customer_Policies cp JOIN Customers c ON cp.Customer_ID = c.Customer_ID WHERE c.Customer_Details = 'Dr. Diana Rath' AND cp.Policy_Type_Code = 'Car' ORDER BY cp.Start_Date DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Customer_Policies"
    ]
  },
  {
    "id": 1297,
    "db_id": "insurance_policies",
    "question": "Which customers have 'Property' policies with an end date later than January 1, 2018?",
    "sql": "SELECT Customers.Customer_Details FROM Customers JOIN Customer_Policies ON Customers.Customer_ID = Customer_Policies.Customer_ID WHERE Customer_Policies.Policy_Type_Code = 'Property' AND Customer_Policies.End_Date > '2018-01-01';",
    "table_names": [
      "Customers",
      "Customer_Policies"
    ]
  },
  {
    "id": 1298,
    "db_id": "insurance_policies",
    "question": "What is the total amount settled for claims under policy ID 744 from the Settlements table that were settled during the year 2017?",
    "sql": "SELECT SUM(s.Amount_Settled) FROM Settlements s JOIN Claims c ON s.Claim_ID = c.Claim_ID WHERE c.Policy_ID = 744 AND s.Date_Claim_Settled BETWEEN '2017-01-01' AND '2017-12-31';",
    "table_names": [
      "Claims",
      "Settlements"
    ]
  },
  {
    "id": 1299,
    "db_id": "insurance_policies",
    "question": "What is the total amount settled for claims made under policy ID 473 that have settlements recorded with a Customer_Policy_ID greater than 500?",
    "sql": "SELECT SUM(s.Amount_Settled) FROM Claims c INNER JOIN Settlements s ON c.Claim_ID = s.Claim_ID WHERE c.Policy_ID = 473 AND s.Customer_Policy_ID > 500;",
    "table_names": [
      "Claims",
      "Settlements"
    ]
  },
  {
    "id": 1300,
    "db_id": "hospital_1",
    "question": "Who is the head of the Surgery Department, and what is their position?",
    "sql": "SELECT Physician.Name FROM Physician JOIN Department ON Physician.EmployeeID = Department.Head WHERE Department.Name = 'Surgery';",
    "table_names": [
      "Physician",
      "Department"
    ]
  },
  {
    "id": 1301,
    "db_id": "hospital_1",
    "question": "Who is the head of the Surgery department?",
    "sql": "SELECT Physician.Name FROM Physician JOIN Department ON Physician.EmployeeID = Department.Head WHERE Department.Name = 'Surgery';",
    "table_names": [
      "Physician",
      "Department"
    ]
  },
  {
    "id": 1302,
    "db_id": "hospital_1",
    "question": "How many appointments were scheduled with a physician different from the primary care provider (PCP) for patients who have PCP number 1?",
    "sql": "SELECT COUNT(DISTINCT a.AppointmentID) FROM Appointment a JOIN Patient p ON a.Patient = p.SSN WHERE p.PCP = 1 AND a.Physician <> p.PCP;",
    "table_names": [
      "Patient",
      "Appointment"
    ]
  },
  {
    "id": 1303,
    "db_id": "hospital_1",
    "question": "Which patient has had the most appointments with the physician with ID 1?",
    "sql": "SELECT Patient.Name, COUNT(Appointment.AppointmentID) as NumAppointments FROM Patient JOIN Appointment ON Patient.SSN = Appointment.Patient WHERE Appointment.Physician = 1 GROUP BY Patient.Name ORDER BY NumAppointments DESC LIMIT 1;",
    "table_names": [
      "Patient",
      "Appointment"
    ]
  },
  {
    "id": 1304,
    "db_id": "hospital_1",
    "question": "How many unique appointments are scheduled in Examination Room B for patients whose primary care physician (PCP) ID is 2?",
    "sql": "SELECT COUNT(DISTINCT Appointment.AppointmentID) FROM Appointment JOIN Patient ON Appointment.Patient = Patient.SSN WHERE Patient.PCP = 2 AND Appointment.ExaminationRoom = 'B';",
    "table_names": [
      "Patient",
      "Appointment"
    ]
  },
  {
    "id": 1305,
    "db_id": "hospital_1",
    "question": "How many distinct physicians have appointments scheduled with patients living at Foobar Lane?",
    "sql": "SELECT COUNT(DISTINCT a.Physician) FROM Appointment a JOIN Patient p ON a.Patient = p.SSN WHERE p.Address LIKE '%Foobar Lane%';",
    "table_names": [
      "Patient",
      "Appointment"
    ]
  },
  {
    "id": 1306,
    "db_id": "hospital_1",
    "question": "Which physician attended to patient 100000001 in examination room 'C'?",
    "sql": "SELECT DISTINCT Physician.Name FROM Physician JOIN Appointment ON Physician.EmployeeID = Appointment.Physician WHERE Appointment.Patient = 100000001 AND Appointment.ExaminationRoom = 'C';",
    "table_names": [
      "Physician",
      "Appointment"
    ]
  },
  {
    "id": 1307,
    "db_id": "hospital_1",
    "question": "Which Surgical Attending Physician has the highest number of appointments?",
    "sql": "SELECT Physician.Name, COUNT(Appointment.AppointmentID) AS Num_Appointments FROM Physician INNER JOIN Appointment ON Physician.EmployeeID = Appointment.Physician WHERE Physician.Position LIKE '%Surgical Attending Physician%' GROUP BY Physician.Name ORDER BY Num_Appointments DESC LIMIT 1;",
    "table_names": [
      "Physician",
      "Appointment"
    ]
  },
  {
    "id": 1308,
    "db_id": "hospital_1",
    "question": "Which physicians had appointments scheduled in examination room 'C' on April 26, 2008?",
    "sql": "SELECT DISTINCT p.Name FROM Physician p JOIN Appointment a ON p.EmployeeID = a.Physician WHERE a.ExaminationRoom = 'C' AND DATE(a.Start) = '2008-04-26';",
    "table_names": [
      "Physician",
      "Appointment"
    ]
  },
  {
    "id": 1309,
    "db_id": "hospital_1",
    "question": "What is the name of the physician who attended patient 100000004 in examination room 'C'?",
    "sql": "SELECT Physician.Name FROM Physician INNER JOIN Appointment ON Physician.EmployeeID = Appointment.Physician WHERE Appointment.Patient = 100000004 AND Appointment.ExaminationRoom = 'C';",
    "table_names": [
      "Physician",
      "Appointment"
    ]
  },
  {
    "id": 1310,
    "db_id": "hospital_1",
    "question": "Which patient has the highest number of appointments?",
    "sql": "SELECT P.Name, COUNT(A.AppointmentID) AS Number_of_Appointments FROM Patient P JOIN Appointment A ON P.SSN = A.Patient GROUP BY P.SSN, P.Name ORDER BY Number_of_Appointments DESC LIMIT 1;",
    "table_names": [
      "Patient",
      "Appointment"
    ]
  },
  {
    "id": 1311,
    "db_id": "hospital_1",
    "question": "How many appointments have been scheduled with Physician 2 for patients whose primary care physician (PCP) is number 2?",
    "sql": "SELECT COUNT(DISTINCT a.AppointmentID) FROM Appointment a JOIN Patient p ON a.Patient = p.SSN WHERE p.PCP = 2 AND a.Physician = 2;",
    "table_names": [
      "Patient",
      "Appointment"
    ]
  },
  {
    "id": 1314,
    "db_id": "hospital_1",
    "question": "How many unique patients have had appointments prepared by the head nurse in examination room 'A'?",
    "sql": "SELECT COUNT(DISTINCT a.Patient) FROM Appointment a JOIN Nurse n ON a.PrepNurse = n.EmployeeID WHERE n.Position = 'Head Nurse' AND a.ExaminationRoom = 'A';",
    "table_names": [
      "Nurse",
      "Appointment"
    ]
  },
  {
    "id": 1315,
    "db_id": "hospital_1",
    "question": "What is the name of the nurse who prepared the patient for the appointment that took place in examination room B on April 24, 2008?",
    "sql": "SELECT Nurse.Name FROM Nurse JOIN Appointment ON Nurse.EmployeeID = Appointment.PrepNurse WHERE Appointment.ExaminationRoom = 'B' AND Appointment.Start LIKE '2008-04-24%'",
    "table_names": [
      "Nurse",
      "Appointment"
    ]
  },
  {
    "id": 1316,
    "db_id": "hospital_1",
    "question": "What are the names and positions of physicians who serve as primary care providers for patients living at addresses containing either 'Foobar Lane' or 'Foobaz Avenue'?",
    "sql": "SELECT Physician.Name, Physician.Position FROM Physician WHERE Physician.EmployeeID IN (SELECT PCP FROM Patient WHERE Address LIKE '%Foobar Lane%' OR Address LIKE '%Foobaz Avenue%');",
    "table_names": [
      "Physician",
      "Patient"
    ]
  },
  {
    "id": 1317,
    "db_id": "hospital_1",
    "question": "Which patients have a primary care physician whose position is 'Attending Physician'?",
    "sql": "SELECT p.Name FROM Patient AS p JOIN Physician AS ph ON p.PCP = ph.EmployeeID WHERE ph.Position = 'Attending Physician';",
    "table_names": [
      "Physician",
      "Patient"
    ]
  },
  {
    "id": 1318,
    "db_id": "hospital_1",
    "question": "Which Physicians serve as primary care providers (PCP) for more than one patient?",
    "sql": "SELECT Physician.Name FROM Physician WHERE Physician.EmployeeID IN (SELECT PCP FROM Patient GROUP BY PCP HAVING COUNT(*) > 1);",
    "table_names": [
      "Physician",
      "Patient"
    ]
  },
  {
    "id": 1319,
    "db_id": "hospital_1",
    "question": "What is the name and position of the Primary Care Physician assigned to the patient with Insurance ID 36546321?",
    "sql": "SELECT Physician.Name, Physician.Position FROM Physician INNER JOIN Patient ON Physician.EmployeeID = Patient.PCP WHERE Patient.InsuranceID = 36546321;",
    "table_names": [
      "Physician",
      "Patient"
    ]
  },
  {
    "id": 1324,
    "db_id": "hospital_1",
    "question": "What is the name of the medication that was prescribed most frequently, and how many times was it prescribed?",
    "sql": "SELECT Medication.Name, COUNT(Prescribes.Medication) as Prescription_Count FROM Medication JOIN Prescribes ON Medication.Code = Prescribes.Medication GROUP BY Medication.Name ORDER BY Prescription_Count DESC LIMIT 1",
    "table_names": [
      "Medication",
      "Prescribes"
    ]
  },
  {
    "id": 1325,
    "db_id": "hospital_1",
    "question": "Which brands of medications have been prescribed by physician number 9 to patient 100000004?",
    "sql": "SELECT DISTINCT m.Brand FROM Medication m JOIN Prescribes p ON m.Code = p.Medication WHERE p.Physician = 9 AND p.Patient = 100000004;",
    "table_names": [
      "Medication",
      "Prescribes"
    ]
  },
  {
    "id": 1326,
    "db_id": "hospital_1",
    "question": "How many unique procedures has patient Dennis Doe undergone?",
    "sql": "SELECT COUNT(DISTINCT u.Procedures) FROM Patient p INNER JOIN Undergoes u ON p.SSN = u.Patient WHERE p.Name = 'Dennis Doe';",
    "table_names": [
      "Patient",
      "Undergoes"
    ]
  },
  {
    "id": 1327,
    "db_id": "hospital_1",
    "question": "Who was the patient that underwent a procedure performed by Physician 3 on May 2, 2008?",
    "sql": "SELECT Patient.Name FROM Patient INNER JOIN Undergoes ON Patient.SSN = Undergoes.Patient WHERE Undergoes.Physician = 3 AND Undergoes.DateUndergoes = '2008-05-02';",
    "table_names": [
      "Patient",
      "Undergoes"
    ]
  },
  {
    "id": 1328,
    "db_id": "hospital_1",
    "question": "List the names of registered nurses who have assisted in more than one procedure, along with the patients and the total number of procedures each nurse has assisted.",
    "sql": "SELECT Nurse.Name, Undergoes.Patient, COUNT(Undergoes.Procedures) as NumProcedures FROM Nurse INNER JOIN Undergoes ON Nurse.EmployeeID = Undergoes.AssistingNurse WHERE Nurse.Registered = 1 GROUP BY Nurse.EmployeeID HAVING COUNT(Undergoes.Procedures) > 1;",
    "table_names": [
      "Nurse",
      "Undergoes"
    ]
  },
  {
    "id": 1329,
    "db_id": "hospital_1",
    "question": "Which registered nurse has assisted in the highest number of procedures?",
    "sql": "SELECT Nurse.Name, COUNT(*) AS TotalProcedures FROM Nurse JOIN Undergoes ON Nurse.EmployeeID = Undergoes.AssistingNurse WHERE Nurse.Registered = 1 GROUP BY Nurse.Name ORDER BY TotalProcedures DESC LIMIT 1;",
    "table_names": [
      "Nurse",
      "Undergoes"
    ]
  },
  {
    "id": 1330,
    "db_id": "hospital_1",
    "question": "What are the names of physicians who prescribed medication ID 2 with a dose equal to or greater than 5?",
    "sql": "SELECT DISTINCT Physician.Name FROM Physician JOIN Prescribes ON Physician.EmployeeID = Prescribes.Physician WHERE Prescribes.Dose >= '5' AND Prescribes.Medication = 2;",
    "table_names": [
      "Physician",
      "Prescribes"
    ]
  },
  {
    "id": 1331,
    "db_id": "hospital_1",
    "question": "What is the name of the physician who prescribed medication number 2 with a dose of 10 on '2008-04-27 10:53'?",
    "sql": "SELECT Physician.Name FROM Physician JOIN Prescribes ON Physician.EmployeeID = Prescribes.Physician WHERE Prescribes.Patient = 100000004 AND Prescribes.Medication = 2 AND Prescribes.Date = '2008-04-27 10:53';",
    "table_names": [
      "Physician",
      "Prescribes"
    ]
  },
  {
    "id": 1332,
    "db_id": "hospital_1",
    "question": "Which departments have more than three affiliated physicians?",
    "sql": "SELECT Name FROM Department WHERE DepartmentID IN (SELECT Department FROM Affiliated_With GROUP BY Department HAVING COUNT(Physician) > 3);",
    "table_names": [
      "Department",
      "Affiliated_With"
    ]
  },
  {
    "id": 1333,
    "db_id": "hospital_1",
    "question": "Which department has the highest number of physicians affiliated with it?",
    "sql": "SELECT Name FROM Department WHERE DepartmentID = (SELECT Department FROM Affiliated_With GROUP BY Department ORDER BY COUNT(Physician) DESC LIMIT 1)",
    "table_names": [
      "Department",
      "Affiliated_With"
    ]
  },
  {
    "id": 1334,
    "db_id": "hospital_1",
    "question": "What are the names of registered nurses who are on call for more than one distinct block code, and how many distinct block codes is each one responsible for?",
    "sql": "SELECT n.Name, COUNT(DISTINCT oc.BlockCode) AS BlockCount FROM Nurse n JOIN On_Call oc ON n.EmployeeID = oc.Nurse WHERE n.Registered = 1 GROUP BY n.Name HAVING COUNT(DISTINCT oc.BlockCode) > 1;",
    "table_names": [
      "Nurse",
      "On_Call"
    ]
  },
  {
    "id": 1335,
    "db_id": "hospital_1",
    "question": "What is the name of the registered nurse scheduled to be on call for block floor 1 and block code 2?",
    "sql": "SELECT Nurse.Name FROM Nurse INNER JOIN On_Call ON Nurse.EmployeeID = On_Call.Nurse WHERE On_Call.BlockFloor = 1 AND On_Call.BlockCode = 2 AND Nurse.Registered = 1;",
    "table_names": [
      "Nurse",
      "On_Call"
    ]
  },
  {
    "id": 1336,
    "db_id": "hospital_1",
    "question": "Among nurses registered and on call during the day shift of November 4th, 2008 (from 11:00 AM to 11:59 PM), who covered the greatest number of block codes and how many blocks were covered?",
    "sql": "SELECT Nurse.Name, Count(On_Call.BlockCode) as Total_Blocks FROM Nurse JOIN On_Call ON Nurse.EmployeeID = On_Call.Nurse WHERE Nurse.Registered = 1 AND On_Call.OnCallStart BETWEEN '2008-11-04 11:00' AND '2008-11-04 23:59' GROUP BY Nurse.Name ORDER BY Total_Blocks DESC LIMIT 1;",
    "table_names": [
      "Nurse",
      "On_Call"
    ]
  },
  {
    "id": 1337,
    "db_id": "hospital_1",
    "question": "How many unique block codes were assigned to registered nurses scheduled from '2008-11-04 11:00' to '2008-11-04 19:00'?",
    "sql": "SELECT COUNT(DISTINCT oc.BlockCode) FROM Nurse n JOIN On_Call oc ON n.EmployeeID = oc.Nurse WHERE n.Registered = 1 AND oc.OnCallStart >= '2008-11-04 11:00' AND oc.OnCallEnd <= '2008-11-04 19:00';",
    "table_names": [
      "Nurse",
      "On_Call"
    ]
  },
  {
    "id": 1338,
    "db_id": "ship_mission",
    "question": "What are the names of the cargo ships launched after 1930 whose mission fate includes being decommissioned?",
    "sql": "SELECT s.Name FROM ship s JOIN mission m ON s.Ship_ID = m.Ship_ID WHERE s.Type = 'Cargo ship' AND m.Launched_Year > 1930 AND m.Fate LIKE '%Decommissioned%'",
    "table_names": [
      "mission",
      "ship"
    ]
  },
  {
    "id": 1339,
    "db_id": "ship_mission",
    "question": "What is the average tonnage of cargo ships launched from locations in Finland?",
    "sql": "SELECT AVG(s.Tonnage) FROM mission m JOIN ship s ON m.Ship_ID = s.Ship_ID WHERE m.Location LIKE '%Finland%' AND s.Type = 'Cargo ship';",
    "table_names": [
      "mission",
      "ship"
    ]
  },
  {
    "id": 1340,
    "db_id": "ship_mission",
    "question": "How many missions involved ships from the United Kingdom that were lost?",
    "sql": "SELECT COUNT(*) FROM mission AS m JOIN ship AS s ON m.Ship_ID = s.Ship_ID WHERE s.Nationality = 'United Kingdom' AND m.Fate LIKE 'Lost%';",
    "table_names": [
      "mission",
      "ship"
    ]
  },
  {
    "id": 1341,
    "db_id": "ship_mission",
    "question": "What was the mission code of the mission involving a ship classified as a British battle ship that launched before 1930 and had a speed of less than 20 knots?",
    "sql": "SELECT m.Code FROM mission m JOIN ship s ON m.Ship_ID = s.Ship_ID WHERE s.Type = 'Battle ship' AND s.Nationality = 'United Kingdom' AND m.Launched_Year < 1930 AND m.Speed_knots < 20;",
    "table_names": [
      "mission",
      "ship"
    ]
  },
  {
    "id": 1342,
    "db_id": "ship_mission",
    "question": "Which cargo ships from the United Kingdom participated in missions with speeds exceeding 20 knots?",
    "sql": "SELECT ship.Name FROM ship JOIN mission ON ship.Ship_ID = mission.Ship_ID WHERE mission.Speed_knots > 20 AND ship.Type = 'Cargo ship' AND ship.Nationality = 'United Kingdom';",
    "table_names": [
      "mission",
      "ship"
    ]
  },
  {
    "id": 1343,
    "db_id": "ship_mission",
    "question": "What are the names of ships from the United States with missions that had a speed greater than 20 knots and were eventually decommissioned?",
    "sql": "SELECT ship.Name FROM mission JOIN ship ON mission.Ship_ID = ship.Ship_ID WHERE mission.Speed_knots > 20 AND mission.Fate LIKE '%Decommissioned%' AND ship.Nationality = 'United States';",
    "table_names": [
      "mission",
      "ship"
    ]
  },
  {
    "id": 1344,
    "db_id": "ship_mission",
    "question": "How many cargo ships had missions that resulted in the ship being lost?",
    "sql": "SELECT COUNT(*) FROM mission m JOIN ship s ON m.Ship_ID = s.Ship_ID WHERE s.Type='Cargo ship' AND m.Fate LIKE '%Lost%';",
    "table_names": [
      "mission",
      "ship"
    ]
  },
  {
    "id": 1345,
    "db_id": "ship_mission",
    "question": "What are the names of the ships from the United Kingdom that had missions originating from Finland?",
    "sql": "SELECT ship.Name FROM mission INNER JOIN ship ON mission.Ship_ID = ship.Ship_ID WHERE mission.Location LIKE '%Finland%' AND ship.Nationality = 'United Kingdom';",
    "table_names": [
      "mission",
      "ship"
    ]
  },
  {
    "id": 1366,
    "db_id": "company_employee",
    "question": "What is the average number of years worked in companies by people from the United States who are older than 28?",
    "sql": "SELECT AVG(e.Year_working) FROM people p JOIN employment e ON p.People_ID = e.People_ID WHERE p.Nationality = 'United States' AND p.Age > 28;",
    "table_names": [
      "people",
      "employment"
    ]
  },
  {
    "id": 1367,
    "db_id": "film_rank",
    "question": "What is the title of the film produced by Universal studios having a market estimation type of 'Mass suicide murder' with a high estimate greater than 1000, and in which year was this event estimated?",
    "sql": "SELECT f.Title, fme.Year FROM film f JOIN film_market_estimation fme ON f.Film_ID = fme.Film_ID WHERE f.Studio = 'Universal' AND fme.Type = 'Mass suicide murder' AND fme.High_Estimate > 1000;",
    "table_names": [
      "film",
      "film_market_estimation"
    ]
  },
  {
    "id": 1368,
    "db_id": "film_rank",
    "question": "Which movie produced by a studio containing 'Paramount' has the highest total of high market estimates?",
    "sql": "SELECT f.Title, SUM(fme.High_Estimate) FROM film f JOIN film_market_estimation fme ON f.Film_ID = fme.Film_ID WHERE f.Studio LIKE '%Paramount%' GROUP BY f.Film_ID ORDER BY SUM(fme.High_Estimate) DESC LIMIT 1;",
    "table_names": [
      "film",
      "film_market_estimation"
    ]
  },
  {
    "id": 1369,
    "db_id": "film_rank",
    "question": "Which Paramount distributed film has the highest sum of high market estimates?",
    "sql": "SELECT f.Title, SUM(fme.High_Estimate) AS Total_High_Estimate FROM film AS f JOIN film_market_estimation AS fme ON f.Film_ID = fme.Film_ID WHERE f.Studio LIKE '%Paramount%' GROUP BY f.Title ORDER BY Total_High_Estimate DESC LIMIT 1;",
    "table_names": [
      "film",
      "film_market_estimation"
    ]
  },
  {
    "id": 1370,
    "db_id": "film_rank",
    "question": "What Universal studio film has the highest total sum of high estimates for film market estimation?",
    "sql": "SELECT f.Title, SUM(fme.High_Estimate) as Total_High_Estimate FROM film f JOIN film_market_estimation fme ON f.Film_ID = fme.Film_ID WHERE f.Studio = 'Universal' GROUP BY f.Title ORDER BY Total_High_Estimate DESC LIMIT 1;",
    "table_names": [
      "film",
      "film_market_estimation"
    ]
  },
  {
    "id": 1371,
    "db_id": "film_rank",
    "question": "Which country's market had the highest total low estimation of films related to mass suicide or murder from 1940 to 2000?",
    "sql": "SELECT m.Country, SUM(f.Low_Estimate) AS Total_Low_Estimate FROM film_market_estimation f JOIN market m ON f.Market_ID = m.Market_ID WHERE f.Year >= 1940 AND f.Year <= 2000 GROUP BY m.Country ORDER BY Total_Low_Estimate DESC LIMIT 1;",
    "table_names": [
      "market",
      "film_market_estimation"
    ]
  },
  {
    "id": 1372,
    "db_id": "film_rank",
    "question": "Which country has the highest total high estimate for film market estimations dating from the year 1900 onwards?",
    "sql": "SELECT m.Country, SUM(fme.High_Estimate) AS Total_High_Estimate FROM market m JOIN film_market_estimation fme ON m.Market_ID = fme.Market_ID WHERE fme.Year >= 1900 GROUP BY m.Country ORDER BY Total_High_Estimate DESC LIMIT 1;",
    "table_names": [
      "market",
      "film_market_estimation"
    ]
  },
  {
    "id": 1373,
    "db_id": "film_rank",
    "question": "What is the total high estimate for films of type 'Mass suicide' in markets having more than 220 cities?",
    "sql": "SELECT SUM(film_market_estimation.High_Estimate) FROM film_market_estimation JOIN market ON film_market_estimation.Market_ID = market.Market_ID WHERE market.Number_cities > 220 AND film_market_estimation.Type = 'Mass suicide';",
    "table_names": [
      "market",
      "film_market_estimation"
    ]
  },
  {
    "id": 1374,
    "db_id": "film_rank",
    "question": "What is the total high estimate value for films of type 'Mass suicide' in markets having more than 300 cities?",
    "sql": "SELECT SUM(fme.High_Estimate) FROM film_market_estimation fme JOIN market m ON fme.Market_ID = m.Market_ID WHERE fme.Type = 'Mass suicide' AND m.Number_cities > 300;",
    "table_names": [
      "market",
      "film_market_estimation"
    ]
  },
  {
    "id": 1375,
    "db_id": "film_rank",
    "question": "Which country's market has a 'Mass suicide murder' type film estimation with a high estimate greater than 80,000?",
    "sql": "SELECT m.Country FROM market m INNER JOIN film_market_estimation fme ON m.Market_ID = fme.Market_ID WHERE fme.Type = 'Mass suicide murder' AND fme.High_Estimate > 80000;",
    "table_names": [
      "market",
      "film_market_estimation"
    ]
  },
  {
    "id": 1376,
    "db_id": "film_rank",
    "question": "Which country has the highest film market estimation (high estimate) above 900 for films categorized as 'Mass suicide murder'?",
    "sql": "SELECT market.Country FROM market JOIN film_market_estimation ON market.Market_ID = film_market_estimation.Market_ID WHERE film_market_estimation.Type = 'Mass suicide murder' AND film_market_estimation.High_Estimate > 900 ORDER BY film_market_estimation.High_Estimate DESC LIMIT 1;",
    "table_names": [
      "market",
      "film_market_estimation"
    ]
  },
  {
    "id": 1377,
    "db_id": "film_rank",
    "question": "Which film associated with 'Mass suicide murder' events had the highest gross dollar earnings?",
    "sql": "SELECT f.Title, f.Gross_in_dollar FROM film f JOIN film_market_estimation fme ON f.Film_ID = fme.Film_ID WHERE fme.Type = 'Mass suicide murder' ORDER BY f.Gross_in_dollar DESC LIMIT 1;",
    "table_names": [
      "film",
      "film_market_estimation"
    ]
  },
  {
    "id": 1378,
    "db_id": "film_rank",
    "question": "Which films have estimations categorized as 'Mass suicide murder' with high estimates greater than 900?",
    "sql": "SELECT film.Title FROM film JOIN film_market_estimation ON film.Film_ID = film_market_estimation.Film_ID WHERE film_market_estimation.Type = 'Mass suicide murder' AND film_market_estimation.High_Estimate > 900;",
    "table_names": [
      "film",
      "film_market_estimation"
    ]
  },
  {
    "id": 1379,
    "db_id": "film_rank",
    "question": "Which Paramount studio film has the highest combined high market estimate according to the film market estimation entries?",
    "sql": "SELECT f.Title, SUM(fme.High_Estimate) AS Total_High_Estimate FROM film f JOIN film_market_estimation fme ON f.Film_ID = fme.Film_ID WHERE f.Studio = 'Paramount' GROUP BY f.Title ORDER BY Total_High_Estimate DESC LIMIT 1;",
    "table_names": [
      "film",
      "film_market_estimation"
    ]
  },
  {
    "id": 1380,
    "db_id": "film_rank",
    "question": "What is the average market estimation of films directed by Sylvester Stallone?",
    "sql": "SELECT f.Title, SUM(fme.Low_Estimate + fme.High_Estimate)/2 AS Average_Estimated FROM film f JOIN film_market_estimation fme ON f.Film_ID = fme.Film_ID WHERE f.Director = 'Sylvester Stallone' GROUP BY f.Title;",
    "table_names": [
      "film",
      "film_market_estimation"
    ]
  },
  {
    "id": 1381,
    "db_id": "cre_Doc_Tracking_DB",
    "question": "How many CV-type documents were stored on dates that fall on day number 7?",
    "sql": "SELECT COUNT(ad.Document_ID) FROM All_Documents ad JOIN Ref_Calendar rc ON ad.Date_Stored = rc.Calendar_Date WHERE rc.Day_Number = 7 AND ad.Document_Type_Code = 'CV';",
    "table_names": [
      "Ref_Calendar",
      "All_Documents"
    ]
  },
  {
    "id": 1382,
    "db_id": "cre_Doc_Tracking_DB",
    "question": "How many documents of type 'BK' or 'RV' were stored on dates corresponding to a 'Day_Number' equal to 7?",
    "sql": "SELECT COUNT(*) FROM All_Documents ad JOIN Ref_Calendar rc ON ad.Date_Stored = rc.Calendar_Date WHERE rc.Day_Number = 7 AND ad.Document_Type_Code IN ('BK', 'RV');",
    "table_names": [
      "Ref_Calendar",
      "All_Documents"
    ]
  },
  {
    "id": 1383,
    "db_id": "cre_Doc_Tracking_DB",
    "question": "How many documents of type 'Paper' or 'Review' have been stored after the year 2000?",
    "sql": "SELECT COUNT(*) FROM All_Documents ad JOIN Ref_Document_Types rd ON ad.Document_Type_Code = rd.Document_Type_Code WHERE rd.Document_Type_Name IN ('Paper', 'Review') AND ad.Date_Stored > '2000-01-01'",
    "table_names": [
      "Ref_Document_Types",
      "All_Documents"
    ]
  },
  {
    "id": 1384,
    "db_id": "cre_Doc_Tracking_DB",
    "question": "How many books were stored after the year 2000?",
    "sql": "SELECT COUNT(*) FROM All_Documents ad JOIN Ref_Document_Types rdt ON ad.Document_Type_Code = rdt.Document_Type_Code WHERE rdt.Document_Type_Name = 'Book' AND YEAR(ad.Date_Stored) > 2000;",
    "table_names": [
      "Ref_Document_Types",
      "All_Documents"
    ]
  },
  {
    "id": 1385,
    "db_id": "cre_Doc_Tracking_DB",
    "question": "How many employees working as either 'Editor' or 'Proof Reader' were born before 1985?",
    "sql": "SELECT COUNT(*) FROM Employees e JOIN Roles r ON e.Role_Code = r.Role_Code WHERE r.Role_Name IN ('Editor', 'Proof Reader') AND YEAR(e.Date_of_Birth) < 1985;",
    "table_names": [
      "Roles",
      "Employees"
    ]
  },
  {
    "id": 1386,
    "db_id": "cre_Doc_Tracking_DB",
    "question": "Who is the oldest employee with the role of 'Editor' and what is their date of birth?",
    "sql": "SELECT E.Employee_Name, E.Date_of_Birth FROM Employees E JOIN Roles R ON E.Role_Code = R.Role_Code WHERE R.Role_Name = 'Editor' ORDER BY E.Date_of_Birth ASC LIMIT 1;",
    "table_names": [
      "Roles",
      "Employees"
    ]
  },
  {
    "id": 1387,
    "db_id": "cre_Doc_Tracking_DB",
    "question": "How many employees who hold either an 'Editor' or 'Proof Reader' role were born after January 1st, 1985?",
    "sql": "SELECT COUNT(*) FROM Employees WHERE Role_Code IN (SELECT Role_Code FROM Roles WHERE Role_Name IN ('Editor', 'Proof Reader')) AND DATE(Date_of_Birth) > '1985-01-01';",
    "table_names": [
      "Roles",
      "Employees"
    ]
  },
  {
    "id": 1388,
    "db_id": "cre_Doc_Tracking_DB",
    "question": "How many employees hold the 'Editor' role and have names starting with the letter 'A'?",
    "sql": "SELECT COUNT(*) FROM Employees WHERE Role_Code = (SELECT Role_Code FROM Roles WHERE Role_Name = 'Editor') AND Employee_Name LIKE 'A%';",
    "table_names": [
      "Roles",
      "Employees"
    ]
  },
  {
    "id": 1389,
    "db_id": "cre_Doc_Tracking_DB",
    "question": "How many employees with the role of 'Editor' have birth dates before the year 1980?",
    "sql": "SELECT COUNT(*) FROM Employees WHERE Role_Code = (SELECT Role_Code FROM Roles WHERE Role_Name = 'Editor') AND DATE(Date_of_Birth) < '1980-01-01';",
    "table_names": [
      "Roles",
      "Employees"
    ]
  },
  {
    "id": 1390,
    "db_id": "cre_Doc_Tracking_DB",
    "question": "How many employees holding the Editor role were born before January 1, 1980?",
    "sql": "SELECT COUNT(*) FROM Employees e JOIN Roles r ON e.Role_Code = r.Role_Code WHERE r.Role_Name = 'Editor' AND e.Date_of_Birth < '1980-01-01';",
    "table_names": [
      "Roles",
      "Employees"
    ]
  },
  {
    "id": 1391,
    "db_id": "cre_Doc_Tracking_DB",
    "question": "How many distinct books (Document_Type_Code = 'BK') have ever been located at location code 'x'?",
    "sql": "SELECT COUNT(DISTINCT dl.Document_ID) FROM Document_Locations dl JOIN All_Documents ad ON dl.Document_ID = ad.Document_ID WHERE dl.Location_Code = 'x' AND ad.Document_Type_Code = 'BK';",
    "table_names": [
      "All_Documents",
      "Document_Locations"
    ]
  },
  {
    "id": 1392,
    "db_id": "cre_Doc_Tracking_DB",
    "question": "What are the names of CV type documents that were located in location code 'e' at any time during the period between 2010 to 2017?",
    "sql": "SELECT ad.Document_Name FROM All_Documents ad JOIN Document_Locations dl ON ad.Document_ID = dl.Document_ID WHERE ad.Document_Type_Code = 'CV' AND dl.Location_Code = 'e' AND dl.Date_in_Location_From <= '2017-01-01' AND dl.Date_in_Locaton_To >= '2010-01-01';",
    "table_names": [
      "All_Documents",
      "Document_Locations"
    ]
  },
  {
    "id": 1393,
    "db_id": "cre_Doc_Tracking_DB",
    "question": "How many distinct documents have been located in either Canada or Xiamen after the year 2000?",
    "sql": "SELECT COUNT(DISTINCT dl.Document_ID) FROM Document_Locations dl JOIN Ref_Locations rl ON dl.Location_Code = rl.Location_Code WHERE rl.Location_Name IN ('Canada', 'Xiamen') AND dl.Date_in_Location_From > '2000-01-01 00:00:00';",
    "table_names": [
      "Ref_Locations",
      "Document_Locations"
    ]
  },
  {
    "id": 1394,
    "db_id": "cre_Doc_Tracking_DB",
    "question": "How many unique documents have been associated with either 'Brazil' or 'Xiamen'?",
    "sql": "SELECT COUNT(DISTINCT Document_ID) FROM Document_Locations WHERE Location_Code IN (SELECT Location_Code FROM Ref_Locations WHERE Location_Name IN ('Brazil', 'Xiamen'));",
    "table_names": [
      "Ref_Locations",
      "Document_Locations"
    ]
  },
  {
    "id": 1395,
    "db_id": "cre_Doc_Tracking_DB",
    "question": "Which employee authorized the planned destruction of document ID 170?",
    "sql": "SELECT Employee_Name FROM Employees WHERE Employee_ID IN (SELECT Destruction_Authorised_by_Employee_ID FROM Documents_to_be_Destroyed WHERE Document_ID = 170);",
    "table_names": [
      "Employees",
      "Documents_to_be_Destroyed"
    ]
  },
  {
    "id": 1396,
    "db_id": "cre_Doc_Tracking_DB",
    "question": "What is the name of the employee who authorized the destruction of Document ID 170, and what is the role code of the employee who actually destroyed this document?",
    "sql": "SELECT E1.Employee_Name AS Authorizer_Name, E2.Role_Code AS Destroyer_Role FROM Documents_to_be_Destroyed D JOIN Employees E1 ON D.Destruction_Authorised_by_Employee_ID = E1.Employee_ID JOIN Employees E2 ON D.Destroyed_by_Employee_ID = E2.Employee_ID WHERE D.Document_ID = 170;",
    "table_names": [
      "Employees",
      "Documents_to_be_Destroyed"
    ]
  },
  {
    "id": 1397,
    "db_id": "cre_Doc_Tracking_DB",
    "question": "Which employees authorized the destruction of documents that were destroyed before their planned destruction dates?",
    "sql": "SELECT e.Employee_Name FROM Employees e INNER JOIN Documents_to_be_Destroyed d ON e.Employee_ID = d.Destruction_Authorised_by_Employee_ID WHERE d.Actual_Destruction_Date < d.Planned_Destruction_Date",
    "table_names": [
      "Employees",
      "Documents_to_be_Destroyed"
    ]
  },
  {
    "id": 1398,
    "db_id": "cre_Doc_Tracking_DB",
    "question": "Who authorized the destruction of documents whose actual destruction dates occurred earlier than the planned destruction dates?",
    "sql": "SELECT e.Employee_Name FROM Employees e INNER JOIN Documents_to_be_Destroyed d ON e.Employee_ID = d.Destruction_Authorised_by_Employee_ID WHERE d.Actual_Destruction_Date < d.Planned_Destruction_Date;",
    "table_names": [
      "Employees",
      "Documents_to_be_Destroyed"
    ]
  },
  {
    "id": 1399,
    "db_id": "cre_Doc_Tracking_DB",
    "question": "Which employee destroyed documents earlier than their planned date, given that the planned date of destruction was after the year 2000?",
    "sql": "SELECT Employees.Employee_Name FROM Employees JOIN Documents_to_be_Destroyed ON Employees.Employee_ID = Documents_to_be_Destroyed.Destructed_by_Employee_ID WHERE Documents_to_be_Destroyed.Planned_Destruction_Date > '2000-01-01 00:00:00' AND Documents_to_be_Destroyed.Actual_Destruction_Date < '2000-01-01 00:00:00';",
    "table_names": [
      "Employees",
      "Documents_to_be_Destroyed"
    ]
  },
  {
    "id": 1400,
    "db_id": "cre_Doc_Tracking_DB",
    "question": "How many documents were authorized for destruction by employees with the role 'ED' and actually destroyed by employees with the role 'PR'?",
    "sql": "SELECT COUNT(DISTINCT d.Document_ID) FROM Documents_to_be_Destroyed d JOIN Employees e1 ON d.Destruction_Authorised_by_Employee_ID = e1.Employee_ID JOIN Employees e2 ON d.Destroyed_by_Employee_ID = e2.Employee_ID WHERE e1.Role_Code = 'ED' AND e2.Role_Code = 'PR';",
    "table_names": [
      "Employees",
      "Documents_to_be_Destroyed"
    ]
  },
  {
    "id": 1403,
    "db_id": "club_1",
    "question": "What clubs have either student ID 1001 or student ID 1010 as a member?",
    "sql": "SELECT ClubName FROM Club WHERE ClubID IN (SELECT ClubID FROM Member_of_club WHERE StuID = 1001 OR StuID = 1010);",
    "table_names": [
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 1404,
    "db_id": "club_1",
    "question": "Which clubs located in 'AKW' have members holding either 'President' or 'Vice-President' positions?",
    "sql": "SELECT DISTINCT c.ClubName FROM Club c JOIN Member_of_club m ON c.ClubID = m.ClubID WHERE c.ClubLocation = 'AKW' AND m.Position IN ('President', 'Vice-President');",
    "table_names": [
      "Club",
      "Member_of_club"
    ]
  },
  {
    "id": 1405,
    "db_id": "tracking_grants_for_research",
    "question": "What is the total amount of grants awarded to organisation 14 associated with documents of the 'REG' type?",
    "sql": "SELECT SUM(g.grant_amount) FROM Documents d JOIN Grants g ON d.grant_id = g.grant_id WHERE d.document_type_code = 'REG' AND g.organisation_id = 14;",
    "table_names": [
      "Documents",
      "Grants"
    ]
  },
  {
    "id": 1406,
    "db_id": "tracking_grants_for_research",
    "question": "What's the total sum of grant amounts for grants that have an 'APP' type document sent between 1980 and 2000?",
    "sql": "SELECT SUM(G.grant_amount) FROM Grants G JOIN Documents D ON G.grant_id = D.grant_id WHERE D.document_type_code = 'APP' AND YEAR(D.sent_date) BETWEEN 1980 AND 2000;",
    "table_names": [
      "Documents",
      "Grants"
    ]
  },
  {
    "id": 1407,
    "db_id": "tracking_grants_for_research",
    "question": "How many unique projects resulted in a Patent from organizations that performed projects with the details labeled 'sed'?",
    "sql": "SELECT COUNT(DISTINCT po.project_id) FROM Project_Outcomes po JOIN Projects p ON po.project_id = p.project_id WHERE po.outcome_code = 'Patent' AND p.organisation_id IN (SELECT organisation_id FROM Projects WHERE project_details = 'sed');",
    "table_names": [
      "Project_Outcomes",
      "Projects"
    ]
  },
  {
    "id": 1408,
    "db_id": "tracking_grants_for_research",
    "question": "Which organisation has projects that resulted in the highest number of different types of outcomes?",
    "sql": "SELECT p.organisation_id, COUNT(DISTINCT po.outcome_code) AS num_outcome_types FROM Projects p JOIN Project_Outcomes po ON p.project_id = po.project_id GROUP BY p.organisation_id ORDER BY num_outcome_types DESC LIMIT 1;",
    "table_names": [
      "Project_Outcomes",
      "Projects"
    ]
  },
  {
    "id": 1409,
    "db_id": "tracking_grants_for_research",
    "question": "What is the total grant amount awarded to organisations with type 'RES' after 2000?",
    "sql": "SELECT SUM(Grants.grant_amount) FROM Grants INNER JOIN Organisations ON Grants.organisation_id = Organisations.organisation_id WHERE Organisations.organisation_type = 'RES' AND Grants.grant_start_date > '2000-01-01';",
    "table_names": [
      "Grants",
      "Organisations"
    ]
  },
  {
    "id": 1410,
    "db_id": "tracking_grants_for_research",
    "question": "What is the total amount of grants awarded to organisations of type 'RES' that began receiving grants after the year 2000?",
    "sql": "SELECT SUM(g.grant_amount) FROM Grants g JOIN Organisations o ON g.organisation_id = o.organisation_id WHERE o.organisation_type = 'RES' AND g.grant_start_date > '2000-01-01';",
    "table_names": [
      "Grants",
      "Organisations"
    ]
  },
  {
    "id": 1411,
    "db_id": "tracking_grants_for_research",
    "question": "What are the details of all research staff who are employees of organisations with the type 'SPON'?",
    "sql": "SELECT rs.staff_details FROM Research_Staff rs JOIN Organisations o ON rs.employer_organisation_id = o.organisation_id WHERE o.organisation_type = 'SPON';",
    "table_names": [
      "Organisations",
      "Research_Staff"
    ]
  },
  {
    "id": 1412,
    "db_id": "tracking_grants_for_research",
    "question": "What are the details of the research staff members who are employed by organisations of type 'SPON'?",
    "sql": "SELECT rs.staff_details FROM Research_Staff rs JOIN Organisations o ON rs.employer_organisation_id = o.organisation_id WHERE o.organisation_type = 'SPON';",
    "table_names": [
      "Organisations",
      "Research_Staff"
    ]
  },
  {
    "id": 1413,
    "db_id": "tracking_grants_for_research",
    "question": "How many distinct research staff members are employed by organisations classified as SPON?",
    "sql": "SELECT COUNT(DISTINCT rs.staff_id) FROM Research_Staff rs JOIN Organisations org ON rs.employer_organisation_id = org.organisation_id WHERE org.organisation_type = 'SPON';",
    "table_names": [
      "Organisations",
      "Research_Staff"
    ]
  },
  {
    "id": 1414,
    "db_id": "tracking_grants_for_research",
    "question": "How many distinct research staff members work for organisations of the type 'SPON'?",
    "sql": "SELECT COUNT(DISTINCT rs.staff_id) AS staff_count FROM Research_Staff rs JOIN Organisations org ON rs.employer_organisation_id = org.organisation_id WHERE org.organisation_type = 'SPON';",
    "table_names": [
      "Organisations",
      "Research_Staff"
    ]
  },
  {
    "id": 1415,
    "db_id": "tracking_grants_for_research",
    "question": "How many distinct staff members held the role 'leader' in projects organized by organisation with ID 11?",
    "sql": "SELECT COUNT(DISTINCT ps.staff_id) FROM Project_Staff ps JOIN Projects p ON ps.project_id = p.project_id WHERE p.organisation_id = 11 AND ps.role_code = 'leader';",
    "table_names": [
      "Project_Staff",
      "Projects"
    ]
  },
  {
    "id": 1416,
    "db_id": "tracking_grants_for_research",
    "question": "What is the organisation_id associated with the project having the researcher with staff_id 29?",
    "sql": "SELECT p.organisation_id FROM Projects p JOIN Project_Staff ps ON p.project_id = ps.project_id WHERE ps.staff_id = 29;",
    "table_names": [
      "Project_Staff",
      "Projects"
    ]
  },
  {
    "id": 1417,
    "db_id": "tracking_grants_for_research",
    "question": "How many distinct researchers have worked on projects that are associated with the organization having organisation_id as 11?",
    "sql": "SELECT COUNT(DISTINCT ps.staff_id) FROM Project_Staff ps JOIN Projects p ON ps.project_id = p.project_id WHERE p.organisation_id = 11 AND ps.role_code = 'researcher';",
    "table_names": [
      "Project_Staff",
      "Projects"
    ]
  },
  {
    "id": 1418,
    "db_id": "tracking_grants_for_research",
    "question": "How many distinct staff members have had the role of 'leader' in projects belonging to organisation 11?",
    "sql": "SELECT COUNT(DISTINCT ps.staff_id) FROM Project_Staff ps INNER JOIN Projects p ON ps.project_id = p.project_id WHERE p.organisation_id = 11 AND ps.role_code = 'leader';",
    "table_names": [
      "Project_Staff",
      "Projects"
    ]
  },
  {
    "id": 1419,
    "db_id": "tracking_grants_for_research",
    "question": "How many unique projects have a patent outcome and are associated with the same organisation as the projects that have details 'sed' or 'beatae'?",
    "sql": "SELECT COUNT(DISTINCT po.project_id) FROM Project_Outcomes po JOIN Projects p ON po.project_id = p.project_id WHERE po.outcome_code = 'Patent' AND p.organisation_id IN (SELECT organisation_id FROM Projects WHERE project_details IN ('sed', 'beatae'));",
    "table_names": [
      "Project_Outcomes",
      "Projects"
    ]
  },
  {
    "id": 1420,
    "db_id": "tracking_grants_for_research",
    "question": "How many unique projects resulted in patents that were conducted by organizations having projects with details 'doloremque', 'vel', or 'sed'?",
    "sql": "SELECT COUNT(DISTINCT po.project_id) FROM Project_Outcomes po JOIN Projects p ON po.project_id = p.project_id WHERE po.outcome_code = 'Patent' AND p.organisation_id IN (SELECT organisation_id FROM Projects WHERE project_details IN ('doloremque', 'vel', 'sed'));",
    "table_names": [
      "Project_Outcomes",
      "Projects"
    ]
  },
  {
    "id": 1421,
    "db_id": "tracking_grants_for_research",
    "question": "How many unique projects from organisation 3 have resulted in at least one paper outcome?",
    "sql": "SELECT COUNT(DISTINCT po.project_id) FROM Project_Outcomes po JOIN Projects p ON po.project_id = p.project_id WHERE po.outcome_code = 'Paper' AND p.organisation_id = 3;",
    "table_names": [
      "Project_Outcomes",
      "Projects"
    ]
  },
  {
    "id": 1422,
    "db_id": "tracking_grants_for_research",
    "question": "How many distinct projects from organisation ID 1 resulted in a Patent outcome?",
    "sql": "SELECT COUNT(DISTINCT po.project_id) FROM Project_Outcomes po JOIN Projects p ON po.project_id = p.project_id WHERE po.outcome_code = 'Patent' AND p.organisation_id = 1;",
    "table_names": [
      "Project_Outcomes",
      "Projects"
    ]
  },
  {
    "id": 1423,
    "db_id": "tracking_grants_for_research",
    "question": "How many research staff members are employed by organisations of type 'RES'?",
    "sql": "SELECT COUNT(*) FROM Organisations AS o JOIN Research_Staff AS rs ON o.organisation_id = rs.employer_organisation_id WHERE o.organisation_type = 'RES';",
    "table_names": [
      "Organisations",
      "Research_Staff"
    ]
  },
  {
    "id": 1424,
    "db_id": "tracking_grants_for_research",
    "question": "How many research staff members are employed by organisations categorized as 'RES'?",
    "sql": "SELECT COUNT(*) FROM Research_Staff rs INNER JOIN Organisations o ON rs.employer_organisation_id = o.organisation_id WHERE o.organisation_type = 'RES';",
    "table_names": [
      "Organisations",
      "Research_Staff"
    ]
  },
  {
    "id": 1425,
    "db_id": "tracking_grants_for_research",
    "question": "How many organisations are classified as 'Research' according to their organisation type description?",
    "sql": "SELECT COUNT(*) FROM Organisations AS o INNER JOIN Organisation_Types AS ot ON o.organisation_type = ot.organisation_type WHERE ot.organisation_type_description = 'Research';",
    "table_names": [
      "Organisation_Types",
      "Organisations"
    ]
  },
  {
    "id": 1426,
    "db_id": "tracking_grants_for_research",
    "question": "How many organisations have the type description 'Sponsor'?",
    "sql": "SELECT COUNT(*) FROM Organisation_Types ot JOIN Organisations o ON ot.organisation_type = o.organisation_type WHERE ot.organisation_type_description = 'Sponsor';",
    "table_names": [
      "Organisation_Types",
      "Organisations"
    ]
  },
  {
    "id": 1427,
    "db_id": "tracking_grants_for_research",
    "question": "How many organisations have the organisation type described as 'Research'?",
    "sql": "SELECT COUNT(*) FROM Organisations AS o INNER JOIN Organisation_Types AS ot ON o.organisation_type = ot.organisation_type WHERE ot.organisation_type_description = 'Research';",
    "table_names": [
      "Organisation_Types",
      "Organisations"
    ]
  },
  {
    "id": 1428,
    "db_id": "tracking_grants_for_research",
    "question": "How many organisations have the type described as 'Research'?",
    "sql": "SELECT COUNT(*) FROM Organisations o JOIN Organisation_Types ot ON o.organisation_type = ot.organisation_type WHERE ot.organisation_type_description = 'Research';",
    "table_names": [
      "Organisation_Types",
      "Organisations"
    ]
  },
  {
    "id": 1429,
    "db_id": "tracking_grants_for_research",
    "question": "How many different projects resulted in a patent from the organization associated with the project described as 'sed'?",
    "sql": "SELECT COUNT(DISTINCT po.project_id) AS num_projects FROM Project_Outcomes po INNER JOIN Projects p ON po.project_id = p.project_id WHERE po.outcome_code = 'Patent' AND p.organisation_id IN (SELECT organisation_id FROM Projects WHERE project_details = 'sed');",
    "table_names": [
      "Project_Outcomes",
      "Projects"
    ]
  },
  {
    "id": 1430,
    "db_id": "tracking_grants_for_research",
    "question": "Which organization IDs have projects that resulted in at least one patent?",
    "sql": "SELECT DISTINCT pr.organisation_id FROM Projects pr JOIN Project_Outcomes po ON pr.project_id = po.project_id WHERE po.outcome_code = 'Patent';",
    "table_names": [
      "Project_Outcomes",
      "Projects"
    ]
  },
  {
    "id": 1431,
    "db_id": "tracking_grants_for_research",
    "question": "How many tasks are associated with projects belonging to organisation_id 4?",
    "sql": "SELECT COUNT(*) FROM Projects INNER JOIN Tasks ON Projects.project_id = Tasks.project_id WHERE organisation_id = 4;",
    "table_names": [
      "Projects",
      "Tasks"
    ]
  },
  {
    "id": 1432,
    "db_id": "tracking_grants_for_research",
    "question": "How many tasks are associated with projects that belong to organisations with multiple projects?",
    "sql": "SELECT COUNT(t.task_id) FROM Tasks t INNER JOIN Projects p ON t.project_id = p.project_id WHERE p.organisation_id IN (SELECT organisation_id FROM Projects GROUP BY organisation_id HAVING COUNT(project_id) > 1);",
    "table_names": [
      "Projects",
      "Tasks"
    ]
  },
  {
    "id": 1433,
    "db_id": "tracking_grants_for_research",
    "question": "Which projects have produced both published research papers and research patents, and how many of each type of outcome did each of these projects generate?",
    "sql": "SELECT po.project_id, COUNT(CASE WHEN po.outcome_code = 'Paper' THEN 1 END) As Paper_Count, COUNT(CASE WHEN po.outcome_code = 'Patent' THEN 1 END) As Patent_Count FROM Project_Outcomes po GROUP BY po.project_id HAVING COUNT(DISTINCT po.outcome_code) = 2;",
    "table_names": [
      "Project_Outcomes",
      "Research_Outcomes"
    ]
  },
  {
    "id": 1434,
    "db_id": "tracking_grants_for_research",
    "question": "List the ID(s) of the project(s) that produced more than one published research paper, along with the number of papers produced by each project.",
    "sql": "SELECT po.project_id, COUNT(po.outcome_code) AS num_of_outcomes FROM Project_Outcomes po JOIN Research_Outcomes ro ON po.outcome_code = ro.outcome_code WHERE ro.outcome_description = 'Published Research Paper' GROUP BY po.project_id HAVING COUNT(po.outcome_code) > 1;",
    "table_names": [
      "Project_Outcomes",
      "Research_Outcomes"
    ]
  },
  {
    "id": 1435,
    "db_id": "network_2",
    "question": "What is the job of the oldest person who is friends with Alice?",
    "sql": "SELECT job FROM Person WHERE name IN (SELECT friend FROM PersonFriend WHERE name = 'Alice') ORDER BY age DESC LIMIT 1;",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1436,
    "db_id": "network_2",
    "question": "What are the cities where the friends of engineers live, given that the friendships have lasted at least 5 years?",
    "sql": "SELECT p2.city FROM PersonFriend pf JOIN Person p1 ON pf.name = p1.name JOIN Person p2 ON pf.friend = p2.name WHERE p1.job = 'engineer' AND pf.year >= 5;",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1437,
    "db_id": "network_2",
    "question": "What is the average age of female friends who have been in friendship for more than 5 years?",
    "sql": "SELECT AVG(P.age) FROM PersonFriend PF JOIN Person P ON PF.friend = P.name WHERE PF.year > 5 AND P.gender = 'female';",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1438,
    "db_id": "network_2",
    "question": "What job does the oldest friend of Alice have and which city does he live in?",
    "sql": "SELECT job, city FROM Person WHERE name = (SELECT friend FROM PersonFriend WHERE name = 'Alice' ORDER BY year DESC LIMIT 1);",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1439,
    "db_id": "network_2",
    "question": "For how many years has Alice been friends with someone whose job is engineer?",
    "sql": "SELECT PersonFriend.year FROM PersonFriend JOIN Person ON Person.name = PersonFriend.friend WHERE PersonFriend.name = 'Alice' AND Person.job = 'engineer';",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1440,
    "db_id": "network_2",
    "question": "What city is the person from who has been friends with Dan for more than 10 years?",
    "sql": "SELECT Person.city FROM Person JOIN PersonFriend ON Person.name = PersonFriend.name WHERE PersonFriend.friend = 'Dan' AND PersonFriend.year > 10;",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1441,
    "db_id": "network_2",
    "question": "What are the jobs of all the friends that Alice has known for at least 5 years?",
    "sql": "SELECT Person.job FROM Person INNER JOIN PersonFriend ON Person.name = PersonFriend.friend WHERE PersonFriend.name = 'Alice' AND PersonFriend.year >= 5;",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1442,
    "db_id": "network_2",
    "question": "How many unique friends have males made, whose job is a student?",
    "sql": "SELECT COUNT(DISTINCT pf.friend) FROM PersonFriend pf JOIN Person p1 ON pf.name = p1.name JOIN Person p2 ON pf.friend = p2.name WHERE p1.gender = 'male' AND p2.job = 'student';",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1443,
    "db_id": "network_2",
    "question": "Which persons have friendships lasting more than 5 years with someone whose job is student?",
    "sql": "SELECT pf.name FROM PersonFriend pf JOIN Person p ON pf.friend = p.name WHERE pf.year > 5 AND p.job = 'student';",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1444,
    "db_id": "network_2",
    "question": "What is the gender of Alice's friends who have been friends with her for 5 years or more?",
    "sql": "SELECT Friend.gender FROM PersonFriend JOIN Person ON PersonFriend.friend = Person.name WHERE PersonFriend.name = 'Alice' AND PersonFriend.year >= 5;",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1445,
    "db_id": "network_2",
    "question": "What is the name and age of Alice's friends whom she has known for more than 8 years?",
    "sql": "SELECT Person.name, Person.age FROM Person JOIN PersonFriend ON Person.name = PersonFriend.friend WHERE PersonFriend.year > 8 AND PersonFriend.name = 'Alice';",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1446,
    "db_id": "network_2",
    "question": "What is the average age of friends whose friendship duration is longer than 5 years and have the job 'student'?",
    "sql": "SELECT AVG(p.age) FROM Person p JOIN PersonFriend pf ON p.name = pf.friend WHERE pf.year > 5 AND p.job = 'student';",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1447,
    "db_id": "network_2",
    "question": "List the names of people who have had friends for more than 5 years where the friend lives in a different city.",
    "sql": "SELECT pf.name FROM PersonFriend pf JOIN Person p1 ON pf.name = p1.name JOIN Person p2 ON pf.friend = p2.name WHERE p1.city != p2.city AND pf.year > 5;",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1448,
    "db_id": "network_2",
    "question": "Which male individuals have friends whose job is student?",
    "sql": "SELECT p1.name FROM Person p1 JOIN PersonFriend pf ON p1.name = pf.name JOIN Person p2 ON pf.friend = p2.name WHERE p1.gender = 'male' AND p2.job = 'student';",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1449,
    "db_id": "network_2",
    "question": "What are the occupations of Bob's friends?",
    "sql": "SELECT job FROM Person WHERE name IN (SELECT friend FROM PersonFriend WHERE name = 'Bob');",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1450,
    "db_id": "network_2",
    "question": "What is the occupation of the friend who lives in salt lake city and is a friend of a female person?",
    "sql": "SELECT p2.job FROM PersonFriend pf JOIN Person p1 ON pf.name = p1.name JOIN Person p2 ON pf.friend = p2.name WHERE p1.gender = 'female' AND p2.city = 'salt lake city';",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1451,
    "db_id": "network_2",
    "question": "What is the occupation of the person who has been friends longest with a female student, and what city do they live in?",
    "sql": "SELECT Person.job, Person.city FROM Person JOIN PersonFriend ON Person.name = PersonFriend.friend JOIN Person AS FriendPerson ON PersonFriend.name = FriendPerson.name WHERE FriendPerson.gender = 'female' AND FriendPerson.job = 'student' ORDER BY PersonFriend.year DESC LIMIT 1;",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1452,
    "db_id": "network_2",
    "question": "What are the distinct jobs held by the friends of people living in New York City?",
    "sql": "SELECT DISTINCT p1.job FROM Person p1 JOIN PersonFriend pf ON p1.name = pf.friend JOIN Person p2 ON pf.name = p2.name WHERE p2.city = 'new york city';",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1453,
    "db_id": "network_2",
    "question": "Who has been friends for more than 5 years with a person who is currently a student?",
    "sql": "SELECT PersonFriend.name FROM PersonFriend JOIN Person ON PersonFriend.friend = Person.name WHERE Person.gender = 'student' AND PersonFriend.year > 5;",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1454,
    "db_id": "network_2",
    "question": "What are the jobs held by Zach's friends whom he has known for more than 5 years?",
    "sql": "SELECT Person.job FROM Person JOIN PersonFriend ON Person.name = PersonFriend.friend WHERE PersonFriend.name = 'Zach' AND PersonFriend.year > 5;",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1455,
    "db_id": "network_2",
    "question": "How many distinct friends of friends does Alice have?",
    "sql": "SELECT COUNT(DISTINCT pf2.friend) FROM PersonFriend pf1 JOIN PersonFriend pf2 ON pf1.friend = pf2.name WHERE pf1.name = 'Alice';",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1456,
    "db_id": "network_2",
    "question": "Which male persons have friendships lasting more than 5 years with friends who are students?",
    "sql": "SELECT Person.name FROM Person JOIN PersonFriend ON Person.name = PersonFriend.name WHERE Person.gender = 'male' AND PersonFriend.year > 5 AND PersonFriend.friend IN (SELECT name FROM Person WHERE job = 'student');",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1457,
    "db_id": "network_2",
    "question": "What is the average age of people who have been friends for more than 5 years?",
    "sql": "SELECT AVG(p.age) FROM Person p JOIN PersonFriend pf ON p.name = pf.friend WHERE pf.year > 5;",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1458,
    "db_id": "network_2",
    "question": "What are the job titles of Alice's friends whose friendship has lasted more than 5 years?",
    "sql": "SELECT p.job FROM PersonFriend pf JOIN Person p ON pf.friend = p.name WHERE pf.name = 'Alice' AND pf.year > 5;",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1459,
    "db_id": "network_2",
    "question": "What is the city of the friend who has been friends with Zach for more than 10 years?",
    "sql": "SELECT Person.city FROM Person JOIN PersonFriend ON Person.name = PersonFriend.friend WHERE PersonFriend.name = 'Zach' AND PersonFriend.year > 10;",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1460,
    "db_id": "network_2",
    "question": "What is the average age of the friends of 'Zach'?",
    "sql": "SELECT AVG(p.age) FROM Person p JOIN PersonFriend pf ON p.name = pf.friend WHERE pf.name = 'Zach';",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1461,
    "db_id": "network_2",
    "question": "What is the average friendship duration of relationships where the person is a doctor and their friend is a student?",
    "sql": "SELECT AVG(pf.year) FROM PersonFriend pf JOIN Person p1 ON pf.name = p1.name JOIN Person p2 ON pf.friend = p2.name WHERE p1.job = 'doctor' AND p2.job = 'student';",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1462,
    "db_id": "network_2",
    "question": "What is the average age of people who are friends with Zach?",
    "sql": "SELECT AVG(p.age) FROM Person p JOIN PersonFriend pf ON p.name = pf.friend WHERE pf.name = 'Zach';",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1463,
    "db_id": "network_2",
    "question": "How many unique friends with the job 'student' or 'engineer' does the person from 'austin' have friendships lasting more than 5 years?",
    "sql": "SELECT COUNT(DISTINCTION pf.friend) FROM PersonFriend pf JOIN Person p ON pf.friend = p.name WHERE p.job IN ('student', 'engineer') AND pf.year > 5 AND pf.name IN (SELECT name FROM Person WHERE city = 'austin');",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1464,
    "db_id": "network_2",
    "question": "What is the average number of years of friendship where the friend's occupation is student?",
    "sql": "SELECT AVG(PersonFriend.year) FROM PersonFriend JOIN Person ON PersonFriend.friend = Person.name WHERE Person.job = 'student';",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1465,
    "db_id": "network_2",
    "question": "What is the average age of people who are doctors or have a friend who is a doctor?",
    "sql": "SELECT AVG(p.age) FROM Person p JOIN PersonFriend pf ON p.name = pf.name WHERE p.job = 'doctor' OR pf.friend IN (SELECT name FROM Person WHERE job = 'doctor');",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1466,
    "db_id": "network_2",
    "question": "Who is a doctor and has Alice as a friend?",
    "sql": "SELECT Person.name FROM Person INNER JOIN PersonFriend ON Person.name = PersonFriend.name WHERE PersonFriend.friend = 'Alice' AND Person.job = 'doctor';",
    "table_names": [
      "Person",
      "PersonFriend"
    ]
  },
  {
    "id": 1467,
    "db_id": "decoration_competition",
    "question": "Which colleges have multiple members from Canada?",
    "sql": "SELECT college.Name FROM college JOIN member ON college.College_ID = member.College_ID WHERE member.Country = 'Canada' GROUP BY college.Name HAVING COUNT(*) > 1;",
    "table_names": [
      "college",
      "member"
    ]
  },
  {
    "id": 1468,
    "db_id": "decoration_competition",
    "question": "Who is the leader of the college attended by the member Lee Trevino?",
    "sql": "SELECT college.Leader_Name FROM college JOIN member ON college.College_ID = member.College_ID WHERE member.Name = 'Lee Trevino';",
    "table_names": [
      "college",
      "member"
    ]
  },
  {
    "id": 1469,
    "db_id": "decoration_competition",
    "question": "Which college located in McGill has Canadian members?",
    "sql": "SELECT college.Name FROM college JOIN member ON college.College_ID = member.College_ID WHERE member.Country = 'Canada' AND college.College_Location = 'McGill';",
    "table_names": [
      "college",
      "member"
    ]
  },
  {
    "id": 1470,
    "db_id": "decoration_competition",
    "question": "Who are the members from the United States who ranked in the top 2 positions in any round?",
    "sql": "SELECT m.Name FROM member m JOIN round r ON m.Member_ID = r.Member_ID WHERE m.Country = 'United States' AND r.Rank_in_Round <= 2;",
    "table_names": [
      "member",
      "round"
    ]
  },
  {
    "id": 1471,
    "db_id": "decoration_competition",
    "question": "Who from United States was ranked 1st in any round?",
    "sql": "SELECT m.Name FROM member m JOIN round r ON m.Member_ID = r.Member_ID WHERE m.Country = 'United States' AND r.Rank_in_Round = 1;",
    "table_names": [
      "member",
      "round"
    ]
  },
  {
    "id": 1472,
    "db_id": "decoration_competition",
    "question": "What decoration theme was used by a Canadian member who ranked second in their round?",
    "sql": "SELECT r.Decoration_Theme FROM round r JOIN member m ON r.Member_ID = m.Member_ID WHERE m.Country = 'Canada' AND r.Rank_in_Round = 2;",
    "table_names": [
      "member",
      "round"
    ]
  },
  {
    "id": 1473,
    "db_id": "decoration_competition",
    "question": "Who among the Canadian members achieved the highest rank in any round?",
    "sql": "SELECT member.Name FROM member INNER JOIN round ON member.Member_ID = round.Member_ID WHERE member.Country = 'Canada' AND round.Rank_in_Round = (SELECT MIN(Rank_in_Round) FROM round INNER JOIN member ON member.Member_ID = round.Member_ID WHERE member.Country = 'Canada');",
    "table_names": [
      "member",
      "round"
    ]
  },
  {
    "id": 1474,
    "db_id": "document_management",
    "question": "What is the total access count of Advertisements in document sections that directly belong under the Header section?",
    "sql": "SELECT SUM(D.access_count) FROM Documents D JOIN Document_Structures DS ON D.document_structure_code = DS.document_structure_code WHERE DS.parent_document_structure_code = '1' AND D.document_type_code = 'Advertisement';",
    "table_names": [
      "Document_Structures",
      "Documents"
    ]
  },
  {
    "id": 1475,
    "db_id": "document_management",
    "question": "What is the name of the most accessed Advertisement document whose structure is a child section of 'Bib'?",
    "sql": "SELECT document_name FROM Documents WHERE document_structure_code IN (SELECT document_structure_code FROM Document_Structures WHERE parent_document_structure_code = (SELECT document_structure_code FROM Document_Structures WHERE document_structure_description = 'Bib')) AND document_type_code = 'Advertisement' ORDER BY access_count DESC LIMIT 1;",
    "table_names": [
      "Document_Structures",
      "Documents"
    ]
  },
  {
    "id": 1476,
    "db_id": "document_management",
    "question": "What are the names of advertisements that contain a section code '34'?",
    "sql": "SELECT d.document_name FROM Documents d JOIN Document_Sections ds ON d.document_code = ds.document_code WHERE ds.section_code = '34' AND d.document_type_code = 'Advertisement';",
    "table_names": [
      "Documents",
      "Document_Sections"
    ]
  },
  {
    "id": 1477,
    "db_id": "document_management",
    "question": "What is the total number of access counts for papers with a section titled 'after'?",
    "sql": "SELECT SUM(D.access_count) FROM Documents D JOIN Document_Sections DS ON D.document_code = DS.document_code WHERE DS.section_title = 'after' AND D.document_type_code = 'Paper';",
    "table_names": [
      "Documents",
      "Document_Sections"
    ]
  },
  {
    "id": 1478,
    "db_id": "document_management",
    "question": "What is the name of the most accessed advertisement document which has at least one section titled 'before'?",
    "sql": "SELECT document_name FROM Documents WHERE document_code IN (SELECT document_code FROM Document_Sections WHERE section_title = 'before') AND document_type_code = 'Advertisement' ORDER BY access_count DESC LIMIT 1",
    "table_names": [
      "Documents",
      "Document_Sections"
    ]
  },
  {
    "id": 1479,
    "db_id": "document_management",
    "question": "What is the total access count for all Advertisement documents that contain at least one section titled 'before'?",
    "sql": "SELECT SUM(d.access_count) FROM Documents d JOIN Document_Sections ds ON d.document_code = ds.document_code WHERE d.document_type_code = 'Advertisement' AND ds.section_title = 'before';",
    "table_names": [
      "Documents",
      "Document_Sections"
    ]
  },
  {
    "id": 1480,
    "db_id": "document_management",
    "question": "What is the total access count for all documents of type 'Paper' that have a section titled 'after'?",
    "sql": "SELECT SUM(d.access_count) FROM Documents d JOIN Document_Sections ds ON d.document_code = ds.document_code WHERE d.document_type_code = 'Paper' AND ds.section_title = 'after';",
    "table_names": [
      "Documents",
      "Document_Sections"
    ]
  },
  {
    "id": 1481,
    "db_id": "document_management",
    "question": "What are the names of advertisements that have a 'before' section with a section sequence greater than 6000?",
    "sql": "SELECT Documents.document_name FROM Documents JOIN Document_Sections ON Documents.document_code = Document_Sections.document_code WHERE Documents.document_type_code = 'Advertisement' AND Document_Sections.section_sequence > 6000 AND Document_Sections.section_title = 'before';",
    "table_names": [
      "Documents",
      "Document_Sections"
    ]
  },
  {
    "id": 1482,
    "db_id": "document_management",
    "question": "How many users with the role of 'Database Administrator' have a login status of '1'?",
    "sql": "SELECT COUNT(*) FROM Users INNER JOIN Roles ON Users.role_code = Roles.role_code WHERE Roles.role_description = 'Database Administrator' AND Users.user_login = '1';",
    "table_names": [
      "Roles",
      "Users"
    ]
  },
  {
    "id": 1483,
    "db_id": "document_management",
    "question": "How many users have the role of Database Administrator and have successfully logged in?",
    "sql": "SELECT COUNT(*) FROM Users u INNER JOIN Roles r ON u.role_code = r.role_code WHERE r.role_description = 'Database Administrator' AND u.user_login = '1';",
    "table_names": [
      "Roles",
      "Users"
    ]
  },
  {
    "id": 1484,
    "db_id": "company_office",
    "question": "Which buildings are under construction and scheduled for occupancy by company with id 9 by the end of 2025?",
    "sql": "SELECT b.name FROM buildings b JOIN Office_locations ol ON b.id = ol.building_id WHERE ol.company_id = 9 AND b.Status = 'under construction' AND ol.move_in_year <= 2025;",
    "table_names": [
      "buildings",
      "Office_locations"
    ]
  },
  {
    "id": 1485,
    "db_id": "company_office",
    "question": "What are the names of buildings located in Mexico City that are under construction and have company move-in dates after 2025?",
    "sql": "SELECT b.name FROM buildings b JOIN Office_locations o ON b.id = o.building_id WHERE b.City = 'Mexico City' AND o.move_in_year > 2025 AND b.Status = 'under construction';",
    "table_names": [
      "buildings",
      "Office_locations"
    ]
  },
  {
    "id": 1486,
    "db_id": "solvency_ii",
    "question": "What is the average price of products that participated in events which featured 'TV Equipments'?",
    "sql": "SELECT AVG(P.Product_Price) FROM Products AS P JOIN Products_in_Events AS PE ON P.Product_ID = PE.Product_ID WHERE PE.Event_ID IN (SELECT DISTINCT Event_ID FROM Products_in_Events WHERE Product_ID IN (SELECT Product_ID FROM Products WHERE Product_Name = 'TV Equipments'));",
    "table_names": [
      "Products",
      "Products_in_Events"
    ]
  },
  {
    "id": 1487,
    "db_id": "solvency_ii",
    "question": "What is the total price of all products that were featured in events that featured the product 'Men suits'?",
    "sql": "SELECT SUM(p.Product_Price) FROM Products AS p INNER JOIN Products_in_Events AS pe ON p.Product_ID = pe.Product_ID WHERE pe.Event_ID IN (SELECT DISTINCT Event_ID FROM Products_in_Events WHERE Product_ID = 45);",
    "table_names": [
      "Products",
      "Products_in_Events"
    ]
  },
  {
    "id": 1488,
    "db_id": "solvency_ii",
    "question": "What is the total price of all products, including categories other than electronics, from events that have at least one electronics product?",
    "sql": "SELECT SUM(p.Product_Price) FROM Products p JOIN Products_in_Events pe ON p.Product_ID = pe.Product_ID WHERE pe.Event_ID IN (SELECT DISTINCT Event_ID FROM Products_in_Events WHERE Product_ID IN (SELECT Product_ID FROM Products WHERE Product_Type_Code = 'Electronics'));",
    "table_names": [
      "Products",
      "Products_in_Events"
    ]
  },
  {
    "id": 1489,
    "db_id": "solvency_ii",
    "question": "What is the average price of all products involved in event ID 4?",
    "sql": "SELECT AVG(Product_Price) FROM Products WHERE Product_ID IN (SELECT Product_ID FROM Products_in_Events WHERE Event_ID = 4);",
    "table_names": [
      "Products",
      "Products_in_Events"
    ]
  },
  {
    "id": 1490,
    "db_id": "solvency_ii",
    "question": "What is the average price of all products featured in events that include the highest-priced 'TV Equipments' product?",
    "sql": "SELECT AVG(Product_Price) FROM Products WHERE Product_ID IN (SELECT Product_ID FROM Products_in_Events WHERE Event_ID IN (SELECT DISTINCT Event_ID FROM Products_in_Events WHERE Product_ID = (SELECT Product_ID FROM Products WHERE Product_Name = 'TV Equipments' AND Product_Price = (SELECT MAX(Product_Price) FROM Products WHERE Product_Name = 'TV Equipments'))));",
    "table_names": [
      "Products",
      "Products_in_Events"
    ]
  },
  {
    "id": 1491,
    "db_id": "entertainment_awards",
    "question": "Which program of type 'Program Music/Variety Show' has won at any festival?",
    "sql": "SELECT a.Name FROM artwork a JOIN nomination n ON a.Artwork_ID = n.Artwork_ID WHERE a.Type = 'Program Music/Variety Show' AND n.Result = 'Won';",
    "table_names": [
      "artwork",
      "nomination"
    ]
  },
  {
    "id": 1492,
    "db_id": "customers_campaigns_ecommerce",
    "question": "What payment methods were used by customers who placed orders after receiving the mailshot following the date '2018-03-01'?",
    "sql": "SELECT payment_method FROM Customers WHERE customer_id IN (SELECT customer_id FROM Mailshot_Customers WHERE outcome_code = 'Order' AND mailshot_customer_date > '2018-03-01');",
    "table_names": [
      "Customers",
      "Mailshot_Customers"
    ]
  },
  {
    "id": 1493,
    "db_id": "customers_campaigns_ecommerce",
    "question": "Which customer placed the highest number of orders in response to the mailshots?",
    "sql": "SELECT c.customer_name, COUNT(mc.mailshot_id) as total_mailshots FROM Customers c JOIN Mailshot_Customers mc ON c.customer_id = mc.customer_id WHERE mc.outcome_code = 'Order' GROUP BY c.customer_id ORDER BY total_mailshots DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Mailshot_Customers"
    ]
  },
  {
    "id": 1494,
    "db_id": "customers_campaigns_ecommerce",
    "question": "What are the names and email addresses of customers who placed an order after receiving a mailshot from March 1, 2018 onwards?",
    "sql": "SELECT customer_name, customer_email FROM Customers WHERE customer_id IN (SELECT customer_id FROM Mailshot_Customers WHERE outcome_code = 'Order' AND mailshot_customer_date >= '2018-03-01');",
    "table_names": [
      "Customers",
      "Mailshot_Customers"
    ]
  },
  {
    "id": 1495,
    "db_id": "customers_campaigns_ecommerce",
    "question": "How many unique customers paying by 'Direct Debit' placed an order in March 2018?",
    "sql": "SELECT COUNT(DISTINCT c.customer_id) FROM Customers c INNER JOIN Mailshot_Customers m ON c.customer_id = m.customer_id WHERE c.payment_method = 'Direct Debit' AND m.outcome_code = 'Order' AND m.mailshot_customer_date BETWEEN '2018-03-01' AND '2018-03-31';",
    "table_names": [
      "Customers",
      "Mailshot_Customers"
    ]
  },
  {
    "id": 1496,
    "db_id": "customers_campaigns_ecommerce",
    "question": "Can you list the names and emails of customers who placed orders in response to mailshots between March 1 and March 10, 2018?",
    "sql": "SELECT customer_name, customer_email FROM Customers WHERE customer_id IN (SELECT customer_id FROM Mailshot_Customers WHERE outcome_code = 'Order' AND mailshot_customer_date BETWEEN '2018-03-01' AND '2018-03-10');",
    "table_names": [
      "Customers",
      "Mailshot_Customers"
    ]
  },
  {
    "id": 1497,
    "db_id": "customers_campaigns_ecommerce",
    "question": "What is the residential shipping address for customer ID 11?",
    "sql": "SELECT premises.premise_details FROM Premises premises JOIN Customer_Addresses ca ON premises.premise_id = ca.premise_id WHERE ca.customer_id = 11 AND ca.address_type_code = 'Shipping' AND premises.premises_type = 'Residence';",
    "table_names": [
      "Premises",
      "Customer_Addresses"
    ]
  },
  {
    "id": 1498,
    "db_id": "customers_and_addresses",
    "question": "Which customer using 'Direct Debit' has incurred the highest total FedEx shipping charges across all orders?",
    "sql": "SELECT c.customer_name, SUM(co.order_shipping_charges) AS total_shipping FROM Customers c JOIN Customer_Orders co ON c.customer_id = co.customer_id WHERE c.payment_method = 'Direct Debit' AND co.shipping_method_code = 'FedEx' GROUP BY c.customer_name ORDER BY total_shipping DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Customer_Orders"
    ]
  },
  {
    "id": 1519,
    "db_id": "customers_and_addresses",
    "question": "List addresses of customers who have lived at more than two different addresses.",
    "sql": "SELECT a.address_details FROM Addresses a JOIN Customer_Addresses ca ON a.address_id = ca.address_id WHERE ca.customer_id IN (SELECT customer_id FROM Customer_Addresses GROUP BY customer_id HAVING COUNT(DISTINCT address_id) > 2) ORDER BY ca.customer_id;",
    "table_names": [
      "Addresses",
      "Customer_Addresses"
    ]
  },
  {
    "id": 1520,
    "db_id": "customers_and_addresses",
    "question": "What are the unique addresses used by customers who have lived at more than two different locations?",
    "sql": "SELECT DISTINCT address_details FROM Addresses a JOIN Customer_Addresses ca ON a.address_id = ca.address_id WHERE ca.customer_id IN (SELECT customer_id FROM Customer_Addresses GROUP BY customer_id HAVING COUNT(DISTINCT address_id) > 2);",
    "table_names": [
      "Addresses",
      "Customer_Addresses"
    ]
  },
  {
    "id": 1521,
    "db_id": "department_store",
    "question": "How many distinct male and female staff members worked in the department with ID 5?",
    "sql": "SELECT staff_gender, COUNT(DISTINCT s.staff_id) FROM Staff s JOIN Staff_Department_Assignments sa ON s.staff_id = sa.staff_id WHERE sa.department_id = 5 GROUP BY staff_gender;",
    "table_names": [
      "Staff",
      "Staff_Department_Assignments"
    ]
  },
  {
    "id": 1522,
    "db_id": "department_store",
    "question": "Which staff members worked as Clerical Staff in department 5 and were assigned after the year 2017?",
    "sql": "SELECT s.staff_name FROM Staff s JOIN Staff_Department_Assignments a ON s.staff_id = a.staff_id WHERE a.department_id = 5 AND a.job_title_code = 'Clerical Staff' AND a.date_assigned_from > '2017-01-01';",
    "table_names": [
      "Staff",
      "Staff_Department_Assignments"
    ]
  },
  {
    "id": 1523,
    "db_id": "customers_and_addresses",
    "question": "What are the names and email addresses of customers who have pending orders placed in March 2018?",
    "sql": "SELECT customer_name, customer_email FROM Customers WHERE customer_id IN (SELECT customer_id FROM Customer_Orders WHERE order_status_code = 'Pending' AND order_date BETWEEN '2018-03-01' AND '2018-03-31');",
    "table_names": [
      "Customers",
      "Customer_Orders"
    ]
  },
  {
    "id": 1524,
    "db_id": "customers_and_addresses",
    "question": "What are the names and phone numbers of all customers who paid by Credit Card and currently have orders in 'Pending' status?",
    "sql": "SELECT DISTINCT c.customer_name, c.customer_phone FROM Customers c INNER JOIN Customer_Orders co ON c.customer_id = co.customer_id WHERE co.order_status_code = 'Pending' AND c.payment_method_code = 'Credit Card';",
    "table_names": [
      "Customers",
      "Customer_Orders"
    ]
  },
  {
    "id": 1525,
    "db_id": "department_store",
    "question": "Which department store chain has the highest number of stores listed in the database, and how many stores does it have?",
    "sql": "SELECT dsc.dept_store_chain_name, COUNT(ds.dept_store_id) AS number_of_stores FROM Department_Store_Chain dsc JOIN Department_Stores ds ON dsc.dept_store_chain_id = ds.dept_store_chain_id GROUP BY dsc.dept_store_chain_name ORDER BY number_of_stores DESC LIMIT 1;",
    "table_names": [
      "Department_Store_Chain",
      "Department_Stores"
    ]
  },
  {
    "id": 1526,
    "db_id": "department_store",
    "question": "What is the name, phone number and address of the department store belonging to the 'East' chain located in North Carolina (NC)?",
    "sql": "SELECT ds.store_name, ds.store_phone, ds.store_address FROM Department_Stores ds JOIN Department_Store_Chain dsc ON ds.dept_store_chain_id = dsc.dept_store_chain_id WHERE dsc.dept_store_chain_name = 'East' AND ds.store_address LIKE '%NC%';",
    "table_names": [
      "Department_Store_Chain",
      "Department_Stores"
    ]
  },
  {
    "id": 1527,
    "db_id": "department_store",
    "question": "What is the name of the staff member who started working as Clerical Staff in department 5 before 2017?",
    "sql": "SELECT s.staff_name FROM Staff s JOIN Staff_Department_Assignments sda ON s.staff_id = sda.staff_id WHERE sda.department_id = 5 AND sda.job_title_code = 'Clerical Staff' AND sda.date_assigned_from < '2017-01-01 00:00:00';",
    "table_names": [
      "Staff",
      "Staff_Department_Assignments"
    ]
  },
  {
    "id": 1528,
    "db_id": "department_store",
    "question": "What is the name of the staff member who was assigned to department 5 with the job title of 'Administration'?",
    "sql": "SELECT Staff.staff_name FROM Staff JOIN Staff_Department_Assignments ON Staff.staff_id = Staff_Department_Assignments.staff_id WHERE Staff_Department_Assignments.department_id = 5 AND Staff_Department_Assignments.job_title_code = 'Administration';",
    "table_names": [
      "Staff",
      "Staff_Department_Assignments"
    ]
  },
  {
    "id": 1529,
    "db_id": "department_store",
    "question": "What is the total amount purchased from supplier 2 for all products of the product type Â«ClothesÂ»?",
    "sql": "SELECT SUM(ps.total_amount_purchased) FROM Products p JOIN Product_Suppliers ps ON p.product_id = ps.product_id WHERE p.product_type_code = 'Clothes' AND ps.supplier_id = 2;",
    "table_names": [
      "Products",
      "Product_Suppliers"
    ]
  },
  {
    "id": 1530,
    "db_id": "department_store",
    "question": "Which hardware product type has the highest total value purchased from suppliers?",
    "sql": "SELECT p.product_name, MAX(ps.total_value_purchased) FROM Products p JOIN Product_Suppliers ps ON p.product_id = ps.product_id WHERE p.product_type_code = 'Hardware' GROUP BY p.product_name ORDER BY MAX(ps.total_value_purchased) DESC LIMIT 1;",
    "table_names": [
      "Products",
      "Product_Suppliers"
    ]
  },
  {
    "id": 1531,
    "db_id": "customers_and_addresses",
    "question": "Which customer has the highest number of cancelled orders and how many cancelled orders do they have?",
    "sql": "SELECT customer_name, COUNT(order_id) AS total_cancelled_orders FROM Customers JOIN Customer_Orders ON Customers.customer_id = Customer_Orders.customer_id WHERE order_status_code = 'Cancelled' GROUP BY customer_name ORDER BY total_cancelled_orders DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Customer_Orders"
    ]
  },
  {
    "id": 1532,
    "db_id": "customers_and_addresses",
    "question": "How many customers using 'Credit Card' as the payment method placed an order with the status 'Completed'?",
    "sql": "SELECT COUNT(DISTINCT c.customer_id) FROM Customers c INNER JOIN Customer_Orders co ON c.customer_id = co.customer_id WHERE c.payment_method_code = 'Credit Card' AND co.order_status_code = 'Completed';",
    "table_names": [
      "Customers",
      "Customer_Orders"
    ]
  },
  {
    "id": 1533,
    "db_id": "customers_and_addresses",
    "question": "How many unique customers who use Direct Debit as the payment method have orders currently in 'Pending' status?",
    "sql": "SELECT COUNT(DISTINCT co.customer_id) FROM Customer_Orders co JOIN Customers c ON co.customer_id = c.customer_id WHERE c.payment_method_code = 'Direct Debit' AND co.order_status_code = 'Pending';",
    "table_names": [
      "Customers",
      "Customer_Orders"
    ]
  },
  {
    "id": 1534,
    "db_id": "customers_and_addresses",
    "question": "Can you provide the names and email addresses of customers whose orders were cancelled during February 2018?",
    "sql": "SELECT customer_name, customer_email FROM Customers WHERE customer_id IN (SELECT customer_id FROM Customer_Orders WHERE order_status_code = 'Cancelled' AND order_date BETWEEN '2018-02-01' AND '2018-03-01');",
    "table_names": [
      "Customers",
      "Customer_Orders"
    ]
  },
  {
    "id": 1535,
    "db_id": "department_store",
    "question": "What is the name and price of the most expensive product supplied by supplier id 4, considering the total purchase value?",
    "sql": "SELECT p.product_name, p.product_price FROM Products p JOIN Product_Suppliers ps ON p.product_id = ps.product_id WHERE ps.supplier_id = 4 ORDER BY ps.total_value_purchased DESC LIMIT 1;",
    "table_names": [
      "Products",
      "Product_Suppliers"
    ]
  },
  {
    "id": 1536,
    "db_id": "department_store",
    "question": "What is the product name and supplier ID of the product that has the highest total value purchased?",
    "sql": "SELECT p.product_name, ps.supplier_id, ps.total_value_purchased FROM Products AS p JOIN Product_Suppliers AS ps ON p.product_id = ps.product_id WHERE ps.total_value_purchased = (SELECT MAX(total_value_purchased) FROM Product_Suppliers);",
    "table_names": [
      "Products",
      "Product_Suppliers"
    ]
  },
  {
    "id": 1537,
    "db_id": "department_store",
    "question": "What is the name and phone number of the store that hosts the marketing department?",
    "sql": "SELECT DS.store_name, DS.store_phone FROM Department_Stores DS JOIN Departments D ON DS.dept_store_id = D.dept_store_id WHERE D.department_name = 'marketing';",
    "table_names": [
      "Department_Stores",
      "Departments"
    ]
  },
  {
    "id": 1538,
    "db_id": "department_store",
    "question": "What is the store name and phone number of the department store that has a marketing department?",
    "sql": "SELECT DS.store_name, DS.store_phone FROM Department_Stores DS INNER JOIN Departments D ON DS.dept_store_id = D.dept_store_id WHERE D.department_name = 'marketing';",
    "table_names": [
      "Department_Stores",
      "Departments"
    ]
  },
  {
    "id": 1539,
    "db_id": "department_store",
    "question": "Which staff members worked as Department Managers and began their assignment before January 1, 2017?",
    "sql": "SELECT Staff.staff_name FROM Staff JOIN Staff_Department_Assignments ON Staff.staff_id = Staff_Department_Assignments.staff_id WHERE Staff_Department_Assignments.job_title_code = 'Department Manager' AND Staff_Department_Assignments.date_assigned_from < '2017-01-01 00:00:00';",
    "table_names": [
      "Staff",
      "Staff_Department_Assignments"
    ]
  },
  {
    "id": 1540,
    "db_id": "department_store",
    "question": "Who was assigned as 'Administration' in department 5?",
    "sql": "SELECT S.staff_name FROM Staff S JOIN Staff_Department_Assignments SDA ON S.staff_id = SDA.staff_id WHERE SDA.department_id = 5 AND SDA.job_title_code = 'Administration';",
    "table_names": [
      "Staff",
      "Staff_Department_Assignments"
    ]
  },
  {
    "id": 1541,
    "db_id": "department_store",
    "question": "Who are the staff members assigned as 'Clerical Staff' in department 5?",
    "sql": "SELECT s.staff_name FROM Staff s JOIN Staff_Department_Assignments sa ON s.staff_id = sa.staff_id WHERE sa.department_id = 5 AND sa.job_title_code = 'Clerical Staff';",
    "table_names": [
      "Staff",
      "Staff_Department_Assignments"
    ]
  },
  {
    "id": 1542,
    "db_id": "department_store",
    "question": "Who were the staff members assigned as Department Managers whose assignments ended after March 24, 2018?",
    "sql": "SELECT s.staff_name FROM Staff s JOIN Staff_Department_Assignments sd ON s.staff_id = sd.staff_id WHERE sd.job_title_code = 'Department Manager' AND sd.date_assigned_to > '2018-03-24 00:00:00';",
    "table_names": [
      "Staff",
      "Staff_Department_Assignments"
    ]
  },
  {
    "id": 1543,
    "db_id": "department_store",
    "question": "Which staff member was assigned as Clerical Staff in department 5 before the year 2017?",
    "sql": "SELECT Staff.staff_name FROM Staff JOIN Staff_Department_Assignments ON Staff.staff_id = Staff_Department_Assignments.staff_id WHERE Staff_Department_Assignments.department_id = 5 AND Staff_Department_Assignments.job_title_code = 'Clerical Staff' AND Staff_Department_Assignments.date_assigned_from < '2017-01-01';",
    "table_names": [
      "Staff",
      "Staff_Department_Assignments"
    ]
  },
  {
    "id": 1544,
    "db_id": "department_store",
    "question": "Who are the staff members assigned to department 5 as Clerical Staff?",
    "sql": "SELECT Staff.staff_name FROM Staff JOIN Staff_Department_Assignments ON Staff.staff_id = Staff_Department_Assignments.staff_id WHERE Staff_Department_Assignments.department_id = 5 AND Staff_Department_Assignments.job_title_code = 'Clerical Staff';",
    "table_names": [
      "Staff",
      "Staff_Department_Assignments"
    ]
  },
  {
    "id": 1545,
    "db_id": "department_store",
    "question": "Which staff member was serving as a Sales Person in department 5 and still had the assignment active after March 24, 2018?",
    "sql": "SELECT S.staff_name FROM Staff S JOIN Staff_Department_Assignments SDA ON S.staff_id = SDA.staff_id WHERE SDA.department_id = 5 AND SDA.job_title_code = 'Sales Person' AND SDA.date_assigned_to > '2018-03-24';",
    "table_names": [
      "Staff",
      "Staff_Department_Assignments"
    ]
  },
  {
    "id": 1546,
    "db_id": "department_store",
    "question": "What is the name of the staff member who has worked as 'Administration' in department 5?",
    "sql": "SELECT s.staff_name FROM Staff s JOIN Staff_Department_Assignments sda ON s.staff_id = sda.staff_id WHERE sda.department_id = 5 AND sda.job_title_code = 'Administration';",
    "table_names": [
      "Staff",
      "Staff_Department_Assignments"
    ]
  },
  {
    "id": 1547,
    "db_id": "department_store",
    "question": "Which customers from Tennessee paid by Credit Card, and what are their phone numbers?",
    "sql": "SELECT c.customer_name, c.customer_phone FROM Customers c WHERE c.payment_method_code = 'Credit Card' AND c.customer_address LIKE '%TN%';",
    "table_names": [
      "Suppliers",
      "Customers"
    ]
  },
  {
    "id": 1548,
    "db_id": "department_store",
    "question": "What are the names and phone numbers of customers paying by Direct Debit who live in the state of Illinois (IL)?",
    "sql": "SELECT customer_name, customer_phone FROM Customers WHERE payment_method_code = 'Direct Debit' AND customer_address LIKE '%IL%';",
    "table_names": [
      "Suppliers",
      "Customers"
    ]
  },
  {
    "id": 1549,
    "db_id": "department_store",
    "question": "What is the total amount purchased of products in order id 15?",
    "sql": "SELECT SUM(ps.total_amount_purchased) FROM Order_Items oi JOIN Product_Suppliers ps ON oi.product_id = ps.product_id WHERE oi.order_id = 15;",
    "table_names": [
      "Order_Items",
      "Product_Suppliers"
    ]
  },
  {
    "id": 1550,
    "db_id": "department_store",
    "question": "Which supplier provided the product with the highest total value purchased among those ordered in order_id 14?",
    "sql": "SELECT supplier_id FROM Product_Suppliers WHERE product_id IN (SELECT product_id FROM Order_Items WHERE order_id = 14) ORDER BY total_value_purchased DESC LIMIT 1;",
    "table_names": [
      "Order_Items",
      "Product_Suppliers"
    ]
  },
  {
    "id": 1551,
    "db_id": "department_store",
    "question": "Who was assigned as a Clerical Staff to department 5 before the year 2017?",
    "sql": "SELECT s.staff_name FROM Staff s JOIN Staff_Department_Assignments a ON s.staff_id = a.staff_id WHERE a.department_id = 5 AND a.job_title_code = 'Clerical Staff' AND a.date_assigned_from < '2017-01-01';",
    "table_names": [
      "Staff",
      "Staff_Department_Assignments"
    ]
  },
  {
    "id": 1552,
    "db_id": "department_store",
    "question": "Who was assigned as Clerical Staff to department 5 before the year 2017?",
    "sql": "SELECT s.staff_name FROM Staff s JOIN Staff_Department_Assignments sda ON s.staff_id = sda.staff_id WHERE sda.department_id = 5 AND sda.job_title_code = 'Clerical Staff' AND sda.date_assigned_from < '2017-01-01';",
    "table_names": [
      "Staff",
      "Staff_Department_Assignments"
    ]
  },
  {
    "id": 1553,
    "db_id": "aircraft",
    "question": "What was the winning aircraft at the match held in the United States?",
    "sql": "SELECT aircraft.Aircraft FROM aircraft JOIN match ON aircraft.Aircraft_ID = match.Winning_Aircraft WHERE match.Country = 'United States';",
    "table_names": [
      "aircraft",
      "match"
    ]
  },
  {
    "id": 1554,
    "db_id": "aircraft",
    "question": "What is the name and maximum gross weight of the winning aircraft at Swan River, Perth?",
    "sql": "SELECT a.Aircraft, a.Max_Gross_Weight FROM aircraft AS a JOIN match AS m ON a.Aircraft_ID = m.Winning_Aircraft WHERE m.Location = 'Swan River , Perth';",
    "table_names": [
      "aircraft",
      "match"
    ]
  },
  {
    "id": 1555,
    "db_id": "aircraft",
    "question": "Which aircraft won the match held at Flamengo Beach, Rio de Janeiro?",
    "sql": "SELECT a.Aircraft FROM aircraft a JOIN match m ON a.Aircraft_ID = m.Winning_Aircraft WHERE m.Location = 'Flamengo Beach , Rio de Janeiro';",
    "table_names": [
      "aircraft",
      "match"
    ]
  },
  {
    "id": 1556,
    "db_id": "aircraft",
    "question": "What is the name and description of the aircraft with the highest maximum disk loading, and in which location and country did it win a match?",
    "sql": "SELECT aircraft.Aircraft, aircraft.Description, match.Location, match.Country FROM aircraft INNER JOIN match ON aircraft.Aircraft_ID = match.Winning_Aircraft WHERE aircraft.Max_disk_Loading = (SELECT MAX(Max_disk_Loading) FROM aircraft)",
    "table_names": [
      "aircraft",
      "match"
    ]
  },
  {
    "id": 1557,
    "db_id": "aircraft",
    "question": "What is the name of the aircraft that was used by the winning pilot in the match held in Australia?",
    "sql": "SELECT Aircraft FROM aircraft WHERE Aircraft_ID IN (SELECT Winning_Aircraft FROM match WHERE Country = 'Australia');",
    "table_names": [
      "aircraft",
      "match"
    ]
  },
  {
    "id": 1558,
    "db_id": "aircraft",
    "question": "Which aircraft won the match held in the United States?",
    "sql": "SELECT aircraft.Aircraft FROM aircraft JOIN match ON aircraft.Aircraft_ID = match.Winning_Aircraft WHERE match.Country = 'United States'",
    "table_names": [
      "aircraft",
      "match"
    ]
  },
  {
    "id": 1559,
    "db_id": "aircraft",
    "question": "Which aircraft achieved the highest number of wins across all rounds?",
    "sql": "SELECT a.Aircraft, COUNT(m.Winning_Aircraft) AS Wins FROM aircraft a JOIN match m ON a.Aircraft_ID = CAST(m.Winning_Aircraft AS INTEGER) GROUP BY a.Aircraft ORDER BY Wins DESC LIMIT 1;",
    "table_names": [
      "aircraft",
      "match"
    ]
  },
  {
    "id": 1560,
    "db_id": "aircraft",
    "question": "Which matches and locations were won by the aircraft with the highest Max Gross Weight?",
    "sql": "SELECT aircraft.Aircraft, match.Location, match.Country FROM aircraft INNER JOIN match ON aircraft.Aircraft_ID = match.Winning_Aircraft WHERE aircraft.Max_Gross_Weight = (SELECT MAX(Max_Gross_Weight) FROM aircraft);",
    "table_names": [
      "aircraft",
      "match"
    ]
  },
  {
    "id": 1561,
    "db_id": "aircraft",
    "question": "Who won the match held in New York City?",
    "sql": "SELECT p.Name FROM pilot p JOIN match m ON p.Pilot_Id = m.Winning_Pilot WHERE m.Location = 'New York City'",
    "table_names": [
      "pilot",
      "match"
    ]
  },
  {
    "id": 1562,
    "db_id": "aircraft",
    "question": "Who is the pilot with the highest number of match wins and how many wins do they have?",
    "sql": "SELECT pilot.Name, COUNT(match.Winning_Pilot) AS Wins FROM pilot JOIN match ON pilot.Pilot_Id = CAST(match.Winning_Pilot AS INT) GROUP BY pilot.Name ORDER BY Wins DESC LIMIT 1;",
    "table_names": [
      "pilot",
      "match"
    ]
  },
  {
    "id": 1563,
    "db_id": "aircraft",
    "question": "What are the names of the pilots who won matches when 'Paul Bonhomme' recorded the fastest qualifying rounds?",
    "sql": "SELECT pilot.Name FROM pilot JOIN match ON pilot.Pilot_Id = match.Winning_Pilot WHERE match.Fastest_Qualifying = 'Paul Bonhomme';",
    "table_names": [
      "pilot",
      "match"
    ]
  },
  {
    "id": 1564,
    "db_id": "aircraft",
    "question": "Which pilot won the most matches?",
    "sql": "SELECT p.Name, COUNT(m.Winning_Pilot) AS Wins FROM pilot p JOIN match m ON p.Pilot_Id = CAST(m.Winning_Pilot AS INTEGER) GROUP BY p.Name ORDER BY Wins DESC LIMIT 1",
    "table_names": [
      "pilot",
      "match"
    ]
  },
  {
    "id": 1565,
    "db_id": "aircraft",
    "question": "Which pilots won matches where Hannes Arch recorded the fastest qualifying time?",
    "sql": "SELECT Name FROM pilot WHERE Pilot_Id IN (SELECT Winning_Pilot FROM match WHERE Fastest_Qualifying = 'Hannes Arch');",
    "table_names": [
      "pilot",
      "match"
    ]
  },
  {
    "id": 1566,
    "db_id": "aircraft",
    "question": "Which pilot has won the most matches, and how many matches has that pilot won?",
    "sql": "SELECT pilot.Name, COUNT(match.Winning_Pilot) AS Wins FROM pilot INNER JOIN match ON pilot.Pilot_Id = CAST(match.Winning_Pilot AS INTEGER) GROUP BY pilot.Name ORDER BY Wins DESC LIMIT 1;",
    "table_names": [
      "pilot",
      "match"
    ]
  },
  {
    "id": 1567,
    "db_id": "local_govt_and_lot",
    "question": "What are the addresses of flats where residents moved out after January 1st, 2018?",
    "sql": "SELECT P.property_address FROM Properties AS P JOIN Residents AS R ON P.property_id = R.property_id WHERE P.property_type_code = 'flat' AND R.date_moved_out > '2018-01-01';",
    "table_names": [
      "Properties",
      "Residents"
    ]
  },
  {
    "id": 1568,
    "db_id": "e_government",
    "question": "Which subordinate organizations under 'Reinger, Hudson and Nolan Group' provided an unsatisfied 'Pay bills' service?",
    "sql": "SELECT o.organization_details FROM Organizations o JOIN Services s ON o.organization_id = s.organization_id WHERE s.service_type_code = 'Pay bills' AND s.service_details = 'Unsatisfied' AND o.parent_organization_id = 7;",
    "table_names": [
      "Organizations",
      "Services"
    ]
  },
  {
    "id": 1569,
    "db_id": "local_govt_and_lot",
    "question": "How many different residents requested services and were unsatisfied, and also moved out before January 1st, 2018?",
    "sql": "SELECT COUNT(DISTINCT rs.resident_id) FROM Residents_Services rs JOIN Residents r ON rs.resident_id = r.resident_id WHERE rs.other_details = 'Unsatisfied' AND r.date_moved_out < '2018-01-01';",
    "table_names": [
      "Residents",
      "Residents_Services"
    ]
  },
  {
    "id": 1570,
    "db_id": "local_govt_and_lot",
    "question": "How many different properties received services from organization 8 where the service details were marked as 'Unsatisfied'?",
    "sql": "SELECT COUNT(DISTINCT r.property_id) FROM Services s INNER JOIN Residents_Services r ON s.service_id = r.service_id WHERE s.organization_id = 8 AND s.service_details = 'Unsatisfied';",
    "table_names": [
      "Services",
      "Residents_Services"
    ]
  },
  {
    "id": 1571,
    "db_id": "local_govt_and_lot",
    "question": "How many 'Unsatisfied' cleaning services were provided by all subsidiary organizations under 'Reinger, Hudson and Nolan Group'?",
    "sql": "SELECT COUNT(*) FROM Things WHERE organization_id IN (SELECT organization_id FROM Organizations WHERE parent_organization_id = 7 AND organization_id <> 7) AND service_type_code = 'Cleanning' AND service_details = 'Unsatisfied';",
    "table_names": [
      "Organizations",
      "Things"
    ]
  },
  {
    "id": 1572,
    "db_id": "local_govt_and_lot",
    "question": "Which customers moved in at '2016-09-27 12:00:00' and used the same thing_id as customer 'Mr. Raul Prosacco'?",
    "sql": "SELECT DISTINCT c.customer_details FROM Customers c JOIN Customer_Events ce ON c.customer_id = ce.customer_id WHERE ce.date_moved_in = '2016-09-27 12:00:00' AND ce.thing_id IN (SELECT thing_id FROM Customer_Events WHERE customer_id = 4);",
    "table_names": [
      "Customers",
      "Customer_Events"
    ]
  },
  {
    "id": 1573,
    "db_id": "local_govt_and_lot",
    "question": "Which customers have moved into more than one distinct property?",
    "sql": "SELECT customer_details FROM Customers WHERE customer_id IN (SELECT customer_id FROM Customer_Events GROUP BY customer_id HAVING COUNT(DISTINCT property_id) > 1);",
    "table_names": [
      "Customers",
      "Customer_Events"
    ]
  },
  {
    "id": 1574,
    "db_id": "local_govt_and_lot",
    "question": "How many distinct properties had 'Cleanning' services scheduled for events belonging to customer ID 91?",
    "sql": "SELECT COUNT(DISTINCT cen.property_id) FROM Customer_Event_Notes cen JOIN Customer_Events ce ON cen.Customer_Event_ID = ce.Customer_Event_ID WHERE cen.service_type_code = 'Cleanning' AND ce.customer_id = 91;",
    "table_names": [
      "Customer_Events",
      "Customer_Event_Notes"
    ]
  },
  {
    "id": 1575,
    "db_id": "local_govt_and_lot",
    "question": "List the IDs and types of things from the organization with ID 8 that have service marked 'Unsatisfied' and also had a status of 'Open' in the 'Timed_Status_of_Things' table.",
    "sql": "SELECT DISTINCT T.thing_id, T.Type_of_Thing_Code FROM Things AS T JOIN Timed_Status_of_Things AS S ON T.thing_id = S.thing_id WHERE T.organization_id = 8 AND T.service_details = 'Unsatisfied' AND S.Status_of_Thing_Code = 'Open';",
    "table_names": [
      "Things",
      "Timed_Status_of_Things"
    ]
  },
  {
    "id": 1576,
    "db_id": "local_govt_and_lot",
    "question": "How many unique things from organization 8 with 'Check' service type had recorded locations between January 1st, 2016, and January 1st, 2017, grouped by the type of thing?",
    "sql": "SELECT t.Type_of_Thing_Code, COUNT(DISTINCT t.thing_id) FROM Things t JOIN Timed_Locations_of_Things tl ON t.thing_id = tl.thing_id WHERE t.organization_id = 8 AND t.service_type_code = 'Check' AND tl.Date_and_Time BETWEEN '2016-01-01 00:00:00' AND '2017-01-01 00:00:00' GROUP BY t.Type_of_Thing_Code;",
    "table_names": [
      "Things",
      "Timed_Locations_of_Things"
    ]
  },
  {
    "id": 1577,
    "db_id": "local_govt_and_lot",
    "question": "How many distinct properties has 'Sabryna Moore PhD' moved into?",
    "sql": "SELECT COUNT(DISTINCT ce.property_id) FROM Customers c JOIN Customer_Events ce ON c.customer_id = ce.customer_id WHERE c.customer_details = 'Sabryna Moore PhD';",
    "table_names": [
      "Customers",
      "Customer_Events"
    ]
  },
  {
    "id": 1584,
    "db_id": "school_player",
    "question": "What is the name and enrollment size of the largest school in Division 1 according to the school details?",
    "sql": "SELECT s.School, s.Enrollment FROM school s JOIN school_details sd ON s.School_ID = sd.School_ID WHERE sd.Division = 'Division 1' ORDER BY s.Enrollment DESC LIMIT 1;",
    "table_names": [
      "school",
      "school_details"
    ]
  },
  {
    "id": 1585,
    "db_id": "school_player",
    "question": "What are the schools' names, their respective locations and nicknames, which offer only day school facilities and compete in Division 1?",
    "sql": "SELECT s.School, s.Location, sd.Nickname FROM school s JOIN school_details sd ON s.School_ID = sd.School_ID WHERE s.Day_or_Boarding = 'Day' AND sd.Division = 'Division 1';",
    "table_names": [
      "school",
      "school_details"
    ]
  },
  {
    "id": 1586,
    "db_id": "soccer_2",
    "question": "Who is the player that has a high score of 1500 or more and successfully passed the tryout as a striker?",
    "sql": "SELECT Player.pName FROM Player JOIN Tryout ON Player.pID = Tryout.pID WHERE Player.HS >= 1500 AND Tryout.decision = 'yes' AND Tryout.pPos = 'striker';",
    "table_names": [
      "Player",
      "Tryout"
    ]
  },
  {
    "id": 1587,
    "db_id": "soccer_2",
    "question": "Which player without a yellow card successfully passed the tryout at ASU?",
    "sql": "SELECT Player.pName FROM Player JOIN Tryout ON Player.pID = Tryout.pID WHERE Tryout.cName = 'ASU' AND Tryout.decision = 'yes' AND Player.yCard = 'no';",
    "table_names": [
      "Player",
      "Tryout"
    ]
  },
  {
    "id": 1588,
    "db_id": "soccer_2",
    "question": "In which state is the college located that accepted a goalie during tryouts?",
    "sql": "SELECT state FROM College WHERE cName IN (SELECT cName FROM Tryout WHERE pPos = 'goalie' AND decision = 'yes');",
    "table_names": [
      "College",
      "Tryout"
    ]
  },
  {
    "id": 1589,
    "db_id": "soccer_2",
    "question": "What state is the college located in where player with pID 10001 successfully passed the tryouts?",
    "sql": "SELECT state FROM College WHERE cName = (SELECT cName FROM Tryout WHERE pID = 10001 AND decision = 'yes');",
    "table_names": [
      "College",
      "Tryout"
    ]
  },
  {
    "id": 1590,
    "db_id": "soccer_2",
    "question": "What is the state of the college that accepted a goalie during tryouts?",
    "sql": "SELECT College.state FROM College JOIN Tryout ON College.cName = Tryout.cName WHERE Tryout.pPos = 'goalie' AND Tryout.decision = 'yes';",
    "table_names": [
      "College",
      "Tryout"
    ]
  },
  {
    "id": 1591,
    "db_id": "soccer_2",
    "question": "What is the player ID of the applicant who was accepted by the college situated in Arizona?",
    "sql": "SELECT T.pID FROM Tryout T JOIN College C ON T.cName = C.cName WHERE T.decision = 'yes' AND C.state = 'AZ';",
    "table_names": [
      "College",
      "Tryout"
    ]
  },
  {
    "id": 1592,
    "db_id": "soccer_2",
    "question": "What are the names of players with a high-score above 1000 who received a positive decision during their tryouts?",
    "sql": "SELECT Player.pName FROM Player JOIN Tryout ON Player.pID = Tryout.pID WHERE Player.HS > 1000 AND Tryout.decision = 'yes';",
    "table_names": [
      "Player",
      "Tryout"
    ]
  },
  {
    "id": 1593,
    "db_id": "soccer_2",
    "question": "How many players with a yellow card and a high score greater than 500 failed their tryouts?",
    "sql": "SELECT COUNT(*) FROM Player P JOIN Tryout T ON P.pID = T.pID WHERE P.HS > 500 AND P.yCard = 'yes' AND T.decision = 'no';",
    "table_names": [
      "Player",
      "Tryout"
    ]
  },
  {
    "id": 1594,
    "db_id": "soccer_2",
    "question": "Which players having a high score of at least 1000 successfully passed a tryout?",
    "sql": "SELECT Player.pName FROM Player JOIN Tryout ON Player.pID = Tryout.pID WHERE Player.HS >= 1000 AND Tryout.decision = 'yes';",
    "table_names": [
      "Player",
      "Tryout"
    ]
  },
  {
    "id": 1595,
    "db_id": "soccer_2",
    "question": "Which player received a yellow card and also got rejected when trying out for the goalie position?",
    "sql": "SELECT Player.pName FROM Player INNER JOIN Tryout ON Player.pID = Tryout.pID WHERE Player.yCard = 'yes' AND Tryout.pPos = 'goalie' AND Tryout.decision = 'no';",
    "table_names": [
      "Player",
      "Tryout"
    ]
  },
  {
    "id": 1596,
    "db_id": "soccer_2",
    "question": "How many unique colleges accepted players who had a high score of at least 1000?",
    "sql": "SELECT COUNT(DISTINCT T.cName) FROM Player P JOIN Tryout T ON P.pID = T.pID WHERE P.HS >= 1000 AND T.decision = 'yes';",
    "table_names": [
      "Player",
      "Tryout"
    ]
  },
  {
    "id": 1597,
    "db_id": "soccer_2",
    "question": "What is the name of the player who has at least 1500 HS points, received no yellow card, and was accepted in the tryout?",
    "sql": "SELECT p.pName FROM Player p JOIN Tryout t ON p.pID = t.pID WHERE p.HS >= 1500 AND p.yCard = 'no' AND t.decision = 'yes';",
    "table_names": [
      "Player",
      "Tryout"
    ]
  },
  {
    "id": 1598,
    "db_id": "soccer_2",
    "question": "Which states have colleges that accepted players trying out for the goalie position?",
    "sql": "SELECT state FROM College WHERE cName IN (SELECT cName FROM Tryout WHERE pPos = 'goalie' AND decision = 'yes')",
    "table_names": [
      "College",
      "Tryout"
    ]
  },
  {
    "id": 1599,
    "db_id": "soccer_2",
    "question": "What are the IDs of players who applied to be goalies at colleges with enrollments over 15000 but were rejected?",
    "sql": "SELECT Tryout.pID FROM Tryout JOIN College ON Tryout.cName = College.cName WHERE College.enr > 15000 AND Tryout.pPos = 'goalie' AND Tryout.decision = 'no';",
    "table_names": [
      "College",
      "Tryout"
    ]
  },
  {
    "id": 1600,
    "db_id": "soccer_2",
    "question": "How many players without any yellow card and with a high score above 1000 made it through any tryout successfully?",
    "sql": "SELECT COUNT(DISTINCT Player.pID) FROM Player JOIN Tryout ON Player.pID = Tryout.pID WHERE Player.HS > 1000 AND Player.yCard = 'no' AND Tryout.decision = 'yes';",
    "table_names": [
      "Player",
      "Tryout"
    ]
  },
  {
    "id": 1601,
    "db_id": "soccer_2",
    "question": "Which players received a yellow card and were rejected from a tryout?",
    "sql": "SELECT DISTINCT p.pName FROM Player p JOIN Tryout t ON p.pID = t.pID WHERE p.yCard = 'yes' AND t.decision = 'no';",
    "table_names": [
      "Player",
      "Tryout"
    ]
  },
  {
    "id": 1602,
    "db_id": "soccer_2",
    "question": "What is the name of the player who successfully passed the tryout as a goalie without receiving a yellow card?",
    "sql": "SELECT Player.pName FROM Player JOIN Tryout ON Player.pID = Tryout.pID WHERE Tryout.pPos = 'goalie' AND Player.yCard = 'no' AND Tryout.decision = 'yes';",
    "table_names": [
      "Player",
      "Tryout"
    ]
  },
  {
    "id": 1603,
    "db_id": "soccer_2",
    "question": "How many players without a yellow card and with a high score of at least 1000 successfully passed their tryout?",
    "sql": "SELECT COUNT(DISTINCT Player.pID) FROM Player INNER JOIN Tryout ON Player.pID = Tryout.pID WHERE Player.HS >= 1000 AND Player.yCard = 'no' AND Tryout.decision = 'yes';",
    "table_names": [
      "Player",
      "Tryout"
    ]
  },
  {
    "id": 1604,
    "db_id": "soccer_2",
    "question": "Which player with a high school score greater than 1000 was accepted as a goalie during tryouts?",
    "sql": "SELECT p.pName FROM Player p INNER JOIN Tryout t ON p.pID = t.pID WHERE p.HS > 1000 AND t.decision = 'yes' AND t.pPos = 'goalie';",
    "table_names": [
      "Player",
      "Tryout"
    ]
  },
  {
    "id": 1605,
    "db_id": "soccer_2",
    "question": "What are the names of players who received a yellow card and got rejected in their tryouts?",
    "sql": "SELECT p.pName FROM Player p INNER JOIN Tryout t ON p.pID = t.pID WHERE p.yCard = 'yes' AND t.decision = 'no';",
    "table_names": [
      "Player",
      "Tryout"
    ]
  },
  {
    "id": 1606,
    "db_id": "soccer_2",
    "question": "What is the name of the player who has a yellow card and applied for the goalie position in a tryout but was not selected?",
    "sql": "SELECT Player.pName FROM Player JOIN Tryout ON Player.pID = Tryout.pID WHERE Player.yCard = 'yes' AND Tryout.pPos = 'goalie' AND Tryout.decision = 'no';",
    "table_names": [
      "Player",
      "Tryout"
    ]
  },
  {
    "id": 1607,
    "db_id": "soccer_2",
    "question": "Which players received yellow cards and were rejected at tryouts for the goalie position?",
    "sql": "SELECT Player.pName FROM Player JOIN Tryout ON Player.pID = Tryout.pID WHERE Player.yCard = 'yes' AND Tryout.decision = 'no' AND Tryout.pPos = 'goalie';",
    "table_names": [
      "Player",
      "Tryout"
    ]
  },
  {
    "id": 1608,
    "db_id": "soccer_2",
    "question": "How many players with yellow cards were rejected during their tryouts?",
    "sql": "SELECT COUNT(DISTINCT Player.pID) FROM Player JOIN Tryout ON Player.pID = Tryout.pID WHERE Player.yCard = 'yes' AND Tryout.decision = 'no';",
    "table_names": [
      "Player",
      "Tryout"
    ]
  },
  {
    "id": 1609,
    "db_id": "soccer_2",
    "question": "Which player's name has a high school score of at least 1000 and was successfully selected as a goalie during tryouts?",
    "sql": "SELECT Player.pName FROM Player JOIN Tryout ON Player.pID = Tryout.pID WHERE Player.HS >= 1000 AND Tryout.pPos = 'goalie' AND Tryout.decision = 'yes';",
    "table_names": [
      "Player",
      "Tryout"
    ]
  },
  {
    "id": 1610,
    "db_id": "soccer_2",
    "question": "In which state is the college located that accepted a goalie?",
    "sql": "SELECT state FROM College WHERE cName IN (SELECT cName FROM Tryout WHERE decision = 'yes' AND pPos = 'goalie');",
    "table_names": [
      "College",
      "Tryout"
    ]
  },
  {
    "id": 1611,
    "db_id": "soccer_2",
    "question": "In which state is the college located that accepted a goalie during tryouts?",
    "sql": "SELECT state FROM College WHERE cName IN (SELECT cName FROM Tryout WHERE pPos = 'goalie' AND decision = 'yes');",
    "table_names": [
      "College",
      "Tryout"
    ]
  },
  {
    "id": 1612,
    "db_id": "soccer_2",
    "question": "In which state is located the college where player with pID 10001 was accepted?",
    "sql": "SELECT College.state FROM College JOIN Tryout ON College.cName = Tryout.cName WHERE Tryout.pID = 10001 AND Tryout.decision = 'yes';",
    "table_names": [
      "College",
      "Tryout"
    ]
  },
  {
    "id": 1613,
    "db_id": "soccer_2",
    "question": "Which states have colleges that accepted goalies?",
    "sql": "SELECT state FROM College WHERE cName IN (SELECT cName FROM Tryout WHERE pPos = 'goalie' AND decision = 'yes');",
    "table_names": [
      "College",
      "Tryout"
    ]
  },
  {
    "id": 1614,
    "db_id": "soccer_2",
    "question": "What is the state of the college where the player with pID 10001 successfully passed the tryout?",
    "sql": "SELECT College.state FROM College INNER JOIN Tryout ON College.cName = Tryout.cName WHERE Tryout.pID = 10001 AND Tryout.decision = 'yes';",
    "table_names": [
      "College",
      "Tryout"
    ]
  },
  {
    "id": 1615,
    "db_id": "soccer_2",
    "question": "What is the state of the college where a goalie player was successfully accepted?",
    "sql": "SELECT College.state FROM College JOIN Tryout ON College.cName = Tryout.cName WHERE Tryout.decision = 'yes' AND Tryout.pPos = 'goalie';",
    "table_names": [
      "College",
      "Tryout"
    ]
  },
  {
    "id": 1616,
    "db_id": "soccer_2",
    "question": "What is the state of the college where player with ID 10001 was accepted after their tryout?",
    "sql": "SELECT College.state FROM College JOIN Tryout ON College.cName = Tryout.cName WHERE Tryout.pID = 10001 AND Tryout.decision = 'yes';",
    "table_names": [
      "College",
      "Tryout"
    ]
  },
  {
    "id": 1617,
    "db_id": "soccer_2",
    "question": "Which state's college accepted a player applying for the goalie position?",
    "sql": "SELECT state FROM College WHERE cName IN (SELECT cName FROM Tryout WHERE pPos = 'goalie' AND decision = 'yes');",
    "table_names": [
      "College",
      "Tryout"
    ]
  },
  {
    "id": 1618,
    "db_id": "soccer_2",
    "question": "Which states have colleges that accepted at least one player based on their tryout decision?",
    "sql": "SELECT state FROM College WHERE cName IN (SELECT cName FROM Tryout WHERE decision = 'yes');",
    "table_names": [
      "College",
      "Tryout"
    ]
  },
  {
    "id": 1619,
    "db_id": "soccer_2",
    "question": "What is the state of the college that accepted a goalie position player?",
    "sql": "SELECT College.state FROM College JOIN Tryout ON College.cName = Tryout.cName WHERE Tryout.pPos = 'goalie' AND Tryout.decision = 'yes';",
    "table_names": [
      "College",
      "Tryout"
    ]
  },
  {
    "id": 1620,
    "db_id": "device",
    "question": "How many total units of Device_ID '4' are there in stores opened before the year 2010?",
    "sql": "SELECT SUM(stock.Quantity) AS total_quantity FROM shop JOIN stock ON shop.Shop_ID = stock.Shop_ID WHERE shop.Open_Year < 2010 AND stock.Device_ID = 4;",
    "table_names": [
      "shop",
      "stock"
    ]
  },
  {
    "id": 1621,
    "db_id": "device",
    "question": "What's the total quantity of Device ID 4 available in all shops that opened on or after 2010?",
    "sql": "SELECT SUM(s.Quantity) FROM stock s JOIN shop sh ON s.Shop_ID = sh.Shop_ID WHERE sh.Open_Year >= 2010 AND s.Device_ID = 4;",
    "table_names": [
      "shop",
      "stock"
    ]
  },
  {
    "id": 1622,
    "db_id": "device",
    "question": "What is the name, location, and quantity of the shop that opened before 2010 and currently has the highest quantity of device with Device_ID 4?",
    "sql": "SELECT shop.Shop_Name, shop.Location, stock.Quantity FROM shop JOIN stock ON shop.Shop_ID = stock.Shop_ID WHERE stock.Device_ID = 4 AND shop.Open_Year < 2010 ORDER BY stock.Quantity DESC LIMIT 1;",
    "table_names": [
      "shop",
      "stock"
    ]
  },
  {
    "id": 1623,
    "db_id": "device",
    "question": "Which shop located either in Dinas or Blaenllechau has the highest number of total devices in stock?",
    "sql": "SELECT s.Shop_Name, SUM(st.Quantity) as Total_Quantity FROM shop s JOIN stock st ON s.Shop_ID = st.Shop_ID WHERE s.Location IN ('Dinas', 'Blaenllechau') GROUP BY s.Shop_Name ORDER BY Total_Quantity DESC LIMIT 1;",
    "table_names": [
      "shop",
      "stock"
    ]
  },
  {
    "id": 1624,
    "db_id": "device",
    "question": "Which shops opened before 2010 have more than 100 units of device ID 4 in stock, and where are they located?",
    "sql": "SELECT shop.Shop_Name, shop.Location FROM shop JOIN stock ON shop.Shop_ID = stock.Shop_ID WHERE stock.Device_ID = 4 AND stock.Quantity > 100 AND shop.Open_Year < 2010;",
    "table_names": [
      "shop",
      "stock"
    ]
  },
  {
    "id": 1625,
    "db_id": "device",
    "question": "Which shops opened before 2010 have stocked Device_ID 4 in quantities greater than 100?",
    "sql": "SELECT shop.Shop_Name FROM shop INNER JOIN stock ON shop.Shop_ID = stock.Shop_ID WHERE shop.Open_Year < 2010 AND stock.Device_ID = 4 AND stock.Quantity > 100;",
    "table_names": [
      "shop",
      "stock"
    ]
  },
  {
    "id": 1626,
    "db_id": "device",
    "question": "What is the total quantity of device 6 in stock in shops located in either Dinas or Blaenllechau that were opened in or before the year 2010?",
    "sql": "SELECT SUM(s.Quantity) FROM stock s JOIN shop sh ON s.Shop_ID = sh.Shop_ID WHERE sh.Location IN ('Dinas', 'Blaenllechau') AND s.Device_ID = 6 AND sh.Open_Year <= 2010;",
    "table_names": [
      "shop",
      "stock"
    ]
  },
  {
    "id": 1627,
    "db_id": "device",
    "question": "What are the names of shops that have device ID 4 in stock but with a quantity less than 100?",
    "sql": "SELECT shop.Shop_Name FROM shop JOIN stock ON shop.Shop_ID = stock.Shop_ID WHERE stock.Device_ID = 4 AND stock.Quantity < 100;",
    "table_names": [
      "shop",
      "stock"
    ]
  },
  {
    "id": 1628,
    "db_id": "device",
    "question": "What is the total quantity available across all shops for Android devices having the package version '5.0.0.419'?",
    "sql": "SELECT SUM(stock.Quantity) FROM stock JOIN device ON stock.Device_ID = device.Device_ID WHERE device.Software_Platform = 'Android' AND device.Package_Version = '5.0.0.419';",
    "table_names": [
      "device",
      "stock"
    ]
  },
  {
    "id": 1629,
    "db_id": "device",
    "question": "What is the total quantity in stock for all Android devices having the package version 5.0.0.419?",
    "sql": "SELECT SUM(s.Quantity) FROM stock s JOIN device d ON s.Device_ID = d.Device_ID WHERE d.Software_Platform = 'Android' AND d.Package_Version = '5.0.0.419';",
    "table_names": [
      "device",
      "stock"
    ]
  },
  {
    "id": 1630,
    "db_id": "device",
    "question": "What is the total stock quantity for devices running the Android software platform with package version 5.0.0.419?",
    "sql": "SELECT SUM(s.Quantity) FROM stock s JOIN device d ON s.Device_ID = d.Device_ID WHERE d.Software_Platform = 'Android' AND d.Package_Version = '5.0.0.419';",
    "table_names": [
      "device",
      "stock"
    ]
  },
  {
    "id": 1631,
    "db_id": "device",
    "question": "What is the total quantity available in stock for Android devices that have the package version 5.0.0.419?",
    "sql": "SELECT SUM(s.Quantity) FROM stock s JOIN device d ON s.Device_ID = d.Device_ID WHERE d.Software_Platform = 'Android' AND d.Package_Version = '5.0.0.419';",
    "table_names": [
      "device",
      "stock"
    ]
  },
  {
    "id": 1636,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "How many stores are located in marketing regions that have a description containing the word 'market'?",
    "sql": "SELECT COUNT(*) FROM Stores WHERE Marketing_Region_Code IN (SELECT Marketing_Region_Code FROM Marketing_Regions WHERE Marketing_Region_Descriptrion LIKE '%market%');",
    "table_names": [
      "Marketing_Regions",
      "Stores"
    ]
  },
  {
    "id": 1637,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "What are the names of the marketing regions where stores with a rating of '5 stars' are located?",
    "sql": "SELECT DISTINCT m.Marketing_Region_Name FROM Marketing_Regions m JOIN Stores s ON m.Marketing_Region_Code = s.Marketing_Region_Code WHERE s.Other_Details = '5 stars';",
    "table_names": [
      "Marketing_Regions",
      "Stores"
    ]
  },
  {
    "id": 1638,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "What is the total price of all services categorized under 'provide filming service'?",
    "sql": "SELECT SUM(Product_Price) FROM Services WHERE Service_Type_Code IN (SELECT Service_Type_Code FROM Ref_Service_Types WHERE Parent_Service_Type_Code='1' AND Service_Type_Description='provide filming service');",
    "table_names": [
      "Ref_Service_Types",
      "Services"
    ]
  },
  {
    "id": 1639,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "What is the total price of all 'film' products under the parent service type code '1'?",
    "sql": "SELECT SUM(s.Product_Price) FROM Services s JOIN Ref_Service_Types r ON s.Service_Type_Code = r.Service_Type_Code WHERE r.Parent_Service_Type_Code = '1' AND s.Product_Name = 'film';",
    "table_names": [
      "Ref_Service_Types",
      "Services"
    ]
  },
  {
    "id": 1640,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "What is the total price for all services that fall under the parent service type 'provide photo service' and have the product name 'photo'?",
    "sql": "SELECT SUM(s.Product_Price) FROM Services s JOIN Ref_Service_Types r ON s.Service_Type_Code = r.Service_Type_Code WHERE r.Parent_Service_Type_Code = '1' AND s.Product_Name = 'photo';",
    "table_names": [
      "Ref_Service_Types",
      "Services"
    ]
  },
  {
    "id": 1641,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "What is the average product price of all 'photo' services whose service type has the parent service type code of '1'?",
    "sql": "SELECT AVG(s.Product_Price) FROM Services s JOIN Ref_Service_Types r ON s.Service_Type_Code = r.Service_Type_Code WHERE r.Parent_Service_Type_Code = '1' AND s.Product_Name = 'photo';",
    "table_names": [
      "Ref_Service_Types",
      "Services"
    ]
  },
  {
    "id": 1642,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "What is the total price of all services that either directly offer filming service or belong to a service type whose parent service type is providing filming service?",
    "sql": "SELECT SUM(S.Product_Price) FROM Services S JOIN Ref_Service_Types R ON S.Service_Type_Code = R.Service_Type_Code WHERE R.Service_Type_Description = 'provide filming service' OR R.Parent_Service_Type_Code = (SELECT Service_Type_Code FROM Ref_Service_Types WHERE Service_Type_Description = 'provide filming service')",
    "table_names": [
      "Ref_Service_Types",
      "Services"
    ]
  },
  {
    "id": 1643,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "What is the total product price for all 'film' services whose service type belongs to parent service type code '1'?",
    "sql": "SELECT SUM(Product_Price) FROM Services WHERE Service_Type_Code IN (SELECT Service_Type_Code FROM Ref_Service_Types WHERE Parent_Service_Type_Code = '1') AND Product_Name = 'film';",
    "table_names": [
      "Ref_Service_Types",
      "Services"
    ]
  },
  {
    "id": 1644,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "What is the total price of all 'photo' services delivered by workshops located in the 'RU' marketing region?",
    "sql": "SELECT SUM(s.Product_Price) FROM Services s JOIN Drama_Workshop_Groups d ON s.Workshop_Group_ID = d.Workshop_Group_ID WHERE d.Marketing_Region_Code = 'RU' AND s.Product_Name = 'photo';",
    "table_names": [
      "Drama_Workshop_Groups",
      "Services"
    ]
  },
  {
    "id": 1645,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "Which stores in the RU region offer 'photo' products priced over 1,000,000, and what are their email addresses and prices?",
    "sql": "SELECT DWG.Store_Name, DWG.Store_Email_Address, S.Product_Price FROM Drama_Workshop_Groups DWG JOIN Services S ON DWG.Workshop_Group_ID = S.Workshop_Group_ID WHERE DWG.Marketing_Region_Code = 'RU' AND S.Product_Name = 'photo' AND S.Product_Price > 1000000;",
    "table_names": [
      "Drama_Workshop_Groups",
      "Services"
    ]
  },
  {
    "id": 1646,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "What is the total price of all 'photo' products offered by drama workshops located in the marketing region 'RU'?",
    "sql": "SELECT SUM(S.Product_Price) FROM Services S JOIN Drama_Workshop_Groups DWG ON S.Workshop_Group_ID = DWG.Workshop_Group_ID WHERE DWG.Marketing_Region_Code = 'RU' AND S.Product_Name = 'photo';",
    "table_names": [
      "Drama_Workshop_Groups",
      "Services"
    ]
  },
  {
    "id": 1647,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "What is the total revenue from photo services offered by drama workshop groups located in the RU marketing region?",
    "sql": "SELECT SUM(s.Product_Price) AS total_revenue FROM Services s INNER JOIN Drama_Workshop_Groups d ON s.Workshop_Group_ID = d.Workshop_Group_ID WHERE d.Marketing_Region_Code = 'RU' AND s.Product_Name = 'photo';",
    "table_names": [
      "Drama_Workshop_Groups",
      "Services"
    ]
  },
  {
    "id": 1648,
    "db_id": "tracking_orders",
    "question": "What is the total revenue generated from orders containing products named 'film'?",
    "sql": "SELECT SUM(oi.Order_Quantity * p.Product_Price) FROM Order_Items oi JOIN Products p ON oi.Product_ID = p.Product_ID WHERE p.Product_Name = 'film';",
    "table_names": [
      "Products",
      "Order_Items"
    ]
  },
  {
    "id": 1649,
    "db_id": "tracking_orders",
    "question": "What is the total revenue generated by all orders containing products named 'film'?",
    "sql": "SELECT SUM(oi.Order_Quantity * p.Product_Price) FROM Order_Items oi JOIN Products p ON oi.Product_ID = p.Product_ID WHERE p.Product_Name = 'film';",
    "table_names": [
      "Products",
      "Order_Items"
    ]
  },
  {
    "id": 1650,
    "db_id": "tracking_orders",
    "question": "What is the total revenue generated from the sale of products named 'film'?",
    "sql": "SELECT SUM(Order_Items.Order_Quantity * Products.Product_Price) FROM Order_Items INNER JOIN Products ON Order_Items.Product_ID = Products.Product_ID WHERE Products.Product_Name = 'film';",
    "table_names": [
      "Products",
      "Order_Items"
    ]
  },
  {
    "id": 1651,
    "db_id": "tracking_orders",
    "question": "What is the total revenue generated from orders containing products labeled as 'film'?",
    "sql": "SELECT SUM(p.Product_Price * CAST(o.Order_Quantity AS INTEGER)) FROM Products p JOIN Order_Items o ON p.Product_ID = o.Product_ID WHERE p.Product_Name = 'film';",
    "table_names": [
      "Products",
      "Order_Items"
    ]
  },
  {
    "id": 1652,
    "db_id": "customers_and_addresses",
    "question": "How many distinct customers have ordered product 300 from store 231?",
    "sql": "SELECT COUNT(DISTINCT co.Customer_ID) AS customer_count FROM Customer_Orders co JOIN Order_Items oi ON co.Order_ID = oi.Order_ID WHERE oi.Product_ID = 300 AND co.Store_ID = 231;",
    "table_names": [
      "Customer_Orders",
      "Order_Items"
    ]
  },
  {
    "id": 1653,
    "db_id": "customers_and_addresses",
    "question": "How many distinct products were ordered from store number 231?",
    "sql": "SELECT COUNT(DISTINCT oi.Product_ID) FROM Customer_Orders co JOIN Order_Items oi ON co.Order_ID = oi.Order_ID WHERE co.Store_ID = 231;",
    "table_names": [
      "Customer_Orders",
      "Order_Items"
    ]
  },
  {
    "id": 1660,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "How many bookings have a 'good' status with workshop groups located in the Russian marketing region (RU)?",
    "sql": "SELECT COUNT(*) FROM Bookings AS b JOIN Drama_Workshop_Groups AS d ON b.Workshop_Group_ID = d.Workshop_Group_ID WHERE d.Marketing_Region_Code = 'RU' AND b.Status_Code = 'good';",
    "table_names": [
      "Drama_Workshop_Groups",
      "Bookings"
    ]
  },
  {
    "id": 1661,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "What is the store name and email address for the booking with the latest order date having the status 'good'?",
    "sql": "SELECT d.Store_Name, d.Store_Email_Address FROM Drama_Workshop_Groups d JOIN Bookings b ON CAST(d.Workshop_Group_ID AS TEXT) = b.Workshop_Group_ID WHERE b.Status_Code = 'good' ORDER BY b.Order_Date DESC LIMIT 1;",
    "table_names": [
      "Drama_Workshop_Groups",
      "Bookings"
    ]
  },
  {
    "id": 1664,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "What is the total price for all photo products whose parent service type code is '1'?",
    "sql": "SELECT SUM(S.Product_Price) FROM Services S INNER JOIN Ref_Service_Types R ON S.Service_Type_Code = R.Service_Type_Code WHERE R.Parent_Service_Type_Code = '1' AND S.Product_Name = 'photo';",
    "table_names": [
      "Ref_Service_Types",
      "Services"
    ]
  },
  {
    "id": 1665,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "What is the average price of all services provided under the parent service type 'provide filming service'?",
    "sql": "SELECT AVG(s.Product_Price) FROM Services s JOIN Ref_Service_Types r ON s.Service_Type_Code = r.Service_Type_Code WHERE r.Parent_Service_Type_Code = (SELECT Service_Type_Code FROM Ref_Service_Types WHERE Service_Type_Description = 'provide filming service');",
    "table_names": [
      "Ref_Service_Types",
      "Services"
    ]
  },
  {
    "id": 1666,
    "db_id": "manufactory_1",
    "question": "What is the average price of products manufactured by companies that have a revenue greater than 100?",
    "sql": "SELECT AVG(P.Price) FROM Products P JOIN Manufacturers M ON P.Manufacturer = M.Code WHERE M.Revenue > 100;",
    "table_names": [
      "Manufacturers",
      "Products"
    ]
  },
  {
    "id": 1667,
    "db_id": "manufactory_1",
    "question": "What's the average price of products made by manufacturers based in Tokyo and Taiwan?",
    "sql": "SELECT AVG(p.Price) FROM Products p JOIN Manufacturers m ON p.Manufacturer = m.Code WHERE m.Headquarter IN ('Tokyo','Taiwan');",
    "table_names": [
      "Manufacturers",
      "Products"
    ]
  },
  {
    "id": 1668,
    "db_id": "manufactory_1",
    "question": "List the names of manufacturers with revenue below 60 having products priced over 100.",
    "sql": "SELECT Manufacturers.Name FROM Manufacturers JOIN Products ON Manufacturers.Code = Products.Manufacturer WHERE Products.Price > 100 AND Manufacturers.Revenue < 60;",
    "table_names": [
      "Manufacturers",
      "Products"
    ]
  },
  {
    "id": 1669,
    "db_id": "manufactory_1",
    "question": "What's the average price of products produced by manufacturers with revenue greater than 100?",
    "sql": "SELECT AVG(P.Price) FROM Products AS P JOIN Manufacturers AS M ON P.Manufacturer = M.Code WHERE M.Revenue > 100;",
    "table_names": [
      "Manufacturers",
      "Products"
    ]
  },
  {
    "id": 1670,
    "db_id": "manufactory_1",
    "question": "What is the name of the manufacturer that has the highest average price across all its products?",
    "sql": "SELECT Manufacturers.Name FROM Manufacturers INNER JOIN Products ON Manufacturers.Code = Products.Manufacturer GROUP BY Manufacturers.Name ORDER BY AVG(Products.Price) DESC LIMIT 1;",
    "table_names": [
      "Manufacturers",
      "Products"
    ]
  },
  {
    "id": 1671,
    "db_id": "manufactory_1",
    "question": "What is the average price of products manufactured by companies headquartered in Tokyo or Beijing?",
    "sql": "SELECT AVG(P.Price) FROM Products AS P JOIN Manufacturers AS M ON P.Manufacturer = M.Code WHERE M.Headquarter IN ('Tokyo', 'Beijing');",
    "table_names": [
      "Manufacturers",
      "Products"
    ]
  },
  {
    "id": 1672,
    "db_id": "manufactory_1",
    "question": "List the names of products priced at $150 or more manufactured by companies headquartered in Austin.",
    "sql": "SELECT Products.Name FROM Products JOIN Manufacturers ON Products.Manufacturer = Manufacturers.Code WHERE Manufacturers.Headquarter = 'Austin' AND Products.Price >= 150;",
    "table_names": [
      "Manufacturers",
      "Products"
    ]
  },
  {
    "id": 1673,
    "db_id": "manufactory_1",
    "question": "Which manufacturers with revenue under 150 produce products priced above 150?",
    "sql": "SELECT Manufacturers.Name FROM Manufacturers JOIN Products ON Manufacturers.Code = Products.Manufacturer WHERE Products.Price > 150 AND Manufacturers.Revenue < 150;",
    "table_names": [
      "Manufacturers",
      "Products"
    ]
  },
  {
    "id": 1674,
    "db_id": "manufactory_1",
    "question": "What is the average price of products made by manufacturers whose revenue exceeds 100 million?",
    "sql": "SELECT AVG(Products.Price) FROM Products INNER JOIN Manufacturers ON Products.Manufacturer = Manufacturers.Code WHERE Manufacturers.Revenue > 100;",
    "table_names": [
      "Manufacturers",
      "Products"
    ]
  },
  {
    "id": 1675,
    "db_id": "manufactory_1",
    "question": "What is the name and headquarter location of the manufacturer who produces the product with the highest price?",
    "sql": "SELECT Manufacturers.Name, Manufacturers.Headquarter FROM Manufacturers INNER JOIN Products ON Manufacturers.Code = Products.Manufacturer WHERE Products.Price = (SELECT MAX(Price) FROM Products) ORDER BY Manufacturers.Name;",
    "table_names": [
      "Manufacturers",
      "Products"
    ]
  },
  {
    "id": 1676,
    "db_id": "manufactory_1",
    "question": "Which manufacturer produces the product with the highest price?",
    "sql": "SELECT m.Name FROM Manufacturers m JOIN Products p ON m.Code = p.Manufacturer WHERE p.Price = (SELECT MAX(Price) FROM Products);",
    "table_names": [
      "Manufacturers",
      "Products"
    ]
  },
  {
    "id": 1677,
    "db_id": "manufactory_1",
    "question": "What is the average price of products manufactured by companies having a revenue of 100 or higher?",
    "sql": "SELECT AVG(P.Price) FROM Products AS P JOIN Manufacturers AS M ON P.Manufacturer = M.Code WHERE M.Revenue >= 100;",
    "table_names": [
      "Manufacturers",
      "Products"
    ]
  },
  {
    "id": 1678,
    "db_id": "manufactory_1",
    "question": "What is the average price of products manufactured by companies headquartered in Tokyo, Beijing, or Taiwan?",
    "sql": "SELECT AVG(P.Price) FROM Products P JOIN Manufacturers M ON P.Manufacturer = M.Code WHERE M.Headquarter IN ('Tokyo', 'Beijing','Taiwan');",
    "table_names": [
      "Manufacturers",
      "Products"
    ]
  },
  {
    "id": 1679,
    "db_id": "manufactory_1",
    "question": "What is the average price of products made by manufacturers headquartered in Paris or Los Angeles?",
    "sql": "SELECT AVG(p.Price) FROM Products p JOIN Manufacturers m ON p.Manufacturer = m.Code WHERE m.Headquarter IN ('Paris', 'Los Angeles');",
    "table_names": [
      "Manufacturers",
      "Products"
    ]
  },
  {
    "id": 1680,
    "db_id": "manufactory_1",
    "question": "What is the average price of products made by manufacturers who have revenue greater than 100?",
    "sql": "SELECT AVG(Products.Price) FROM Products JOIN Manufacturers ON Products.Manufacturer = Manufacturers.Code WHERE Manufacturers.Revenue > 100;",
    "table_names": [
      "Manufacturers",
      "Products"
    ]
  },
  {
    "id": 1681,
    "db_id": "manufactory_1",
    "question": "Which manufacturer produces the product with the highest price?",
    "sql": "SELECT Manufacturers.Name FROM Manufacturers JOIN Products ON Manufacturers.Code = Products.Manufacturer WHERE Products.Price = (SELECT MAX(Price) FROM Products);",
    "table_names": [
      "Manufacturers",
      "Products"
    ]
  },
  {
    "id": 1682,
    "db_id": "manufactory_1",
    "question": "What is the average price of products made by manufacturers headquartered in either Austin or Los Angeles?",
    "sql": "SELECT AVG(P.Price) FROM Products P JOIN Manufacturers M ON P.Manufacturer = M.Code WHERE M.Headquarter IN ('Austin', 'Los Angeles');",
    "table_names": [
      "Manufacturers",
      "Products"
    ]
  },
  {
    "id": 1683,
    "db_id": "manufactory_1",
    "question": "Where is the headquarters of the manufacturer who produces the cheapest product?",
    "sql": "SELECT Manufacturers.Headquarter FROM Manufacturers JOIN Products ON Manufacturers.Code = Products.Manufacturer WHERE Products.Price = (SELECT MIN(Price) FROM Products);",
    "table_names": [
      "Manufacturers",
      "Products"
    ]
  },
  {
    "id": 1684,
    "db_id": "tracking_software_problems",
    "question": "Who is the staff member that has the most 'GUI' category problems with status 'Reported', and how many such problems do they have?",
    "sql": "SELECT s.staff_first_name, s.staff_last_name, COUNT(pl.problem_log_id) AS total_reported_gui_problems FROM Problem_Log pl JOIN Staff s ON pl.assigned_to_staff_id = s.staff_id WHERE pl.problem_category_code = 'GUI' AND pl.problem_status_code = 'Reported' GROUP BY s.staff_id ORDER BY total_reported_gui_problems DESC LIMIT 1;",
    "table_names": [
      "Problem_Log",
      "Staff"
    ]
  },
  {
    "id": 1685,
    "db_id": "tracking_software_problems",
    "question": "Which staff member solved the highest number of distinct GUI and Middleware problems?",
    "sql": "SELECT s.staff_first_name, s.staff_last_name, COUNT(DISTINCT p.problem_id) AS solved_problems FROM Problem_Log p JOIN Staff s ON p.assigned_to_staff_id = s.staff_id WHERE p.problem_status_code = 'Solved' AND p.problem_category_code IN ('GUI', 'Middleware') GROUP BY s.staff_id ORDER BY solved_problems DESC LIMIT 1;",
    "table_names": [
      "Problem_Log",
      "Staff"
    ]
  },
  {
    "id": 1686,
    "db_id": "tracking_software_problems",
    "question": "Which staff member has solved the highest number of problems related to GUI issues, and how many GUI issues did they solve?",
    "sql": "SELECT s.staff_first_name, s.staff_last_name, COUNT(pl.problem_log_id) AS solved_gui_issues FROM Problem_Log pl JOIN Staff s ON pl.assigned_to_staff_id = s.staff_id WHERE pl.problem_category_code = 'GUI' AND pl.problem_status_code = 'Solved' GROUP BY s.staff_id ORDER BY solved_gui_issues DESC LIMIT 1;",
    "table_names": [
      "Problem_Log",
      "Staff"
    ]
  },
  {
    "id": 1687,
    "db_id": "tracking_software_problems",
    "question": "How many distinct middleware problems have been reported and assigned to the staff member with last name 'Lynch'?",
    "sql": "SELECT COUNT(DISTINCT pl.problem_id) FROM Problem_Log pl JOIN Staff s ON pl.assigned_to_staff_id = s.staff_id WHERE s.staff_last_name = 'Lynch' AND pl.problem_category_code = 'Middleware' AND pl.problem_status_code = 'Reported';",
    "table_names": [
      "Problem_Log",
      "Staff"
    ]
  },
  {
    "id": 1688,
    "db_id": "tracking_software_problems",
    "question": "How many problems have been reported for the product named 'wechat'?",
    "sql": "SELECT COUNT(*) FROM Problems WHERE product_id = (SELECT product_id FROM Product WHERE product_name = 'wechat');",
    "table_names": [
      "Product",
      "Problems"
    ]
  },
  {
    "id": 1689,
    "db_id": "tracking_software_problems",
    "question": "What are the names of products for which problems were authorized to be closed by staff member 9 after January 1, 1990?",
    "sql": "SELECT product_name FROM Product WHERE product_id IN (SELECT product_id FROM Problems WHERE closure_authorised_by_staff_id = 9 AND date_problem_closed > '1990-01-01 00:00:00');",
    "table_names": [
      "Product",
      "Problems"
    ]
  },
  {
    "id": 1690,
    "db_id": "tracking_software_problems",
    "question": "Which product has the highest number of reported problems?",
    "sql": "SELECT p.product_name, COUNT(pr.problem_id) AS total_problems FROM Product p JOIN Problems pr ON p.product_id = pr.product_id GROUP BY p.product_id ORDER BY total_problems DESC LIMIT 1;",
    "table_names": [
      "Product",
      "Problems"
    ]
  },
  {
    "id": 1691,
    "db_id": "tracking_software_problems",
    "question": "Which product had the earliest reported problem that was closed after the year 2000?",
    "sql": "SELECT p.product_name FROM Product p JOIN Problems pr ON p.product_id = pr.product_id WHERE pr.date_problem_closed > '2000-01-01' ORDER BY pr.date_problem_reported ASC LIMIT 1;",
    "table_names": [
      "Product",
      "Problems"
    ]
  },
  {
    "id": 1692,
    "db_id": "tracking_software_problems",
    "question": "How many unique problems were reported by the staff member 'Dameon' and later closed with authorization by the staff member named 'Lacey'?",
    "sql": "SELECT COUNT(DISTINCT p.problem_id) FROM Problems p JOIN Staff s1 ON p.reported_by_staff_id = s1.staff_id JOIN Staff s2 ON p.closure_authorised_by_staff_id = s2.staff_id WHERE s1.staff_first_name = 'Dameon' AND s2.staff_first_name = 'Lacey';",
    "table_names": [
      "Staff",
      "Problems"
    ]
  },
  {
    "id": 1693,
    "db_id": "tracking_software_problems",
    "question": "What are the IDs and descriptions of problems that were authorized for closure by staff member Ashley and were closed before the year 1990?",
    "sql": "SELECT p.problem_id, p.problem_description FROM Problems p JOIN Staff s ON p.closure_authorised_by_staff_id = s.staff_id WHERE s.staff_first_name = 'Ashley' AND p.date_problem_closed < '1990-01-01';",
    "table_names": [
      "Staff",
      "Problems"
    ]
  },
  {
    "id": 1694,
    "db_id": "tracking_software_problems",
    "question": "Who is the staff member that reported the earliest problem recorded?",
    "sql": "SELECT s.staff_first_name, s.staff_last_name FROM Staff AS s JOIN Problems AS p ON s.staff_id = p.reported_by_staff_id WHERE p.problem_id = (SELECT problem_id FROM Problems ORDER BY date_problem_reported LIMIT 1)",
    "table_names": [
      "Staff",
      "Problems"
    ]
  },
  {
    "id": 1695,
    "db_id": "tracking_software_problems",
    "question": "Who reported the highest number of problems and how many problems did they report?",
    "sql": "SELECT S.staff_first_name, S.staff_last_name, COUNT(P.problem_id) AS problems_reported FROM Staff S INNER JOIN Problems P ON S.staff_id = P.reported_by_staff_id GROUP BY S.staff_id ORDER BY problems_reported DESC LIMIT 1;",
    "table_names": [
      "Staff",
      "Problems"
    ]
  },
  {
    "id": 1696,
    "db_id": "tracking_software_problems",
    "question": "What is the name of the product that has more than two reported problems associated with it?",
    "sql": "SELECT product_name FROM Product WHERE product_id IN (SELECT product_id FROM Problems GROUP BY product_id HAVING COUNT(problem_id) > 2);",
    "table_names": [
      "Product",
      "Problems"
    ]
  },
  {
    "id": 1697,
    "db_id": "tracking_software_problems",
    "question": "List the names of products that have problems reported between 1970 and 1980, which were closed by staff with id 9.",
    "sql": "SELECT product_name FROM Product WHERE product_id IN (SELECT product_id FROM Problems WHERE closure_authorised_by_staff_id = 9 AND date_problem_reported BETWEEN '1970-01-01' AND '1980-12-31');",
    "table_names": [
      "Product",
      "Problems"
    ]
  },
  {
    "id": 1698,
    "db_id": "tracking_software_problems",
    "question": "What are the names of products that have been reported with problems more than twice, and how many problems were reported for each of them?",
    "sql": "SELECT p.product_name, COUNT(*) AS total_problems FROM Product p JOIN Problems pb ON p.product_id = pb.product_id GROUP BY p.product_name HAVING COUNT(*) > 2;",
    "table_names": [
      "Product",
      "Problems"
    ]
  },
  {
    "id": 1699,
    "db_id": "tracking_software_problems",
    "question": "How many problems related to the product named 'wechat' were authorized for closure by a staff member with an ID greater than 10?",
    "sql": "SELECT COUNT(*) FROM Problems WHERE product_id = (SELECT product_id FROM Product WHERE product_name = 'wechat') AND closure_authorised_by_staff_id > 10;",
    "table_names": [
      "Product",
      "Problems"
    ]
  },
  {
    "id": 1700,
    "db_id": "tracking_software_problems",
    "question": "Who authorized the closure of the problem reported by Kayla Klein?",
    "sql": "SELECT CONCAT(closure_staff.staff_first_name, ' ', closure_staff.staff_last_name) AS closure_authorizer_name FROM Staff AS closure_staff JOIN Problems ON closure_staff.staff_id = Problems.closure_authorised_by_staff_id WHERE Problems.problem_id = 6;",
    "table_names": [
      "Staff",
      "Problems"
    ]
  },
  {
    "id": 1701,
    "db_id": "tracking_software_problems",
    "question": "How many problems were reported by the staff member with the last name 'Frami'?",
    "sql": "SELECT COUNT(*) FROM Problems p JOIN Staff s ON p.reported_by_staff_id = s.staff_id WHERE s.staff_last_name = 'Frami';",
    "table_names": [
      "Staff",
      "Problems"
    ]
  },
  {
    "id": 1702,
    "db_id": "tracking_software_problems",
    "question": "What is the full name of the staff member who authorized the closure of a problem described as 'a' and reported after January 1, 1990?",
    "sql": "SELECT S.staff_first_name, S.staff_last_name FROM Staff S JOIN Problems P ON S.staff_id = P.closure_authorised_by_staff_id WHERE P.problem_description = 'a' AND P.date_problem_reported > '1990-01-01';",
    "table_names": [
      "Staff",
      "Problems"
    ]
  },
  {
    "id": 1703,
    "db_id": "tracking_software_problems",
    "question": "How many problems reported by the staff member with first name 'Christop' were closed before the year 2000?",
    "sql": "SELECT COUNT(*) FROM Problems p JOIN Staff s ON p.reported_by_staff_id = s.staff_id WHERE s.staff_first_name = 'Christop' AND p.date_problem_closed < '2000-01-01';",
    "table_names": [
      "Staff",
      "Problems"
    ]
  },
  {
    "id": 1704,
    "db_id": "tracking_software_problems",
    "question": "Who authorized the closure of the most recently reported problem?",
    "sql": "SELECT staff_first_name, staff_last_name FROM Staff WHERE staff_id = (SELECT closure_authorised_by_staff_id FROM Problems WHERE problem_id = (SELECT problem_id FROM Problems WHERE date_problem_reported = (SELECT MAX(date_problem_reported) FROM Problems)))",
    "table_names": [
      "Staff",
      "Problems"
    ]
  },
  {
    "id": 1705,
    "db_id": "tracking_software_problems",
    "question": "Which staff member authorized the closure of the highest number of problems, and what is the total number?",
    "sql": "SELECT s.staff_first_name, s.staff_last_name, COUNT(p.problem_id) AS num_authored_problems FROM Staff s JOIN Problems p ON s.staff_id = p.closure_authorised_by_staff_id GROUP BY s.staff_id ORDER BY num_authored_problems DESC LIMIT 1;",
    "table_names": [
      "Staff",
      "Problems"
    ]
  },
  {
    "id": 1706,
    "db_id": "tracking_software_problems",
    "question": "Who authorized the closure of problem reports for product ID 4 that were closed after 2000?",
    "sql": "SELECT s.staff_first_name, s.staff_last_name FROM Staff s JOIN Problems p ON s.staff_id = p.closure_authorised_by_staff_id WHERE p.product_id = 4 AND p.date_problem_closed > '2000-01-01';",
    "table_names": [
      "Staff",
      "Problems"
    ]
  },
  {
    "id": 1707,
    "db_id": "tracking_software_problems",
    "question": "How many problems were authorized for closure by the staff member named Lacey Bosco?",
    "sql": "SELECT COUNT(*) FROM Problems p JOIN Staff s ON p.closure_authorised_by_staff_id = s.staff_id WHERE s.staff_first_name = 'Lacey' AND s.staff_last_name = 'Bosco';",
    "table_names": [
      "Staff",
      "Problems"
    ]
  },
  {
    "id": 1708,
    "db_id": "tracking_software_problems",
    "question": "Which product has the highest number of problems reported, and how many problems does it have?",
    "sql": "SELECT p.product_name, COUNT(pr.problem_id) as problem_count FROM Product p JOIN Problems pr ON p.product_id = pr.product_id GROUP BY p.product_name ORDER BY problem_count DESC LIMIT 1;",
    "table_names": [
      "Product",
      "Problems"
    ]
  },
  {
    "id": 1709,
    "db_id": "tracking_software_problems",
    "question": "Which product has the largest number of reported problems?",
    "sql": "SELECT Product.product_name, COUNT(Problems.problem_id) AS num_problems FROM Product INNER JOIN Problems ON Product.product_id = Problems.product_id GROUP BY Product.product_name ORDER BY num_problems DESC LIMIT 1;",
    "table_names": [
      "Product",
      "Problems"
    ]
  },
  {
    "id": 1710,
    "db_id": "shop_membership",
    "question": "Which branches located in Oxford had members registering in the year 2016?",
    "sql": "SELECT b.Name, b.City FROM branch b JOIN membership_register_branch mrb ON b.Branch_ID = mrb.Branch_ID WHERE mrb.Register_Year = '2016' AND b.City = 'Oxford';",
    "table_names": [
      "branch",
      "membership_register_branch"
    ]
  },
  {
    "id": 1711,
    "db_id": "shop_membership",
    "question": "Which branches located in Oxford had new membership registrations in the year 2016?",
    "sql": "SELECT b.Name FROM branch b JOIN membership_register_branch mrb ON b.Branch_ID = mrb.Branch_ID WHERE mrb.Register_Year = '2016' AND b.City = 'Oxford';",
    "table_names": [
      "branch",
      "membership_register_branch"
    ]
  },
  {
    "id": 1712,
    "db_id": "shop_membership",
    "question": "Which members registered in the year 2016 are at level 6?",
    "sql": "SELECT m.Name FROM member m INNER JOIN membership_register_branch r ON m.Member_ID = r.Member_ID WHERE r.Register_Year = '2016' AND m.Level = 6;",
    "table_names": [
      "member",
      "membership_register_branch"
    ]
  },
  {
    "id": 1713,
    "db_id": "shop_membership",
    "question": "How many level 6 members registered at a branch in 2016?",
    "sql": "SELECT COUNT(DISTINCT m.Member_ID) FROM member m JOIN membership_register_branch b ON m.Member_ID = b.Member_ID WHERE m.Level = 6 AND b.Register_Year = '2016';",
    "table_names": [
      "member",
      "membership_register_branch"
    ]
  },
  {
    "id": 1714,
    "db_id": "shop_membership",
    "question": "How many members registered in branches located in London during the year 2016?",
    "sql": "SELECT COUNT(*) FROM membership_register_branch AS mrb JOIN branch AS b ON mrb.Branch_ID = b.Branch_ID WHERE b.City = 'London' AND mrb.Register_Year = '2016';",
    "table_names": [
      "branch",
      "membership_register_branch"
    ]
  },
  {
    "id": 1715,
    "db_id": "shop_membership",
    "question": "Which branches located in London had members who registered in the year 2016?",
    "sql": "SELECT b.Name FROM branch b INNER JOIN membership_register_branch m ON b.Branch_ID = m.Branch_ID WHERE b.City = 'London' AND m.Register_Year = '2016';",
    "table_names": [
      "branch",
      "membership_register_branch"
    ]
  },
  {
    "id": 1716,
    "db_id": "shop_membership",
    "question": "Which branch in London had the highest number of members registering in the year 2016, according to the membership register records?",
    "sql": "SELECT b.Name, COUNT(mrb.Member_ID) AS member_count FROM branch b JOIN membership_register_branch mrb ON b.Branch_ID = mrb.Branch_ID WHERE b.City = 'London' AND mrb.Register_Year = '2016' GROUP BY b.Name ORDER BY member_count DESC LIMIT 1;",
    "table_names": [
      "branch",
      "membership_register_branch"
    ]
  },
  {
    "id": 1717,
    "db_id": "shop_membership",
    "question": "Which branch in Oxford has members registered in the year 2016?",
    "sql": "SELECT b.Name FROM branch b JOIN membership_register_branch mrb ON b.Branch_ID = mrb.Branch_ID WHERE b.City = 'Oxford' AND mrb.Register_Year = '2016';",
    "table_names": [
      "branch",
      "membership_register_branch"
    ]
  },
  {
    "id": 1718,
    "db_id": "shop_membership",
    "question": "How many distinct hometown locations are associated with members who registered in 2016?",
    "sql": "SELECT COUNT(DISTINCT m.Hometown) FROM member m JOIN membership_register_branch r ON m.Member_ID = r.Member_ID WHERE r.Register_Year = '2016';",
    "table_names": [
      "member",
      "membership_register_branch"
    ]
  },
  {
    "id": 1719,
    "db_id": "shop_membership",
    "question": "What are the card numbers of level 6 members who registered in 2016 at either branch 1 or branch 2?",
    "sql": "SELECT m.Card_Number FROM member AS m JOIN membership_register_branch AS mb ON m.Member_ID = mb.Member_ID WHERE mb.Register_Year = '2016' AND m.Level = 6 AND mb.Branch_ID IN ('1', '2') ORDER BY m.Member_ID ASC;",
    "table_names": [
      "member",
      "membership_register_branch"
    ]
  },
  {
    "id": 1720,
    "db_id": "shop_membership",
    "question": "Which branch in London that opened in 2010 or earlier generated the highest total sales?",
    "sql": "SELECT b.Name, SUM(p.Total_pounds) AS total_sales FROM branch b INNER JOIN purchase p ON b.Branch_ID = CAST(p.Branch_ID AS INTEGER) WHERE b.City = 'London' AND b.Open_year <= '2010' GROUP BY b.Name ORDER BY total_sales DESC LIMIT 1;",
    "table_names": [
      "branch",
      "purchase"
    ]
  },
  {
    "id": 1721,
    "db_id": "shop_membership",
    "question": "What is the name of the London branch with the highest total sales amount in the year 2018, and what was its total sales?",
    "sql": "SELECT b.Name, SUM(p.Total_pounds) AS total_sales FROM branch b JOIN purchase p ON b.Branch_ID = CAST(p.Branch_ID AS INTEGER) WHERE b.City = 'London' AND p.Year = '2018' GROUP BY b.Name ORDER BY total_sales DESC LIMIT 1;",
    "table_names": [
      "branch",
      "purchase"
    ]
  },
  {
    "id": 1722,
    "db_id": "shop_membership",
    "question": "Who are the level 6 members who made purchases in branch 5 during the year 2018?",
    "sql": "SELECT m.Name FROM member m INNER JOIN purchase p ON m.Member_ID = p.Member_ID WHERE m.Level = 6 AND p.Branch_ID = '5' AND p.Year = '2018';",
    "table_names": [
      "member",
      "purchase"
    ]
  },
  {
    "id": 1723,
    "db_id": "shop_membership",
    "question": "What is the name of the member who made purchases in Branch 3 in 2018 and has the highest membership level?",
    "sql": "SELECT member.Name FROM member JOIN purchase ON member.Member_ID = purchase.Member_ID WHERE purchase.Year='2018' AND purchase.Branch_ID='3' AND member.Level = (SELECT MAX(Level) FROM member JOIN purchase ON member.Member_ID = purchase.Member_ID WHERE purchase.Year='2018' AND purchase.Branch_ID='3');",
    "table_names": [
      "member",
      "purchase"
    ]
  },
  {
    "id": 1752,
    "db_id": "products_gen_characteristics",
    "question": "What is the total selling price of all seed category products that have the color blue?",
    "sql": "SELECT SUM(CAST(P.typical_selling_price AS FLOAT)) AS total_blue_products_selling_price FROM Products P JOIN Ref_Colors R ON P.color_code = R.color_code WHERE R.color_description = 'blue' AND P.product_category_code = 'Seeds';",
    "table_names": [
      "Ref_Colors",
      "Products"
    ]
  },
  {
    "id": 1753,
    "db_id": "products_gen_characteristics",
    "question": "What is the total typical selling price of all products categorized as 'Seeds' and having the color 'blue'?",
    "sql": "SELECT SUM(CAST(Products.typical_selling_price AS FLOAT)) FROM Products JOIN Ref_Colors ON Products.color_code = Ref_Colors.color_code WHERE Ref_Colors.color_description = 'blue' AND Products.product_category_code = 'Seeds';",
    "table_names": [
      "Ref_Colors",
      "Products"
    ]
  },
  {
    "id": 1754,
    "db_id": "products_gen_characteristics",
    "question": "What is the average typical selling price of products that are categorized as 'Seeds' and have a color described as 'blue'?",
    "sql": "SELECT AVG(p.typical_selling_price) FROM Products p JOIN Ref_Colors rc ON p.color_code = rc.color_code WHERE rc.color_description = 'blue' AND p.product_category_code = 'Seeds' AND p.typical_selling_price <> '';",
    "table_names": [
      "Ref_Colors",
      "Products"
    ]
  },
  {
    "id": 1755,
    "db_id": "products_gen_characteristics",
    "question": "What is the name and color description of the product with the highest selling price?",
    "sql": "SELECT P.product_name, RC.color_description FROM Products P JOIN Ref_Colors RC ON P.color_code = RC.color_code WHERE P.typical_selling_price = (SELECT MAX(typical_selling_price) FROM Products WHERE typical_selling_price <> '')",
    "table_names": [
      "Ref_Colors",
      "Products"
    ]
  },
  {
    "id": 1756,
    "db_id": "products_gen_characteristics",
    "question": "What is the typical selling price for the herb product that has a buying price closest to 25,000?",
    "sql": "SELECT p.typical_selling_price FROM Products p JOIN Ref_Product_Categories rpc ON p.product_category_code = rpc.product_category_code WHERE rpc.product_category_description = 'Herbs' AND p.typical_buying_price != '' ORDER BY ABS(p.typical_buying_price - 25000) ASC LIMIT 1;",
    "table_names": [
      "Ref_Product_Categories",
      "Products"
    ]
  },
  {
    "id": 1757,
    "db_id": "products_gen_characteristics",
    "question": "What are the names, typical selling prices, and units of measure of seed category products that have a typical selling price greater than 100,000?",
    "sql": "SELECT p.product_name, p.typical_selling_price, c.unit_of_measure FROM Products p JOIN Ref_Product_Categories c ON p.product_category_code = c.product_category_code WHERE p.product_category_code = 'Seeds' AND CAST(p.typical_selling_price AS FLOAT) > 100000;",
    "table_names": [
      "Ref_Product_Categories",
      "Products"
    ]
  },
  {
    "id": 1758,
    "db_id": "products_gen_characteristics",
    "question": "What are the names of seed products with a selling price greater than 50000 and color blue?",
    "sql": "SELECT Products.product_name FROM Products INNER JOIN Ref_Colors ON Products.color_code = Ref_Colors.color_code WHERE Ref_Colors.color_description = 'blue' AND Products.product_category_code = 'Seeds' AND Products.typical_selling_price > 50000;",
    "table_names": [
      "Ref_Colors",
      "Products"
    ]
  },
  {
    "id": 1759,
    "db_id": "products_gen_characteristics",
    "question": "What are the names of seed products with a selling price above 50000 and have the color blue?",
    "sql": "SELECT p.product_name FROM Products p JOIN Ref_Colors rc ON p.color_code = rc.color_code WHERE rc.color_description = 'blue' AND p.product_category_code = 'Seeds' AND CAST(p.typical_selling_price AS FLOAT) > 50000",
    "table_names": [
      "Ref_Colors",
      "Products"
    ]
  },
  {
    "id": 1760,
    "db_id": "products_gen_characteristics",
    "question": "What is the average typical selling price of all herb products which have the color red?",
    "sql": "SELECT AVG(CAST(p.typical_selling_price AS FLOAT)) FROM Products p JOIN Ref_Colors c ON p.color_code = c.color_code WHERE c.color_description = 'red' AND p.product_category_code = 'Herbs';",
    "table_names": [
      "Ref_Colors",
      "Products"
    ]
  },
  {
    "id": 1761,
    "db_id": "products_gen_characteristics",
    "question": "How many products belong to the 'Seeds' category and have a color described as 'blue'?",
    "sql": "SELECT COUNT(*) FROM Products p JOIN Ref_Colors rc ON p.color_code = rc.color_code WHERE rc.color_description = 'blue' AND p.product_category_code = 'Seeds';",
    "table_names": [
      "Ref_Colors",
      "Products"
    ]
  },
  {
    "id": 1762,
    "db_id": "products_gen_characteristics",
    "question": "What seeds have a blue color and a typical selling price greater than 60000?",
    "sql": "SELECT p.product_name FROM Products p JOIN Ref_Colors c ON p.color_code = c.color_code WHERE c.color_description = 'blue' AND p.product_category_code = 'Seeds' AND CAST(p.typical_selling_price AS FLOAT) > 60000;",
    "table_names": [
      "Ref_Colors",
      "Products"
    ]
  },
  {
    "id": 1763,
    "db_id": "products_gen_characteristics",
    "question": "What are the names of products in the 'Seeds' category that are blue in color and have a typical selling price greater than 60000?",
    "sql": "SELECT Products.product_name FROM Products JOIN Ref_Colors ON Products.color_code = Ref_Colors.color_code WHERE Ref_Colors.color_description = 'blue' AND Products.product_category_code = 'Seeds' AND Products.typical_selling_price > 60000;",
    "table_names": [
      "Ref_Colors",
      "Products"
    ]
  },
  {
    "id": 1764,
    "db_id": "products_gen_characteristics",
    "question": "What is the name of the most expensive 'Seeds' category product available in a blue color?",
    "sql": "SELECT p.product_name FROM Products p JOIN Ref_Colors rc ON p.color_code = rc.color_code WHERE rc.color_description = 'blue' AND p.product_category_code = 'Seeds' AND p.typical_buying_price != '' ORDER BY CAST(p.typical_buying_price AS FLOAT) DESC LIMIT 1;",
    "table_names": [
      "Ref_Colors",
      "Products"
    ]
  },
  {
    "id": 1765,
    "db_id": "products_gen_characteristics",
    "question": "What is the name of the seed product that is blue and has a typical selling price greater than 50,000?",
    "sql": "SELECT Products.product_name FROM Products INNER JOIN Ref_Colors ON Products.color_code = Ref_Colors.color_code WHERE Ref_Colors.color_description = 'blue' AND Products.product_category_code = 'Seeds' AND Products.typical_selling_price > 50000;",
    "table_names": [
      "Ref_Colors",
      "Products"
    ]
  },
  {
    "id": 1766,
    "db_id": "products_gen_characteristics",
    "question": "Which 'Seeds' category product has the highest selling price among products with a 'high' characteristic value?",
    "sql": "SELECT p.product_name, p.typical_selling_price FROM Products AS p JOIN Product_Characteristics AS pc ON p.product_id = pc.product_id WHERE p.product_category_code = 'Seeds' AND pc.product_characteristic_value = 'high' ORDER BY CAST(p.typical_selling_price AS FLOAT) DESC LIMIT 1;",
    "table_names": [
      "Products",
      "Product_Characteristics"
    ]
  },
  {
    "id": 1767,
    "db_id": "products_gen_characteristics",
    "question": "What is the name of the seed product that has a high rating for characteristic id 15?",
    "sql": "SELECT p.product_name FROM Products p JOIN Product_Characteristics pc ON p.product_id = pc.product_id WHERE pc.product_characteristic_value = 'high' AND pc.characteristic_id = 15 AND p.product_category_code = 'Seeds';",
    "table_names": [
      "Products",
      "Product_Characteristics"
    ]
  },
  {
    "id": 1768,
    "db_id": "products_gen_characteristics",
    "question": "What is the average selling price of products from categories that are measured in units containing 'pound'?",
    "sql": "SELECT AVG(p.typical_selling_price) FROM Products p JOIN Ref_Product_Categories rpc ON p.product_category_code = rpc.product_category_code WHERE rpc.unit_of_measure LIKE '%pound%';",
    "table_names": [
      "Ref_Product_Categories",
      "Products"
    ]
  },
  {
    "id": 1769,
    "db_id": "products_gen_characteristics",
    "question": "What is the average typical selling price of all products whose categories have units of measure including 'pound'?",
    "sql": "SELECT AVG(CAST(typical_selling_price AS FLOAT)) FROM Products WHERE product_category_code IN (SELECT product_category_code FROM Ref_Product_Categories WHERE unit_of_measure LIKE '%pound%');",
    "table_names": [
      "Ref_Product_Categories",
      "Products"
    ]
  },
  {
    "id": 1770,
    "db_id": "products_gen_characteristics",
    "question": "List the name, buying price, and unit of measure of all 'Seeds' category products whose buying price is higher than 1000.",
    "sql": "SELECT product_name, typical_buying_price, unit_of_measure FROM Products INNER JOIN Ref_Product_Categories ON Products.product_category_code = Ref_Product_Categories.product_category_code WHERE Ref_Product_Categories.product_category_description = 'Seeds' AND CAST(typical_buying_price AS FLOAT) > 1000",
    "table_names": [
      "Ref_Product_Categories",
      "Products"
    ]
  },
  {
    "id": 1771,
    "db_id": "products_gen_characteristics",
    "question": "What is the name and selling price of the most expensive product among products measured in pounds?",
    "sql": "SELECT p.product_name, p.typical_selling_price FROM Products p JOIN Ref_Product_Categories rpc ON p.product_category_code = rpc.product_category_code WHERE rpc.unit_of_measure LIKE '%pound%' AND p.typical_selling_price = (SELECT MAX(CAST(typical_selling_price AS FLOAT)) FROM Products WHERE product_category_code IN (SELECT product_category_code FROM Ref_Product_Categories WHERE unit_of_measure LIKE '%pound%'))",
    "table_names": [
      "Ref_Product_Categories",
      "Products"
    ]
  },
  {
    "id": 1772,
    "db_id": "products_gen_characteristics",
    "question": "List the names of all 'Seeds' category products that have the color 'blue' and a typical selling price greater than 1000?",
    "sql": "SELECT p.product_name FROM Products p JOIN Ref_Colors rc ON p.color_code = rc.color_code WHERE rc.color_description = 'blue' AND p.product_category_code = 'Seeds' AND CAST(p.typical_selling_price AS FLOAT) > 1000;",
    "table_names": [
      "Ref_Colors",
      "Products"
    ]
  },
  {
    "id": 1773,
    "db_id": "products_gen_characteristics",
    "question": "What is the average selling price of products in the 'Seeds' category that have the color blue?",
    "sql": "SELECT AVG(CAST(P.typical_selling_price AS REAL)) FROM Products AS P JOIN Ref_Colors AS C ON P.color_code = C.color_code WHERE C.color_description = 'blue' AND P.product_category_code = 'Seeds';",
    "table_names": [
      "Ref_Colors",
      "Products"
    ]
  },
  {
    "id": 1774,
    "db_id": "products_gen_characteristics",
    "question": "What is the name of the product with the highest selling price among all products that have the color description 'red'?",
    "sql": "SELECT product_name FROM Products WHERE typical_selling_price = (SELECT MAX(CAST(typical_selling_price AS FLOAT)) FROM Products WHERE color_code = (SELECT color_code FROM Ref_Colors WHERE color_description = 'red'));",
    "table_names": [
      "Ref_Colors",
      "Products"
    ]
  },
  {
    "id": 1775,
    "db_id": "products_gen_characteristics",
    "question": "What is the product name and typical buying price of the white herb product whose typical selling price exceeds 50000?",
    "sql": "SELECT P.product_name, P.typical_buying_price FROM Products P JOIN Ref_Colors C ON P.color_code = C.color_code WHERE C.color_description = 'white' AND P.product_category_code = 'Herbs' AND P.typical_selling_price > 50000;",
    "table_names": [
      "Ref_Colors",
      "Products"
    ]
  },
  {
    "id": 1776,
    "db_id": "products_gen_characteristics",
    "question": "How many unique products have a characteristic type code of 'Grade' with a characteristic value of 'medium'?",
    "sql": "SELECT COUNT(DISTINCT pc.product_id) FROM Product_Characteristics pc JOIN Characteristics c ON pc.characteristic_id = c.characteristic_id WHERE c.characteristic_type_code = 'Grade' AND pc.product_characteristic_value = 'medium';",
    "table_names": [
      "Characteristics",
      "Product_Characteristics"
    ]
  },
  {
    "id": 1777,
    "db_id": "products_gen_characteristics",
    "question": "Which product has a 'warm' purity characteristic at a 'low' level?",
    "sql": "SELECT pc.product_id FROM Characteristics c JOIN Product_Characteristics pc ON c.characteristic_id = pc.characteristic_id WHERE c.characteristic_type_code = 'Purity' AND c.characteristic_name = 'warm' AND pc.product_characteristic_value = 'low';",
    "table_names": [
      "Characteristics",
      "Product_Characteristics"
    ]
  },
  {
    "id": 1778,
    "db_id": "products_gen_characteristics",
    "question": "What is the total selling price of all 'Seeds' products that are either 'red' or 'blue' in color?",
    "sql": "SELECT SUM(CAST(p.typical_selling_price AS FLOAT)) AS total_selling_price FROM Products p JOIN Ref_Colors rc ON p.color_code = rc.color_code WHERE rc.color_description IN ('red', 'blue') AND p.product_category_code = 'Seeds';",
    "table_names": [
      "Ref_Colors",
      "Products"
    ]
  },
  {
    "id": 1779,
    "db_id": "products_gen_characteristics",
    "question": "How many products in the category 'Seeds' have the color 'blue' and have a selling price greater than 50000?",
    "sql": "SELECT COUNT(*) FROM Products p JOIN Ref_Colors rc ON p.color_code = rc.color_code WHERE rc.color_description = 'blue' AND p.product_category_code = 'Seeds' AND CAST(p.typical_selling_price AS FLOAT) > 50000;",
    "table_names": [
      "Ref_Colors",
      "Products"
    ]
  },
  {
    "id": 1780,
    "db_id": "swimming",
    "question": "Find the name and nationality of swimmers who completed the 100 meters swim in less than 57 seconds and won at least one event.",
    "sql": "SELECT swimmer.name, swimmer.Nationality FROM swimmer JOIN record ON swimmer.ID = record.Swimmer_ID WHERE swimmer.meter_100 < 57 AND record.Result = 'Win';",
    "table_names": [
      "swimmer",
      "record"
    ]
  },
  {
    "id": 1781,
    "db_id": "swimming",
    "question": "Which stadiums in Russia hosted events after the year 2012?",
    "sql": "SELECT stadium.name FROM stadium JOIN event ON stadium.ID = event.Stadium_ID WHERE stadium.Country = 'Russia' AND event.Year > '2012';",
    "table_names": [
      "stadium",
      "event"
    ]
  },
  {
    "id": 1782,
    "db_id": "swimming",
    "question": "Which country hosted the highest number of events according to the provided data?",
    "sql": "SELECT stadium.Country, COUNT(event.ID) AS total_events FROM stadium INNER JOIN event ON stadium.ID = event.Stadium_ID GROUP BY stadium.Country ORDER BY total_events DESC LIMIT 1;",
    "table_names": [
      "stadium",
      "event"
    ]
  },
  {
    "id": 1783,
    "db_id": "swimming",
    "question": "What are the names of stadiums in Russia opened in or before 2007 that hosted events after 2010?",
    "sql": "SELECT stadium.name FROM stadium JOIN event ON stadium.ID = event.Stadium_ID WHERE stadium.Country = 'Russia' AND stadium.Opening_year <= 2007 AND event.Year > '2010';",
    "table_names": [
      "stadium",
      "event"
    ]
  },
  {
    "id": 1784,
    "db_id": "swimming",
    "question": "What are the names and nationalities of swimmers who won event 3 and whose 700-meter split time was less than 6:52.00?",
    "sql": "SELECT swimmer.name, swimmer.Nationality FROM swimmer INNER JOIN record ON swimmer.ID = record.Swimmer_ID WHERE record.Event_ID = 3 AND record.Result = 'Win' AND swimmer.meter_700 < '6:52.00';",
    "table_names": [
      "swimmer",
      "record"
    ]
  },
  {
    "id": 1785,
    "db_id": "swimming",
    "question": "What are the names of Australian swimmers who won in event 1?",
    "sql": "SELECT swimmer.name FROM swimmer JOIN record ON swimmer.ID = record.Swimmer_ID WHERE swimmer.Nationality = 'Australia' AND record.Result = 'Win' AND record.Event_ID = 1;",
    "table_names": [
      "swimmer",
      "record"
    ]
  },
  {
    "id": 1786,
    "db_id": "swimming",
    "question": "Which swimmers won Event 3 and achieved a 400-meter time faster than 3 minutes and 56 seconds, and what is their nationality?",
    "sql": "SELECT swimmer.name, swimmer.Nationality FROM swimmer JOIN record ON swimmer.ID = record.Swimmer_ID WHERE record.Event_ID = 3 AND record.Result = 'Win' AND swimmer.meter_400 < '3:56.00';",
    "table_names": [
      "swimmer",
      "record"
    ]
  },
  {
    "id": 1787,
    "db_id": "swimming",
    "question": "Which swimmer won event 3 and completed the first 400 meters faster than 3 minutes and 54 seconds?",
    "sql": "SELECT swimmer.name, swimmer.Nationality FROM swimmer JOIN record ON swimmer.ID = record.Swimmer_ID WHERE record.Result = 'Win' AND record.Event_ID = 3 AND swimmer.meter_400 < '3:54.00';",
    "table_names": [
      "swimmer",
      "record"
    ]
  },
  {
    "id": 1788,
    "db_id": "swimming",
    "question": "Which swimmers recorded a time under 57 seconds at the 100-meter mark and achieved a win in event 3? Provide the swimmers' names along with their nationalities.",
    "sql": "SELECT swimmer.name, swimmer.Nationality FROM swimmer INNER JOIN record ON swimmer.ID = record.Swimmer_ID WHERE swimmer.meter_100 < 57.00 AND record.Result = 'Win' AND record.Event_ID = 3;",
    "table_names": [
      "swimmer",
      "record"
    ]
  },
  {
    "id": 1789,
    "db_id": "railway",
    "question": "Who built the railway associated with the train 'Nandigram Exp'?",
    "sql": "SELECT railway.Builder FROM railway JOIN train ON railway.Railway_ID = train.Railway_ID WHERE train.Name = 'Nandigram Exp'",
    "table_names": [
      "railway",
      "train"
    ]
  },
  {
    "id": 1790,
    "db_id": "railway",
    "question": "Who built the railway located in Shildon that is associated with the 'Andaman Exp' train?",
    "sql": "SELECT railway.Builder FROM railway INNER JOIN train ON railway.Railway_ID = train.Railway_ID WHERE train.Name = 'Andaman Exp' AND railway.Location = 'Shildon';",
    "table_names": [
      "railway",
      "train"
    ]
  },
  {
    "id": 1791,
    "db_id": "railway",
    "question": "Where is the railway located that was built by Stephenson and operates a train named 'Andaman Exp'?",
    "sql": "SELECT railway.Location FROM railway INNER JOIN train ON railway.Railway_ID = train.Railway_ID WHERE train.Name='Andaman Exp' AND railway.Builder='Stephenson';",
    "table_names": [
      "railway",
      "train"
    ]
  },
  {
    "id": 1792,
    "db_id": "railway",
    "question": "What is the current location of the railway built in 1905 that operates the 'Andaman Exp' train?",
    "sql": "SELECT railway.Location FROM railway JOIN train ON railway.Railway_ID = train.Railway_ID WHERE train.Name='Andaman Exp' AND railway.Built = '1905';",
    "table_names": [
      "railway",
      "train"
    ]
  },
  {
    "id": 1793,
    "db_id": "railway",
    "question": "What is the railway name and builder of the railway used by the 'Andaman Exp' train that has a wheel arrangement of '2-8-0'?",
    "sql": "SELECT railway.Railway, railway.Builder FROM railway INNER JOIN train ON railway.Railway_ID = train.Railway_ID WHERE train.Name = 'Andaman Exp' AND railway.Wheels = '2-8-0';",
    "table_names": [
      "railway",
      "train"
    ]
  },
  {
    "id": 1795,
    "db_id": "customers_and_addresses",
    "question": "What are the names and email addresses of customers who have completed orders before 1980?",
    "sql": "SELECT customer_name, customer_email FROM Customers WHERE customer_id IN (SELECT customer_id FROM Customer_Orders WHERE order_status_code = 'Completed' AND order_date < '1980-01-01');",
    "table_names": [
      "Customers",
      "Customer_Orders"
    ]
  },
  {
    "id": 1796,
    "db_id": "customers_and_addresses",
    "question": "List the names and emails of customers who have placed orders after January 1, 2000, and whose orders have a status of 'Completed'.",
    "sql": "SELECT customer_name, customer_email FROM Customers WHERE customer_id IN (SELECT customer_id FROM Customer_Orders WHERE order_status_code = 'Completed' AND order_date > '2000-01-01');",
    "table_names": [
      "Customers",
      "Customer_Orders"
    ]
  },
  {
    "id": 1797,
    "db_id": "tracking_orders",
    "question": "What is the total order value for all Gucci clothes ordered?",
    "sql": "SELECT SUM(p.product_price * CAST(oi.order_quantity AS INTEGER)) AS total_value FROM Products p JOIN Order_Items oi ON p.product_id = oi.product_id WHERE p.product_type_code = 'Clothes' AND p.product_name = 'gucci';",
    "table_names": [
      "Products",
      "Order_Items"
    ]
  },
  {
    "id": 1798,
    "db_id": "customers_and_addresses",
    "question": "What are the names and email addresses of customers who have completed more than one order?",
    "sql": "SELECT customer_name, customer_email FROM Customers WHERE customer_id IN (SELECT customer_id FROM Customer_Orders WHERE order_status_code = 'Completed' GROUP BY customer_id HAVING COUNT(order_id) > 1)",
    "table_names": [
      "Customers",
      "Customer_Orders"
    ]
  },
  {
    "id": 1803,
    "db_id": "customer_complaints",
    "question": "How many 'Open' and 'New' complaints are there for each 'Food' category product?",
    "sql": "SELECT p.product_name, COUNT(c.complaint_id) AS total_complaints FROM Products p JOIN Complaints c ON p.product_id = c.product_id WHERE p.product_category_code = 'Food' AND c.complaint_status_code IN ('Open', 'New') GROUP BY p.product_name;",
    "table_names": [
      "Products",
      "Complaints"
    ]
  },
  {
    "id": 1804,
    "db_id": "customer_complaints",
    "question": "Which product currently has the highest number of open complaints?",
    "sql": "SELECT product_name, COUNT(Complaints.complaint_id) AS Number_of_Complaints FROM Products JOIN Complaints ON Products.product_id = Complaints.product_id WHERE complaint_status_code = 'Open' GROUP BY product_name ORDER BY Number_of_Complaints DESC LIMIT 1;",
    "table_names": [
      "Products",
      "Complaints"
    ]
  },
  {
    "id": 1805,
    "db_id": "customer_complaints",
    "question": "Which customer IDs are from Tennessee, have a 'Good Credit Rating', and have open complaints?",
    "sql": "SELECT c.customer_id FROM Customers c JOIN Complaints cp ON c.customer_id = cp.customer_id WHERE cp.complaint_status_code = 'Open' AND c.customer_type_code = 'Good Credit Rating' AND c.state = 'Tennessee';",
    "table_names": [
      "Customers",
      "Complaints"
    ]
  },
  {
    "id": 1806,
    "db_id": "customer_complaints",
    "question": "How many open complaints were raised by customers residing in Tennessee?",
    "sql": "SELECT COUNT(*) FROM Complaints AS comp INNER JOIN Customers AS cust ON comp.customer_id = cust.customer_id WHERE cust.state = 'Tennessee' AND comp.complaint_status_code = 'Open';",
    "table_names": [
      "Customers",
      "Complaints"
    ]
  },
  {
    "id": 1807,
    "db_id": "customer_complaints",
    "question": "How many complaints do customers from Tennessee have individually?",
    "sql": "SELECT c.customer_id, COUNT(cp.complaint_id) AS total_complaints FROM Customers c INNER JOIN Complaints cp ON c.customer_id = cp.customer_id WHERE c.state = 'Tennessee' GROUP BY c.customer_id;",
    "table_names": [
      "Customers",
      "Complaints"
    ]
  },
  {
    "id": 1808,
    "db_id": "customer_complaints",
    "question": "How many 'Open' complaints have been raised by customers located in Tennessee?",
    "sql": "SELECT COUNT(*) FROM Customers c JOIN Complaints co ON c.customer_id = co.customer_id WHERE c.state = 'Tennessee' AND co.complaint_status_code = 'Open';",
    "table_names": [
      "Customers",
      "Complaints"
    ]
  },
  {
    "id": 1809,
    "db_id": "customer_complaints",
    "question": "Among customers with a good credit rating, which customer from which city has raised the highest number of complaints that are still open or new?",
    "sql": "SELECT Customers.customer_id, Customers.town_city, COUNT(Complaints.complaint_id) as complaint_count FROM Customers JOIN Complaints ON Customers.customer_id = Complaints.customer_id WHERE Customers.customer_type_code = 'Good Credit Rating' AND Complaints.complaint_status_code IN ('Open', 'New') GROUP BY Customers.customer_id ORDER BY complaint_count DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Complaints"
    ]
  },
  {
    "id": 1810,
    "db_id": "customer_complaints",
    "question": "How many open complaints are there from customers located in Tennessee?",
    "sql": "SELECT COUNT(*) FROM Complaints c JOIN Customers cu ON c.customer_id = cu.customer_id WHERE cu.state = 'Tennessee' AND c.complaint_status_code = 'Open';",
    "table_names": [
      "Customers",
      "Complaints"
    ]
  },
  {
    "id": 1811,
    "db_id": "customer_complaints",
    "question": "What is the full name and customer type code of the staff member who has the same ID as a customer with a good credit rating living in Tennessee?",
    "sql": "SELECT s.first_name, s.last_name, c.customer_type_code, c.state FROM Staff s JOIN Customers c ON s.staff_id = c.customer_id WHERE c.state = 'Tennessee' AND c.customer_type_code = 'Good Credit Rating';",
    "table_names": [
      "Staff",
      "Customers"
    ]
  },
  {
    "id": 1812,
    "db_id": "customer_complaints",
    "question": "What are the full names of staff members who have matching customer IDs with customers who default on payments, and in which states are these customers located?",
    "sql": "SELECT Staff.first_name, Staff.last_name, Customers.state FROM Staff INNER JOIN Customers ON Staff.staff_id = Customers.customer_id WHERE Customers.customer_type_code = 'Defaults on payments';",
    "table_names": [
      "Staff",
      "Customers"
    ]
  },
  {
    "id": 1813,
    "db_id": "customer_complaints",
    "question": "What is the full name and email address of the staff member handling the complaint raised by customer_id 118 about a product failure issue?",
    "sql": "SELECT first_name, last_name, email_address FROM Staff WHERE staff_id = (SELECT staff_id FROM Complaints WHERE customer_id = 118 AND complaint_type_code = 'Product Failure');",
    "table_names": [
      "Staff",
      "Complaints"
    ]
  },
  {
    "id": 1814,
    "db_id": "customer_complaints",
    "question": "Which staff member has handled the highest number of open complaints, and how many open complaints have they managed?",
    "sql": "SELECT Staff.first_name, Staff.last_name, COUNT(Complaints.complaint_id) AS num_complaints FROM Staff JOIN Complaints ON Staff.staff_id = Complaints.staff_id WHERE Complaints.complaint_status_code = 'Open' GROUP BY Staff.staff_id ORDER BY num_complaints DESC LIMIT 1;",
    "table_names": [
      "Staff",
      "Complaints"
    ]
  },
  {
    "id": 1815,
    "db_id": "customer_complaints",
    "question": "What is the name of the staff member handling an open complaint which had an outcome code 'OK' and a complaint type of 'Product Failure'?",
    "sql": "SELECT s.first_name, s.last_name FROM Staff s JOIN Complaints c ON s.staff_id = c.staff_id WHERE c.complaint_outcome_code = 'OK' AND c.complaint_status_code = 'Open' AND c.complaint_type_code = 'Product Failure';",
    "table_names": [
      "Staff",
      "Complaints"
    ]
  },
  {
    "id": 1816,
    "db_id": "customer_complaints",
    "question": "Which staff member handled the highest number of complaints that are currently in the 'Open' status, and how many did they handle?",
    "sql": "SELECT Staff.first_name, Staff.last_name, COUNT(Complaints.complaint_id) AS complaint_count FROM Staff JOIN Complaints ON Staff.staff_id = Complaints.staff_id WHERE Complaints.complaint_status_code = 'Open' GROUP BY Staff.staff_id ORDER BY complaint_count DESC LIMIT 1;",
    "table_names": [
      "Staff",
      "Complaints"
    ]
  },
  {
    "id": 1817,
    "db_id": "workshop_paper",
    "question": "Who is the author of the highest scoring submission that has been accepted?",
    "sql": "SELECT s.Author FROM submission s JOIN Acceptance a ON s.Submission_ID = a.Submission_ID WHERE a.Result = 'Accepted' ORDER BY s.Scores DESC LIMIT 1;",
    "table_names": [
      "submission",
      "Acceptance"
    ]
  },
  {
    "id": 1818,
    "db_id": "workshop_paper",
    "question": "Who is the highest scoring author whose submission was rejected at workshop 6?",
    "sql": "SELECT submission.Author, submission.Scores FROM submission JOIN Acceptance ON submission.Submission_ID = Acceptance.Submission_ID WHERE Acceptance.Workshop_ID = 6 AND Acceptance.Result = 'Rejected' ORDER BY submission.Scores DESC LIMIT 1;",
    "table_names": [
      "submission",
      "Acceptance"
    ]
  },
  {
    "id": 1819,
    "db_id": "workshop_paper",
    "question": "Who is the author and what is the college of the highest scoring submission that was accepted?",
    "sql": "SELECT submission.Author, submission.College FROM submission INNER JOIN Acceptance ON submission.Submission_ID = Acceptance.Submission_ID WHERE Acceptance.Result = 'Accepted' ORDER BY submission.Scores DESC LIMIT 1;",
    "table_names": [
      "submission",
      "Acceptance"
    ]
  },
  {
    "id": 1820,
    "db_id": "workshop_paper",
    "question": "Who is the author of the accepted submission having the highest score?",
    "sql": "SELECT submission.Author FROM submission JOIN Acceptance ON submission.Submission_ID = Acceptance.Submission_ID WHERE Acceptance.Result = 'Accepted' ORDER BY submission.Scores DESC LIMIT 1;",
    "table_names": [
      "submission",
      "Acceptance"
    ]
  },
  {
    "id": 1821,
    "db_id": "workshop_paper",
    "question": "List the authors and their respective colleges who had submissions rejected but had a score greater than 80.",
    "sql": "SELECT submission.Author, submission.College FROM submission JOIN Acceptance ON submission.Submission_ID = Acceptance.Submission_ID WHERE Acceptance.Result = 'Rejected' AND submission.Scores > 80;",
    "table_names": [
      "submission",
      "Acceptance"
    ]
  },
  {
    "id": 1822,
    "db_id": "workshop_paper",
    "question": "Who are the authors and their scores for submissions rejected by Workshop ID 6?",
    "sql": "SELECT submission.Author, submission.Scores FROM submission JOIN Acceptance ON submission.Submission_ID = Acceptance.Submission_ID WHERE Acceptance.Result = 'Rejected' AND Acceptance.Workshop_ID = 6;",
    "table_names": [
      "submission",
      "Acceptance"
    ]
  },
  {
    "id": 1823,
    "db_id": "workshop_paper",
    "question": "Which author(s) submitted papers with scores above 75 that were accepted?",
    "sql": "SELECT s.Author FROM submission s JOIN Acceptance a ON s.Submission_ID = a.Submission_ID WHERE a.Result = 'Accepted' AND s.Scores > 75;",
    "table_names": [
      "submission",
      "Acceptance"
    ]
  },
  {
    "id": 1824,
    "db_id": "workshop_paper",
    "question": "What is the college of the highest scoring author whose submission was accepted?",
    "sql": "SELECT College FROM submission WHERE Submission_ID IN (SELECT Submission_ID FROM Acceptance WHERE Result = 'Accepted') ORDER BY Scores DESC LIMIT 1;",
    "table_names": [
      "submission",
      "Acceptance"
    ]
  },
  {
    "id": 1825,
    "db_id": "workshop_paper",
    "question": "List authors and their colleges for submissions that have scores above 80 but have been rejected at workshops.",
    "sql": "SELECT DISTINCT submission.Author, submission.College FROM submission JOIN Acceptance ON submission.Submission_ID = Acceptance.Submission_ID WHERE Acceptance.Result = 'Rejected' AND submission.Scores > 80;",
    "table_names": [
      "submission",
      "Acceptance"
    ]
  },
  {
    "id": 1826,
    "db_id": "workshop_paper",
    "question": "Who is the author of the highest scoring submission that was accepted?",
    "sql": "SELECT submission.Author FROM submission INNER JOIN Acceptance ON submission.Submission_ID = Acceptance.Submission_ID WHERE Acceptance.Result = 'Accepted' ORDER BY submission.Scores DESC LIMIT 1;",
    "table_names": [
      "submission",
      "Acceptance"
    ]
  },
  {
    "id": 1827,
    "db_id": "tracking_share_transactions",
    "question": "What is the total amount of transaction for all Purchase (PUR) transactions made by investor 19?",
    "sql": "SELECT SUM(amount_of_transaction) FROM Transactions JOIN Ref_Transaction_Types ON Transactions.transaction_type_code = Ref_Transaction_Types.transaction_type_code WHERE transaction_type_description = 'Purchase' AND investor_id = 19;",
    "table_names": [
      "Ref_Transaction_Types",
      "Transactions"
    ]
  },
  {
    "id": 1830,
    "db_id": "tracking_share_transactions",
    "question": "What is the total transaction amount for all purchase transactions that have purchase details marked as 'a'?",
    "sql": "SELECT SUM(T.amount_of_transaction) FROM Transactions T JOIN Purchases P ON T.transaction_id = P.purchase_transaction_id WHERE P.purchase_details = 'a' AND T.transaction_type_code = 'PUR';",
    "table_names": [
      "Transactions",
      "Purchases"
    ]
  },
  {
    "id": 1831,
    "db_id": "tracking_share_transactions",
    "question": "What is the total amount of transactions for sales that have sales_details listed as either 'x' or 'p' in the Sales table?",
    "sql": "SELECT SUM(amount_of_transaction) FROM Transactions WHERE transaction_type_code='SALE' AND transaction_id IN (SELECT sales_transaction_id FROM Sales WHERE sales_details IN ('x', 'p'))",
    "table_names": [
      "Transactions",
      "Sales"
    ]
  },
  {
    "id": 1832,
    "db_id": "tracking_share_transactions",
    "question": "List the transaction IDs and dates of all SALE transactions that are linked to lot_id 14 according to the Transactions_Lots table.",
    "sql": "SELECT t.transaction_id, t.date_of_transaction FROM Transactions AS t JOIN Transactions_Lots AS tl ON t.transaction_id = tl.transaction_id WHERE tl.lot_id = 14 AND t.transaction_type_code = 'SALE';",
    "table_names": [
      "Transactions",
      "Transactions_Lots"
    ]
  },
  {
    "id": 1833,
    "db_id": "tracking_share_transactions",
    "question": "What is the total sale amount for all transactions associated with lot ID 1?",
    "sql": "SELECT SUM(t.amount_of_transaction) FROM Transactions t JOIN Transactions_Lots tl ON t.transaction_id = tl.transaction_id WHERE tl.lot_id = 1 AND t.transaction_type_code = 'SALE';",
    "table_names": [
      "Transactions",
      "Transactions_Lots"
    ]
  },
  {
    "id": 1834,
    "db_id": "tracking_share_transactions",
    "question": "What is the total amount spent on purchase transactions by investor with investor_id 19?",
    "sql": "SELECT SUM(t.amount_of_transaction) FROM Transactions t JOIN Ref_Transaction_Types r ON t.transaction_type_code = r.transaction_type_code WHERE t.investor_id = 19 AND r.transaction_type_description = 'Purchase';",
    "table_names": [
      "Ref_Transaction_Types",
      "Transactions"
    ]
  },
  {
    "id": 1839,
    "db_id": "tracking_share_transactions",
    "question": "What is the number of distinct transaction details appearing in both sales and purchases transactions, considering only sales transaction IDs from 5 to 15 and purchase transaction IDs from 3 to 15?",
    "sql": "SELECT COUNT(DISTINCT s.sales_details) FROM Sales s INNER JOIN Purchases p ON s.sales_details = p.purchase_details WHERE s.sales_transaction_id BETWEEN 5 AND 15 AND p.purchase_transaction_id BETWEEN 3 AND 15;",
    "table_names": [
      "Sales",
      "Purchases"
    ]
  },
  {
    "id": 1840,
    "db_id": "tracking_share_transactions",
    "question": "How many unique investors are associated with transaction ID 3 based on the lots they own?",
    "sql": "SELECT COUNT(DISTINCT l.investor_id) FROM Lots l JOIN Transactions_Lots t ON l.lot_id = t.lot_id WHERE t.transaction_id = 3;",
    "table_names": [
      "Lots",
      "Transactions_Lots"
    ]
  },
  {
    "id": 1843,
    "db_id": "cre_Theme_park",
    "question": "List the names and museum details of tourist attractions that can be reached by bus and have an entry in the Museums table.",
    "sql": "SELECT T.Name, M.Museum_Details FROM Tourist_Attractions T INNER JOIN Museums M ON T.Tourist_Attraction_ID = M.Museum_ID WHERE T.How_to_Get_There = 'bus';",
    "table_names": [
      "Tourist_Attractions",
      "Museums"
    ]
  },
  {
    "id": 1844,
    "db_id": "cre_Theme_park",
    "question": "What are the names of tourist attractions accessible by shuttle and their corresponding museum details?",
    "sql": "SELECT TA.Name, M.Museum_Details FROM Tourist_Attractions TA JOIN Museums M ON TA.Tourist_Attraction_ID = M.Museum_ID WHERE TA.How_to_Get_There = 'shuttle';",
    "table_names": [
      "Tourist_Attractions",
      "Museums"
    ]
  },
  {
    "id": 1845,
    "db_id": "cre_Theme_park",
    "question": "What are the names of photos associated with tourist attractions of type code '5' that can be reached by bus?",
    "sql": "SELECT p.Name FROM Tourist_Attractions t JOIN Photos p ON t.Tourist_Attraction_ID = p.Tourist_Attraction_ID WHERE t.Attraction_Type_Code = '5' AND t.How_to_Get_There = 'bus';",
    "table_names": [
      "Tourist_Attractions",
      "Photos"
    ]
  },
  {
    "id": 1846,
    "db_id": "cre_Theme_park",
    "question": "How many photos are associated with tourist attractions categorized as type code '5' and accessible by bus?",
    "sql": "SELECT COUNT(p.Photo_ID) FROM Tourist_Attractions AS t INNER JOIN Photos AS p ON t.Tourist_Attraction_ID = p.Tourist_Attraction_ID WHERE t.Attraction_Type_Code = '5' AND t.How_to_Get_There = 'bus';",
    "table_names": [
      "Tourist_Attractions",
      "Photos"
    ]
  },
  {
    "id": 1847,
    "db_id": "cre_Theme_park",
    "question": "How many photos exist that are associated with tourist attractions that have an attraction type code of '5' and are reachable by bus?",
    "sql": "SELECT COUNT(P.Photo_ID) FROM Photos P JOIN Tourist_Attractions T ON P.Tourist_Attraction_ID = T.Tourist_Attraction_ID WHERE T.Attraction_Type_Code = '5' AND T.How_to_Get_There = 'bus';",
    "table_names": [
      "Tourist_Attractions",
      "Photos"
    ]
  },
  {
    "id": 1848,
    "db_id": "cre_Theme_park",
    "question": "What are the names of photos associated with tourist attractions that have an attraction type code of '2' and can be reached by bus?",
    "sql": "SELECT p.Name FROM Photos p JOIN Tourist_Attractions t ON p.Tourist_Attraction_ID = t.Tourist_Attraction_ID WHERE t.How_to_Get_There = 'bus' AND t.Attraction_Type_Code = '2';",
    "table_names": [
      "Tourist_Attractions",
      "Photos"
    ]
  },
  {
    "id": 1849,
    "db_id": "cre_Theme_park",
    "question": "What are the names of the tourist attractions that are accessible by bus and are also listed in the Royal_Family table?",
    "sql": "SELECT TA.Name FROM Tourist_Attractions TA INNER JOIN Royal_Family RF ON TA.Tourist_Attraction_ID = RF.Royal_Family_ID WHERE TA.How_to_Get_There = 'bus';",
    "table_names": [
      "Tourist_Attractions",
      "Royal_Family"
    ]
  },
  {
    "id": 1850,
    "db_id": "cre_Theme_park",
    "question": "What tourist attractions accessible by bus have connections with the royal family?",
    "sql": "SELECT ta.Name FROM Tourist_Attractions ta JOIN Royal_Family rf ON ta.Tourist_Attraction_ID = rf.Royal_Family_ID WHERE ta.How_to_Get_There='bus'",
    "table_names": [
      "Tourist_Attractions",
      "Royal_Family"
    ]
  },
  {
    "id": 1851,
    "db_id": "cre_Theme_park",
    "question": "What are the names of tourist attractions accessible by shuttle in location 868 and what type of shops are available there?",
    "sql": "SELECT T.Name, S.Shop_Details FROM Tourist_Attractions T JOIN Shops S ON T.Tourist_Attraction_ID = S.Shop_ID WHERE T.Location_ID = 868 AND T.How_to_Get_There = 'shuttle';",
    "table_names": [
      "Tourist_Attractions",
      "Shops"
    ]
  },
  {
    "id": 1852,
    "db_id": "cre_Theme_park",
    "question": "What are the tourist attractions accessible by shuttle and the details of their associated shops?",
    "sql": "SELECT ta.Name, s.Shop_Details FROM Tourist_Attractions ta JOIN Shops s ON ta.Tourist_Attraction_ID = s.Shop_ID WHERE ta.How_to_Get_There = 'shuttle';",
    "table_names": [
      "Tourist_Attractions",
      "Shops"
    ]
  },
  {
    "id": 1855,
    "db_id": "cre_Theme_park",
    "question": "List the names and market details of tourist attractions that are accessible by bus and are also listed in the street markets table.",
    "sql": "SELECT ta.Name, sm.Market_Details FROM Tourist_Attractions ta INNER JOIN Street_Markets sm ON ta.Tourist_Attraction_ID = sm.Market_ID WHERE ta.How_to_Get_There = 'bus';",
    "table_names": [
      "Tourist_Attractions",
      "Street_Markets"
    ]
  },
  {
    "id": 1856,
    "db_id": "cre_Theme_park",
    "question": "What are the names of the street markets corresponding to type code '5' tourist attractions, which can be reached by bus?",
    "sql": "SELECT sm.Market_Details FROM Street_Markets sm, Tourist_Attractions ta WHERE sm.Market_ID = ta.Tourist_Attraction_ID AND ta.How_to_Get_There = 'bus' AND ta.Attraction_Type_Code = '5';",
    "table_names": [
      "Tourist_Attractions",
      "Street_Markets"
    ]
  },
  {
    "id": 1859,
    "db_id": "cre_Theme_park",
    "question": "Which tourist attractions are museums that can be reached by walking?",
    "sql": "SELECT TA.Name FROM Tourist_Attractions TA JOIN Ref_Attraction_Types RAT ON TA.Attraction_Type_Code = RAT.Attraction_Type_Code WHERE RAT.Attraction_Type_Description = 'museum' AND TA.How_to_Get_There = 'walk';",
    "table_names": [
      "Ref_Attraction_Types",
      "Tourist_Attractions"
    ]
  },
  {
    "id": 1860,
    "db_id": "cre_Theme_park",
    "question": "How many tourist attractions classified as a gallery can be reached by bus?",
    "sql": "SELECT COUNT(*) FROM Tourist_Attractions ta JOIN Ref_Attraction_Types rat ON ta.Attraction_Type_Code = rat.Attraction_Type_Code WHERE rat.Attraction_Type_Description = 'gallery' AND ta.How_to_Get_There = 'bus';",
    "table_names": [
      "Ref_Attraction_Types",
      "Tourist_Attractions"
    ]
  },
  {
    "id": 1867,
    "db_id": "cre_Theme_park",
    "question": "What are the names of tourist attractions accessible by bus located at 'African Adventure'?",
    "sql": "SELECT Tourist_Attractions.Name FROM Tourist_Attractions JOIN Locations ON Tourist_Attractions.Location_ID = Locations.Location_ID WHERE Locations.Location_Name = 'African Adventure' AND Tourist_Attractions.How_to_Get_There = 'bus';",
    "table_names": [
      "Locations",
      "Tourist_Attractions"
    ]
  },
  {
    "id": 1868,
    "db_id": "cre_Theme_park",
    "question": "What are the tourist attractions that can be reached by bus located at the location named 'African Adventure'?",
    "sql": "SELECT ta.Name FROM Tourist_Attractions ta JOIN Locations l ON ta.Location_ID = l.Location_ID WHERE l.Location_Name = 'African Adventure' AND ta.How_to_Get_There = 'bus';",
    "table_names": [
      "Locations",
      "Tourist_Attractions"
    ]
  },
  {
    "id": 1869,
    "db_id": "cre_Theme_park",
    "question": "What is the address of the location housing the tourist attraction named 'haunted mansion'?",
    "sql": "SELECT L.Address FROM Locations L JOIN Tourist_Attractions T ON L.Location_ID = T.Location_ID WHERE T.Name = 'haunted mansion';",
    "table_names": [
      "Locations",
      "Tourist_Attractions"
    ]
  },
  {
    "id": 1870,
    "db_id": "cre_Theme_park",
    "question": "What are the names of locations that have tourist attractions of type '5' accessible by shuttle?",
    "sql": "SELECT l.Location_Name FROM Locations l JOIN Tourist_Attractions ta ON l.Location_ID = ta.Location_ID WHERE ta.How_to_Get_There = 'shuttle' AND ta.Attraction_Type_Code = '5';",
    "table_names": [
      "Locations",
      "Tourist_Attractions"
    ]
  },
  {
    "id": 1891,
    "db_id": "game_1",
    "question": "What is the total number of gaming hours played by students who are on a sports scholarship?",
    "sql": "SELECT SUM(p.Hours_Played) FROM Plays_Games p JOIN SportsInfo s ON p.StuID = s.StuID WHERE s.OnScholarship = 'Y';",
    "table_names": [
      "Plays_Games",
      "SportsInfo"
    ]
  },
  {
    "id": 1892,
    "db_id": "game_1",
    "question": "Which sport practiced by scholarship students has the highest average hours played in video games?",
    "sql": "SELECT SI.SportName, AVG(PG.Hours_Played) AS avg_hours_played FROM SportsInfo SI JOIN Plays_Games PG ON SI.StuID = PG.StuID WHERE SI.OnScholarship = 'Y' GROUP BY SI.SportName ORDER BY avg_hours_played DESC LIMIT 1;",
    "table_names": [
      "Plays_Games",
      "SportsInfo"
    ]
  },
  {
    "id": 1893,
    "db_id": "game_1",
    "question": "What is the game genre that student 1032 spent the most hours playing?",
    "sql": "SELECT VG.GType FROM Video_Games VG JOIN Plays_Games PG ON VG.GameID = PG.GameID WHERE PG.StuID = 1032 ORDER BY PG.Hours_Played DESC LIMIT 1;",
    "table_names": [
      "Video_Games",
      "Plays_Games"
    ]
  },
  {
    "id": 1894,
    "db_id": "game_1",
    "question": "What is the name of the game that student ID 1032 has spent the most time playing?",
    "sql": "SELECT VG.GName FROM Video_Games VG JOIN Plays_Games PG ON VG.GameID = PG.GameID WHERE PG.StuID = 1032 AND PG.Hours_Played = (SELECT MAX(Hours_Played) FROM Plays_Games WHERE StuID = 1032);",
    "table_names": [
      "Video_Games",
      "Plays_Games"
    ]
  },
  {
    "id": 1895,
    "db_id": "game_1",
    "question": "What is the game type of the game that student 1008 spent the most hours playing?",
    "sql": "SELECT VG.GType FROM Video_Games VG JOIN Plays_Games PG ON VG.GameID = PG.GameID WHERE PG.StuID = 1008 AND PG.GameID = (SELECT GameID FROM Plays_Games WHERE StuID = 1008 ORDER BY Hours_Played DESC LIMIT 1);",
    "table_names": [
      "Video_Games",
      "Plays_Games"
    ]
  },
  {
    "id": 1896,
    "db_id": "game_1",
    "question": "What type of game has the highest average hours played by students?",
    "sql": "SELECT GType FROM Video_Games WHERE GameID IN (SELECT GameID FROM Plays_Games GROUP BY GameID ORDER BY AVG(Hours_Played) DESC LIMIT 1)",
    "table_names": [
      "Video_Games",
      "Plays_Games"
    ]
  },
  {
    "id": 1905,
    "db_id": "customers_and_addresses",
    "question": "What are the names of customers who used 'Credit Card' as their payment method and have at least one cancelled order?",
    "sql": "SELECT DISTINCT c.customer_name FROM Customers c JOIN Customer_Orders o ON c.customer_id = o.customer_id WHERE c.payment_method = 'Credit Card' AND o.order_status = 'Cancelled';",
    "table_names": [
      "Customers",
      "Customer_Orders"
    ]
  },
  {
    "id": 1906,
    "db_id": "customers_and_addresses",
    "question": "How many distinct customers who use the payment method 'Credit Card' have orders with the status 'Cancelled'?",
    "sql": "SELECT COUNT(DISTINCT co.customer_id) FROM Customers c JOIN Customer_Orders co ON c.customer_id = co.customer_id WHERE c.payment_method = 'Credit Card' AND co.order_status = 'Cancelled';",
    "table_names": [
      "Customers",
      "Customer_Orders"
    ]
  },
  {
    "id": 1907,
    "db_id": "customers_and_addresses",
    "question": "Which product has the highest total ordered quantity considering only cancelled orders?",
    "sql": "SELECT oi.product_id, SUM(CAST(oi.order_quantity AS INTEGER)) AS total_quantity FROM Customer_Orders co JOIN Order_Items oi ON co.order_id = oi.order_id WHERE co.order_status = 'Cancelled' GROUP BY oi.product_id ORDER BY total_quantity DESC LIMIT 1;",
    "table_names": [
      "Customer_Orders",
      "Order_Items"
    ]
  },
  {
    "id": 1908,
    "db_id": "customers_and_addresses",
    "question": "What is the total quantity ordered of product 2 for all orders that have been delivered?",
    "sql": "SELECT SUM(CAST(oi.order_quantity AS INT)) FROM Customer_Orders co JOIN Order_Items oi ON co.order_id = oi.order_id WHERE co.order_status = 'Delivered' AND oi.product_id = 2;",
    "table_names": [
      "Customer_Orders",
      "Order_Items"
    ]
  },
  {
    "id": 1909,
    "db_id": "customers_and_addresses",
    "question": "How many unique customers canceled orders that included product_id 2?",
    "sql": "SELECT COUNT(DISTINCT co.customer_id) FROM Customer_Orders co JOIN Order_Items oi ON co.order_id = oi.order_id WHERE co.order_status = 'Cancelled' AND oi.product_id = 2;",
    "table_names": [
      "Customer_Orders",
      "Order_Items"
    ]
  },
  {
    "id": 1910,
    "db_id": "customers_and_addresses",
    "question": "How many cancelled orders included the product with product_id 2?",
    "sql": "SELECT COUNT(DISTINCT co.order_id) FROM Customer_Orders co JOIN Order_Items oi ON co.order_id = oi.order_id WHERE co.order_status = 'Cancelled' AND oi.product_id = 2;",
    "table_names": [
      "Customer_Orders",
      "Order_Items"
    ]
  },
  {
    "id": 1911,
    "db_id": "customers_and_addresses",
    "question": "Which customers have a payment method as 'Cash' and have had an order cancelled for the 'Second time'?",
    "sql": "SELECT customer_name FROM Customers WHERE customer_id IN (SELECT customer_id FROM Customer_Orders WHERE order_status = 'Cancelled' AND order_details = 'Second time') AND payment_method = 'Cash';",
    "table_names": [
      "Customers",
      "Customer_Orders"
    ]
  },
  {
    "id": 1912,
    "db_id": "customers_and_addresses",
    "question": "Which VIP customers have successfully had their orders delivered?",
    "sql": "SELECT c.customer_name FROM Customers c JOIN Customer_Orders o ON c.customer_id = o.customer_id WHERE c.other_customer_details='VIP' AND o.order_status='Delivered';",
    "table_names": [
      "Customers",
      "Customer_Orders"
    ]
  },
  {
    "id": 1913,
    "db_id": "tracking_orders",
    "question": "Which product has the highest total order quantity?",
    "sql": "SELECT Products.product_details, SUM(Order_Items.order_quantity) AS total_quantity FROM Order_Items JOIN Products ON Order_Items.product_id = Products.product_id GROUP BY Products.product_details ORDER BY total_quantity DESC LIMIT 1;",
    "table_names": [
      "Products",
      "Order_Items"
    ]
  },
  {
    "id": 1914,
    "db_id": "tracking_orders",
    "question": "Which product has the highest total order quantity?",
    "sql": "SELECT P.product_details, SUM(O.order_quantity) AS total_quantity FROM Products P JOIN Order_Items O ON P.product_id = O.product_id GROUP BY P.product_id ORDER BY total_quantity DESC LIMIT 1;",
    "table_names": [
      "Products",
      "Order_Items"
    ]
  },
  {
    "id": 1915,
    "db_id": "tracking_orders",
    "question": "Which product has the highest total quantity ordered across all orders?",
    "sql": "SELECT p.product_details, SUM(CAST(o.order_quantity AS INTEGER)) AS total_quantity FROM Products p JOIN Order_Items o ON p.product_id = o.product_id GROUP BY p.product_details ORDER BY total_quantity DESC LIMIT 1;",
    "table_names": [
      "Products",
      "Order_Items"
    ]
  },
  {
    "id": 1916,
    "db_id": "tracking_orders",
    "question": "Which product has the highest total order quantity across all orders, and what is the total quantity ordered?",
    "sql": "SELECT p.product_details, SUM(CAST(oi.order_quantity AS INTEGER)) AS total_quantity FROM Products p JOIN Order_Items oi ON p.product_id = oi.product_id GROUP BY p.product_details ORDER BY total_quantity DESC LIMIT 1;",
    "table_names": [
      "Products",
      "Order_Items"
    ]
  },
  {
    "id": 1917,
    "db_id": "customers_and_addresses",
    "question": "Which customers have had more than one cancelled order?",
    "sql": "SELECT customer_name FROM Customers WHERE customer_id IN (SELECT customer_id FROM Customer_Orders WHERE order_status = 'Cancelled' GROUP BY customer_id HAVING COUNT(order_id) > 1);",
    "table_names": [
      "Customers",
      "Customer_Orders"
    ]
  },
  {
    "id": 1918,
    "db_id": "customers_and_addresses",
    "question": "Which customers paying by Credit Card have cancelled more than one order?",
    "sql": "SELECT c.customer_name FROM Customers c INNER JOIN Customer_Orders co ON c.customer_id = co.customer_id WHERE c.payment_method = 'Credit Card' AND co.order_status = 'Cancelled' GROUP BY c.customer_id HAVING COUNT(co.order_id) > 1;",
    "table_names": [
      "Customers",
      "Customer_Orders"
    ]
  },
  {
    "id": 1919,
    "db_id": "music_4",
    "question": "Which songs have won the Best Song category in a music festival and stayed more than one week at the top?",
    "sql": "SELECT v.Song FROM volume v JOIN music_festival mf ON v.Volume_ID = mf.Volume WHERE mf.Category = 'Best Song' AND mf.Result = 'Awarded' AND v.Weeks_on_Top > 1;",
    "table_names": [
      "volume",
      "music_festival"
    ]
  },
  {
    "id": 1920,
    "db_id": "music_4",
    "question": "Which songs won awards at music festivals and stayed more than 1 week on top of the charts?",
    "sql": "SELECT v.Song FROM volume v JOIN music_festival mf ON v.Volume_ID = mf.Volume WHERE mf.Result = 'Awarded' AND v.Weeks_on_Top > 1;",
    "table_names": [
      "volume",
      "music_festival"
    ]
  },
  {
    "id": 1921,
    "db_id": "music_4",
    "question": "List the names of the songs that won an award at the music festival and stayed at the top of the chart for at least 2 weeks.",
    "sql": "SELECT volume.Song FROM volume JOIN music_festival ON volume.Volume_ID = music_festival.Volume WHERE music_festival.Result = 'Awarded' AND volume.Weeks_on_Top >= 2;",
    "table_names": [
      "volume",
      "music_festival"
    ]
  },
  {
    "id": 1922,
    "db_id": "music_4",
    "question": "Which songs won the 'Best Song' category award at the Music Festival, and what are their titles?",
    "sql": "SELECT v.Song FROM volume v JOIN music_festival m ON v.Volume_ID = m.Volume WHERE m.Category = 'Best Song' AND m.Result = 'Awarded';",
    "table_names": [
      "volume",
      "music_festival"
    ]
  },
  {
    "id": 1923,
    "db_id": "music_4",
    "question": "Which artist older than 30 years had the highest total number of weeks on top based on the chart data provided?",
    "sql": "SELECT artist.Artist, SUM(volume.Weeks_on_Top) AS Total_Weeks FROM artist JOIN volume ON artist.Artist_ID = volume.Artist_ID WHERE artist.Age > 30 GROUP BY artist.Artist ORDER BY Total_Weeks DESC LIMIT 1;",
    "table_names": [
      "artist",
      "volume"
    ]
  },
  {
    "id": 1924,
    "db_id": "music_4",
    "question": "What is the name and age of the artist whose song stayed the longest at the top of the volume chart?",
    "sql": "SELECT artist.Artist, artist.Age FROM artist JOIN volume ON artist.Artist_ID = volume.Artist_ID WHERE volume.Weeks_on_Top = (SELECT MAX(Weeks_on_Top) FROM volume);",
    "table_names": [
      "artist",
      "volume"
    ]
  },
  {
    "id": 1925,
    "db_id": "music_4",
    "question": "Which artist older than 30 has the highest cumulative number of weeks at the top across all their top songs, and how many such weeks and top songs do they have?",
    "sql": "SELECT artist.Artist, COUNT(volume.Song) AS total_top_songs, SUM(volume.Weeks_on_Top) AS cumulative_weeks FROM artist JOIN volume ON artist.Artist_ID = volume.Artist_ID WHERE artist.Age > 30 GROUP BY artist.Artist ORDER BY cumulative_weeks DESC LIMIT 1;",
    "table_names": [
      "artist",
      "volume"
    ]
  },
  {
    "id": 1926,
    "db_id": "music_4",
    "question": "Which artist has the most successful song by total weeks at the top, and what is the name of that song?",
    "sql": "SELECT a.Artist, v.Song, SUM(v.Weeks_on_Top) AS Total_Weeks FROM artist a JOIN volume v ON a.Artist_ID = v.Artist_ID GROUP BY a.Artist, v.Song ORDER BY Total_Weeks DESC LIMIT 1;",
    "table_names": [
      "artist",
      "volume"
    ]
  },
  {
    "id": 1927,
    "db_id": "music_4",
    "question": "What is the total number of weeks that songs by artists 'Tangorodrim' and 'Gorgoroth' spent at the top?",
    "sql": "SELECT SUM(v.Weeks_on_Top) FROM volume v JOIN artist a ON v.Artist_ID = a.Artist_ID WHERE a.Artist IN ('Tangorodrim', 'Gorgoroth');",
    "table_names": [
      "artist",
      "volume"
    ]
  },
  {
    "id": 1928,
    "db_id": "music_4",
    "question": "Which artist older than 30 has the highest number of songs listed in the volume table?",
    "sql": "SELECT a.Artist, COUNT(v.Volume_ID) AS Num_Top_Hits FROM artist a JOIN volume v ON a.Artist_ID = v.Artist_ID WHERE a.Age > 30 GROUP BY a.Artist ORDER BY Num_Top_Hits DESC LIMIT 1;",
    "table_names": [
      "artist",
      "volume"
    ]
  },
  {
    "id": 1929,
    "db_id": "music_4",
    "question": "Which artist has the longest duration at the top of the chart and with what song?",
    "sql": "SELECT artist.Artist, volume.Song, MAX(volume.Weeks_on_Top) FROM artist INNER JOIN volume ON artist.Artist_ID = volume.Artist_ID GROUP BY artist.Artist ORDER BY MAX(volume.Weeks_on_Top) DESC LIMIT 1;",
    "table_names": [
      "artist",
      "volume"
    ]
  },
  {
    "id": 1930,
    "db_id": "music_4",
    "question": "List the names of artists younger than 35 years old who had songs that stayed on top for more than one week.",
    "sql": "SELECT artist.Artist FROM artist JOIN volume ON artist.Artist_ID = volume.Artist_ID WHERE volume.Weeks_on_Top > 1 AND artist.Age < 35;",
    "table_names": [
      "artist",
      "volume"
    ]
  },
  {
    "id": 1931,
    "db_id": "music_4",
    "question": "Which artist had songs staying the highest total number of weeks on top according to the volume records?",
    "sql": "SELECT artist.Artist, COUNT(volume.Song) AS Song_Count, SUM(volume.Weeks_on_Top) AS Total_Weeks FROM artist JOIN volume ON artist.Artist_ID = volume.Artist_ID GROUP BY artist.Artist ORDER BY Total_Weeks DESC LIMIT 1;",
    "table_names": [
      "artist",
      "volume"
    ]
  },
  {
    "id": 1932,
    "db_id": "music_4",
    "question": "Which artist had the most total weeks at the top throughout all their songs listed, and how many top songs did they have?",
    "sql": "SELECT a.Artist, COUNT(v.Song) AS Total_Songs, SUM(v.Weeks_on_Top) AS Total_Weeks FROM artist a JOIN volume v ON a.Artist_ID = v.Artist_ID GROUP BY a.Artist ORDER BY Total_Weeks DESC LIMIT 1;",
    "table_names": [
      "artist",
      "volume"
    ]
  },
  {
    "id": 1933,
    "db_id": "music_4",
    "question": "Which artist above the age of 25 had the highest total number of weeks on top of the volume charts, and what is their famous title?",
    "sql": "SELECT artist.Artist, artist.Famous_Title, SUM(volume.Weeks_on_Top) AS Total_Weeks FROM artist JOIN volume ON artist.Artist_ID = volume.Artist_ID WHERE artist.Age > 25 GROUP BY artist.Artist_ID ORDER BY Total_Weeks DESC LIMIT 1;",
    "table_names": [
      "artist",
      "volume"
    ]
  },
  {
    "id": 1934,
    "db_id": "music_4",
    "question": "List the artist names, their respective songs from the 'volume' table, and their famous titles for artists older than 30 years old whose songs remained at the top of charts for two or more weeks.",
    "sql": "SELECT artist.Artist, volume.Song, artist.Famous_Title FROM artist INNER JOIN volume ON artist.Artist_ID = volume.Artist_ID WHERE artist.Age > 30 AND volume.Weeks_on_Top >= 2;",
    "table_names": [
      "artist",
      "volume"
    ]
  },
  {
    "id": 1935,
    "db_id": "music_4",
    "question": "Which artist older than 30 has the highest number of top songs according to volume?",
    "sql": "SELECT artist.Artist, COUNT(volume.Volume_ID) AS song_count FROM artist JOIN volume ON artist.Artist_ID = volume.Artist_ID WHERE artist.Age > 30 GROUP BY artist.Artist ORDER BY song_count DESC LIMIT 1;",
    "table_names": [
      "artist",
      "volume"
    ]
  },
  {
    "id": 1936,
    "db_id": "music_4",
    "question": "Which artist older than 25 has the highest number of top-volume charted songs?",
    "sql": "SELECT a.Artist, COUNT(v.Volume_ID) AS Song_Count FROM artist a JOIN volume v ON a.Artist_ID = v.Artist_ID WHERE a.Age > 25 GROUP BY a.Artist ORDER BY Song_Count DESC LIMIT 1;",
    "table_names": [
      "artist",
      "volume"
    ]
  },
  {
    "id": 1937,
    "db_id": "roller_coaster",
    "question": "What roller coaster is located in a country where Swedish is spoken and has a speed greater than 40 mph?",
    "sql": "SELECT r.Name FROM roller_coaster r JOIN country c ON r.Country_ID = c.Country_ID WHERE c.Languages LIKE '%Swedish%' AND CAST(r.Speed AS FLOAT) > 40",
    "table_names": [
      "roller_coaster",
      "country"
    ]
  },
  {
    "id": 1938,
    "db_id": "roller_coaster",
    "question": "What roller coaster(s) are located in countries with an area greater than 100000 sq km and have a speed higher than 60 mph?",
    "sql": "SELECT roller_coaster.Name FROM roller_coaster JOIN country ON roller_coaster.Country_ID = country.Country_ID WHERE country.Area > 100000 AND roller_coaster.Speed > 60;",
    "table_names": [
      "roller_coaster",
      "country"
    ]
  },
  {
    "id": 1939,
    "db_id": "roller_coaster",
    "question": "What roller coaster is located in a country where the languages spoken include Swedish and has a speed greater than 40 mph?",
    "sql": "SELECT rc.Name FROM roller_coaster rc JOIN country c ON rc.Country_ID = c.Country_ID WHERE c.Languages LIKE '%Swedish%' AND rc.Speed > 40;",
    "table_names": [
      "roller_coaster",
      "country"
    ]
  },
  {
    "id": 1940,
    "db_id": "roller_coaster",
    "question": "What is the name of the country where the roller coaster 'The Voyage' is located?",
    "sql": "SELECT c.Name FROM roller_coaster rc JOIN country c ON rc.Country_ID = c.Country_ID WHERE rc.Name = 'The Voyage';",
    "table_names": [
      "roller_coaster",
      "country"
    ]
  },
  {
    "id": 1941,
    "db_id": "roller_coaster",
    "question": "Which country with the highest population has a roller coaster that exceeds 60 mph in speed and 130 feet in height?",
    "sql": "SELECT c.Name FROM country c INNER JOIN roller_coaster r ON c.Country_ID = r.Country_ID WHERE CAST(r.Speed AS FLOAT) > 60 AND CAST(r.Height AS FLOAT) > 130 ORDER BY c.Population DESC LIMIT 1;",
    "table_names": [
      "roller_coaster",
      "country"
    ]
  },
  {
    "id": 1942,
    "db_id": "roller_coaster",
    "question": "What is the fastest roller coaster located in a country where Finnish is spoken?",
    "sql": "SELECT rc.Name FROM roller_coaster rc JOIN country c ON rc.Country_ID = c.Country_ID WHERE c.Languages LIKE '%Finnish%' ORDER BY rc.Speed DESC LIMIT 1;",
    "table_names": [
      "roller_coaster",
      "country"
    ]
  },
  {
    "id": 1943,
    "db_id": "ship_1",
    "question": "What are the names of ships built in 1998 commanded by captains older than 45?",
    "sql": "SELECT Ship.Name FROM captain JOIN Ship ON captain.Ship_ID = Ship.Ship_ID WHERE captain.age > 45 AND Ship.Built_Year = 1998.0;",
    "table_names": [
      "captain",
      "Ship"
    ]
  },
  {
    "id": 1944,
    "db_id": "ship_1",
    "question": "Which captains older than 40 years command ships that were built in 1998?",
    "sql": "SELECT c.Name FROM captain c JOIN Ship s ON c.Ship_ID = s.Ship_ID WHERE c.age > 40 AND s.Built_Year = 1998.0;",
    "table_names": [
      "captain",
      "Ship"
    ]
  },
  {
    "id": 1945,
    "db_id": "ship_1",
    "question": "List the names of captains who are older than 50 and command ships built in the year 1998.",
    "sql": "SELECT captain.name FROM captain JOIN Ship ON captain.Ship_ID = Ship.Ship_ID WHERE Ship.Built_Year = 1998 AND captain.age > 50;",
    "table_names": [
      "captain",
      "Ship"
    ]
  },
  {
    "id": 1946,
    "db_id": "ship_1",
    "question": "What is the name of the ship commanded by the oldest captain?",
    "sql": "SELECT Ship.Name FROM Ship JOIN captain ON Ship.Ship_ID = captain.Ship_ID WHERE captain.age = (SELECT MAX(cast(age as INT)) FROM captain);",
    "table_names": [
      "captain",
      "Ship"
    ]
  },
  {
    "id": 1947,
    "db_id": "ship_1",
    "question": "Which captains ranked as Midshipman command a ship built in the year 1997?",
    "sql": "SELECT c.Name FROM captain c JOIN Ship s ON c.Ship_ID = s.Ship_ID WHERE s.Built_Year = 1997 AND c.Rank = 'Midshipman';",
    "table_names": [
      "captain",
      "Ship"
    ]
  },
  {
    "id": 1948,
    "db_id": "ship_1",
    "question": "Who are the captains with the rank of 'Midshipman' serving on ships built in the year 1997?",
    "sql": "SELECT captain.Name FROM captain JOIN Ship ON captain.Ship_ID = Ship.Ship_ID WHERE Ship.Built_Year = 1997 AND captain.Rank = 'Midshipman';",
    "table_names": [
      "captain",
      "Ship"
    ]
  },
  {
    "id": 1949,
    "db_id": "ship_1",
    "question": "List the ships captained by midshipmen who are older than 40.",
    "sql": "SELECT Ship.Name FROM Ship JOIN captain ON Ship.Ship_ID = captain.Ship_ID WHERE captain.age > '40' AND captain.Rank = 'Midshipman';",
    "table_names": [
      "captain",
      "Ship"
    ]
  },
  {
    "id": 1950,
    "db_id": "ship_1",
    "question": "What is the name of the ship commanded by the junior captain ranked Commander Richard Bolitho?",
    "sql": "SELECT Ship.Name FROM Ship JOIN captain ON Ship.Ship_ID = captain.Ship_ID WHERE captain.Name = 'Commander Richard Bolitho' AND captain.Rank = 'Commander, junior captain';",
    "table_names": [
      "captain",
      "Ship"
    ]
  },
  {
    "id": 1951,
    "db_id": "ship_1",
    "question": "What are the names of ships built in 1997 and their respective captains who are younger than 45 years old?",
    "sql": "SELECT Ship.Name, captain.Name FROM captain JOIN Ship ON captain.Ship_ID = Ship.Ship_ID WHERE captain.age < '45' AND Ship.Built_Year = 1997.0;",
    "table_names": [
      "captain",
      "Ship"
    ]
  },
  {
    "id": 1952,
    "db_id": "ship_1",
    "question": "What is the name of ship commanded by a captain ranked 'Lieutenant' who is older than 45 years?",
    "sql": "SELECT Ship.Name FROM Ship INNER JOIN captain ON Ship.Ship_ID = captain.Ship_ID WHERE captain.age > '45' AND captain.Rank = 'Lieutenant';",
    "table_names": [
      "captain",
      "Ship"
    ]
  },
  {
    "id": 1953,
    "db_id": "ship_1",
    "question": "What are the names of ships built in 1998 that have captains with the rank of 'Lieutenant'?",
    "sql": "SELECT Ship.Name FROM captain JOIN Ship ON captain.Ship_ID = Ship.Ship_ID WHERE captain.Rank = 'Lieutenant' AND Ship.Built_Year = 1998;",
    "table_names": [
      "captain",
      "Ship"
    ]
  },
  {
    "id": 1954,
    "db_id": "ship_1",
    "question": "What is the name of the ship captained by the youngest Lieutenant?",
    "sql": "SELECT Ship.Name FROM captain INNER JOIN Ship ON captain.Ship_ID = Ship.Ship_ID WHERE captain.age = (SELECT MIN(age) FROM captain WHERE captain.Rank = 'Lieutenant');",
    "table_names": [
      "captain",
      "Ship"
    ]
  },
  {
    "id": 1955,
    "db_id": "city_record",
    "question": "What was the GDP of the city that hosted the match in the year 2011?",
    "sql": "SELECT c.City, c.GDP FROM city c JOIN hosting_city h ON c.City_ID = CAST(h.Host_City AS INTEGER) WHERE h.Year = 2011;",
    "table_names": [
      "city",
      "hosting_city"
    ]
  },
  {
    "id": 1956,
    "db_id": "city_record",
    "question": "What was the population of the city hosting the match in the year 2012?",
    "sql": "SELECT city.City, city.Regional_Population FROM city INNER JOIN hosting_city ON city.City_ID = CAST(hosting_city.Host_City AS INTEGER) WHERE hosting_city.Year = 2012;",
    "table_names": [
      "city",
      "hosting_city"
    ]
  },
  {
    "id": 1957,
    "db_id": "city_record",
    "question": "In 2012, which city hosted the match and what was its regional population?",
    "sql": "SELECT city.City, city.Regional_Population FROM city JOIN hosting_city ON city.City_ID = hosting_city.Host_City WHERE hosting_city.Year = 2012;",
    "table_names": [
      "city",
      "hosting_city"
    ]
  },
  {
    "id": 1958,
    "db_id": "city_record",
    "question": "What is the name of the city that hosted the match with Match_ID 6 in 2013?",
    "sql": "SELECT city.City FROM city JOIN hosting_city ON city.City_ID = hosting_city.Host_City WHERE hosting_city.Year = 2013;",
    "table_names": [
      "city",
      "hosting_city"
    ]
  },
  {
    "id": 1959,
    "db_id": "city_record",
    "question": "Which cities have a GDP over 1000 and an average temperature above 30Â°C in July?",
    "sql": "SELECT city.City FROM city JOIN temperature ON city.City_ID = temperature.City_ID WHERE temperature.Jul > 30 AND city.GDP > 1000;",
    "table_names": [
      "city",
      "temperature"
    ]
  },
  {
    "id": 1960,
    "db_id": "city_record",
    "question": "Which city has the highest average temperature in July, and what is its GDP?",
    "sql": "SELECT c.City, c.GDP FROM city c JOIN temperature t ON c.City_ID = t.City_ID WHERE t.Jul = (SELECT MAX(Jul) FROM temperature);",
    "table_names": [
      "city",
      "temperature"
    ]
  },
  {
    "id": 1961,
    "db_id": "city_record",
    "question": "Which city hosted the most recent match according to available data?",
    "sql": "SELECT city.City FROM city JOIN hosting_city ON city.City_ID = hosting_city.Host_City WHERE hosting_city.Year = (SELECT MAX(Year) FROM hosting_city);",
    "table_names": [
      "city",
      "hosting_city"
    ]
  },
  {
    "id": 1962,
    "db_id": "city_record",
    "question": "What is the English name and GDP of the city that hosted the match in 2011?",
    "sql": "SELECT c.City, c.GDP FROM city c JOIN hosting_city h ON c.City_ID = CAST(h.Host_City AS INTEGER) WHERE h.Year = 2011;",
    "table_names": [
      "city",
      "hosting_city"
    ]
  },
  {
    "id": 1963,
    "db_id": "city_record",
    "question": "Which cities have a GDP higher than 600 billion and an average temperature in July higher than 25 degrees?",
    "sql": "SELECT city.City FROM city JOIN temperature ON city.City_ID = temperature.City_ID WHERE city.GDP > 600 AND temperature.Jul > 25;",
    "table_names": [
      "city",
      "temperature"
    ]
  },
  {
    "id": 1964,
    "db_id": "city_record",
    "question": "What is the average GDP of cities that have an average temperature higher than 25 degrees in July?",
    "sql": "SELECT AVG(city.GDP) FROM city INNER JOIN temperature ON city.City_ID = temperature.City_ID WHERE temperature.Jul > 25;",
    "table_names": [
      "city",
      "temperature"
    ]
  },
  {
    "id": 1965,
    "db_id": "city_record",
    "question": "Which cities have a GDP higher than 700 and average December temperatures below 20 degrees?",
    "sql": "SELECT city.City FROM city JOIN temperature ON city.City_ID = temperature.City_ID WHERE city.GDP > 700 AND temperature.Dec < 20;",
    "table_names": [
      "city",
      "temperature"
    ]
  },
  {
    "id": 1966,
    "db_id": "city_record",
    "question": "Which cities have a GDP greater than 500 billion and a temperature higher than 28.5 degrees Celsius in July?",
    "sql": "SELECT city.City FROM city JOIN temperature ON city.City_ID = temperature.City_ID WHERE city.GDP > 500 AND temperature.Jul > 28.5;",
    "table_names": [
      "city",
      "temperature"
    ]
  },
  {
    "id": 1967,
    "db_id": "city_record",
    "question": "What is the name and regional population of the city that hosted the match in 2011?",
    "sql": "SELECT c.City, c.Regional_Population FROM city c JOIN hosting_city h ON c.City_ID = h.Host_City WHERE h.Year = 2011;",
    "table_names": [
      "city",
      "hosting_city"
    ]
  },
  {
    "id": 1968,
    "db_id": "city_record",
    "question": "What is the average GDP of cities that hosted matches between 2009 and 2012 inclusive?",
    "sql": "SELECT AVG(c.GDP) FROM city c JOIN hosting_city h ON c.City_ID = CAST(h.Host_City AS INTEGER) WHERE h.Year BETWEEN 2009 AND 2012;",
    "table_names": [
      "city",
      "hosting_city"
    ]
  },
  {
    "id": 1969,
    "db_id": "e_government",
    "question": "How many complex type forms have a completion status of either 'Completed' or 'Partially Completed' and were fully completed after February 1st, 2018?",
    "sql": "SELECT COUNT(*) FROM Forms f INNER JOIN Party_Forms pf ON f.form_id = pf.form_id WHERE f.form_type_code = 'Complex' AND pf.form_status_code IN ('Completed', 'Partially Completed') AND pf.date_fully_completed > '2018-02-01';",
    "table_names": [
      "Forms",
      "Party_Forms"
    ]
  },
  {
    "id": 1970,
    "db_id": "e_government",
    "question": "What is the total number of parties that have completed forms for complex-type forms?",
    "sql": "SELECT COUNT(DISTINCT pf.party_id) FROM Party_Forms pf JOIN Forms f ON pf.form_id = f.form_id WHERE f.form_type_code = 'Complex' AND pf.form_status_code = 'Completed';",
    "table_names": [
      "Forms",
      "Party_Forms"
    ]
  },
  {
    "id": 1971,
    "db_id": "e_government",
    "question": "How many unique parties using 'Cash' as their payment method have fully completed forms?",
    "sql": "SELECT COUNT(DISTINCT pf.party_id) FROM Party_Forms AS pf JOIN Parties AS p ON pf.party_id = p.party_id WHERE p.payment_method_code = 'Cash' AND pf.form_status_code = 'Completed';",
    "table_names": [
      "Parties",
      "Party_Forms"
    ]
  },
  {
    "id": 1972,
    "db_id": "e_government",
    "question": "How many unique forms have been partially completed by parties whose payment method is Cheque?",
    "sql": "SELECT COUNT(DISTINCT pf.form_id) FROM Parties p JOIN Party_Forms pf ON p.party_id = pf.party_id WHERE p.payment_method_code = 'Cheque' AND pf.form_status_code = 'Partially Completed';",
    "table_names": [
      "Parties",
      "Party_Forms"
    ]
  },
  {
    "id": 1973,
    "db_id": "e_government",
    "question": "How many bookings were made for services with a 'service_type_code' of 'Education' during the period 2018-03-24 and 2018-03-25?",
    "sql": "SELECT COUNT(*) FROM Party_Services ps JOIN Services s ON ps.service_id = s.service_id WHERE s.service_type_code = 'Education' AND DATE(ps.booking_made_date) BETWEEN '2018-03-24' AND '2018-03-25';",
    "table_names": [
      "Services",
      "Party_Services"
    ]
  },
  {
    "id": 1974,
    "db_id": "e_government",
    "question": "How many distinct customers booked services categorized as 'Education' between March 1st, 2018 and March 15th, 2018?",
    "sql": "SELECT COUNT(DISTINCT ps.customer_id) FROM Party_Services ps JOIN Services s ON ps.service_id = s.service_id WHERE s.service_type_code = 'Education' AND ps.service_datetime BETWEEN '2018-03-01' AND '2018-03-15';",
    "table_names": [
      "Services",
      "Party_Services"
    ]
  },
  {
    "id": 1975,
    "db_id": "e_government",
    "question": "How many distinct services were booked by customers who paid using a Credit Card?",
    "sql": "SELECT COUNT(DISTINCT ps.service_id) FROM Party_Services ps JOIN Parties p ON ps.customer_id = p.party_id WHERE p.payment_method_code = 'Credit Card';",
    "table_names": [
      "Parties",
      "Party_Services"
    ]
  },
  {
    "id": 1976,
    "db_id": "e_government",
    "question": "How many unique customers who made bookings with payment method 'Cheque' had services scheduled between March 1 and March 10, 2018?",
    "sql": "SELECT COUNT(DISTINCT ps.customer_id) FROM Party_Services ps JOIN Parties p ON ps.customer_id = p.party_id WHERE p.payment_method_code = 'Cheque' AND ps.service_datetime BETWEEN '2018-03-01' AND '2018-03-10';",
    "table_names": [
      "Parties",
      "Party_Services"
    ]
  },
  {
    "id": 1977,
    "db_id": "e_government",
    "question": "List the names of organizations having contact relationships with at least 3 different individuals.",
    "sql": "SELECT organization_name FROM Organizations WHERE organization_id IN (SELECT organization_id FROM Organization_Contact_Individuals GROUP BY organization_id HAVING COUNT(DISTINCT individual_id) >= 3);",
    "table_names": [
      "Organizations",
      "Organization_Contact_Individuals"
    ]
  },
  {
    "id": 1978,
    "db_id": "e_government",
    "question": "Which organization's contact individuals had contact periods starting before it was officially formed, and what are the respective individual IDs?",
    "sql": "SELECT O.organization_name, OCI.individual_id FROM Organizations O JOIN Organization_Contact_Individuals OCI ON O.organization_id = OCI.organization_id WHERE OCI.date_contact_from < O.date_formed;",
    "table_names": [
      "Organizations",
      "Organization_Contact_Individuals"
    ]
  },
  {
    "id": 1979,
    "db_id": "e_government",
    "question": "What are the full names of individuals who started contact with organization 3 before or on January 1, 2017?",
    "sql": "SELECT individual_first_name, individual_last_name FROM Individuals WHERE individual_id IN (SELECT individual_id FROM Organization_Contact_Individuals WHERE organization_id = 3 AND date_contact_from <= '2017-01-01 00:00:00');",
    "table_names": [
      "Individuals",
      "Organization_Contact_Individuals"
    ]
  },
  {
    "id": 1980,
    "db_id": "e_government",
    "question": "What are the first names and email addresses of individuals who were contacts for organization with id 3 and started their contact before 2017, but ended it after January 1st, 2018?",
    "sql": "SELECT Individuals.individual_first_name, Individuals.individual_email FROM Individuals JOIN Organization_Contact_Individuals ON Individuals.individual_id = Organization_Contact_Individuals.individual_id WHERE Organization_Contact_Individuals.organization_id = 3 AND Organization_Contact_Individuals.date_contact_from < '2017-01-01' AND Organization_Contact_Individuals.date_contact_to > '2018-01-01';",
    "table_names": [
      "Individuals",
      "Organization_Contact_Individuals"
    ]
  },
  {
    "id": 1981,
    "db_id": "school_bus",
    "question": "What is the average age of Democratic drivers who work full-time?",
    "sql": "SELECT AVG(driver.Age) FROM driver JOIN school_bus ON driver.Driver_ID = school_bus.Driver_ID WHERE school_bus.If_full_time = 'T' AND driver.Party = 'Dem';",
    "table_names": [
      "driver",
      "school_bus"
    ]
  },
  {
    "id": 1982,
    "db_id": "school_bus",
    "question": "How many years has the full-time bus driver worked at the public school located in Jakarta, Indonesia?",
    "sql": "SELECT sb.Years_Working FROM school_bus sb JOIN school s ON sb.School_ID = s.School_ID WHERE s.Location = 'Jakarta, Indonesia' AND sb.If_full_time = 'T';",
    "table_names": [
      "school",
      "school_bus"
    ]
  },
  {
    "id": 1983,
    "db_id": "school_bus",
    "question": "What is the name of the private school that has a full-time school bus driver with the most years of working experience?",
    "sql": "SELECT s.School FROM school s JOIN school_bus sb ON s.School_ID = sb.School_ID WHERE s.Type = 'Private' AND sb.If_full_time = 'T' ORDER BY sb.Years_Working DESC LIMIT 1;",
    "table_names": [
      "school",
      "school_bus"
    ]
  },
  {
    "id": 1984,
    "db_id": "school_bus",
    "question": "What is the average age of drivers who have worked more than 5 years and are employed full-time?",
    "sql": "SELECT AVG(d.Age) FROM driver d JOIN school_bus s ON d.Driver_ID = s.Driver_ID WHERE s.Years_Working > 5 AND s.If_full_time = 'T';",
    "table_names": [
      "driver",
      "school_bus"
    ]
  },
  {
    "id": 1985,
    "db_id": "flight_company",
    "question": "List the Vehicle Flight numbers and Dates for flights operated by companies incorporated in Hong Kong whose principal activities are Cargo airline?",
    "sql": "SELECT f.Vehicle_Flight_number, f.Date FROM flight f JOIN operate_company oc ON f.company_id = oc.id WHERE oc.Principal_activities = 'Cargo airline' AND oc.Incorporated_in = 'Hong Kong';",
    "table_names": [
      "operate_company",
      "flight"
    ]
  },
  {
    "id": 1986,
    "db_id": "flight_company",
    "question": "Which companies with a 100 percent group equity shareholding conducted flights piloted by Peterson?",
    "sql": "SELECT oc.name FROM operate_company oc JOIN flight f ON oc.id = f.company_id WHERE f.Pilot = 'Peterson' AND oc.Group_Equity_Shareholding = 100.0;",
    "table_names": [
      "operate_company",
      "flight"
    ]
  },
  {
    "id": 1987,
    "db_id": "flight_company",
    "question": "List the names of subsidiary companies whose flights were piloted by Peterson.",
    "sql": "SELECT oc.name FROM operate_company oc JOIN flight f ON oc.id = f.company_id WHERE oc.Type = 'Subsidiary' AND f.Pilot = 'Peterson';",
    "table_names": [
      "operate_company",
      "flight"
    ]
  },
  {
    "id": 1988,
    "db_id": "flight_company",
    "question": "What are the names of airports located in the United States where pilot Peterson had flown?",
    "sql": "SELECT airport.name FROM airport JOIN flight ON airport.id = flight.airport_id WHERE flight.Pilot = 'Peterson' AND airport.Country = 'United States';",
    "table_names": [
      "airport",
      "flight"
    ]
  },
  {
    "id": 1989,
    "db_id": "flight_company",
    "question": "Which airports located in the United States had flights piloted by Peterson?",
    "sql": "SELECT airport.name FROM airport INNER JOIN flight ON airport.id = flight.airport_id WHERE flight.Pilot = 'Peterson' AND airport.Country = 'United States';",
    "table_names": [
      "airport",
      "flight"
    ]
  },
  {
    "id": 1990,
    "db_id": "flight_company",
    "question": "What country was the airport located in which pilot Peterson conducted a flight from the city of Boston?",
    "sql": "SELECT airport.Country FROM airport JOIN flight ON airport.id = flight.airport_id WHERE flight.Pilot = 'Peterson' AND airport.City = 'Boston';",
    "table_names": [
      "airport",
      "flight"
    ]
  },
  {
    "id": 1991,
    "db_id": "flight_company",
    "question": "List all companies incorporated in Hong Kong that had flights piloted by Peterson.",
    "sql": "SELECT oc.name FROM operate_company oc JOIN flight f ON oc.id = f.company_id WHERE f.Pilot = 'Peterson' AND oc.Incorporated_in = 'Hong Kong';",
    "table_names": [
      "operate_company",
      "flight"
    ]
  },
  {
    "id": 1992,
    "db_id": "cre_Docs_and_Epenses",
    "question": "What is the total sum of account details for all accounts linked to the 'Private Project' statement?",
    "sql": "SELECT SUM(CAST(a.Account_Details AS FLOAT)) FROM Accounts AS a JOIN Statements AS s ON a.Statement_ID = s.Statement_ID WHERE s.Statement_Details = 'Private Project';",
    "table_names": [
      "Statements",
      "Accounts"
    ]
  },
  {
    "id": 1993,
    "db_id": "cre_Docs_and_Epenses",
    "question": "What is the total amount of all accounts related to the Open Project?",
    "sql": "SELECT SUM(CAST(a.Account_Details AS FLOAT)) FROM Accounts a JOIN Statements s ON a.Statement_ID = s.Statement_ID WHERE s.Statement_Details = 'Open Project';",
    "table_names": [
      "Statements",
      "Accounts"
    ]
  },
  {
    "id": 1994,
    "db_id": "cre_Docs_and_Epenses",
    "question": "What is the sum of account details amounts for 'Open Project' statement?",
    "sql": "SELECT SUM(CAST(Account_Details AS FLOAT)) FROM Accounts JOIN Statements ON Accounts.Statement_ID = Statements.Statement_ID WHERE Statements.Statement_Details = 'Open Project';",
    "table_names": [
      "Statements",
      "Accounts"
    ]
  },
  {
    "id": 1995,
    "db_id": "cre_Docs_and_Epenses",
    "question": "What is the total amount for accounts associated with the Private Project statement?",
    "sql": "SELECT SUM(CAST(Account_Details AS FLOAT)) FROM Accounts WHERE Statement_ID = (SELECT Statement_ID FROM Statements WHERE Statement_Details = 'Private Project')",
    "table_names": [
      "Statements",
      "Accounts"
    ]
  },
  {
    "id": 1996,
    "db_id": "cre_Docs_and_Epenses",
    "question": "How many unique documents of type 'CV' are associated with projects whose project details mention 'Research'?",
    "sql": "SELECT COUNT(DISTINCT d.Document_ID) FROM Documents AS d JOIN Projects AS p ON d.Project_ID = p.Project_ID WHERE p.Project_Details LIKE '%Research%' AND d.Document_Type_Code = 'CV';",
    "table_names": [
      "Projects",
      "Documents"
    ]
  },
  {
    "id": 1997,
    "db_id": "cre_Docs_and_Epenses",
    "question": "How many 'BK' type documents are associated with projects that have 'Research project' in their project details?",
    "sql": "SELECT COUNT(Documents.Document_ID) FROM Documents JOIN Projects ON Documents.Project_ID = Projects.Project_ID WHERE Documents.Document_Type_Code = 'BK' AND Projects.Project_Details LIKE '%Research project%';",
    "table_names": [
      "Projects",
      "Documents"
    ]
  },
  {
    "id": 1998,
    "db_id": "cre_Docs_and_Epenses",
    "question": "What is the name of document associated with an 'Open Project' statement, that shares a project ID with documents of type 'PP'?",
    "sql": "SELECT Document_Name FROM Documents WHERE Document_ID IN (SELECT Statement_ID FROM Statements WHERE Statement_Details = 'Open Project') AND Project_ID IN (SELECT Project_ID FROM Documents WHERE Document_Type_Code = 'PP');",
    "table_names": [
      "Documents",
      "Statements"
    ]
  },
  {
    "id": 1999,
    "db_id": "cre_Docs_and_Epenses",
    "question": "What is the name and date of the CV type document that is associated with an 'Open Project' statement?",
    "sql": "SELECT d.Document_Name, d.Document_Date FROM Documents d JOIN Statements s ON d.Document_ID = s.Statement_ID WHERE s.Statement_Details = 'Open Project' AND d.Document_Type_Code = 'CV';",
    "table_names": [
      "Documents",
      "Statements"
    ]
  },
  {
    "id": 2000,
    "db_id": "cre_Docs_and_Epenses",
    "question": "How many documents of type rated either 'excellent' or 'very good' were created in the period from 1980 to 2000 inclusive?",
    "sql": "SELECT COUNT(*) FROM Documents d JOIN Ref_Document_Types r ON d.Document_Type_Code = r.Document_Type_Code WHERE r.Document_Type_Description IN ('excellent', 'very good') AND d.Document_Date BETWEEN '1980-01-01' AND '2000-12-31';",
    "table_names": [
      "Ref_Document_Types",
      "Documents"
    ]
  },
  {
    "id": 2001,
    "db_id": "cre_Docs_and_Epenses",
    "question": "How many documents with a document type described as either 'excellent' or 'very good' were created between 1970 and 1990?",
    "sql": "SELECT COUNT(*) FROM Documents D JOIN Ref_Document_Types R ON D.Document_Type_Code = R.Document_Type_Code WHERE R.Document_Type_Description IN ('excellent', 'very good') AND D.Document_Date BETWEEN '1970-01-01' AND '1990-12-31';",
    "table_names": [
      "Ref_Document_Types",
      "Documents"
    ]
  },
  {
    "id": 2002,
    "db_id": "cre_Docs_and_Epenses",
    "question": "How many documents of type 'CV' are associated with projects that contain the word 'Research' in their descriptions?",
    "sql": "SELECT COUNT(*) FROM Documents d JOIN Projects p ON d.Project_ID = p.Project_ID WHERE p.Project_Details LIKE '%Research%' AND d.Document_Type_Code = 'CV';",
    "table_names": [
      "Projects",
      "Documents"
    ]
  },
  {
    "id": 2003,
    "db_id": "cre_Docs_and_Epenses",
    "question": "What is the name of the document of type 'BK' associated with the 'Internet of Things project'?",
    "sql": "SELECT Documents.Document_Name FROM Documents JOIN Projects ON Documents.Project_ID = Projects.Project_ID WHERE Documents.Document_Type_Code = 'BK' AND Projects.Project_Details = 'Internet of Things project';",
    "table_names": [
      "Projects",
      "Documents"
    ]
  },
  {
    "id": 2004,
    "db_id": "cre_Docs_and_Epenses",
    "question": "How many documents with Document_Type_Code 'CV' are associated with projects whose details contain the word 'Research'?",
    "sql": "SELECT COUNT(*) FROM Documents d INNER JOIN Projects p ON d.Project_ID = p.Project_ID WHERE p.Project_Details LIKE '%Research%' AND d.Document_Type_Code = 'CV';",
    "table_names": [
      "Projects",
      "Documents"
    ]
  },
  {
    "id": 2005,
    "db_id": "cre_Docs_and_Epenses",
    "question": "Which project has the most documents created after the year 2000, and how many documents does it have?",
    "sql": "SELECT Projects.Project_Details, COUNT(Documents.Document_ID) FROM Projects JOIN Documents ON Projects.Project_ID = Documents.Project_ID WHERE YEAR(Documents.Document_Date) > 2000 GROUP BY Projects.Project_Details ORDER BY COUNT(Documents.Document_ID) DESC LIMIT 1;",
    "table_names": [
      "Projects",
      "Documents"
    ]
  },
  {
    "id": 2006,
    "db_id": "cre_Docs_and_Epenses",
    "question": "How many documents with expenses are categorized under 'Government' budget type?",
    "sql": "SELECT COUNT(*) FROM Documents_with_Expenses de JOIN Ref_Budget_Codes rbc ON de.Budget_Type_Code = rbc.Budget_Type_Code WHERE rbc.Budget_Type_Description = 'Government';",
    "table_names": [
      "Ref_Budget_Codes",
      "Documents_with_Expenses"
    ]
  },
  {
    "id": 2007,
    "db_id": "cre_Docs_and_Epenses",
    "question": "How many expense documents are associated with a budget type described as 'Government'?",
    "sql": "SELECT COUNT(*) FROM Documents_with_Expenses d JOIN Ref_Budget_Codes r ON d.Budget_Type_Code = r.Budget_Type_Code WHERE r.Budget_Type_Description = 'Government';",
    "table_names": [
      "Ref_Budget_Codes",
      "Documents_with_Expenses"
    ]
  },
  {
    "id": 2008,
    "db_id": "cre_Docs_and_Epenses",
    "question": "How many documents have expenses listed under the budget type description 'Government'?",
    "sql": "SELECT COUNT(*) FROM Documents_with_Expenses INNER JOIN Ref_Budget_Codes ON Documents_with_Expenses.Budget_Type_Code = Ref_Budget_Codes.Budget_Type_Code WHERE Ref_Budget_Codes.Budget_Type_Description = 'Government';",
    "table_names": [
      "Ref_Budget_Codes",
      "Documents_with_Expenses"
    ]
  },
  {
    "id": 2009,
    "db_id": "cre_Docs_and_Epenses",
    "question": "How many documents with expenses are associated with the 'Government' budget type description?",
    "sql": "SELECT COUNT(*) FROM Documents_with_Expenses AS de JOIN Ref_Budget_Codes AS rb ON de.Budget_Type_Code = rb.Budget_Type_Code WHERE rb.Budget_Type_Description = 'Government';",
    "table_names": [
      "Ref_Budget_Codes",
      "Documents_with_Expenses"
    ]
  },
  {
    "id": 2010,
    "db_id": "cre_Docs_and_Epenses",
    "question": "How many documents of type 'BK' are associated with budget type 'GV'?",
    "sql": "SELECT COUNT(*) FROM Documents D JOIN Documents_with_Expenses DE ON D.Document_ID = DE.Document_ID WHERE D.Document_Type_Code = 'BK' AND DE.Budget_Type_Code = 'GV';",
    "table_names": [
      "Documents",
      "Documents_with_Expenses"
    ]
  },
  {
    "id": 2011,
    "db_id": "cre_Docs_and_Epenses",
    "question": "How many documents associated with project 105 have a government ('GV') budget type?",
    "sql": "SELECT COUNT(DISTINCT d.Document_ID) FROM Documents d INNER JOIN Documents_with_Expenses dwe ON d.Document_ID = dwe.Document_ID WHERE d.Project_ID = 105 AND dwe.Budget_Type_Code = 'GV';",
    "table_names": [
      "Documents",
      "Documents_with_Expenses"
    ]
  },
  {
    "id": 2012,
    "db_id": "cre_Docs_and_Epenses",
    "question": "What are the names of the documents associated with project ID 105 that have an 'organization' budget type?",
    "sql": "SELECT Documents.Document_Name FROM Documents JOIN Documents_with_Expenses ON Documents.Document_ID = Documents_with_Expenses.Document_ID WHERE Documents.Project_ID = 105 AND Documents_with_Expenses.Budget_Type_Code = 'ORG';",
    "table_names": [
      "Documents",
      "Documents_with_Expenses"
    ]
  },
  {
    "id": 2013,
    "db_id": "cre_Docs_and_Epenses",
    "question": "What is the name of the 'BK' type document associated with project 30 that has a budget type 'GV'?",
    "sql": "SELECT D.Document_Name FROM Documents D JOIN Documents_with_Expenses DE ON D.Document_ID = DE.Document_ID WHERE DE.Budget_Type_Code = 'GV' AND D.Document_Type_Code = 'BK' AND D.Project_ID = 30;",
    "table_names": [
      "Documents",
      "Documents_with_Expenses"
    ]
  },
  {
    "id": 2014,
    "db_id": "cre_Docs_and_Epenses",
    "question": "How many documents related to project ID 105 have a budget type code 'GV'?",
    "sql": "SELECT COUNT(*) FROM Documents WHERE Project_ID = 105 AND Document_ID IN (SELECT Document_ID FROM Documents_with_Expenses WHERE Budget_Type_Code = 'GV');",
    "table_names": [
      "Documents",
      "Documents_with_Expenses"
    ]
  },
  {
    "id": 2015,
    "db_id": "cre_Docs_and_Epenses",
    "question": "Among all documents of type 'BK' with a budget type of 'GV', what is the name and date of the earliest document?",
    "sql": "SELECT d.Document_Name, d.Document_Date FROM Documents d INNER JOIN Documents_with_Expenses de ON d.Document_ID = de.Document_ID WHERE de.Budget_Type_Code = 'GV' AND d.Document_Type_Code = 'BK' ORDER BY d.Document_Date ASC LIMIT 1;",
    "table_names": [
      "Documents",
      "Documents_with_Expenses"
    ]
  },
  {
    "id": 2016,
    "db_id": "cre_Docs_and_Epenses",
    "question": "What is the name of the document associated with project ID 105 that has a budget type code of 'ORG'?",
    "sql": "SELECT Documents.Document_Name FROM Documents JOIN Documents_with_Expenses ON Documents.Document_ID = Documents_with_Expenses.Document_ID WHERE Documents.Project_ID = 105 AND Documents_with_Expenses.Budget_Type_Code = 'ORG';",
    "table_names": [
      "Documents",
      "Documents_with_Expenses"
    ]
  },
  {
    "id": 2017,
    "db_id": "cre_Docs_and_Epenses",
    "question": "How many documents are of type 'BK' and have a budget type of 'GV'?",
    "sql": "SELECT COUNT(*) FROM Documents d JOIN Documents_with_Expenses de ON d.Document_ID = de.Document_ID WHERE d.Document_Type_Code = 'BK' AND de.Budget_Type_Code = 'GV';",
    "table_names": [
      "Documents",
      "Documents_with_Expenses"
    ]
  },
  {
    "id": 2018,
    "db_id": "scientist_1",
    "question": "How many distinct scientists are assigned to projects requiring more than 300 hours?",
    "sql": "SELECT COUNT(DISTINCT AssignedTo.Scientist) FROM AssignedTo INNER JOIN Projects ON AssignedTo.Project = Projects.Code WHERE Projects.Hours > 300;",
    "table_names": [
      "Projects",
      "AssignedTo"
    ]
  },
  {
    "id": 2019,
    "db_id": "scientist_1",
    "question": "List the name(s) of all projects assigned to the scientists with IDs 152934485 and 745685214.",
    "sql": "SELECT Projects.Name FROM Projects JOIN AssignedTo ON Projects.Code = AssignedTo.Project WHERE AssignedTo.Scientist = 152934485 OR AssignedTo.Scientist = 745685214;",
    "table_names": [
      "Projects",
      "AssignedTo"
    ]
  },
  {
    "id": 2020,
    "db_id": "scientist_1",
    "question": "Which projects are assigned to scientists who are working on more than one project, and what is the total number of hours dedicated to each of these projects, ordered by the project with the most hours?",
    "sql": "SELECT p.Name, SUM(p.Hours) AS TotalHours FROM Projects p INNER JOIN AssignedTo a ON p.Code = a.Project WHERE a.Scientist IN (SELECT Scientist FROM AssignedTo GROUP BY Scientist HAVING COUNT(Project) > 1) GROUP BY p.Name ORDER BY TotalHours DESC;",
    "table_names": [
      "Projects",
      "AssignedTo"
    ]
  },
  {
    "id": 2021,
    "db_id": "scientist_1",
    "question": "What is the total number of hours spent on projects assigned to the scientists with IDs 631231482 and 222364883?",
    "sql": "SELECT SUM(Projects.Hours) FROM Projects JOIN AssignedTo ON Projects.Code = AssignedTo.Project WHERE AssignedTo.Scientist = 631231482 OR AssignedTo.Scientist = 222364883;",
    "table_names": [
      "Projects",
      "AssignedTo"
    ]
  },
  {
    "id": 2022,
    "db_id": "scientist_1",
    "question": "Which project names are assigned to multiple scientists?",
    "sql": "SELECT Name FROM Projects WHERE Code IN (SELECT Project FROM AssignedTo GROUP BY Project HAVING COUNT(DISTINCT Scientist) > 1);",
    "table_names": [
      "Projects",
      "AssignedTo"
    ]
  },
  {
    "id": 2023,
    "db_id": "scientist_1",
    "question": "How many distinct scientists are working on projects that require more than 200 hours?",
    "sql": "SELECT COUNT(DISTINCT Scientist) FROM AssignedTo WHERE Project IN (SELECT Code FROM Projects WHERE Hours > 200);",
    "table_names": [
      "Projects",
      "AssignedTo"
    ]
  },
  {
    "id": 2024,
    "db_id": "scientist_1",
    "question": "Which project is scientist George ODonnell assigned to?",
    "sql": "SELECT Project FROM AssignedTo WHERE Scientist = (SELECT SSN FROM Scientists WHERE Name = 'George ODonnell');",
    "table_names": [
      "Scientists",
      "AssignedTo"
    ]
  },
  {
    "id": 2025,
    "db_id": "scientist_1",
    "question": "What are the names of the scientists assigned to project Ast3?",
    "sql": "SELECT Name FROM Scientists WHERE SSN IN (SELECT Scientist FROM AssignedTo WHERE Project = 'Ast3');",
    "table_names": [
      "Scientists",
      "AssignedTo"
    ]
  },
  {
    "id": 2026,
    "db_id": "scientist_1",
    "question": "How many unique projects are assigned to scientists having the surname 'Doe'?",
    "sql": "SELECT COUNT(DISTINCT Project) FROM AssignedTo WHERE Scientist IN (SELECT SSN FROM Scientists WHERE Name LIKE '%Doe%');",
    "table_names": [
      "Scientists",
      "AssignedTo"
    ]
  },
  {
    "id": 2027,
    "db_id": "scientist_1",
    "question": "List the names of scientists who are working on projects whose names start with 'Ast'.",
    "sql": "SELECT s.Name FROM Scientists s JOIN AssignedTo a ON s.SSN = a.Scientist WHERE a.Project LIKE 'Ast%';",
    "table_names": [
      "Scientists",
      "AssignedTo"
    ]
  },
  {
    "id": 2028,
    "db_id": "scientist_1",
    "question": "What is the total number of hours for the projects assigned to scientists who are working on more than one project?",
    "sql": "SELECT SUM(p.Hours) FROM Projects p JOIN AssignedTo a ON p.Code = a.Project WHERE a.Scientist IN (SELECT Scientist FROM AssignedTo GROUP BY Scientist HAVING COUNT(Project) > 1);",
    "table_names": [
      "Projects",
      "AssignedTo"
    ]
  },
  {
    "id": 2029,
    "db_id": "scientist_1",
    "question": "What is the total number of project hours for scientists who are assigned to more than one project?",
    "sql": "SELECT SUM(Projects.Hours) FROM Projects INNER JOIN AssignedTo ON Projects.Code = AssignedTo.Project WHERE AssignedTo.Scientist IN (SELECT AssignedTo.Scientist FROM AssignedTo GROUP BY AssignedTo.Scientist HAVING COUNT(DISTINCT AssignedTo.Project) > 1);",
    "table_names": [
      "Projects",
      "AssignedTo"
    ]
  },
  {
    "id": 2030,
    "db_id": "scientist_1",
    "question": "Which scientists are assigned to projects starting with 'Ast'?",
    "sql": "SELECT Name FROM Scientists WHERE SSN IN (SELECT Scientist FROM AssignedTo WHERE Project LIKE 'Ast%');",
    "table_names": [
      "Scientists",
      "AssignedTo"
    ]
  },
  {
    "id": 2031,
    "db_id": "scientist_1",
    "question": "What are the names of the scientists assigned to the project 'Ast3'?",
    "sql": "SELECT Name FROM Scientists WHERE SSN IN (SELECT Scientist FROM AssignedTo WHERE Project = 'Ast3');",
    "table_names": [
      "Scientists",
      "AssignedTo"
    ]
  },
  {
    "id": 2062,
    "db_id": "train_station",
    "question": "Which station has the highest number of trains, and how many platforms does it have?",
    "sql": "SELECT s.Name, COUNT(ts.Train_ID) AS Train_count, s.Number_of_Platforms FROM station s JOIN train_station ts ON s.Station_ID = ts.Station_ID GROUP BY s.Name, s.Number_of_Platforms ORDER BY Train_count DESC LIMIT 1;",
    "table_names": [
      "station",
      "train_station"
    ]
  },
  {
    "id": 2063,
    "db_id": "train_station",
    "question": "Which station has the highest number of trains stopping at it, and how many trains stop there compared to the number of platforms it has?",
    "sql": "SELECT s.Name, COUNT(ts.Train_ID) AS number_of_trains, s.Number_of_Platforms FROM station s JOIN train_station ts ON s.Station_ID = ts.Station_ID GROUP BY s.Name, s.Number_of_Platforms ORDER BY number_of_trains DESC LIMIT 1;",
    "table_names": [
      "station",
      "train_station"
    ]
  },
  {
    "id": 2064,
    "db_id": "train_station",
    "question": "Which station has the highest number of trains connected to it, and what are the main services provided by this station?",
    "sql": "SELECT s.Name, s.Main_Services FROM station s JOIN train_station ts ON s.Station_ID = ts.Station_ID GROUP BY s.Name, s.Main_Services ORDER BY COUNT(ts.Train_ID) DESC LIMIT 1;",
    "table_names": [
      "station",
      "train_station"
    ]
  },
  {
    "id": 2065,
    "db_id": "train_station",
    "question": "Which station has the highest number of trains operating from it?",
    "sql": "SELECT s.Name FROM station s JOIN train_station ts ON s.Station_ID = ts.Station_ID GROUP BY s.Station_ID ORDER BY COUNT(ts.Train_ID) DESC LIMIT 1;",
    "table_names": [
      "station",
      "train_station"
    ]
  },
  {
    "id": 2066,
    "db_id": "driving_school",
    "question": "What are the first and last names of staff members who joined before 2017 and reside in Georgia?",
    "sql": "SELECT S.first_name, S.last_name FROM Staff AS S JOIN Addresses AS A ON S.staff_address_id = A.address_id WHERE A.state_province_county = 'Georgia' AND S.date_joined_staff < '2017-01-01';",
    "table_names": [
      "Addresses",
      "Staff"
    ]
  },
  {
    "id": 2067,
    "db_id": "driving_school",
    "question": "What are the first and last names of staff members who live in Connecticut?",
    "sql": "SELECT first_name, last_name FROM Staff WHERE staff_address_id IN (SELECT address_id FROM Addresses WHERE state_province_county = 'Connecticut');",
    "table_names": [
      "Addresses",
      "Staff"
    ]
  },
  {
    "id": 2068,
    "db_id": "driving_school",
    "question": "Which staff members lived in Georgia and left the staff between March 1, 2018 and March 15, 2018?",
    "sql": "SELECT S.first_name, S.last_name FROM Staff AS S INNER JOIN Addresses AS A ON S.staff_address_id = A.address_id WHERE A.state_province_county = 'Georgia' AND S.date_left_staff BETWEEN '2018-03-01' AND '2018-03-15';",
    "table_names": [
      "Addresses",
      "Staff"
    ]
  },
  {
    "id": 2069,
    "db_id": "driving_school",
    "question": "Who are the staff members living in Kentucky, and in which cities do they reside, arranged alphabetically by their first names?",
    "sql": "SELECT s.first_name, s.last_name, a.city FROM Staff s JOIN Addresses a ON s.staff_address_id = a.address_id WHERE a.state_province_county = 'Kentucky' ORDER BY s.first_name;",
    "table_names": [
      "Addresses",
      "Staff"
    ]
  },
  {
    "id": 2070,
    "db_id": "driving_school",
    "question": "How many completed lessons are there for customers with the status 'Good Customer'?",
    "sql": "SELECT COUNT(*) FROM Lessons l INNER JOIN Customers c ON l.customer_id = c.customer_id WHERE c.customer_status_code = 'Good Customer' AND l.lesson_status_code = 'Completed';",
    "table_names": [
      "Customers",
      "Lessons"
    ]
  },
  {
    "id": 2071,
    "db_id": "driving_school",
    "question": "What is the name of the customer who completed the most expensive lesson?",
    "sql": "SELECT first_name, last_name FROM Customers WHERE customer_id = (SELECT customer_id FROM Lessons WHERE lesson_status_code = 'Completed' ORDER BY price DESC LIMIT 1)",
    "table_names": [
      "Customers",
      "Lessons"
    ]
  },
  {
    "id": 2072,
    "db_id": "driving_school",
    "question": "Which staff members born before the year 2000 reside in Georgia?",
    "sql": "SELECT s.first_name, s.last_name FROM Staff s JOIN Addresses a ON s.staff_address_id = a.address_id WHERE a.state_province_county = 'Georgia' AND s.date_of_birth < '2000-01-01';",
    "table_names": [
      "Addresses",
      "Staff"
    ]
  },
  {
    "id": 2073,
    "db_id": "driving_school",
    "question": "What are the first and last names of staff members who joined after January 1st, 2016 and are living in Kentucky?",
    "sql": "SELECT s.first_name, s.last_name FROM Staff AS s JOIN Addresses AS a ON s.staff_address_id = a.address_id WHERE a.state_province_county = 'Kentucky' AND s.date_joined_staff > '2016-01-01 00:00:00';",
    "table_names": [
      "Addresses",
      "Staff"
    ]
  },
  {
    "id": 2074,
    "db_id": "driving_school",
    "question": "What is the full address of the staff member with the earliest birthdate?",
    "sql": "SELECT line_1_number_building, city, zip_postcode, state_province_county, country FROM Addresses WHERE address_id = (SELECT staff_address_id FROM Staff ORDER BY date_of_birth ASC LIMIT 1)",
    "table_names": [
      "Addresses",
      "Staff"
    ]
  },
  {
    "id": 2075,
    "db_id": "driving_school",
    "question": "How many staff members live in the state of Connecticut?",
    "sql": "SELECT COUNT(*) FROM Staff s INNER JOIN Addresses a ON s.staff_address_id = a.address_id WHERE a.state_province_county = 'Connecticut';",
    "table_names": [
      "Addresses",
      "Staff"
    ]
  },
  {
    "id": 2076,
    "db_id": "driving_school",
    "question": "Which staff members joined after January 1, 2017, and live in Connecticut?",
    "sql": "SELECT s.first_name, s.last_name, s.nickname FROM Staff s JOIN Addresses a ON s.staff_address_id = a.address_id WHERE a.state_province_county = 'Connecticut' AND DATE(s.date_joined_staff) >= '2017-01-01';",
    "table_names": [
      "Addresses",
      "Staff"
    ]
  },
  {
    "id": 2077,
    "db_id": "driving_school",
    "question": "How many staff members are associated with addresses located in Kentucky?",
    "sql": "SELECT COUNT(*) FROM Staff WHERE staff_address_id IN (SELECT address_id FROM Addresses WHERE state_province_county = 'Kentucky');",
    "table_names": [
      "Addresses",
      "Staff"
    ]
  },
  {
    "id": 2078,
    "db_id": "driving_school",
    "question": "What are the first and last names of staff members who live in the state of Georgia, and in which cities do they reside?",
    "sql": "SELECT Staff.first_name, Staff.last_name, Addresses.city, Addresses.state_province_county FROM Staff JOIN Addresses ON Staff.staff_address_id = Addresses.address_id WHERE Addresses.state_province_county = 'Georgia';",
    "table_names": [
      "Addresses",
      "Staff"
    ]
  },
  {
    "id": 2079,
    "db_id": "driving_school",
    "question": "Which staff members who lived in Connecticut left the staff on or after March 1st, 2018?",
    "sql": "SELECT Staff.first_name, Staff.last_name FROM Staff INNER JOIN Addresses ON Staff.staff_address_id = Addresses.address_id WHERE Addresses.state_province_county = 'Connecticut' AND Staff.date_left_staff >= '2018-03-01 00:00:00';",
    "table_names": [
      "Addresses",
      "Staff"
    ]
  },
  {
    "id": 2080,
    "db_id": "driving_school",
    "question": "Which 'Bad Customer' has spent the most money on 'Completed' lessons, and what is the total amount spent?",
    "sql": "SELECT c.first_name, c.last_name, SUM(l.price) AS total_completed_lesson_price FROM Customers c JOIN Lessons l ON c.customer_id = l.customer_id WHERE c.customer_status_code = 'Bad Customer' AND l.lesson_status_code = 'Completed' GROUP BY c.customer_id ORDER BY total_completed_lesson_price DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Lessons"
    ]
  },
  {
    "id": 2081,
    "db_id": "driving_school",
    "question": "Among all 'Good Customers', who has completed the highest total priced lessons and what is the total number and cost of these completed lessons?",
    "sql": "SELECT first_name, last_name, COUNT(*) AS total_completed_lessons, SUM(price) AS total_spent FROM Customers INNER JOIN Lessons ON Customers.customer_id = Lessons.customer_id WHERE customer_status_code = 'Good Customer' AND lesson_status_code = 'Completed' GROUP BY Customers.customer_id ORDER BY total_spent DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Lessons"
    ]
  },
  {
    "id": 2082,
    "db_id": "driving_school",
    "question": "What are the names and outstanding amounts of all customers who are marked as 'Bad Customer' and reside in Kentucky?",
    "sql": "SELECT Customers.first_name, Customers.last_name, Customers.amount_outstanding FROM Customers JOIN Addresses ON Customers.customer_address_id = Addresses.address_id WHERE Addresses.state_province_county = 'Kentucky' AND Customers.customer_status_code = 'Bad Customer';",
    "table_names": [
      "Addresses",
      "Customers"
    ]
  },
  {
    "id": 2083,
    "db_id": "driving_school",
    "question": "Which customers living in Louisiana are classified as 'Bad Customer', and what is the amount outstanding for each?",
    "sql": "SELECT c.first_name, c.last_name, a.state_province_county, c.amount_outstanding FROM Customers c JOIN Addresses a ON c.customer_address_id = a.address_id WHERE a.state_province_county = 'Louisiana' AND c.customer_status_code = 'Bad Customer';",
    "table_names": [
      "Addresses",
      "Customers"
    ]
  },
  {
    "id": 2084,
    "db_id": "driving_school",
    "question": "Which city in Louisiana has the highest total amount outstanding from its customers?",
    "sql": "SELECT A.city, SUM(C.amount_outstanding) AS total_outstanding FROM Customers C JOIN Addresses A ON C.customer_address_id = A.address_id WHERE A.state_province_county = 'Louisiana' GROUP BY A.city ORDER BY total_outstanding DESC LIMIT 1;",
    "table_names": [
      "Addresses",
      "Customers"
    ]
  },
  {
    "id": 2085,
    "db_id": "driving_school",
    "question": "What are the cities where bad customers with an outstanding amount over $7000 reside?",
    "sql": "SELECT Addresses.city FROM Addresses JOIN Customers ON Addresses.address_id = Customers.customer_address_id WHERE Customers.customer_status_code = 'Bad Customer' AND Customers.amount_outstanding > 7000;",
    "table_names": [
      "Addresses",
      "Customers"
    ]
  },
  {
    "id": 2086,
    "db_id": "driving_school",
    "question": "What are the names and email addresses of bad customers residing in the state of Georgia?",
    "sql": "SELECT c.first_name, c.last_name, c.email_address FROM Customers c JOIN Addresses a ON c.customer_address_id = a.address_id WHERE a.state_province_county = 'Georgia' AND c.customer_status_code = 'Bad Customer'",
    "table_names": [
      "Addresses",
      "Customers"
    ]
  },
  {
    "id": 2087,
    "db_id": "driving_school",
    "question": "Who is the bad customer residing in Georgia with the highest outstanding amount, and what is the amount?",
    "sql": "SELECT c.first_name, c.last_name, c.amount_outstanding FROM Customers c JOIN Addresses a ON c.customer_address_id = a.address_id WHERE a.state_province_county = 'Georgia' AND c.customer_status_code = 'Bad Customer' ORDER BY c.amount_outstanding DESC LIMIT 1;",
    "table_names": [
      "Addresses",
      "Customers"
    ]
  },
  {
    "id": 2088,
    "db_id": "driving_school",
    "question": "What are the names of the 'Bad Customers' living in Connecticut?",
    "sql": "SELECT CONCAT(Customers.first_name, ' ', Customers.last_name) FROM Customers INNER JOIN Addresses ON Customers.customer_address_id = Addresses.address_id WHERE Addresses.state_province_county = 'Connecticut' AND Customers.customer_status_code = 'Bad Customer';",
    "table_names": [
      "Addresses",
      "Customers"
    ]
  },
  {
    "id": 2089,
    "db_id": "driving_school",
    "question": "What is the average outstanding amount for bad customers residing in Kentucky?",
    "sql": "SELECT AVG(c.amount_outstanding) FROM Customers c JOIN Addresses a ON c.customer_address_id = a.address_id WHERE a.state_province_county = 'Kentucky' AND c.customer_status_code = 'Bad Customer';",
    "table_names": [
      "Addresses",
      "Customers"
    ]
  },
  {
    "id": 2090,
    "db_id": "driving_school",
    "question": "Who is the 'Good Customer' with the highest total payment amount and what is this amount?",
    "sql": "SELECT c.first_name, c.last_name, SUM(cp.amount_payment) as total_payment FROM Customers c JOIN Customer_Payments cp ON c.customer_id = cp.customer_id WHERE c.customer_status_code = 'Good Customer' GROUP BY c.customer_id ORDER BY total_payment DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Customer_Payments"
    ]
  },
  {
    "id": 2091,
    "db_id": "driving_school",
    "question": "Which 'Bad Customer' status customers have total payments exceeding their outstanding amount, and what are their names and outstanding amounts?",
    "sql": "SELECT c.first_name, c.last_name, c.amount_outstanding, SUM(p.amount_payment) AS total_paid FROM Customers c JOIN Customer_Payments p ON c.customer_id = p.customer_id WHERE c.customer_status_code = 'Bad Customer' GROUP BY c.customer_id HAVING total_paid > c.amount_outstanding;",
    "table_names": [
      "Customers",
      "Customer_Payments"
    ]
  },
  {
    "id": 2092,
    "db_id": "driving_school",
    "question": "What is the first and last name of the customer who made the highest credit card payment amount?",
    "sql": "SELECT first_name, last_name FROM Customers WHERE customer_id = (SELECT customer_id FROM Customer_Payments WHERE payment_method_code = 'Credit Card' ORDER BY amount_payment DESC LIMIT 1)",
    "table_names": [
      "Customers",
      "Customer_Payments"
    ]
  },
  {
    "id": 2093,
    "db_id": "driving_school",
    "question": "Which 'Good Customer' has made the highest total payments through 'Direct Debit'?",
    "sql": "SELECT c.first_name, c.last_name, SUM(cp.amount_payment) AS total_payment FROM Customers c JOIN Customer_Payments cp ON c.customer_id = cp.customer_id WHERE c.customer_status_code = 'Good Customer' AND cp.payment_method_code = 'Direct Debit' GROUP BY c.customer_id ORDER BY total_payment DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Customer_Payments"
    ]
  },
  {
    "id": 2094,
    "db_id": "driving_school",
    "question": "Which 'Bad Customer' has made the largest total payments, and what is the total payment amount?",
    "sql": "SELECT c.first_name, c.last_name, SUM(cp.amount_payment) AS total_payments FROM Customers c JOIN Customer_Payments cp ON c.customer_id = cp.customer_id WHERE c.customer_status_code = 'Bad Customer' GROUP BY c.customer_id ORDER BY total_payments DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Customer_Payments"
    ]
  },
  {
    "id": 2095,
    "db_id": "driving_school",
    "question": "Which customers have made payments more than once using a Credit Card?",
    "sql": "SELECT first_name, last_name FROM Customers WHERE customer_id IN (SELECT customer_id FROM Customer_Payments WHERE payment_method_code = 'Credit Card' GROUP BY customer_id HAVING COUNT(DISTINCT datetime_payment) > 1);",
    "table_names": [
      "Customers",
      "Customer_Payments"
    ]
  },
  {
    "id": 2096,
    "db_id": "driving_school",
    "question": "Which staff member brought in the highest total revenue from completed lessons?",
    "sql": "SELECT s.first_name, s.last_name, SUM(l.price) AS total_revenue FROM Staff s INNER JOIN Lessons l ON s.staff_id = l.staff_id WHERE l.lesson_status_code = 'Completed' GROUP BY s.staff_id ORDER BY total_revenue DESC LIMIT 1;",
    "table_names": [
      "Staff",
      "Lessons"
    ]
  },
  {
    "id": 2097,
    "db_id": "driving_school",
    "question": "What is the full name of the staff member who has completed the highest number of lessons?",
    "sql": "SELECT S.first_name, S.middle_name, S.last_name FROM Staff S JOIN Lessons L ON S.staff_id = L.staff_id WHERE L.lesson_status_code = 'Completed' GROUP BY S.staff_id ORDER BY COUNT(L.lesson_id) DESC LIMIT 1;",
    "table_names": [
      "Staff",
      "Lessons"
    ]
  },
  {
    "id": 2098,
    "db_id": "driving_school",
    "question": "What are the full names of staff members who live at address id 1 and have completed at least one lesson?",
    "sql": "SELECT DISTINCT s.first_name, s.last_name FROM Staff s JOIN Lessons l ON s.staff_id = l.staff_id WHERE l.lesson_status_code = 'Completed' AND s.staff_address_id = 1;",
    "table_names": [
      "Staff",
      "Lessons"
    ]
  },
  {
    "id": 2099,
    "db_id": "driving_school",
    "question": "Which staff member has the most cancelled lessons and how many were cancelled?",
    "sql": "SELECT s.first_name, s.last_name, COUNT(l.lesson_id) as cancelled_lessons FROM Staff s JOIN Lessons l ON s.staff_id = l.staff_id WHERE l.lesson_status_code = 'Cancelled' GROUP BY s.staff_id ORDER BY cancelled_lessons DESC LIMIT 1;",
    "table_names": [
      "Staff",
      "Lessons"
    ]
  },
  {
    "id": 2100,
    "db_id": "driving_school",
    "question": "How many completed lessons were handled by staff members whose address ID is 1?",
    "sql": "SELECT COUNT(*) FROM Lessons INNER JOIN Staff ON Lessons.staff_id = Staff.staff_id WHERE Staff.staff_address_id = 1 AND Lessons.lesson_status_code = 'Completed';",
    "table_names": [
      "Staff",
      "Lessons"
    ]
  },
  {
    "id": 2101,
    "db_id": "driving_school",
    "question": "How many completed lessons were given by staff members whose address has an address_id of 1?",
    "sql": "SELECT COUNT(*) FROM Lessons l INNER JOIN Staff s ON l.staff_id = s.staff_id WHERE s.staff_address_id = 1 AND l.lesson_status_code = 'Completed';",
    "table_names": [
      "Staff",
      "Lessons"
    ]
  },
  {
    "id": 2102,
    "db_id": "driving_school",
    "question": "What is the average price of completed lessons that staff member with nickname 'gabe21' has conducted?",
    "sql": "SELECT AVG(L.price) FROM Lessons L JOIN Staff S ON L.staff_id = S.staff_id WHERE S.nickname = 'gabe21' AND L.lesson_status_code = 'Completed';",
    "table_names": [
      "Staff",
      "Lessons"
    ]
  },
  {
    "id": 2103,
    "db_id": "driving_school",
    "question": "Which staff member conducted the most completed lessons, and what was their average price per lesson?",
    "sql": "SELECT S.first_name, S.last_name, COUNT(L.lesson_id) AS completed_lessons, AVG(L.price) AS average_price FROM Staff AS S JOIN Lessons AS L ON S.staff_id = L.staff_id WHERE L.lesson_status_code = 'Completed' GROUP BY S.staff_id ORDER BY completed_lessons DESC LIMIT 1;",
    "table_names": [
      "Staff",
      "Lessons"
    ]
  },
  {
    "id": 2104,
    "db_id": "driving_school",
    "question": "Which 'Bad Customer' has completed the highest number of lessons?",
    "sql": "SELECT C.first_name, C.last_name, COUNT(L.lesson_id) FROM Customers AS C JOIN Lessons AS L ON C.customer_id = L.customer_id WHERE C.customer_status_code='Bad Customer' AND L.lesson_status_code='Completed' GROUP BY C.customer_id ORDER BY COUNT(L.lesson_id) DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Lessons"
    ]
  },
  {
    "id": 2105,
    "db_id": "driving_school",
    "question": "What is the total price of all completed lessons taken by good customers?",
    "sql": "SELECT SUM(L.price) FROM Customers AS C JOIN Lessons AS L ON C.customer_id = L.customer_id WHERE C.customer_status_code = 'Good Customer' AND L.lesson_status_code = 'Completed';",
    "table_names": [
      "Customers",
      "Lessons"
    ]
  },
  {
    "id": 2106,
    "db_id": "customer_complaints",
    "question": "Which staff member shares an address with the bad customer who has the highest outstanding amount, and what is that outstanding amount?",
    "sql": "SELECT s.first_name, s.last_name, c.amount_outstanding FROM Staff s JOIN Customers c ON s.staff_address_id = c.customer_address_id WHERE c.customer_status_code = 'Bad Customer' ORDER BY c.amount_outstanding DESC LIMIT 1;",
    "table_names": [
      "Staff",
      "Customers"
    ]
  },
  {
    "id": 2107,
    "db_id": "customer_complaints",
    "question": "How many unique staff members live at the same address as customers who are labeled as 'Bad Customer' and have an amount outstanding greater than 5000?",
    "sql": "SELECT COUNT(DISTINCT s.staff_id) FROM Staff s JOIN Customers c ON s.staff_address_id = c.customer_address_id WHERE c.customer_status_code = 'Bad Customer' AND c.amount_outstanding > 5000;",
    "table_names": [
      "Staff",
      "Customers"
    ]
  },
  {
    "id": 2108,
    "db_id": "driving_school",
    "question": "Which staff member completed the most earnings from lessons, and how many lessons did they complete?",
    "sql": "SELECT S.first_name, S.last_name, COUNT(L.lesson_id) as Completed_Lessons, SUM(L.price) as Total_Earnings FROM Staff S JOIN Lessons L ON S.staff_id = L.staff_id WHERE L.lesson_status_code = 'Completed' GROUP BY S.staff_id ORDER BY Total_Earnings DESC LIMIT 1;",
    "table_names": [
      "Staff",
      "Lessons"
    ]
  },
  {
    "id": 2109,
    "db_id": "driving_school",
    "question": "How many completed lessons were taught by staff members living at staff_address_id 1?",
    "sql": "SELECT COUNT(DISTINCT l.lesson_id) FROM Lessons l JOIN Staff s ON l.staff_id = s.staff_id WHERE s.staff_address_id = 1 AND l.lesson_status_code = 'Completed';",
    "table_names": [
      "Staff",
      "Lessons"
    ]
  },
  {
    "id": 2110,
    "db_id": "driving_school",
    "question": "What is the average price of all completed lessons for vehicles classified as 'Truck'?",
    "sql": "SELECT AVG(L.price) FROM Lessons L JOIN Vehicles V ON L.vehicle_id = V.vehicle_id WHERE V.vehicle_details = 'Truck' AND L.lesson_status_code = 'Completed';",
    "table_names": [
      "Vehicles",
      "Lessons"
    ]
  },
  {
    "id": 2183,
    "db_id": "tracking_orders",
    "question": "Which customer placed the earliest order with status 'On Road'?",
    "sql": "SELECT customer_name FROM Customers WHERE customer_id = (SELECT customer_id FROM Orders WHERE order_status = 'On Road' ORDER BY date_order_placed ASC LIMIT 1)",
    "table_names": [
      "Customers",
      "Orders"
    ]
  },
  {
    "id": 2184,
    "db_id": "tracking_orders",
    "question": "Who is the customer with the earliest placed order currently in 'Packing' status?",
    "sql": "SELECT customer_name FROM Customers WHERE customer_id = (SELECT customer_id FROM Orders WHERE order_status = 'Packing' ORDER BY date_order_placed ASC LIMIT 1);",
    "table_names": [
      "Customers",
      "Orders"
    ]
  },
  {
    "id": 2185,
    "db_id": "tracking_orders",
    "question": "What is the name of the customer who placed the earliest order currently with status 'On Road'?",
    "sql": "SELECT customer_name FROM Customers WHERE customer_id = (SELECT customer_id FROM Orders WHERE order_status = 'On Road' ORDER BY date_order_placed ASC LIMIT 1)",
    "table_names": [
      "Customers",
      "Orders"
    ]
  },
  {
    "id": 2186,
    "db_id": "tracking_orders",
    "question": "What is the name of the customer(s) whose order placed in the year 1974 currently has the packing status?",
    "sql": "SELECT customer_name FROM Customers WHERE customer_id IN (SELECT customer_id FROM Orders WHERE order_status = 'Packing' AND date_order_placed LIKE '1974%')",
    "table_names": [
      "Customers",
      "Orders"
    ]
  },
  {
    "id": 2187,
    "db_id": "tracking_orders",
    "question": "Who is the customer that placed the earliest order currently in 'Packing' status?",
    "sql": "SELECT customer_name FROM Customers WHERE customer_id = (SELECT customer_id FROM Orders WHERE order_status = 'Packing' ORDER BY date_order_placed ASC LIMIT 1)",
    "table_names": [
      "Customers",
      "Orders"
    ]
  },
  {
    "id": 2188,
    "db_id": "tracking_orders",
    "question": "List the names of customers who have placed orders with status 'Packing' after the year 2000.",
    "sql": "SELECT customer_name FROM Customers WHERE customer_id IN (SELECT customer_id FROM Orders WHERE order_status = 'Packing' AND date_order_placed > '2000-01-01');",
    "table_names": [
      "Customers",
      "Orders"
    ]
  },
  {
    "id": 2189,
    "db_id": "tracking_orders",
    "question": "List all customer names who have orders with status 'Packing' placed before the year 1980.",
    "sql": "SELECT customer_name FROM Customers WHERE customer_id IN (SELECT customer_id FROM Orders WHERE order_status = 'Packing' AND date_order_placed < '1980-01-01');",
    "table_names": [
      "Customers",
      "Orders"
    ]
  },
  {
    "id": 2190,
    "db_id": "tracking_orders",
    "question": "Which customers have more than one order currently in 'Packing' status?",
    "sql": "SELECT customer_name FROM Customers WHERE customer_id IN (SELECT customer_id FROM Orders WHERE order_status = 'Packing' GROUP BY customer_id HAVING COUNT(order_id) > 1);",
    "table_names": [
      "Customers",
      "Orders"
    ]
  },
  {
    "id": 2191,
    "db_id": "tracking_orders",
    "question": "How many orders with status either 'On Road' or 'Packing' were placed by customers whose details are 'rerum'?",
    "sql": "SELECT COUNT(DISTINCT Orders.order_id) FROM Orders JOIN Customers ON Orders.customer_id = Customers.customer_id WHERE Customers.customer_details = 'rerum' AND Orders.order_status IN ('On Road', 'Packing');",
    "table_names": [
      "Customers",
      "Orders"
    ]
  },
  {
    "id": 2192,
    "db_id": "tracking_orders",
    "question": "List the names of customers who placed an order with the status 'Packing' before the year 1980.",
    "sql": "SELECT customer_name FROM Customers WHERE customer_id IN (SELECT customer_id FROM Orders WHERE order_status = 'Packing' AND date_order_placed < '1980-01-01');",
    "table_names": [
      "Customers",
      "Orders"
    ]
  },
  {
    "id": 2193,
    "db_id": "tracking_orders",
    "question": "Which customer placed the earliest order with the status 'Shipped'?",
    "sql": "SELECT customer_name FROM Customers WHERE customer_id = (SELECT customer_id FROM Orders WHERE order_status='Shipped' ORDER BY date_order_placed ASC LIMIT 1);",
    "table_names": [
      "Customers",
      "Orders"
    ]
  },
  {
    "id": 2194,
    "db_id": "tracking_orders",
    "question": "What is the name of the customer who placed the earliest order?",
    "sql": "SELECT customer_name FROM Customers WHERE customer_id = (SELECT customer_id FROM Orders WHERE date_order_placed = (SELECT MIN(date_order_placed) FROM Orders));",
    "table_names": [
      "Customers",
      "Orders"
    ]
  },
  {
    "id": 2195,
    "db_id": "tracking_orders",
    "question": "What are the names of customers who placed orders before 1980 with an order status of 'Packing'?",
    "sql": "SELECT customer_name FROM Customers WHERE customer_id IN (SELECT customer_id FROM Orders WHERE order_status = 'Packing' AND date_order_placed < '1980-01-01');",
    "table_names": [
      "Customers",
      "Orders"
    ]
  },
  {
    "id": 2196,
    "db_id": "tracking_orders",
    "question": "What are the names of customers who have orders in 'Packing' status placed before January 1, 1980?",
    "sql": "SELECT customer_name FROM Customers WHERE customer_id IN (SELECT customer_id FROM Orders WHERE order_status = 'Packing' AND date_order_placed < '1980-01-01')",
    "table_names": [
      "Customers",
      "Orders"
    ]
  },
  {
    "id": 2197,
    "db_id": "tracking_orders",
    "question": "How many distinct orders have a status 'On Road' and contain at least one order item with the item status 'Payed'?",
    "sql": "SELECT COUNT(DISTINCT orders.order_id) FROM Orders orders INNER JOIN Order_Items order_items ON orders.order_id = order_items.order_id WHERE orders.order_status = 'On Road' AND order_items.order_item_status = 'Payed';",
    "table_names": [
      "Orders",
      "Order_Items"
    ]
  },
  {
    "id": 2198,
    "db_id": "tracking_orders",
    "question": "Which product_ids are associated with orders placed by customer_id 15 that currently have status 'On Road'?",
    "sql": "SELECT DISTINCT oi.product_id FROM Orders o JOIN Order_Items oi ON o.order_id = oi.order_id WHERE o.customer_id = 15 AND o.order_status = 'On Road';",
    "table_names": [
      "Orders",
      "Order_Items"
    ]
  },
  {
    "id": 2199,
    "db_id": "tracking_orders",
    "question": "List all customer names who have orders currently in 'Packing' status.",
    "sql": "SELECT customer_name FROM Customers WHERE customer_id IN (SELECT customer_id FROM Orders WHERE order_status = 'Packing')",
    "table_names": [
      "Customers",
      "Orders"
    ]
  },
  {
    "id": 2200,
    "db_id": "tracking_orders",
    "question": "Which customers have orders with a status of 'Packing' placed before 1980?",
    "sql": "SELECT customer_name FROM Customers WHERE customer_id IN (SELECT customer_id FROM Orders WHERE order_status = 'Packing' AND date_order_placed < '1980-01-01');",
    "table_names": [
      "Customers",
      "Orders"
    ]
  },
  {
    "id": 2201,
    "db_id": "tracking_orders",
    "question": "What are the names of customers who have placed orders with 'Packing' status before the year 1980?",
    "sql": "SELECT Customers.customer_name FROM Customers JOIN Orders ON Customers.customer_id = Orders.customer_id WHERE Orders.order_status = 'Packing' AND Orders.date_order_placed < '1980-01-01';",
    "table_names": [
      "Customers",
      "Orders"
    ]
  },
  {
    "id": 2202,
    "db_id": "tracking_orders",
    "question": "What is the name of the customer whose shipped order was placed earliest?",
    "sql": "SELECT customer_name FROM Customers WHERE customer_id = (SELECT customer_id FROM Orders WHERE order_status = 'Shipped' ORDER BY date_order_placed ASC LIMIT 1);",
    "table_names": [
      "Customers",
      "Orders"
    ]
  },
  {
    "id": 2203,
    "db_id": "tracking_orders",
    "question": "How many distinct customers currently have orders with status 'On Road' that were shipped before the year 2000?",
    "sql": "SELECT COUNT(DISTINCT Orders.customer_id) FROM Orders INNER JOIN Shipments ON Orders.order_id = Shipments.order_id WHERE Orders.order_status = 'On Road' AND Shipments.shipment_date < '2000-01-01';",
    "table_names": [
      "Orders",
      "Shipments"
    ]
  },
  {
    "id": 2204,
    "db_id": "tracking_orders",
    "question": "Which customer with orders currently 'On Road' has the highest number of associated shipments, and how many shipments do they have?",
    "sql": "SELECT o.customer_id, COUNT(DISTINCT s.shipment_id) FROM Orders o JOIN Shipments s ON o.order_id = s.order_id WHERE o.order_status = 'On Road' GROUP BY o.customer_id ORDER BY COUNT(DISTINCT s.shipment_id) DESC LIMIT 1;",
    "table_names": [
      "Orders",
      "Shipments"
    ]
  },
  {
    "id": 2205,
    "db_id": "tracking_orders",
    "question": "How many orders with 'On Road' status have shipment dates before the year 2000?",
    "sql": "SELECT COUNT(DISTINCT o.order_id) FROM Orders o JOIN Shipments s ON o.order_id = s.order_id WHERE o.order_status = 'On Road' AND s.shipment_date < '2000-01-01';",
    "table_names": [
      "Orders",
      "Shipments"
    ]
  },
  {
    "id": 2206,
    "db_id": "tracking_orders",
    "question": "How many distinct customers have orders with status 'Packing' that were shipped before the year 1990?",
    "sql": "SELECT COUNT(DISTINCT Orders.customer_id) FROM Orders INNER JOIN Shipments ON Orders.order_id = Shipments.order_id WHERE Orders.order_status = 'Packing' AND Shipments.shipment_date < '1990-01-01';",
    "table_names": [
      "Orders",
      "Shipments"
    ]
  },
  {
    "id": 2207,
    "db_id": "tracking_orders",
    "question": "How many distinct orders are currently in 'On Road' status and have at least one order item with status 'Payed'?",
    "sql": "SELECT COUNT(DISTINCT o.order_id) FROM Orders o JOIN Order_Items oi ON o.order_id = oi.order_id WHERE o.order_status='On Road' AND oi.order_item_status='Payed';",
    "table_names": [
      "Orders",
      "Order_Items"
    ]
  },
  {
    "id": 2208,
    "db_id": "tracking_orders",
    "question": "How many unique products have a 'Payed' status in order items belonging to orders with 'On Road' status?",
    "sql": "SELECT COUNT(DISTINCT oi.product_id) FROM Orders o JOIN Order_Items oi ON o.order_id = oi.order_id WHERE o.order_status = 'On Road' AND oi.order_item_status = 'Payed';",
    "table_names": [
      "Orders",
      "Order_Items"
    ]
  },
  {
    "id": 2209,
    "db_id": "tracking_orders",
    "question": "Which customer placed the highest number of orders?",
    "sql": "SELECT c.customer_name, COUNT(o.order_id) AS total_orders FROM Customers c INNER JOIN Orders o ON c.customer_id = o.customer_id GROUP BY c.customer_name ORDER BY total_orders DESC LIMIT 1;",
    "table_names": [
      "Customers",
      "Orders"
    ]
  },
  {
    "id": 2210,
    "db_id": "tracking_orders",
    "question": "Which customer placed the earliest order that has already been shipped?",
    "sql": "SELECT customer_name FROM Customers WHERE customer_id = (SELECT customer_id FROM Orders WHERE order_status = 'Shipped' ORDER BY date_order_placed ASC LIMIT 1);",
    "table_names": [
      "Customers",
      "Orders"
    ]
  },
  {
    "id": 2211,
    "db_id": "tracking_orders",
    "question": "What is the name of the customer who placed the earliest order that is still in packing status?",
    "sql": "SELECT customer_name FROM Customers WHERE customer_id = (SELECT customer_id FROM Orders WHERE order_status = 'Packing' ORDER BY date_order_placed ASC LIMIT 1);",
    "table_names": [
      "Customers",
      "Orders"
    ]
  },
  {
    "id": 2212,
    "db_id": "tracking_orders",
    "question": "Who is the customer with the earliest 'Packing' status order?",
    "sql": "SELECT customer_name FROM Customers WHERE customer_id = (SELECT customer_id FROM Orders WHERE order_status = 'Packing' ORDER BY date_order_placed ASC LIMIT 1);",
    "table_names": [
      "Customers",
      "Orders"
    ]
  },
  {
    "id": 2213,
    "db_id": "tracking_orders",
    "question": "Who was the first customer in chronological order to have an order status marked as 'Shipped'?",
    "sql": "SELECT C.customer_name FROM Customers C JOIN Orders O ON C.customer_id = O.customer_id WHERE O.order_status = 'Shipped' ORDER BY O.date_order_placed ASC LIMIT 1;",
    "table_names": [
      "Customers",
      "Orders"
    ]
  },
  {
    "id": 2214,
    "db_id": "tracking_orders",
    "question": "What is the name of the customer who placed the earliest order among all orders with status 'Shipped'?",
    "sql": "SELECT customer_name FROM Customers WHERE customer_id = (SELECT customer_id FROM Orders WHERE order_status = 'Shipped' ORDER BY date_order_placed ASC LIMIT 1)",
    "table_names": [
      "Customers",
      "Orders"
    ]
  },
  {
    "id": 2215,
    "db_id": "architecture",
    "question": "Who is the architect responsible for designing the longest bridge located in China?",
    "sql": "SELECT architect.name FROM architect INNER JOIN bridge ON architect.id = bridge.architect_id WHERE bridge.location LIKE '%China%' ORDER BY bridge.length_meters DESC LIMIT 1;",
    "table_names": [
      "architect",
      "bridge"
    ]
  },
  {
    "id": 2216,
    "db_id": "architecture",
    "question": "Who are the architects who have designed at least two mills of type 'Grondzeiler'?",
    "sql": "SELECT architect.name FROM architect JOIN mill ON architect.id = mill.architect_id WHERE mill.type = 'Grondzeiler' GROUP BY architect.name HAVING COUNT(*) >= 2;",
    "table_names": [
      "architect",
      "mill"
    ]
  },
  {
    "id": 2217,
    "db_id": "architecture",
    "question": "Which architects designed mills of type 'Grondzeiler' built before 1850?",
    "sql": "SELECT architect.name FROM architect INNER JOIN mill ON architect.id = mill.architect_id WHERE mill.type = 'Grondzeiler' AND mill.built_year < 1850;",
    "table_names": [
      "architect",
      "mill"
    ]
  },
  {
    "id": 2218,
    "db_id": "architecture",
    "question": "Which male architect designed the highest number of bridges?",
    "sql": "SELECT architect.name, COUNT(bridge.id) FROM architect JOIN bridge ON architect.id = bridge.architect_id WHERE architect.gender = 'male' GROUP BY architect.id ORDER BY COUNT(bridge.id) DESC LIMIT 1;",
    "table_names": [
      "architect",
      "bridge"
    ]
  },
  {
    "id": 2219,
    "db_id": "architecture",
    "question": "Which architect designed the oldest mill and what is the architect's name?",
    "sql": "SELECT architect.name FROM architect JOIN mill ON architect.id = mill.architect_id WHERE mill.built_year = (SELECT MIN(built_year) FROM mill);",
    "table_names": [
      "architect",
      "mill"
    ]
  },
  {
    "id": 2220,
    "db_id": "architecture",
    "question": "Who is the architect that designed the oldest mill and what is the name of this architect?",
    "sql": "SELECT architect.name FROM architect JOIN mill ON architect.id = mill.architect_id WHERE mill.built_year = (SELECT MIN(built_year) FROM mill)",
    "table_names": [
      "architect",
      "mill"
    ]
  },
  {
    "id": 2221,
    "db_id": "architecture",
    "question": "Which architect designed the highest number of bridges, and how many bridges did they design?",
    "sql": "SELECT a.name, COUNT(b.id) AS bridge_count FROM architect a JOIN bridge b ON a.id = b.architect_id GROUP BY a.id ORDER BY bridge_count DESC LIMIT 1;",
    "table_names": [
      "architect",
      "bridge"
    ]
  },
  {
    "id": 2222,
    "db_id": "culture_company",
    "question": "Who are the authors or editors of books that won awards and are associated with a culture company incorporated in China?",
    "sql": "SELECT bc.Author_or_Editor FROM book_club bc JOIN culture_company cc ON bc.book_club_id = cc.book_club_id WHERE bc.Result LIKE 'Won%' AND cc.Incorporated_in = 'China';",
    "table_names": [
      "book_club",
      "culture_company"
    ]
  },
  {
    "id": 2223,
    "db_id": "culture_company",
    "question": "List the names of subsidiaries incorporated in Hong Kong that are associated with books nominated (not won) under the 'Gay M/SF' category in 1989.",
    "sql": "SELECT cc.Company_name FROM culture_company AS cc JOIN book_club AS bc ON cc.book_club_id = bc.book_club_id WHERE cc.Type = 'Subsidiary' AND cc.Incorporated_in = 'Hong Kong' AND bc.Year = 1989 AND bc.Category = 'Gay M/SF' AND bc.Result = 'Nom';",
    "table_names": [
      "book_club",
      "culture_company"
    ]
  },
  {
    "id": 2224,
    "db_id": "culture_company",
    "question": "List the titles of the movies along with the company names and countries of incorporation for any Joint Venture companies involved, where each movie earned less than 1 million gross worldwide.",
    "sql": "SELECT movie.Title, culture_company.Company_name, culture_company.Incorporated_in FROM movie JOIN culture_company ON movie.movie_id = culture_company.movie_id WHERE movie.Gross_worldwide < 1000000 AND culture_company.Type = 'Joint Venture';",
    "table_names": [
      "movie",
      "culture_company"
    ]
  },
  {
    "id": 2225,
    "db_id": "culture_company",
    "question": "What was the average budget in million dollars for films produced in the year 2000 by companies incorporated in Hong Kong?",
    "sql": "SELECT AVG(movie.Budget_million) FROM movie JOIN culture_company ON movie.movie_id = culture_company.movie_id WHERE culture_company.Incorporated_in = 'Hong Kong' AND movie.Year = 2000;",
    "table_names": [
      "movie",
      "culture_company"
    ]
  },
  {
    "id": 2226,
    "db_id": "concert_singer",
    "question": "What is the name of the stadium where the concert with theme 'Bleeding Love' was held in the year 2015?",
    "sql": "SELECT s.Name FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Theme = 'Bleeding Love' AND c.Year = '2015';",
    "table_names": [
      "stadium",
      "concert"
    ]
  },
  {
    "id": 2227,
    "db_id": "concert_singer",
    "question": "What is the name of the stadium with the highest capacity that hosted a concert in 2015?",
    "sql": "SELECT s.Name FROM stadium AS s JOIN concert AS c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year = '2015' AND s.Capacity = (SELECT MAX(Capacity) FROM stadium AS s JOIN concert AS c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year = '2015');",
    "table_names": [
      "stadium",
      "concert"
    ]
  },
  {
    "id": 2228,
    "db_id": "concert_singer",
    "question": "What is the name of the stadium that hosted the concert with the theme 'Bleeding Love'?",
    "sql": "SELECT stadium.Name FROM stadium JOIN concert ON stadium.Stadium_ID = concert.Stadium_ID WHERE concert.Theme = 'Bleeding Love';",
    "table_names": [
      "stadium",
      "concert"
    ]
  },
  {
    "id": 2229,
    "db_id": "concert_singer",
    "question": "Which stadiums hosted concerts in 2015 and have a capacity greater than 3500?",
    "sql": "SELECT stadium.Name FROM stadium JOIN concert ON stadium.Stadium_ID = concert.Stadium_ID WHERE concert.Year = '2015' AND stadium.Capacity > 3500;",
    "table_names": [
      "stadium",
      "concert"
    ]
  },
  {
    "id": 2230,
    "db_id": "concert_singer",
    "question": "What is the name of the stadium with a capacity greater than 10,000 that hosted a concert with the theme 'Bleeding Love'?",
    "sql": "SELECT stadium.Name FROM stadium INNER JOIN concert ON stadium.Stadium_ID = concert.Stadium_ID WHERE concert.Theme = 'Bleeding Love' AND stadium.Capacity > 10000;",
    "table_names": [
      "stadium",
      "concert"
    ]
  },
  {
    "id": 2231,
    "db_id": "concert_singer",
    "question": "What is the name of the stadium that hosted a concert with the theme 'Bleeding Love' in the year 2015?",
    "sql": "SELECT s.Name FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Theme = 'Bleeding Love' AND c.Year = '2015';",
    "table_names": [
      "stadium",
      "concert"
    ]
  },
  {
    "id": 2232,
    "db_id": "concert_singer",
    "question": "What is the name of the stadium where the concert with the theme 'Bleeding Love' was held?",
    "sql": "SELECT s.Name FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Theme = 'Bleeding Love';",
    "table_names": [
      "stadium",
      "concert"
    ]
  },
  {
    "id": 2233,
    "db_id": "concert_singer",
    "question": "What concerts occurred at the stadium with the highest capacity and what was their theme?",
    "sql": "SELECT c.concert_Name, c.Theme FROM concert AS c JOIN stadium AS s ON c.Stadium_ID = s.Stadium_ID WHERE s.Capacity = (SELECT MAX(Capacity) FROM stadium);",
    "table_names": [
      "stadium",
      "concert"
    ]
  },
  {
    "id": 2234,
    "db_id": "concert_singer",
    "question": "How many unique singers participated in concerts held in stadium ID 1 or 2 during the year 2014?",
    "sql": "SELECT COUNT(DISTINCT sc.Singer_ID) FROM singer_in_concert sc JOIN concert c ON sc.concert_ID = c.concert_ID WHERE c.Year = '2014' AND c.Stadium_ID IN ('1', '2');",
    "table_names": [
      "concert",
      "singer_in_concert"
    ]
  },
  {
    "id": 2235,
    "db_id": "concert_singer",
    "question": "Which concert IDs in 2015 featured at least one singer who performed in a concert in 2014?",
    "sql": "SELECT DISTINCT concert_ID FROM singer_in_concert WHERE Singer_ID IN (SELECT Singer_ID FROM singer_in_concert WHERE concert_ID IN (SELECT concert_ID FROM concert WHERE Year='2014')) AND concert_ID IN (SELECT concert_ID FROM concert WHERE Year='2015');",
    "table_names": [
      "concert",
      "singer_in_concert"
    ]
  },
  {
    "id": 2236,
    "db_id": "concert_singer",
    "question": "List the names of singers from France who have performed in at least one concert with the singer whose Singer_ID is '2'.",
    "sql": "SELECT DISTINCT s.Name FROM singer s JOIN singer_in_concert sic ON s.Singer_ID = sic.Singer_ID WHERE s.Country='France' AND sic.concert_ID IN (SELECT concert_ID FROM singer_in_concert WHERE Singer_ID = '2');",
    "table_names": [
      "singer",
      "singer_in_concert"
    ]
  },
  {
    "id": 2237,
    "db_id": "concert_singer",
    "question": "List the names of male singers from France who performed in concerts with 'Justin Brown'.",
    "sql": "SELECT DISTINCT s.Name FROM singer s JOIN singer_in_concert sc ON s.Singer_ID = sc.Singer_ID WHERE s.Country = 'France' AND s.Is_male = 'T' AND sc.concert_ID IN (SELECT concert_ID FROM singer_in_concert WHERE Singer_ID = (SELECT Singer_ID FROM singer WHERE Name = 'Justin Brown'));",
    "table_names": [
      "singer",
      "singer_in_concert"
    ]
  },
  {
    "id": 2238,
    "db_id": "concert_singer",
    "question": "What stadiums with a capacity greater than 5000 hosted concerts in the year 2014?",
    "sql": "SELECT stadium.Name FROM stadium JOIN concert ON stadium.Stadium_ID = concert.Stadium_ID WHERE concert.Year = '2014' AND stadium.Capacity > 5000;",
    "table_names": [
      "stadium",
      "concert"
    ]
  },
  {
    "id": 2239,
    "db_id": "concert_singer",
    "question": "What is the name of the stadium located in Peterhead which hosted a concert in the year 2015?",
    "sql": "SELECT s.Name FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Year = '2015' AND s.Location = 'Peterhead';",
    "table_names": [
      "stadium",
      "concert"
    ]
  },
  {
    "id": 2240,
    "db_id": "concert_singer",
    "question": "What is the name of the stadium hosting concerts with the theme 'Bleeding Love' that has a capacity greater than 10,000?",
    "sql": "SELECT s.Name FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Theme = 'Bleeding Love' AND s.Capacity > 10000;",
    "table_names": [
      "stadium",
      "concert"
    ]
  },
  {
    "id": 2241,
    "db_id": "concert_singer",
    "question": "What is the stadium name where a concert with the theme 'Bleeding Love' took place in 2015?",
    "sql": "SELECT s.Name FROM stadium s JOIN concert c ON s.Stadium_ID = c.Stadium_ID WHERE c.Theme = 'Bleeding Love' AND c.Year = '2015';",
    "table_names": [
      "stadium",
      "concert"
    ]
  },
  {
    "id": 2254,
    "db_id": "car_1",
    "question": "How many countries are in the continent america?",
    "sql": "SELECT COUNT(*) FROM countries WHERE Continent = (SELECT ContId FROM continents WHERE Continent = 'america')",
    "table_names": [
      "continents",
      "countries"
    ]
  },
  {
    "id": 2255,
    "db_id": "car_1",
    "question": "Which continent has the most number of countries listed?",
    "sql": "SELECT continents.Continent FROM continents JOIN countries ON continents.ContId = countries.Continent GROUP BY continents.Continent ORDER BY COUNT(countries.CountryId) DESC LIMIT 1;",
    "table_names": [
      "continents",
      "countries"
    ]
  },
  {
    "id": 2320,
    "db_id": "employee_hire_evaluation",
    "question": "Which employees from Bristol received a bonus of at least 3000, and what were their awarded bonuses?",
    "sql": "SELECT employee.Name, employee.City, evaluation.Bonus FROM employee JOIN evaluation ON employee.Employee_ID = CAST(evaluation.Employee_ID AS INTEGER) WHERE employee.City = 'Bristol' AND evaluation.Bonus >= 3000;",
    "table_names": [
      "employee",
      "evaluation"
    ]
  },
  {
    "id": 2321,
    "db_id": "employee_hire_evaluation",
    "question": "What is the average bonus awarded to employees from Bristol?",
    "sql": "SELECT AVG(evaluation.Bonus) FROM employee JOIN evaluation ON employee.Employee_ID = evaluation.Employee_ID WHERE employee.City = 'Bristol';",
    "table_names": [
      "employee",
      "evaluation"
    ]
  },
  {
    "id": 2322,
    "db_id": "employee_hire_evaluation",
    "question": "What is the average bonus of employees who live in the city of Bristol?",
    "sql": "SELECT AVG(evaluation.Bonus) FROM employee JOIN evaluation ON employee.Employee_ID = evaluation.Employee_ID WHERE employee.City = 'Bristol';",
    "table_names": [
      "employee",
      "evaluation"
    ]
  },
  {
    "id": 2323,
    "db_id": "employee_hire_evaluation",
    "question": "Which employees from Bath received bonuses from the year 2015 onwards, and how much did they receive?",
    "sql": "SELECT employee.Name, evaluation.Bonus FROM employee JOIN evaluation ON employee.Employee_ID = CAST(evaluation.Employee_ID AS INTEGER) WHERE employee.City = 'Bath' AND evaluation.Year_awarded >= 2015;",
    "table_names": [
      "employee",
      "evaluation"
    ]
  },
  {
    "id": 2324,
    "db_id": "employee_hire_evaluation",
    "question": "What is the average bonus awarded to employees from the city of Bristol?",
    "sql": "SELECT AVG(evaluation.Bonus) FROM evaluation JOIN employee ON evaluation.Employee_ID = employee.Employee_ID WHERE employee.City = 'Bristol';",
    "table_names": [
      "employee",
      "evaluation"
    ]
  },
  {
    "id": 2325,
    "db_id": "employee_hire_evaluation",
    "question": "Who received the highest bonus in the year 2016 and what was their name?",
    "sql": "SELECT e.Name FROM employee e JOIN evaluation ev ON e.Employee_ID = CAST(ev.Employee_ID AS INTEGER) WHERE ev.Bonus = (SELECT MAX(Bonus) FROM evaluation) AND ev.Year_awarded = '2016';",
    "table_names": [
      "employee",
      "evaluation"
    ]
  },
  {
    "id": 2326,
    "db_id": "employee_hire_evaluation",
    "question": "Which shops have more than 5000 products and employ any part-time staff?",
    "sql": "SELECT s.Name FROM shop s JOIN hiring h ON s.Shop_ID = h.Shop_ID WHERE s.Number_products > 5000 AND h.Is_full_time = 'F';",
    "table_names": [
      "shop",
      "hiring"
    ]
  },
  {
    "id": 2327,
    "db_id": "employee_hire_evaluation",
    "question": "What are the district names of shops that have hired part-time employees?",
    "sql": "SELECT s.District FROM shop s JOIN hiring h ON s.Shop_ID = h.Shop_ID WHERE h.Is_full_time = 'F';",
    "table_names": [
      "shop",
      "hiring"
    ]
  },
  {
    "id": 2328,
    "db_id": "employee_hire_evaluation",
    "question": "Which shops have part-time employees and more than 10,000 products?",
    "sql": "SELECT s.Name FROM shop s INNER JOIN hiring h ON s.Shop_ID = h.Shop_ID WHERE h.Is_full_time = 'F' AND s.Number_products > 10000;",
    "table_names": [
      "shop",
      "hiring"
    ]
  },
  {
    "id": 2329,
    "db_id": "employee_hire_evaluation",
    "question": "What is the average number of products in shops that have at least one full-time employee?",
    "sql": "SELECT AVG(s.Number_products) FROM shop s JOIN hiring h ON s.Shop_ID = h.Shop_ID WHERE h.Is_full_time = 'T';",
    "table_names": [
      "shop",
      "hiring"
    ]
  },
  {
    "id": 2330,
    "db_id": "employee_hire_evaluation",
    "question": "Which shop names have more than 4000 products and have at least one employee employed full-time?",
    "sql": "SELECT shop.Name FROM shop JOIN hiring ON shop.Shop_ID = hiring.Shop_ID WHERE shop.Number_products > 4000 AND hiring.Is_full_time = 'T';",
    "table_names": [
      "shop",
      "hiring"
    ]
  },
  {
    "id": 2331,
    "db_id": "employee_hire_evaluation",
    "question": "What is the name of the shop which has hired part-time employees and has more than 5000 products?",
    "sql": "SELECT shop.Name FROM shop INNER JOIN hiring ON shop.Shop_ID = hiring.Shop_ID WHERE hiring.Is_full_time = 'F' AND CAST(shop.Number_products AS INTEGER) > 5000;",
    "table_names": [
      "shop",
      "hiring"
    ]
  },
  {
    "id": 2350,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "How many different paragraphs are included in documents that have the document description marked as 'y'?",
    "sql": "SELECT COUNT(DISTINCT Paragraphs.Paragraph_Text) FROM Documents JOIN Paragraphs ON Documents.Document_ID = Paragraphs.Document_ID WHERE Documents.Document_Description = 'y';",
    "table_names": [
      "Documents",
      "Paragraphs"
    ]
  },
  {
    "id": 2351,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "What are the names of the Documents which have paragraphs mentioning 'Korea' and have the document description labeled as 'y'?",
    "sql": "SELECT Document_Name FROM Documents WHERE Document_ID IN (SELECT Document_ID FROM Paragraphs WHERE Paragraph_Text = 'Korea') AND Document_Description = 'y';",
    "table_names": [
      "Documents",
      "Paragraphs"
    ]
  },
  {
    "id": 2352,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "What is the name of the document containing paragraphs mentioning 'Korea'?",
    "sql": "SELECT Document_Name FROM Documents WHERE Document_ID IN (SELECT Document_ID FROM Paragraphs WHERE Paragraph_Text = 'Korea');",
    "table_names": [
      "Documents",
      "Paragraphs"
    ]
  },
  {
    "id": 2353,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "What is the name of the document containing a paragraph about Ukraine?",
    "sql": "SELECT Documents.Document_Name FROM Documents JOIN Paragraphs ON Documents.Document_ID = Paragraphs.Document_ID WHERE Paragraphs.Paragraph_Text = 'Ukraine';",
    "table_names": [
      "Documents",
      "Paragraphs"
    ]
  },
  {
    "id": 2354,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "What are the names of documents whose descriptions are marked as 'y' and include paragraphs mentioning 'Korea'?",
    "sql": "SELECT DISTINCT d.Document_Name FROM Documents d JOIN Paragraphs p ON d.Document_ID = p.Document_ID WHERE d.Document_Description = 'y' AND p.Paragraph_Text = 'Korea';",
    "table_names": [
      "Documents",
      "Paragraphs"
    ]
  },
  {
    "id": 2355,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "List the names of documents that contain paragraphs mentioning 'Korea' and have a document description marked as 'y'.",
    "sql": "SELECT d.Document_Name FROM Documents d JOIN Paragraphs p ON d.Document_ID = p.Document_ID WHERE p.Paragraph_Text = 'Korea' AND d.Document_Description = 'y';",
    "table_names": [
      "Documents",
      "Paragraphs"
    ]
  },
  {
    "id": 2356,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "What is the name of the document that contains paragraphs about 'Korea' and has a document description marked as 'y'?",
    "sql": "SELECT d.Document_Name FROM Documents d JOIN Paragraphs p ON d.Document_ID = p.Document_ID WHERE p.Paragraph_Text = 'Korea' AND d.Document_Description = 'y';",
    "table_names": [
      "Documents",
      "Paragraphs"
    ]
  },
  {
    "id": 2357,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "What is the name of the document that contains a paragraph mentioning 'Ukraine'?",
    "sql": "SELECT Document_Name FROM Documents WHERE Document_ID IN (SELECT Document_ID FROM Paragraphs WHERE Paragraph_Text = 'Ukraine');",
    "table_names": [
      "Documents",
      "Paragraphs"
    ]
  },
  {
    "id": 2358,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "How many unique documents with description 'y' contain paragraphs mentioning either Korea or Ukraine?",
    "sql": "SELECT COUNT(DISTINCT d.Document_ID) FROM Documents d JOIN Paragraphs p ON d.Document_ID = p.Document_ID WHERE d.Document_Description = 'y' AND p.Paragraph_Text IN ('Korea', 'Ukraine');",
    "table_names": [
      "Documents",
      "Paragraphs"
    ]
  },
  {
    "id": 2359,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "What are the names of the documents that contain paragraphs mentioning 'Korea'?",
    "sql": "SELECT Document_Name FROM Documents WHERE Document_ID IN (SELECT Document_ID FROM Paragraphs WHERE Paragraph_Text = 'Korea');",
    "table_names": [
      "Documents",
      "Paragraphs"
    ]
  },
  {
    "id": 2360,
    "db_id": "course_teach",
    "question": "What is the name of the teacher who is assigned to teach the class with the highest grade?",
    "sql": "SELECT t.Name FROM teacher AS t JOIN course_arrange AS ca ON t.Teacher_ID = ca.Teacher_ID WHERE ca.Grade = (SELECT MAX(Grade) FROM course_arrange);",
    "table_names": [
      "teacher",
      "course_arrange"
    ]
  },
  {
    "id": 2361,
    "db_id": "course_teach",
    "question": "Which teachers older than 30 years are teaching courses in grades lower than 4?",
    "sql": "SELECT t.Name FROM teacher AS t JOIN course_arrange AS ca ON t.Teacher_ID = ca.Teacher_ID WHERE ca.Grade < 4 AND t.Age > 30;",
    "table_names": [
      "teacher",
      "course_arrange"
    ]
  },
  {
    "id": 2362,
    "db_id": "course_teach",
    "question": "Who is the teacher assigned to the course arrangement with the highest grade?",
    "sql": "SELECT Name FROM teacher WHERE Teacher_ID IN (SELECT Teacher_ID FROM course_arrange WHERE Grade = (SELECT MAX(Grade) FROM course_arrange));",
    "table_names": [
      "teacher",
      "course_arrange"
    ]
  },
  {
    "id": 2363,
    "db_id": "course_teach",
    "question": "Who is the teacher that teaches the highest grade?",
    "sql": "SELECT Name FROM teacher WHERE Teacher_ID = (SELECT Teacher_ID FROM course_arrange WHERE Grade = (SELECT MAX(Grade) FROM course_arrange));",
    "table_names": [
      "teacher",
      "course_arrange"
    ]
  },
  {
    "id": 2364,
    "db_id": "course_teach",
    "question": "What is the name of the teacher who teaches the course with the highest grade?",
    "sql": "SELECT Name FROM teacher WHERE Teacher_ID IN (SELECT Teacher_ID FROM course_arrange WHERE Grade = (SELECT MAX(Grade) FROM course_arrange));",
    "table_names": [
      "teacher",
      "course_arrange"
    ]
  },
  {
    "id": 2365,
    "db_id": "course_teach",
    "question": "What is the name of the teacher who handles more than one course?",
    "sql": "SELECT Name FROM teacher WHERE Teacher_ID IN (SELECT Teacher_ID FROM course_arrange GROUP BY Teacher_ID HAVING COUNT(DISTINCT Course_ID) > 1);",
    "table_names": [
      "teacher",
      "course_arrange"
    ]
  },
  {
    "id": 2366,
    "db_id": "museum_visit",
    "question": "List the names of visitors whose membership level exceeds 3 and who have purchased more than 10 tickets in a single visit.",
    "sql": "SELECT visitor.Name FROM visitor JOIN visit ON visitor.ID = CAST(visit.visitor_ID AS INT) WHERE visitor.Level_of_membership > 3 AND visit.Num_of_Ticket > 10;",
    "table_names": [
      "visitor",
      "visit"
    ]
  },
  {
    "id": 2367,
    "db_id": "museum_visit",
    "question": "Find the names of visitors with a membership level higher than 3 who bought more than 5 tickets in a visit?",
    "sql": "SELECT visitor.Name FROM visitor JOIN visit ON visitor.ID = CAST(visit.visitor_ID AS INTEGER) WHERE visitor.Level_of_membership > 3 AND visit.Num_of_Ticket > 5;",
    "table_names": [
      "visitor",
      "visit"
    ]
  },
  {
    "id": 2368,
    "db_id": "museum_visit",
    "question": "Which museum had the highest single total spending from one visitor?",
    "sql": "SELECT m.Name FROM museum m JOIN visit v ON m.Museum_ID = v.Museum_ID WHERE v.Total_spent = (SELECT MAX(Total_spent) FROM visit);",
    "table_names": [
      "museum",
      "visit"
    ]
  },
  {
    "id": 2369,
    "db_id": "museum_visit",
    "question": "Which museums visited by visitor ID 3 have fewer than 20 staff members?",
    "sql": "SELECT m.Name FROM museum m JOIN visit v ON m.Museum_ID = v.Museum_ID WHERE v.visitor_ID = '3' AND m.Num_of_Staff < 20;",
    "table_names": [
      "museum",
      "visit"
    ]
  },
  {
    "id": 2370,
    "db_id": "museum_visit",
    "question": "Which visitors with a membership level greater than 1 purchased more than 5 tickets in a single visit?",
    "sql": "SELECT visitor.Name FROM visitor JOIN visit ON visitor.ID = CAST(visit.visitor_ID AS INTEGER) WHERE visit.Num_of_Ticket > 5 AND visitor.Level_of_membership > 1;",
    "table_names": [
      "visitor",
      "visit"
    ]
  },
  {
    "id": 2371,
    "db_id": "museum_visit",
    "question": "What is the name of the visitor who made a visit with the highest single spend amount?",
    "sql": "SELECT visitor.Name FROM visitor JOIN visit ON visitor.ID = CAST(visit.visitor_ID AS INT) WHERE visit.Total_spent = (SELECT MAX(Total_spent) FROM visit);",
    "table_names": [
      "visitor",
      "visit"
    ]
  },
  {
    "id": 2382,
    "db_id": "battle_death",
    "question": "What is the name of the ship responsible for the highest number of deaths recorded in a single event?",
    "sql": "SELECT s.name FROM ship s JOIN death d ON s.id = d.caused_by_ship_id WHERE d.killed = (SELECT MAX(killed) FROM death);",
    "table_names": [
      "ship",
      "death"
    ]
  },
  {
    "id": 2383,
    "db_id": "battle_death",
    "question": "What is the name of the ship that sank in a battle commanded by Bulgarian commander Kaloyan?",
    "sql": "SELECT ship.name FROM ship JOIN battle ON ship.lost_in_battle = battle.id WHERE battle.bulgarian_commander = 'Kaloyan' AND ship.disposition_of_ship = 'Sank';",
    "table_names": [
      "battle",
      "ship"
    ]
  },
  {
    "id": 2384,
    "db_id": "battle_death",
    "question": "What is the total number of killed individuals caused by ships that have the disposition 'Captured'?",
    "sql": "SELECT SUM(death.killed) FROM death JOIN ship ON death.caused_by_ship_id = ship.id WHERE ship.disposition_of_ship = 'Captured';",
    "table_names": [
      "ship",
      "death"
    ]
  },
  {
    "id": 2385,
    "db_id": "battle_death",
    "question": "What are the names of the ships lost in battles won by the Bulgarian commander Kaloyan?",
    "sql": "SELECT ship.name FROM ship JOIN battle ON ship.lost_in_battle = battle.id WHERE battle.result = 'Bulgarian victory' AND battle.bulgarian_commander = 'Kaloyan';",
    "table_names": [
      "battle",
      "ship"
    ]
  },
  {
    "id": 2386,
    "db_id": "battle_death",
    "question": "Which ships were captured during battles commanded by Boril?",
    "sql": "SELECT ship.name FROM ship JOIN battle ON ship.lost_in_battle = battle.id WHERE battle.bulgarian_commander = 'Boril' AND ship.disposition_of_ship = 'Captured';",
    "table_names": [
      "battle",
      "ship"
    ]
  },
  {
    "id": 2387,
    "db_id": "battle_death",
    "question": "What are the names of the battles in which Brig-type ships were captured?",
    "sql": "SELECT battle.name FROM battle WHERE id IN (SELECT lost_in_battle FROM ship WHERE disposition_of_ship = 'Captured' AND ship_type = 'Brig');",
    "table_names": [
      "battle",
      "ship"
    ]
  },
  {
    "id": 2388,
    "db_id": "student_transcripts_tracking",
    "question": "List all the degree programs available in the history department.",
    "sql": "SELECT degree_summary_name FROM Degree_Programs WHERE department_id = (SELECT department_id FROM Departments WHERE department_name = 'history')",
    "table_names": [
      "Departments",
      "Degree_Programs"
    ]
  },
  {
    "id": 2389,
    "db_id": "student_transcripts_tracking",
    "question": "How many Bachelor degree programs are offered by departments with the description 'in'?",
    "sql": "SELECT COUNT(*) FROM Degree_Programs dp JOIN Departments d ON dp.department_id = d.department_id WHERE dp.degree_summary_name = 'Bachelor' AND d.department_description = 'in';",
    "table_names": [
      "Departments",
      "Degree_Programs"
    ]
  },
  {
    "id": 2390,
    "db_id": "student_transcripts_tracking",
    "question": "How many 'Master' degree programs are offered by departments whose description is 'consequatur'?",
    "sql": "SELECT COUNT(*) FROM Degree_Programs DP JOIN Departments D ON DP.department_id = D.department_id WHERE D.department_description = 'consequatur' AND DP.degree_summary_name = 'Master';",
    "table_names": [
      "Departments",
      "Degree_Programs"
    ]
  },
  {
    "id": 2391,
    "db_id": "student_transcripts_tracking",
    "question": "What departments have degree programs offering a PHD degree?",
    "sql": "SELECT d.department_name FROM Departments d JOIN Degree_Programs dp ON d.department_id = dp.department_id WHERE dp.degree_summary_name = 'PHD';",
    "table_names": [
      "Departments",
      "Degree_Programs"
    ]
  },
  {
    "id": 2392,
    "db_id": "student_transcripts_tracking",
    "question": "Retrieve the names of courses that have more than one section listed.",
    "sql": "SELECT course_name FROM Courses WHERE course_id IN (SELECT course_id FROM Sections GROUP BY course_id HAVING COUNT(section_id) > 1);",
    "table_names": [
      "Courses",
      "Sections"
    ]
  },
  {
    "id": 2393,
    "db_id": "student_transcripts_tracking",
    "question": "What is the number of sections associated with courses having the description 'q'?",
    "sql": "SELECT COUNT(DISTINCT Sections.section_id) FROM Courses JOIN Sections ON Courses.course_id = Sections.course_id WHERE Courses.course_description = 'q';",
    "table_names": [
      "Courses",
      "Sections"
    ]
  },
  {
    "id": 2394,
    "db_id": "student_transcripts_tracking",
    "question": "How many unique students enrolled in semesters described as 'x' during spring semesters?",
    "sql": "SELECT COUNT(DISTINCT se.student_id) FROM Student_Enrolment se INNER JOIN Semesters s ON se.semester_id = s.semester_id WHERE s.semester_name LIKE 'spring%' AND s.semester_description = 'x';",
    "table_names": [
      "Semesters",
      "Student_Enrolment"
    ]
  },
  {
    "id": 2395,
    "db_id": "student_transcripts_tracking",
    "question": "How many unique students enrolled in degree program id 9 during all the spring semesters?",
    "sql": "SELECT COUNT(DISTINCT SE.student_id) FROM Student_Enrolment SE JOIN Semesters S ON SE.semester_id = S.semester_id WHERE S.semester_name LIKE '%spring%' AND SE.degree_program_id = 9;",
    "table_names": [
      "Semesters",
      "Student_Enrolment"
    ]
  },
  {
    "id": 2396,
    "db_id": "student_transcripts_tracking",
    "question": "What are the names and email addresses of students who are enrolled in degree program number 9 and have their permanent address with the address ID 5?",
    "sql": "SELECT Students.first_name, Students.last_name, Students.email_address FROM Students JOIN Student_Enrolment ON Students.student_id = Student_Enrolment.student_id WHERE Student_Enrolment.degree_program_id = 9 AND Students.permanent_address_id = 5;",
    "table_names": [
      "Students",
      "Student_Enrolment"
    ]
  },
  {
    "id": 2397,
    "db_id": "student_transcripts_tracking",
    "question": "Which student has the highest number of enrollments, and how many enrollments does the student have?",
    "sql": "SELECT s.first_name, s.last_name, COUNT(e.student_enrolment_id) AS enrollment_count FROM Students s JOIN Student_Enrolment e ON s.student_id = e.student_id GROUP BY s.student_id ORDER BY enrollment_count DESC LIMIT 1;",
    "table_names": [
      "Students",
      "Student_Enrolment"
    ]
  },
  {
    "id": 2398,
    "db_id": "student_transcripts_tracking",
    "question": "How many students are enrolled in degree programs with a 'Master' degree summary?",
    "sql": "SELECT COUNT(DISTINCT se.student_id) FROM Student_Enrolment se JOIN Degree_Programs dp ON se.degree_program_id = dp.degree_program_id WHERE dp.degree_summary_name = 'Master';",
    "table_names": [
      "Degree_Programs",
      "Student_Enrolment"
    ]
  },
  {
    "id": 2399,
    "db_id": "student_transcripts_tracking",
    "question": "How many unique students enrolled in a Bachelor's degree program?",
    "sql": "SELECT COUNT(DISTINCT se.student_id) FROM Student_Enrolment se JOIN Degree_Programs dp ON se.degree_program_id = dp.degree_program_id WHERE dp.degree_summary_name = 'Bachelor';",
    "table_names": [
      "Degree_Programs",
      "Student_Enrolment"
    ]
  },
  {
    "id": 2400,
    "db_id": "student_transcripts_tracking",
    "question": "How many unique students have enrolled in 'Master' degree programs?",
    "sql": "SELECT COUNT(DISTINCT se.student_id) FROM Student_Enrolment se JOIN Degree_Programs dp ON se.degree_program_id = dp.degree_program_id WHERE dp.degree_summary_name = 'Master';",
    "table_names": [
      "Degree_Programs",
      "Student_Enrolment"
    ]
  },
  {
    "id": 2401,
    "db_id": "student_transcripts_tracking",
    "question": "How many distinct students have enrolled in Bachelor programs offered by department 8?",
    "sql": "SELECT COUNT(DISTINCT se.student_id) FROM Degree_Programs dp JOIN Student_Enrolment se ON dp.degree_program_id = se.degree_program_id WHERE dp.degree_summary_name = 'Bachelor' AND dp.department_id = 8;",
    "table_names": [
      "Degree_Programs",
      "Student_Enrolment"
    ]
  },
  {
    "id": 2402,
    "db_id": "student_transcripts_tracking",
    "question": "Which student has the highest number of enrolments, and what is the count of their enrolments?",
    "sql": "SELECT s.first_name, s.last_name, COUNT(se.student_enrolment_id) AS total_enrolments FROM Students s JOIN Student_Enrolment se ON s.student_id = se.student_id GROUP BY s.student_id ORDER BY total_enrolments DESC LIMIT 1;",
    "table_names": [
      "Students",
      "Student_Enrolment"
    ]
  },
  {
    "id": 2403,
    "db_id": "student_transcripts_tracking",
    "question": "Which student has the highest number of enrolments, and how many enrolments do they have?",
    "sql": "SELECT s.first_name, s.last_name, COUNT(se.student_enrolment_id) AS enrolment_count FROM Students s JOIN Student_Enrolment se ON s.student_id = se.student_id GROUP BY s.student_id ORDER BY enrolment_count DESC LIMIT 1;",
    "table_names": [
      "Students",
      "Student_Enrolment"
    ]
  },
  {
    "id": 2404,
    "db_id": "student_transcripts_tracking",
    "question": "How many distinct students enrolled in semesters taking place in spring semesters described as 'x'?",
    "sql": "SELECT COUNT(DISTINCT se.student_id) FROM Student_Enrolment se JOIN Semesters s ON se.semester_id = s.semester_id WHERE s.semester_name LIKE '%spring%' AND s.semester_description = 'x';",
    "table_names": [
      "Semesters",
      "Student_Enrolment"
    ]
  },
  {
    "id": 2405,
    "db_id": "student_transcripts_tracking",
    "question": "How many distinct students enrolled during all the 'spring' semesters?",
    "sql": "SELECT COUNT(DISTINCT student_id) FROM Student_Enrolment WHERE semester_id IN (SELECT semester_id FROM Semesters WHERE semester_name LIKE '%spring%');",
    "table_names": [
      "Semesters",
      "Student_Enrolment"
    ]
  },
  {
    "id": 2406,
    "db_id": "student_transcripts_tracking",
    "question": "What are the names of all the courses in which the student with enrolment ID 4 has enrolled?",
    "sql": "SELECT course_name FROM Courses WHERE course_id IN (SELECT course_id FROM Student_Enrolment_Courses WHERE student_enrolment_id = 4);",
    "table_names": [
      "Courses",
      "Student_Enrolment_Courses"
    ]
  },
  {
    "id": 2407,
    "db_id": "student_transcripts_tracking",
    "question": "What are the names of the courses that the student with enrolment ID 5 is enrolled in?",
    "sql": "SELECT course_name FROM Courses WHERE course_id IN (SELECT course_id FROM Student_Enrolment_Courses WHERE student_enrolment_id = 5);",
    "table_names": [
      "Courses",
      "Student_Enrolment_Courses"
    ]
  },
  {
    "id": 2408,
    "db_id": "student_transcripts_tracking",
    "question": "What are the names of all courses taken by students who are enrolled in the 'ml' course?",
    "sql": "SELECT course_name FROM Courses WHERE course_id IN (SELECT course_id FROM Student_Enrolment_Courses WHERE student_enrolment_id IN (SELECT student_enrolment_id FROM Student_Enrolment_Courses WHERE course_id = (SELECT course_id FROM Courses WHERE course_name = 'ml')))",
    "table_names": [
      "Courses",
      "Student_Enrolment_Courses"
    ]
  },
  {
    "id": 2409,
    "db_id": "student_transcripts_tracking",
    "question": "What are the names of courses enrolled by the student with enrolment id 4?",
    "sql": "SELECT course_name FROM Courses WHERE course_id IN (SELECT course_id FROM Student_Enrolment_Courses WHERE student_enrolment_id = 4);",
    "table_names": [
      "Courses",
      "Student_Enrolment_Courses"
    ]
  },
  {
    "id": 2410,
    "db_id": "student_transcripts_tracking",
    "question": "What are the transcript_ids and corresponding dates for any transcripts associated with the student_course_id 76?",
    "sql": "SELECT Transcripts.transcript_id, Transcripts.transcript_date FROM Transcripts JOIN Transcript_Contents ON Transcripts.transcript_id = Transcript_Contents.transcript_id WHERE Transcript_Contents.student_course_id = 76;",
    "table_names": [
      "Transcripts",
      "Transcript_Contents"
    ]
  },
  {
    "id": 2411,
    "db_id": "student_transcripts_tracking",
    "question": "What is the most recent date of a transcript that is associated with more than one student course?",
    "sql": "SELECT transcript_date FROM Transcripts WHERE transcript_id IN (SELECT transcript_id FROM Transcript_Contents GROUP BY transcript_id HAVING COUNT(student_course_id) > 1) ORDER BY transcript_date DESC LIMIT 1;",
    "table_names": [
      "Transcripts",
      "Transcript_Contents"
    ]
  },
  {
    "id": 2412,
    "db_id": "student_assessment",
    "question": "What is the name of the student whose permanent address is located in Haiti, and which city is it?",
    "sql": "SELECT S.first_name, S.last_name, A.city FROM Students S JOIN Addresses A ON S.permanent_address_id = A.address_id WHERE A.country = 'Haiti';",
    "table_names": [
      "Addresses",
      "Students"
    ]
  },
  {
    "id": 2413,
    "db_id": "student_assessment",
    "question": "What is the first name, last name, and country of residence for student ID 6 based on their current address?",
    "sql": "SELECT s.first_name, s.last_name, a.country FROM Students AS s JOIN Addresses AS a ON s.current_address_id = a.address_id WHERE s.student_id = 6;",
    "table_names": [
      "Addresses",
      "Students"
    ]
  },
  {
    "id": 2414,
    "db_id": "student_transcripts_tracking",
    "question": "How many unique student course IDs were involved in transcripts recorded between the years 1980 and 1990 inclusive?",
    "sql": "SELECT COUNT(DISTINCT tc.student_course_id) FROM Transcripts t JOIN Transcript_Contents tc ON t.transcript_id = tc.transcript_id WHERE YEAR(t.transcript_date) BETWEEN 1980 AND 1990;",
    "table_names": [
      "Transcripts",
      "Transcript_Contents"
    ]
  },
  {
    "id": 2415,
    "db_id": "student_transcripts_tracking",
    "question": "How many distinct transcripts are there that have content entries and were issued between the years 1985 and 1990 inclusive?",
    "sql": "SELECT COUNT(DISTINICT transcript_id) FROM Transcript_Contents AS tc JOIN Transcripts AS t ON tc.transcript_id = t.transcript_id WHERE YEAR(t.transcript_date) BETWEEN 1985 AND 1990;",
    "table_names": [
      "Transcripts",
      "Transcript_Contents"
    ]
  },
  {
    "id": 2416,
    "db_id": "student_transcripts_tracking",
    "question": "How many distinct students enrolled in Master degree programs in semesters 1 or 13?",
    "sql": "SELECT COUNT(DISTINCT se.student_id) FROM Student_Enrolment se JOIN Degree_Programs dp ON se.degree_program_id = dp.degree_program_id WHERE dp.degree_summary_name = 'Master' AND se.semester_id IN (1, 13);",
    "table_names": [
      "Degree_Programs",
      "Student_Enrolment"
    ]
  },
  {
    "id": 2417,
    "db_id": "student_transcripts_tracking",
    "question": "How many distinct students enrolled in Bachelor degree programs during semester 2?",
    "sql": "SELECT COUNT(DISTINCT SE.student_id) FROM Student_Enrolment SE JOIN Degree_Programs DP ON SE.degree_program_id = DP.degree_program_id WHERE DP.degree_summary_name = 'Bachelor' AND SE.semester_id = 2;",
    "table_names": [
      "Degree_Programs",
      "Student_Enrolment"
    ]
  },
  {
    "id": 2418,
    "db_id": "student_assessment",
    "question": "What is the first and last name of students whose permanent addresses are located in Haiti, and what city in Haiti are they located in?",
    "sql": "SELECT s.first_name, s.last_name, a.city, a.country FROM Students s JOIN Addresses a ON s.permanent_address_id = a.address_id WHERE a.country = 'Haiti';",
    "table_names": [
      "Addresses",
      "Students"
    ]
  },
  {
    "id": 2419,
    "db_id": "student_assessment",
    "question": "What is the country of residence for the current address of the student with the student id 10, and what is the student's full name?",
    "sql": "SELECT s.first_name, s.last_name, a.country FROM Students s JOIN Addresses a ON s.current_address_id = a.address_id WHERE s.student_id = 10;",
    "table_names": [
      "Addresses",
      "Students"
    ]
  },
  {
    "id": 2420,
    "db_id": "tvshow",
    "question": "What are the cartoon titles directed by Ben Jones that were broadcast on channels offering high definition, and what is the name and country of these channels?",
    "sql": "SELECT Cartoon.Title, TV_Channel.series_name, TV_Channel.Country FROM Cartoon JOIN TV_Channel ON Cartoon.Channel = TV_Channel.id WHERE TV_Channel.Hight_definition_TV = 'yes' AND Cartoon.Directed_by = 'Ben Jones';",
    "table_names": [
      "TV_Channel",
      "Cartoon"
    ]
  },
  {
    "id": 2421,
    "db_id": "tvshow",
    "question": "List the titles of cartoons aired on TV channels from the United Kingdom that are not broadcasted in high-definition (HD).",
    "sql": "SELECT Cartoon.Title FROM Cartoon JOIN TV_Channel ON Cartoon.Channel = TV_Channel.id WHERE TV_Channel.Country = 'United Kingdom' AND TV_Channel.Hight_definition_TV = 'no';",
    "table_names": [
      "TV_Channel",
      "Cartoon"
    ]
  },
  {
    "id": 2422,
    "db_id": "tvshow",
    "question": "Which cartoon episodes were aired on Italian TV channels with a pixel aspect ratio of 16:9 and a free-to-view broadcasting option?",
    "sql": "SELECT Cartoon.Title FROM Cartoon JOIN TV_Channel ON Cartoon.Channel = TV_Channel.id WHERE TV_Channel.Country = 'Italy' AND TV_Channel.Pixel_aspect_ratio_PAR = '16:9' AND TV_Channel.Package_Option = 'no ( FTV )';",
    "table_names": [
      "TV_Channel",
      "Cartoon"
    ]
  },
  {
    "id": 2423,
    "db_id": "tvshow",
    "question": "What are the names of TV channels that broadcast cartoons directed by Ben Jones and do not offer high definition TV?",
    "sql": "SELECT TV_Channel.series_name FROM TV_Channel JOIN Cartoon ON TV_Channel.id = Cartoon.Channel WHERE Cartoon.Directed_by = 'Ben Jones' AND TV_Channel.Hight_definition_TV = 'no';",
    "table_names": [
      "TV_Channel",
      "Cartoon"
    ]
  },
  {
    "id": 2424,
    "db_id": "tvshow",
    "question": "What are the names of Italian music TV channels that aired TV episodes with a rating higher than 4.0?",
    "sql": "SELECT DISTINCT TV_Channel.series_name FROM TV_Channel JOIN TV_series ON TV_Channel.id = TV_series.Channel WHERE TV_Channel.Country = 'Italy' AND TV_Category = 'music' AND TV_series.Rating > 4.0;",
    "table_names": [
      "TV_Channel",
      "TV_series"
    ]
  },
  {
    "id": 2425,
    "db_id": "tvshow",
    "question": "List the names of channels that aired episodes with a rating higher than 4.5, and specifically have a pixel aspect ratio of 4:3.",
    "sql": "SELECT TV_Channel.series_name FROM TV_Channel JOIN TV_series ON TV_Channel.id = TV_series.Channel WHERE TV_series.Rating > 4.5 AND TV_Channel.Pixel_aspect_ratio_PAR = '4:3';",
    "table_names": [
      "TV_Channel",
      "TV_series"
    ]
  },
  {
    "id": 2426,
    "db_id": "tvshow",
    "question": "Which episodes aired on channels from the United Kingdom with a Pixel aspect ratio of '16:9' and obtained ratings higher than 4.0, and what channels did they air on?",
    "sql": "SELECT TV_series.Episode, TV_Channel.series_name FROM TV_series INNER JOIN TV_Channel ON TV_series.Channel = TV_Channel.id WHERE TV_Channel.Country = 'United Kingdom' AND TV_Channel.Pixel_aspect_ratio_PAR = '16:9' AND TV_series.Rating > 4.0;",
    "table_names": [
      "TV_Channel",
      "TV_series"
    ]
  },
  {
    "id": 2427,
    "db_id": "tvshow",
    "question": "Which TV channels from Italy with a pixel aspect ratio of '16:9' aired episodes with ratings higher than 3.5?",
    "sql": "SELECT TV_Channel.series_name FROM TV_Channel JOIN TV_series ON TV_Channel.id = TV_series.Channel WHERE TV_Channel.Country = 'Italy' AND TV_Channel.Pixel_aspect_ratio_PAR = '16:9' AND TV_series.Rating > 3.5;",
    "table_names": [
      "TV_Channel",
      "TV_series"
    ]
  },
  {
    "id": 2428,
    "db_id": "tvshow",
    "question": "What are the names of TV channels that aired cartoons directed by Ben Jones and do not have high-definition capability?",
    "sql": "SELECT TV_Channel.series_name FROM TV_Channel JOIN Cartoon ON TV_Channel.id = Cartoon.Channel WHERE Cartoon.Directed_by = 'Ben Jones' AND TV_Channel.Hight_definition_TV = 'no';",
    "table_names": [
      "TV_Channel",
      "Cartoon"
    ]
  },
  {
    "id": 2429,
    "db_id": "tvshow",
    "question": "What are the names of the TV channels broadcasting cartoons directed by Ben Jones, have Italian language content, and do not support high definition TV?",
    "sql": "SELECT TV_Channel.series_name FROM TV_Channel JOIN Cartoon ON TV_Channel.id = Cartoon.Channel WHERE Cartoon.Directed_by = 'Ben Jones' AND TV_Channel.Hight_definition_TV = 'no' AND TV_Channel.Language = 'Italian';",
    "table_names": [
      "TV_Channel",
      "Cartoon"
    ]
  },
  {
    "id": 2430,
    "db_id": "tvshow",
    "question": "Which English-language TV channels broadcast cartoons directed by Michael Chang and also offer high-definition content?",
    "sql": "SELECT DISTINCT TV_Channel.series_name FROM TV_Channel INNER JOIN Cartoon ON TV_Channel.id = Cartoon.Channel WHERE Cartoon.Directed_by = 'Michael Chang' AND TV_Channel.Language = 'English' AND TV_Channel.Hight_definition_TV = 'yes';",
    "table_names": [
      "TV_Channel",
      "Cartoon"
    ]
  },
  {
    "id": 2431,
    "db_id": "tvshow",
    "question": "Which cartoon episodes aired on channels from Poland with high-definition TV available?",
    "sql": "SELECT Cartoon.Title FROM Cartoon INNER JOIN TV_Channel ON Cartoon.Channel = TV_Channel.id WHERE TV_Channel.Country = 'Poland' AND TV_Channel.Hight_definition_TV = 'yes';",
    "table_names": [
      "TV_Channel",
      "Cartoon"
    ]
  },
  {
    "id": 2432,
    "db_id": "tvshow",
    "question": "How many cartoon episodes aired on TV channels from Italy in the 'Sky Famiglia' package?",
    "sql": "SELECT COUNT(*) FROM Cartoon c JOIN TV_Channel t ON c.Channel = t.id WHERE t.Country = 'Italy' AND t.Package_Option = 'Sky Famiglia';",
    "table_names": [
      "TV_Channel",
      "Cartoon"
    ]
  },
  {
    "id": 2433,
    "db_id": "tvshow",
    "question": "What Italian TV channels without HD aired cartoons directed by Ben Jones?",
    "sql": "SELECT TV_Channel.series_name FROM TV_Channel JOIN Cartoon ON TV_Channel.id = Cartoon.Channel WHERE Cartoon.Directed_by = 'Ben Jones' AND TV_Channel.Hight_definition_TV = 'no' AND TV_Channel.Country = 'Italy';",
    "table_names": [
      "TV_Channel",
      "Cartoon"
    ]
  },
  {
    "id": 2434,
    "db_id": "tvshow",
    "question": "Which cartoon episode titles directed by Ben Jones aired on Italian channels with a pixel aspect ratio containing '16:9'?",
    "sql": "SELECT Cartoon.Title FROM Cartoon JOIN TV_Channel ON Cartoon.Channel = TV_Channel.id WHERE TV_Channel.Country = 'Italy' AND TV_Channel.Pixel_aspect_ratio_PAR LIKE '%16:9%' AND Cartoon.Directed_by = 'Ben Jones';",
    "table_names": [
      "TV_Channel",
      "Cartoon"
    ]
  },
  {
    "id": 2435,
    "db_id": "tvshow",
    "question": "Which TV channels without high-definition broadcast cartoons directed by Ben Jones?",
    "sql": "SELECT TV_Channel.series_name FROM TV_Channel JOIN Cartoon ON TV_Channel.id = Cartoon.Channel WHERE Cartoon.Directed_by = 'Ben Jones' AND TV_Channel.Hight_definition_TV = 'no';",
    "table_names": [
      "TV_Channel",
      "Cartoon"
    ]
  },
  {
    "id": 2436,
    "db_id": "tvshow",
    "question": "Which cartoon episode aired on a high-definition TV channel from Poland?",
    "sql": "SELECT Cartoon.Title FROM Cartoon INNER JOIN TV_Channel ON Cartoon.Channel = TV_Channel.id WHERE TV_Channel.Hight_definition_TV = 'yes' AND TV_Channel.Country = 'Poland';",
    "table_names": [
      "TV_Channel",
      "Cartoon"
    ]
  },
  {
    "id": 2437,
    "db_id": "tvshow",
    "question": "Who are the distinct directors of cartoons aired on channels originating from Italy with a pixel aspect ratio of exactly 16:9?",
    "sql": "SELECT DISTINCT Cartoon.Directed_by FROM Cartoon JOIN TV_Channel ON Cartoon.Channel = TV_Channel.id WHERE TV_Channel.Country = 'Italy' AND TV_Channel.Pixel_aspect_ratio_PAR = '16:9';",
    "table_names": [
      "TV_Channel",
      "Cartoon"
    ]
  },
  {
    "id": 2438,
    "db_id": "poker_player",
    "question": "What is the average height of Russian poker players who have earned more than 200,000?",
    "sql": "SELECT AVG(p.Height) FROM poker_player pp JOIN people p ON pp.People_ID = p.People_ID WHERE pp.Earnings > 200000 AND p.Nationality = 'Russia';",
    "table_names": [
      "poker_player",
      "people"
    ]
  },
  {
    "id": 2439,
    "db_id": "poker_player",
    "question": "Who is the Russian poker player with the highest poker earnings and how much did they earn?",
    "sql": "SELECT p.Name, pp.Earnings FROM poker_player pp JOIN people p ON pp.People_ID = p.People_ID WHERE p.Nationality = 'Russia' ORDER BY pp.Earnings DESC LIMIT 1;",
    "table_names": [
      "poker_player",
      "people"
    ]
  },
  {
    "id": 2440,
    "db_id": "poker_player",
    "question": "What is the average earnings of Russian poker players who achieved the best finish of 1st place?",
    "sql": "SELECT AVG(pp.Earnings) FROM poker_player pp JOIN people p ON pp.People_ID = p.People_ID WHERE p.Nationality = 'Russia' AND pp.Best_Finish = 1.0;",
    "table_names": [
      "poker_player",
      "people"
    ]
  },
  {
    "id": 2441,
    "db_id": "poker_player",
    "question": "Which poker players taller than 190 cm have achieved a best finish at second place or better, and how much have they earned? List the players sorted by their earnings from highest to lowest.",
    "sql": "SELECT people.Name, people.Nationality, poker_player.Earnings FROM poker_player INNER JOIN people ON poker_player.People_ID = people.People_ID WHERE people.Height > 190 AND poker_player.Best_Finish <= 2 ORDER BY poker_player.Earnings DESC;",
    "table_names": [
      "poker_player",
      "people"
    ]
  },
  {
    "id": 2442,
    "db_id": "poker_player",
    "question": "What are the names and earnings of Russian poker players who achieved a Best_Finish of 1st place?",
    "sql": "SELECT people.Name, poker_player.Earnings FROM poker_player JOIN people ON poker_player.People_ID = people.People_ID WHERE people.Nationality = 'Russia' AND poker_player.Best_Finish = 1.0;",
    "table_names": [
      "poker_player",
      "people"
    ]
  },
  {
    "id": 2443,
    "db_id": "poker_player",
    "question": "Who are the poker players who have finished in the first position at least once and earned more than $200,000? Also, list the nationality for each player.",
    "sql": "SELECT p.Name, p.Nationality FROM poker_player pp JOIN people p ON pp.People_ID = p.People_ID WHERE pp.Best_Finish = 1 AND pp.Earnings > 200000",
    "table_names": [
      "poker_player",
      "people"
    ]
  },
  {
    "id": 2444,
    "db_id": "poker_player",
    "question": "Who is the highest earning poker player from Russia in this dataset, and what are their total earnings?",
    "sql": "SELECT people.Name, poker_player.Earnings FROM poker_player JOIN people ON poker_player.People_ID = people.People_ID WHERE people.Nationality = 'Russia' ORDER BY poker_player.Earnings DESC LIMIT 1;",
    "table_names": [
      "poker_player",
      "people"
    ]
  },
  {
    "id": 2445,
    "db_id": "poker_player",
    "question": "What are the earnings of poker players taller than 195 cm who had the best finish position of 1?",
    "sql": "SELECT pp.Earnings FROM poker_player AS pp JOIN people AS p ON pp.People_ID = p.People_ID WHERE p.Height > 195 AND pp.Best_Finish = 1;",
    "table_names": [
      "poker_player",
      "people"
    ]
  },
  {
    "id": 2446,
    "db_id": "poker_player",
    "question": "Who are the poker players with a best finish of 1st place who have a height above 200 cm, and what are their earnings?",
    "sql": "SELECT p.Name, poker.Earnings, p.Height FROM poker_player poker INNER JOIN people p ON poker.People_ID = p.People_ID WHERE poker.Best_Finish = 1 AND p.Height > 200;",
    "table_names": [
      "poker_player",
      "people"
    ]
  },
  {
    "id": 2447,
    "db_id": "poker_player",
    "question": "What is the name of the poker player who achieved the best finish of 1 and whose height is above 200 cm?",
    "sql": "SELECT p.Name FROM poker_player pp JOIN people p ON pp.People_ID = p.People_ID WHERE pp.Best_Finish = 1 AND p.Height > 200;",
    "table_names": [
      "poker_player",
      "people"
    ]
  },
  {
    "id": 2448,
    "db_id": "poker_player",
    "question": "What are the names and heights of poker players that have achieved a Best Finish of 1 and have a height greater than 190 cm?",
    "sql": "SELECT people.Name, people.Height FROM poker_player JOIN people ON poker_player.People_ID = people.People_ID WHERE poker_player.Best_Finish = 1 AND people.Height > 190;",
    "table_names": [
      "poker_player",
      "people"
    ]
  },
  {
    "id": 2449,
    "db_id": "poker_player",
    "question": "What are the names and poker earnings of Russian poker players who achieved a first place best finish?",
    "sql": "SELECT people.Name, poker_player.Earnings FROM poker_player INNER JOIN people ON poker_player.People_ID = people.People_ID WHERE people.Nationality = 'Russia' AND poker_player.Best_Finish = 1.0;",
    "table_names": [
      "poker_player",
      "people"
    ]
  },
  {
    "id": 2450,
    "db_id": "poker_player",
    "question": "What is the average height of poker players whose best finish position is 1?",
    "sql": "SELECT AVG(p.Height) FROM poker_player pp JOIN people p ON pp.People_ID = p.People_ID WHERE pp.Best_Finish = 1.0;",
    "table_names": [
      "poker_player",
      "people"
    ]
  },
  {
    "id": 2451,
    "db_id": "poker_player",
    "question": "Which players taller than 195 cm reached more than 15 final tables?",
    "sql": "SELECT people.Name FROM poker_player INNER JOIN people ON poker_player.People_ID = people.People_ID WHERE poker_player.Final_Table_Made > 15 AND people.Height > 195;",
    "table_names": [
      "poker_player",
      "people"
    ]
  },
  {
    "id": 2452,
    "db_id": "poker_player",
    "question": "What is the average earnings of poker players from Russia who have achieved a best finish of 1?",
    "sql": "SELECT AVG(pp.Earnings) FROM poker_player AS pp INNER JOIN people AS p ON pp.People_ID = p.People_ID WHERE p.Nationality = 'Russia' AND pp.Best_Finish = 1;",
    "table_names": [
      "poker_player",
      "people"
    ]
  },
  {
    "id": 2453,
    "db_id": "poker_player",
    "question": "Who is the tallest Russian poker player who has earned more than 150000?",
    "sql": "SELECT p.Name FROM poker_player pk INNER JOIN people p ON pk.People_ID = p.People_ID WHERE p.Nationality = 'Russia' AND pk.Earnings > 150000 ORDER BY p.Height DESC LIMIT 1;",
    "table_names": [
      "poker_player",
      "people"
    ]
  },
  {
    "id": 2454,
    "db_id": "voter_1",
    "question": "Which contestants received votes from the state of NY?",
    "sql": "SELECT C.contestant_name FROM CONTESTANTS C JOIN VOTES V ON C.contestant_number = V.contestant_number WHERE V.state = 'NY';",
    "table_names": [
      "CONTESTANTS",
      "VOTES"
    ]
  },
  {
    "id": 2455,
    "db_id": "voter_1",
    "question": "Which contestant received the highest total number of votes?",
    "sql": "SELECT c.contestant_name, COUNT(v.vote_id) as total_votes FROM CONTESTANTS c JOIN VOTES v ON c.contestant_number = v.contestant_number GROUP BY c.contestant_name ORDER BY total_votes DESC LIMIT 1;",
    "table_names": [
      "CONTESTANTS",
      "VOTES"
    ]
  },
  {
    "id": 2456,
    "db_id": "voter_1",
    "question": "Which contestant received the highest number of votes?",
    "sql": "SELECT contestant_name FROM CONTESTANTS WHERE contestant_number = (SELECT contestant_number FROM VOTES GROUP BY contestant_number ORDER BY COUNT(vote_id) DESC LIMIT 1);",
    "table_names": [
      "CONTESTANTS",
      "VOTES"
    ]
  },
  {
    "id": 2458,
    "db_id": "voter_1",
    "question": "What are the names of contestants who received votes from voters in NY?",
    "sql": "SELECT contestant_name FROM CONTESTANTS WHERE contestant_number IN (SELECT contestant_number FROM VOTES WHERE state = 'NY');",
    "table_names": [
      "CONTESTANTS",
      "VOTES"
    ]
  },
  {
    "id": 2500,
    "db_id": "orchestra",
    "question": "Can you name orchestras with record company 'Decca Records' that have conductors with more than 15 years of work experience and who are these conductors?",
    "sql": "SELECT o.Orchestra, c.Name FROM orchestra o JOIN conductor c ON o.Conductor_ID = c.Conductor_ID WHERE o.Record_Company = 'Decca Records' AND c.Year_of_Work > 15;",
    "table_names": [
      "conductor",
      "orchestra"
    ]
  },
  {
    "id": 2501,
    "db_id": "orchestra",
    "question": "Which orchestras founded before 2005 and recorded primarily in CD format have conductors with the nationality of USA?",
    "sql": "SELECT orchestra.Orchestra FROM orchestra JOIN conductor ON orchestra.Conductor_ID = conductor.Conductor_ID WHERE conductor.Nationality = 'USA' AND orchestra.Year_of_Founded < 2005 AND orchestra.Major_Record_Format = 'CD';",
    "table_names": [
      "conductor",
      "orchestra"
    ]
  },
  {
    "id": 2502,
    "db_id": "orchestra",
    "question": "What orchestras founded in or after 2005 have conductors with French nationality, and who are these conductors?",
    "sql": "SELECT orchestra.Orchestra, conductor.Name FROM orchestra INNER JOIN conductor ON orchestra.Conductor_ID = conductor.Conductor_ID WHERE conductor.Nationality='France' AND orchestra.Year_of_Founded >= 2005",
    "table_names": [
      "conductor",
      "orchestra"
    ]
  },
  {
    "id": 2503,
    "db_id": "orchestra",
    "question": "What are the names of orchestras and their corresponding record labels for those conducted by American conductors who are older than 45?",
    "sql": "SELECT o.Orchestra, o.Record_Company FROM orchestra o JOIN conductor c ON o.Conductor_ID = c.Conductor_ID WHERE c.Age > 45 AND c.Nationality = 'USA';",
    "table_names": [
      "conductor",
      "orchestra"
    ]
  },
  {
    "id": 2504,
    "db_id": "orchestra",
    "question": "Which conductors have worked more than 15 years and conducted orchestras whose major record format is CD?",
    "sql": "SELECT c.Name FROM conductor c JOIN orchestra o ON c.Conductor_ID = o.Conductor_ID WHERE c.Year_of_Work > 15 AND o.Major_Record_Format = 'CD';",
    "table_names": [
      "conductor",
      "orchestra"
    ]
  },
  {
    "id": 2505,
    "db_id": "orchestra",
    "question": "What is the average age of conductors who work with orchestras recorded by Decca Records?",
    "sql": "SELECT AVG(conductor.Age) FROM conductor INNER JOIN orchestra ON conductor.Conductor_ID = orchestra.Conductor_ID WHERE orchestra.Record_Company = 'Decca Records';",
    "table_names": [
      "conductor",
      "orchestra"
    ]
  },
  {
    "id": 2506,
    "db_id": "orchestra",
    "question": "Which orchestras founded before 2005 had performances with official ratings higher than 9 million viewers, and what were the performance types and dates?",
    "sql": "SELECT o.Orchestra, p.[Type], p.Date FROM orchestra o JOIN performance p ON o.Orchestra_ID = p.Orchestra_ID WHERE o.Year_of_Founded < 2005 AND p.Official_ratings_(millions) > 9.0;",
    "table_names": [
      "orchestra",
      "performance"
    ]
  },
  {
    "id": 2507,
    "db_id": "orchestra",
    "question": "Which orchestras have performances that garnered official ratings exceeding 9 million viewers, and what record companies are these orchestras associated with?",
    "sql": "SELECT o.Orchestra, o.Record_Company FROM orchestra AS o JOIN performance AS p ON o.Orchestra_ID = p.Orchestra_ID WHERE p.`Official_ratings_(millions)` > 9;",
    "table_names": [
      "orchestra",
      "performance"
    ]
  },
  {
    "id": 2524,
    "db_id": "network_1",
    "question": "Which 12th grade student likes a student in the 10th grade?",
    "sql": "SELECT H1.name FROM Highschooler H1 JOIN Likes L ON H1.ID = L.student_id JOIN Highschooler H2 ON L.liked_id = H2.ID WHERE H1.grade = 12 AND H2.grade = 10",
    "table_names": [
      "Highschooler",
      "Likes"
    ]
  },
  {
    "id": 2525,
    "db_id": "network_1",
    "question": "Which 11th grade students like 10th grade students?",
    "sql": "SELECT h1.name FROM Highschooler h1 JOIN Likes l ON h1.ID = l.student_id JOIN Highschooler h2 ON l.liked_id = h2.ID WHERE h1.grade = 11 AND h2.grade = 10;",
    "table_names": [
      "Highschooler",
      "Likes"
    ]
  },
  {
    "id": 2526,
    "db_id": "network_1",
    "question": "Which 11th grade students like someone who is in the 12th grade?",
    "sql": "SELECT name FROM Highschooler WHERE ID IN (SELECT student_id FROM Likes WHERE liked_id IN (SELECT ID FROM Highschooler WHERE grade = 12)) AND grade = 11;",
    "table_names": [
      "Highschooler",
      "Likes"
    ]
  },
  {
    "id": 2527,
    "db_id": "network_1",
    "question": "What are the names of students who like any 12th grader?",
    "sql": "SELECT h.name FROM Highschooler h WHERE h.ID IN (SELECT student_id FROM Likes WHERE liked_id IN (SELECT ID FROM Highschooler WHERE grade = 12));",
    "table_names": [
      "Highschooler",
      "Likes"
    ]
  },
  {
    "id": 2530,
    "db_id": "network_1",
    "question": "Who are the students liked by 11th graders?",
    "sql": "SELECT name FROM Highschooler WHERE ID IN (SELECT liked_id FROM Likes WHERE student_id IN (SELECT ID FROM Highschooler WHERE grade = 11));",
    "table_names": [
      "Highschooler",
      "Likes"
    ]
  },
  {
    "id": 2531,
    "db_id": "network_1",
    "question": "Which 11th grade students like a student in the 12th grade?",
    "sql": "SELECT h1.name FROM Highschooler h1 JOIN Likes l ON h1.ID = l.student_id JOIN Highschooler h2 ON l.liked_id = h2.ID WHERE h1.grade = 11 AND h2.grade = 12;",
    "table_names": [
      "Highschooler",
      "Likes"
    ]
  },
  {
    "id": 2536,
    "db_id": "dog_kennels",
    "question": "Who is the owner from zip code 36871, and what is the name of the veterinarian located in the same state as this owner?",
    "sql": "SELECT o.first_name, o.last_name, p.first_name, p.last_name FROM Owners o JOIN Professionals p ON o.state = p.state WHERE o.zip_code = '36871' AND p.role_code = 'Veterenarian';",
    "table_names": [
      "Owners",
      "Professionals"
    ]
  },
  {
    "id": 2537,
    "db_id": "dog_kennels",
    "question": "Who is the owner living in Mississippi, and can you provide the name of the Veterinarian also operating in the same state?",
    "sql": "SELECT o.first_name, o.last_name, p.first_name, p.last_name FROM Owners o JOIN Professionals p ON o.state = p.state WHERE o.state = 'Mississippi' AND p.role_code = 'Veterenarian';",
    "table_names": [
      "Owners",
      "Professionals"
    ]
  },
  {
    "id": 2538,
    "db_id": "dog_kennels",
    "question": "Which abandoned Eskimo breed ('ESK') dog has incurred the highest total cost of treatments, and what is the total cost amount?",
    "sql": "SELECT d.name, SUM(t.cost_of_treatment) AS total_cost FROM Dogs d JOIN Treatments t ON d.dog_id = t.dog_id WHERE d.breed_code = 'ESK' AND d.abandoned_yn = '1' GROUP BY d.name ORDER BY total_cost DESC LIMIT 1;",
    "table_names": [
      "Dogs",
      "Treatments"
    ]
  },
  {
    "id": 2539,
    "db_id": "dog_kennels",
    "question": "What is the average cost of treatments administered to dogs that were abandoned?",
    "sql": "SELECT AVG(T.cost_of_treatment) as avg_treatment_cost FROM Dogs D JOIN Treatments T ON D.dog_id = T.dog_id WHERE D.abandoned_yn = '1';",
    "table_names": [
      "Dogs",
      "Treatments"
    ]
  },
  {
    "id": 2540,
    "db_id": "dog_kennels",
    "question": "What are the first names, last names, and cell numbers of professionals from Connecticut who have administered a vaccination?",
    "sql": "SELECT DISTINCT P.first_name, P.last_name, P.cell_number FROM Professionals P INNER JOIN Treatments T ON P.professional_id = T.professional_id WHERE T.treatment_type_code='VAC' AND P.state='Connecticut';",
    "table_names": [
      "Professionals",
      "Treatments"
    ]
  },
  {
    "id": 2541,
    "db_id": "dog_kennels",
    "question": "What was the total cost for treatments of type 'VAC' performed by professionals living in Connecticut?",
    "sql": "SELECT SUM(T.cost_of_treatment) FROM Treatments T JOIN Professionals P ON T.professional_id = P.professional_id WHERE T.treatment_type_code = 'VAC' AND P.state = 'Connecticut';",
    "table_names": [
      "Professionals",
      "Treatments"
    ]
  },
  {
    "id": 2542,
    "db_id": "dog_kennels",
    "question": "What are the names of male bulldogs who have received vaccinations?",
    "sql": "SELECT D.name FROM Dogs D JOIN Treatments T ON D.dog_id = T.dog_id WHERE T.treatment_type_code = 'VAC' AND D.breed_code = 'BUL' AND D.gender = '0';",
    "table_names": [
      "Dogs",
      "Treatments"
    ]
  },
  {
    "id": 2543,
    "db_id": "dog_kennels",
    "question": "What is the average cost of treatments of type 'WALK' for dogs of breed 'ESK'?",
    "sql": "SELECT AVG(T.cost_of_treatment) FROM Dogs D JOIN Treatments T ON D.dog_id = T.dog_id WHERE D.breed_code = 'ESK' AND T.treatment_type_code = 'WALK';",
    "table_names": [
      "Dogs",
      "Treatments"
    ]
  },
  {
    "id": 2544,
    "db_id": "dog_kennels",
    "question": "What is the total cost for all treatments performed by veterinarians located in SouthCarolina?",
    "sql": "SELECT SUM(T.cost_of_treatment) FROM Treatments T INNER JOIN Professionals P ON T.professional_id = P.professional_id WHERE P.role_code = 'Veterenarian' AND P.state = 'SouthCarolina';",
    "table_names": [
      "Professionals",
      "Treatments"
    ]
  },
  {
    "id": 2545,
    "db_id": "dog_kennels",
    "question": "Which veterinarian has generated the highest total revenue from provided treatments, and what are their first name, last name, and contact cell number?",
    "sql": "SELECT p.first_name, p.last_name, p.cell_number, SUM(t.cost_of_treatment) as total_paid FROM Professionals p JOIN Treatments t ON p.professional_id = t.professional_id WHERE p.role_code = 'Veterenarian' GROUP BY p.professional_id ORDER BY total_paid DESC LIMIT 1;",
    "table_names": [
      "Professionals",
      "Treatments"
    ]
  },
  {
    "id": 2546,
    "db_id": "dog_kennels",
    "question": "Who owns the highest number of Huskies and how many Huskies does this owner have?",
    "sql": "SELECT Owners.first_name, Owners.last_name, COUNT(Dogs.dog_id) AS total_husky FROM Owners JOIN Dogs ON Owners.owner_id = Dogs.owner_id WHERE Dogs.breed_code = 'HUS' GROUP BY Owners.owner_id ORDER BY total_husky DESC LIMIT 1;",
    "table_names": [
      "Owners",
      "Dogs"
    ]
  },
  {
    "id": 2547,
    "db_id": "dog_kennels",
    "question": "Who is the owner with the highest number of dogs of breed 'BUL', and how many dogs of that breed do they own?",
    "sql": "SELECT Owners.first_name, Owners.last_name, COUNT(Dogs.dog_id) as num_of_dogs FROM Owners JOIN Dogs ON Owners.owner_id = Dogs.owner_id WHERE Dogs.breed_code = 'BUL' GROUP BY Owners.owner_id ORDER BY num_of_dogs DESC LIMIT 1;",
    "table_names": [
      "Owners",
      "Dogs"
    ]
  },
  {
    "id": 2548,
    "db_id": "dog_kennels",
    "question": "Which professional from Connecticut performed the highest number of treatments, and how many treatments did they perform?",
    "sql": "SELECT p.first_name, p.last_name, COUNT(t.treatment_id) AS num_treatments FROM Professionals p JOIN Treatments t ON p.professional_id = t.professional_id WHERE p.state = 'Connecticut' GROUP BY p.professional_id ORDER BY num_treatments DESC LIMIT 1;",
    "table_names": [
      "Professionals",
      "Treatments"
    ]
  },
  {
    "id": 2549,
    "db_id": "dog_kennels",
    "question": "What is the total cost of EXAM treatments performed by professionals located in Mississippi?",
    "sql": "SELECT SUM(cost_of_treatment) FROM Treatments WHERE treatment_type_code = 'EXAM' AND professional_id IN (SELECT professional_id FROM Professionals WHERE state = 'Mississippi');",
    "table_names": [
      "Professionals",
      "Treatments"
    ]
  },
  {
    "id": 2550,
    "db_id": "dog_kennels",
    "question": "What is the average weight of all non-abandoned Bulldogs?",
    "sql": "SELECT AVG(D.weight) FROM Dogs D JOIN Breeds B ON D.breed_code = B.breed_code WHERE B.breed_name = 'Bulldog' AND D.abandoned_yn = '0';",
    "table_names": [
      "Breeds",
      "Dogs"
    ]
  },
  {
    "id": 2551,
    "db_id": "dog_kennels",
    "question": "How many 'Husky' dogs are medium-sized and were not abandoned?",
    "sql": "SELECT COUNT(*) FROM Dogs JOIN Breeds ON Dogs.breed_code = Breeds.breed_code WHERE Breeds.breed_name = 'Husky' AND Dogs.size_code = 'MED' AND Dogs.abandoned_yn = '0';",
    "table_names": [
      "Breeds",
      "Dogs"
    ]
  },
  {
    "id": 2552,
    "db_id": "dog_kennels",
    "question": "What is the average cost of treatments for the treatment type description 'Vaccination'?",
    "sql": "SELECT AVG(cost_of_treatment) FROM Treatments INNER JOIN Treatment_Types ON Treatments.treatment_type_code = Treatment_Types.treatment_type_code WHERE Treatment_Types.treatment_type_description = 'Vaccination';",
    "table_names": [
      "Treatment_Types",
      "Treatments"
    ]
  },
  {
    "id": 2553,
    "db_id": "dog_kennels",
    "question": "During the month of March 2018, which type of treatment was administered the most number of times?",
    "sql": "SELECT tt.treatment_type_description, COUNT(t.treatment_id) FROM Treatment_Types tt JOIN Treatments t ON tt.treatment_type_code = t.treatment_type_code WHERE t.date_of_treatment BETWEEN '2018-03-01' AND '2018-03-31' GROUP BY tt.treatment_type_description ORDER BY COUNT(t.treatment_id) DESC LIMIT 1;",
    "table_names": [
      "Treatment_Types",
      "Treatments"
    ]
  },
  {
    "id": 2554,
    "db_id": "dog_kennels",
    "question": "What is the total cost of treatments provided by the veterinarian named 'Monte Kshlerin'?",
    "sql": "SELECT SUM(cost_of_treatment) FROM Treatments JOIN Professionals ON Treatments.professional_id = Professionals.professional_id WHERE Professionals.first_name = 'Monte' AND Professionals.last_name = 'Kshlerin';",
    "table_names": [
      "Professionals",
      "Treatments"
    ]
  },
  {
    "id": 2555,
    "db_id": "dog_kennels",
    "question": "What is the total cost of treatments performed by veterinarians located in Mississippi?",
    "sql": "SELECT SUM(cost_of_treatment) FROM Treatments WHERE professional_id IN (SELECT professional_id FROM Professionals WHERE role_code = 'Veterenarian' AND state='Mississippi');",
    "table_names": [
      "Professionals",
      "Treatments"
    ]
  },
  {
    "id": 2556,
    "db_id": "dog_kennels",
    "question": "Which professionals have performed vaccination treatments costing more than $500?",
    "sql": "SELECT first_name, last_name FROM Professionals WHERE professional_id IN (SELECT professional_id FROM Treatments WHERE treatment_type_code = 'VAC' AND cost_of_treatment > 500);",
    "table_names": [
      "Professionals",
      "Treatments"
    ]
  },
  {
    "id": 2557,
    "db_id": "dog_kennels",
    "question": "Which professionals administered vaccination treatments costing more than $500 and in which cities do they live?",
    "sql": "SELECT p.first_name, p.last_name, p.city FROM Professionals p JOIN Treatments t ON p.professional_id = t.professional_id WHERE t.treatment_type_code = 'VAC' AND t.cost_of_treatment > 500;",
    "table_names": [
      "Professionals",
      "Treatments"
    ]
  },
  {
    "id": 2558,
    "db_id": "dog_kennels",
    "question": "Who administered the most expensive treatment of type 'EXAM'?",
    "sql": "SELECT p.first_name, p.last_name FROM Professionals p JOIN Treatments t ON p.professional_id = t.professional_id WHERE t.treatment_type_code = 'EXAM' AND t.cost_of_treatment = (SELECT MAX(cost_of_treatment) FROM Treatments WHERE treatment_type_code = 'EXAM');",
    "table_names": [
      "Professionals",
      "Treatments"
    ]
  },
  {
    "id": 2559,
    "db_id": "dog_kennels",
    "question": "What is the total cost of treatments provided by veterinarians from South Carolina in March 2018?",
    "sql": "SELECT SUM(t.cost_of_treatment) FROM Treatments t JOIN Professionals p ON t.professional_id = p.professional_id WHERE p.role_code='Veterenarian' AND p.state='SouthCarolina' AND t.date_of_treatment >= '2018-03-01' AND t.date_of_treatment <= '2018-03-31';",
    "table_names": [
      "Professionals",
      "Treatments"
    ]
  },
  {
    "id": 2560,
    "db_id": "dog_kennels",
    "question": "What is the total cost spent on treatments classified as 'Physical examination'?",
    "sql": "SELECT SUM(T.cost_of_treatment) FROM Treatments T JOIN Treatment_Types TT ON T.treatment_type_code = TT.treatment_type_code WHERE TT.treatment_type_description='Physical examination';",
    "table_names": [
      "Treatment_Types",
      "Treatments"
    ]
  },
  {
    "id": 2561,
    "db_id": "dog_kennels",
    "question": "What was the total cost of all vaccinations performed in the month of March 2018?",
    "sql": "SELECT SUM(cost_of_treatment) FROM Treatments WHERE treatment_type_code = (SELECT treatment_type_code FROM Treatment_Types WHERE treatment_type_description = 'Vaccination') AND date_of_treatment BETWEEN '2018-03-01' AND '2018-03-31';",
    "table_names": [
      "Treatment_Types",
      "Treatments"
    ]
  },
  {
    "id": 2562,
    "db_id": "dog_kennels",
    "question": "Find the names of the owners who have abandoned dogs of the breed 'ESK'.",
    "sql": "SELECT O.first_name, O.last_name FROM Owners O JOIN Dogs D ON O.owner_id = D.owner_id WHERE D.abandoned_yn = '1' AND D.breed_code = 'ESK'",
    "table_names": [
      "Owners",
      "Dogs"
    ]
  },
  {
    "id": 2563,
    "db_id": "dog_kennels",
    "question": "Which owner has the highest number of abandoned dogs, and how many abandoned dogs do they have?",
    "sql": "SELECT O.first_name, O.last_name, COUNT(D.dog_id) AS dog_count FROM Owners O JOIN Dogs D ON O.owner_id = D.owner_id WHERE D.abandoned_yn = '1' GROUP BY O.owner_id ORDER BY dog_count DESC LIMIT 1;",
    "table_names": [
      "Owners",
      "Dogs"
    ]
  },
  {
    "id": 2564,
    "db_id": "dog_kennels",
    "question": "What are the names and email addresses of owners who have abandoned their dogs of breed 'ESK'?",
    "sql": "SELECT first_name, last_name, email_address FROM Owners WHERE owner_id IN (SELECT owner_id FROM Dogs WHERE abandoned_yn = '1' AND breed_code = 'ESK');",
    "table_names": [
      "Owners",
      "Dogs"
    ]
  },
  {
    "id": 2565,
    "db_id": "dog_kennels",
    "question": "What are the full names of owners who have abandoned dogs older than 5 years?",
    "sql": "SELECT Owners.first_name, Owners.last_name FROM Owners JOIN Dogs ON Owners.owner_id = Dogs.owner_id WHERE Dogs.age > 5 AND Dogs.abandoned_yn = '1';",
    "table_names": [
      "Owners",
      "Dogs"
    ]
  },
  {
    "id": 2566,
    "db_id": "dog_kennels",
    "question": "How many dogs of breed 'ESK' received a treatment of type 'EXAM' in March 2018?",
    "sql": "SELECT COUNT(DISTINCT d.dog_id) FROM Dogs d JOIN Treatments t ON d.dog_id = t.dog_id WHERE d.breed_code = 'ESK' AND t.treatment_type_code = 'EXAM' AND t.date_of_treatment BETWEEN '2018-03-01' AND '2018-03-31';",
    "table_names": [
      "Dogs",
      "Treatments"
    ]
  },
  {
    "id": 2567,
    "db_id": "dog_kennels",
    "question": "What is the name of the ESK breed dog with the highest total treatment cost, and what is the total treatment cost?",
    "sql": "SELECT Dogs.name, SUM(Treatments.cost_of_treatment) AS total_treatment_cost FROM Dogs JOIN Treatments ON Dogs.dog_id = Treatments.dog_id WHERE Dogs.breed_code = 'ESK' GROUP BY Dogs.name ORDER BY total_treatment_cost DESC LIMIT 1;",
    "table_names": [
      "Dogs",
      "Treatments"
    ]
  },
  {
    "id": 2568,
    "db_id": "dog_kennels",
    "question": "What is the email address of the owner who adopted a medium-sized dog named 'Holden'?",
    "sql": "SELECT Owners.email_address FROM Owners JOIN Dogs ON Owners.owner_id = Dogs.owner_id WHERE Dogs.name = 'Holden' AND Dogs.size_code = 'MED';",
    "table_names": [
      "Owners",
      "Dogs"
    ]
  },
  {
    "id": 2569,
    "db_id": "dog_kennels",
    "question": "How many dogs of breed 'HUS' have owners residing in the state of NorthDakota?",
    "sql": "SELECT COUNT(*) FROM Dogs d JOIN Owners o ON d.owner_id = o.owner_id WHERE o.state = 'NorthDakota' AND d.breed_code = 'HUS';",
    "table_names": [
      "Owners",
      "Dogs"
    ]
  },
  {
    "id": 2570,
    "db_id": "dog_kennels",
    "question": "What is the average cost of treatments given to abandoned Eskimo breed dogs?",
    "sql": "SELECT AVG(t.cost_of_treatment) FROM Dogs d JOIN Treatments t ON d.dog_id = t.dog_id WHERE d.breed_code = 'ESK' AND d.abandoned_yn = '1';",
    "table_names": [
      "Dogs",
      "Treatments"
    ]
  },
  {
    "id": 2571,
    "db_id": "dog_kennels",
    "question": "What is the average cost of treatments for dogs of breed 'ESK' that have been abandoned?",
    "sql": "SELECT AVG(cost_of_treatment) FROM Treatments WHERE dog_id IN (SELECT dog_id FROM Dogs WHERE breed_code = 'ESK' AND abandoned_yn = '1');",
    "table_names": [
      "Dogs",
      "Treatments"
    ]
  },
  {
    "id": 2572,
    "db_id": "dog_kennels",
    "question": "How many dogs older than 5 years with breed code 'HUS' are owned by owners from North Dakota?",
    "sql": "SELECT COUNT(D.dog_id) FROM Dogs D INNER JOIN Owners O ON D.owner_id = O.owner_id WHERE O.state = 'NorthDakota' AND D.breed_code = 'HUS' AND D.age > 5;",
    "table_names": [
      "Owners",
      "Dogs"
    ]
  },
  {
    "id": 2573,
    "db_id": "dog_kennels",
    "question": "What is the full name of the owner who abandoned a dog with breed code 'BUL'?",
    "sql": "SELECT Owners.first_name, Owners.last_name FROM Owners INNER JOIN Dogs ON Owners.owner_id = Dogs.owner_id WHERE Dogs.breed_code = 'BUL' AND Dogs.abandoned_yn = '1';",
    "table_names": [
      "Owners",
      "Dogs"
    ]
  },
  {
    "id": 2574,
    "db_id": "dog_kennels",
    "question": "What was the total cost of treatments given to all dogs that were abandoned?",
    "sql": "SELECT SUM(cost_of_treatment) FROM Treatments WHERE dog_id IN (SELECT dog_id FROM Dogs WHERE abandoned_yn='1');",
    "table_names": [
      "Dogs",
      "Treatments"
    ]
  },
  {
    "id": 2575,
    "db_id": "dog_kennels",
    "question": "What is the average cost of 'WALK' treatments provided to dogs of breed 'ESK'?",
    "sql": "SELECT AVG(T.cost_of_treatment) FROM Treatments T JOIN Dogs D ON T.dog_id = D.dog_id WHERE D.breed_code = 'ESK' AND T.treatment_type_code = 'WALK';",
    "table_names": [
      "Dogs",
      "Treatments"
    ]
  },
  {
    "id": 2576,
    "db_id": "dog_kennels",
    "question": "How many dogs of the breed 'BUL' weighing more than 5 units are owned by people from North Dakota?",
    "sql": "SELECT COUNT(*) FROM Dogs AS d JOIN Owners AS o ON d.owner_id = o.owner_id WHERE o.state = 'NorthDakota' AND d.breed_code = 'BUL' AND d.weight > 5;",
    "table_names": [
      "Owners",
      "Dogs"
    ]
  },
  {
    "id": 2577,
    "db_id": "dog_kennels",
    "question": "How many dogs older than 3 years have owners residing in North Dakota?",
    "sql": "SELECT COUNT(*) FROM Dogs d INNER JOIN Owners o ON d.owner_id = o.owner_id WHERE d.age > 3 AND o.state = 'NorthDakota';",
    "table_names": [
      "Owners",
      "Dogs"
    ]
  },
  {
    "id": 2578,
    "db_id": "dog_kennels",
    "question": "What is the total cost for all treatments performed by professionals residing in the state of Connecticut?",
    "sql": "SELECT SUM(t.cost_of_treatment) FROM Treatments t INNER JOIN Professionals p ON t.professional_id = p.professional_id WHERE p.state = 'Connecticut';",
    "table_names": [
      "Professionals",
      "Treatments"
    ]
  },
  {
    "id": 2579,
    "db_id": "dog_kennels",
    "question": "Which veterinarian generated the highest total income from treatments, and how much was it?",
    "sql": "SELECT p.first_name, p.last_name, SUM(t.cost_of_treatment) AS total_income FROM Professionals p INNER JOIN Treatments t ON p.professional_id = t.professional_id WHERE p.role_code = 'Veterenarian' GROUP BY p.professional_id ORDER BY total_income DESC LIMIT 1;",
    "table_names": [
      "Professionals",
      "Treatments"
    ]
  },
  {
    "id": 2580,
    "db_id": "singer",
    "question": "What is the total sales of songs that reached the highest position of 1 and were performed by singers from the United States?",
    "sql": "SELECT SUM(song.Sales) FROM song JOIN singer ON song.Singer_ID = singer.Singer_ID WHERE singer.Citizenship = 'United States' AND song.Highest_Position = 1;",
    "table_names": [
      "singer",
      "song"
    ]
  },
  {
    "id": 2581,
    "db_id": "singer",
    "question": "Which singer from the United States has the best-selling song?",
    "sql": "SELECT singer.Name FROM singer JOIN song ON singer.Singer_ID = song.Singer_ID WHERE singer.Citizenship = 'United States' ORDER BY song.Sales DESC LIMIT 1;",
    "table_names": [
      "singer",
      "song"
    ]
  },
  {
    "id": 2582,
    "db_id": "singer",
    "question": "Which U.S. singer with a number one hit song has the highest net worth?",
    "sql": "SELECT singer.Name FROM singer JOIN song ON singer.Singer_ID = song.Singer_ID WHERE song.Highest_Position = 1 AND singer.Citizenship = 'United States' ORDER BY singer.Net_Worth_Millions DESC LIMIT 1;",
    "table_names": [
      "singer",
      "song"
    ]
  },
  {
    "id": 2583,
    "db_id": "singer",
    "question": "Who is the singer from the United States with the highest total sales from all their songs, and how much is their net worth?",
    "sql": "SELECT singer.Name, singer.Net_Worth_Millions FROM singer JOIN song ON singer.Singer_ID = song.Singer_ID WHERE singer.Citizenship = 'United States' GROUP BY singer.Singer_ID ORDER BY SUM(song.Sales) DESC LIMIT 1;",
    "table_names": [
      "singer",
      "song"
    ]
  },
  {
    "id": 2584,
    "db_id": "singer",
    "question": "Among singers with a net worth over 20 million, who achieved the highest total song sales?",
    "sql": "SELECT singer.Name, SUM(song.Sales) AS Total_Sales FROM singer INNER JOIN song ON singer.Singer_ID = song.Singer_ID WHERE singer.Net_Worth_Millions > 20 GROUP BY singer.Name ORDER BY Total_Sales DESC LIMIT 1;",
    "table_names": [
      "singer",
      "song"
    ]
  },
  {
    "id": 2585,
    "db_id": "singer",
    "question": "What is the average net worth of singers who have songs with sales above 300,000 and that reached number one position?",
    "sql": "SELECT AVG(s.Net_Worth_Millions) FROM singer s JOIN song so ON s.Singer_ID = so.Singer_ID WHERE so.Sales > 300000 AND so.Highest_Position = 1;",
    "table_names": [
      "singer",
      "song"
    ]
  },
  {
    "id": 2586,
    "db_id": "singer",
    "question": "Who is the wealthiest singer with citizenship in the United States that has at least one song reaching position 1 on the charts?",
    "sql": "SELECT singer.Name FROM singer JOIN song ON singer.Singer_ID = song.Singer_ID WHERE song.Highest_Position = 1 AND singer.Citizenship = 'United States' ORDER BY singer.Net_Worth_Millions DESC LIMIT 1;",
    "table_names": [
      "singer",
      "song"
    ]
  },
  {
    "id": 2587,
    "db_id": "singer",
    "question": "Which singers with United States citizenship have songs that reached the highest position of No. 1?",
    "sql": "SELECT singer.Name FROM singer JOIN song ON singer.Singer_ID = song.Singer_ID WHERE singer.Citizenship = 'United States' AND song.Highest_Position = 1;",
    "table_names": [
      "singer",
      "song"
    ]
  },
  {
    "id": 2588,
    "db_id": "singer",
    "question": "Which singers have achieved more than one highest-positioned song?",
    "sql": "SELECT s.Name FROM singer s JOIN song sg ON s.Singer_ID = sg.Singer_ID WHERE sg.Highest_Position = 1 GROUP BY s.Singer_ID HAVING COUNT(sg.Song_ID) > 1;",
    "table_names": [
      "singer",
      "song"
    ]
  },
  {
    "id": 2589,
    "db_id": "singer",
    "question": "Among the singers from the United States, who has the highest total number of song sales and what is the total?",
    "sql": "SELECT singer.Name, SUM(song.Sales) FROM singer JOIN song ON singer.Singer_ID = song.Singer_ID WHERE singer.Citizenship = 'United States' GROUP BY singer.Name ORDER BY SUM(song.Sales) DESC LIMIT 1;",
    "table_names": [
      "singer",
      "song"
    ]
  },
  {
    "id": 2590,
    "db_id": "real_estate_properties",
    "question": "What are the features listed under the feature type 'Securiyt, eg Burglar Alarm.'?",
    "sql": "SELECT feature_name FROM Other_Available_Features WHERE feature_type_code = (SELECT feature_type_code FROM Ref_Feature_Types WHERE feature_type_name LIKE '%Securiyt%');",
    "table_names": [
      "Ref_Feature_Types",
      "Other_Available_Features"
    ]
  },
  {
    "id": 2591,
    "db_id": "real_estate_properties",
    "question": "What is the average agreed selling price of apartments having more than 5 rooms?",
    "sql": "SELECT AVG(P.agreed_selling_price) FROM Properties P JOIN Ref_Property_Types R ON P.property_type_code = R.property_type_code WHERE R.property_type_description = 'Apartment, Flat, Condo, etc.' AND P.room_count > 5;",
    "table_names": [
      "Ref_Property_Types",
      "Properties"
    ]
  },
  {
    "id": 43,
    "db_id": "bike_1",
    "question": "Return the unique name for stations that have ever had 7 bikes available.",
    "sql": "SELECT DISTINCT T1.name FROM station AS T1 JOIN status AS T2 ON T1.id  =  T2.station_id WHERE T2.bikes_available  =  7",
    "table_names": [
      "station",
      "status"
    ]
  },
  {
    "id": 44,
    "db_id": "bike_1",
    "question": "What are the different names for each station that has ever had 7 bikes available?",
    "sql": "SELECT DISTINCT T1.name FROM station AS T1 JOIN status AS T2 ON T1.id  =  T2.station_id WHERE T2.bikes_available  =  7",
    "table_names": [
      "station",
      "status"
    ]
  },
  {
    "id": 45,
    "db_id": "bike_1",
    "question": "What is the latitude, longitude, city of the station from which the shortest trip started?",
    "sql": "SELECT T1.lat ,  T1.long ,  T1.city FROM station AS T1 JOIN trip AS T2 ON T1.id  =  T2.start_station_id ORDER BY T2.duration LIMIT 1",
    "table_names": [
      "station",
      "trip"
    ]
  },
  {
    "id": 46,
    "db_id": "bike_1",
    "question": "What is the latitude, longitude, and city of the station from which the trip with smallest duration started?",
    "sql": "SELECT T1.lat ,  T1.long ,  T1.city FROM station AS T1 JOIN trip AS T2 ON T1.id  =  T2.start_station_id ORDER BY T2.duration LIMIT 1",
    "table_names": [
      "station",
      "trip"
    ]
  },
  {
    "id": 47,
    "db_id": "bike_1",
    "question": "What are the ids of stations that are located in San Francisco and have average bike availability above 10.",
    "sql": "SELECT id FROM station WHERE city  =  \"San Francisco\" INTERSECT SELECT station_id FROM status GROUP BY station_id HAVING avg(bikes_available)  >  10",
    "table_names": [
      "station",
      "status"
    ]
  },
  {
    "id": 48,
    "db_id": "bike_1",
    "question": "What are the ids of the stations in San Francisco that normally have more than 10 bikes available?",
    "sql": "SELECT id FROM station WHERE city  =  \"San Francisco\" INTERSECT SELECT station_id FROM status GROUP BY station_id HAVING avg(bikes_available)  >  10",
    "table_names": [
      "station",
      "status"
    ]
  },
  {
    "id": 49,
    "db_id": "bike_1",
    "question": "What are the names and ids of stations that had more than 14 bikes available on average or were installed in December?",
    "sql": "SELECT T1.name ,  T1.id FROM station AS T1 JOIN status AS T2 ON T1.id  =  T2.station_id GROUP BY T2.station_id HAVING avg(T2.bikes_available)  >  14 UNION SELECT name ,  id FROM station WHERE installation_date LIKE \"12/%\"",
    "table_names": [
      "station",
      "status"
    ]
  },
  {
    "id": 50,
    "db_id": "bike_1",
    "question": "What are the names and ids of all stations that have more than 14 bikes available on average or had bikes installed in December?",
    "sql": "SELECT T1.name ,  T1.id FROM station AS T1 JOIN status AS T2 ON T1.id  =  T2.station_id GROUP BY T2.station_id HAVING avg(T2.bikes_available)  >  14 UNION SELECT name ,  id FROM station WHERE installation_date LIKE \"12/%\"",
    "table_names": [
      "station",
      "status"
    ]
  },
  {
    "id": 51,
    "db_id": "bike_1",
    "question": "What is the average bike availability in stations that are not located in Palo Alto?",
    "sql": "SELECT avg(bikes_available) FROM status WHERE station_id NOT IN (SELECT id FROM station WHERE city  =  \"Palo Alto\")",
    "table_names": [
      "station",
      "status"
    ]
  },
  {
    "id": 52,
    "db_id": "bike_1",
    "question": "What is the average bike availablility for stations not in Palo Alto?",
    "sql": "SELECT avg(bikes_available) FROM status WHERE station_id NOT IN (SELECT id FROM station WHERE city  =  \"Palo Alto\")",
    "table_names": [
      "station",
      "status"
    ]
  },
  {
    "id": 53,
    "db_id": "bike_1",
    "question": "What is the average longitude of stations that never had bike availability more than 10?",
    "sql": "SELECT avg(long) FROM station WHERE id NOT IN (SELECT station_id FROM status GROUP BY station_id HAVING max(bikes_available)  >  10)",
    "table_names": [
      "station",
      "status"
    ]
  },
  {
    "id": 54,
    "db_id": "bike_1",
    "question": "What is the mean longitude for all stations that have never had more than 10 bikes available?",
    "sql": "SELECT avg(long) FROM station WHERE id NOT IN (SELECT station_id FROM status GROUP BY station_id HAVING max(bikes_available)  >  10)",
    "table_names": [
      "station",
      "status"
    ]
  },
  {
    "id": 55,
    "db_id": "bike_1",
    "question": "Give me ids for all the trip that took place in a zip code area with average mean temperature above 60.",
    "sql": "SELECT T1.id FROM trip AS T1 JOIN weather AS T2 ON T1.zip_code  =  T2.zip_code GROUP BY T2.zip_code HAVING avg(T2.mean_temperature_f)  >  60",
    "table_names": [
      "trip",
      "weather"
    ]
  },
  {
    "id": 56,
    "db_id": "bike_1",
    "question": "For each zip code, find the ids of all trips that have a higher average mean temperature above 60?",
    "sql": "SELECT T1.id FROM trip AS T1 JOIN weather AS T2 ON T1.zip_code  =  T2.zip_code GROUP BY T2.zip_code HAVING avg(T2.mean_temperature_f)  >  60",
    "table_names": [
      "trip",
      "weather"
    ]
  },
  {
    "id": 57,
    "db_id": "bike_1",
    "question": "For each trip, return its ending station's installation date.",
    "sql": "SELECT T1.id ,  T2.installation_date FROM trip AS T1 JOIN station AS T2 ON T1.end_station_id  =  T2.id",
    "table_names": [
      "station",
      "trip"
    ]
  },
  {
    "id": 58,
    "db_id": "bike_1",
    "question": "What is the installation date for each ending station on all the trips?",
    "sql": "SELECT T1.id ,  T2.installation_date FROM trip AS T1 JOIN station AS T2 ON T1.end_station_id  =  T2.id",
    "table_names": [
      "station",
      "trip"
    ]
  },
  {
    "id": 59,
    "db_id": "bike_1",
    "question": "Which trip started from the station with the largest dock count? Give me the trip id.",
    "sql": "SELECT T1.id FROM trip AS T1 JOIN station AS T2 ON T1.start_station_id  =  T2.id ORDER BY T2.dock_count DESC LIMIT 1",
    "table_names": [
      "station",
      "trip"
    ]
  },
  {
    "id": 60,
    "db_id": "bike_1",
    "question": "What is the id of the trip that started from the station with the highest dock count?",
    "sql": "SELECT T1.id FROM trip AS T1 JOIN station AS T2 ON T1.start_station_id  =  T2.id ORDER BY T2.dock_count DESC LIMIT 1",
    "table_names": [
      "station",
      "trip"
    ]
  },
  {
    "id": 61,
    "db_id": "bike_1",
    "question": "Count the number of trips that did not end in San Francisco city.",
    "sql": "SELECT count(*) FROM trip AS T1 JOIN station AS T2 ON T1.end_station_id  =  T2.id WHERE T2.city !=  \"San Francisco\"",
    "table_names": [
      "station",
      "trip"
    ]
  },
  {
    "id": 62,
    "db_id": "bike_1",
    "question": "How many trips did not end in San Francisco?",
    "sql": "SELECT count(*) FROM trip AS T1 JOIN station AS T2 ON T1.end_station_id  =  T2.id WHERE T2.city != \"San Francisco\"",
    "table_names": [
      "station",
      "trip"
    ]
  },
  {
    "id": 63,
    "db_id": "bike_1",
    "question": "What are the ids of stations that have latitude above 37.4 and never had bike availability below 7?",
    "sql": "SELECT id FROM station WHERE lat  >  37.4 EXCEPT SELECT station_id FROM status GROUP BY station_id HAVING min(bikes_available)  <  7",
    "table_names": [
      "station",
      "status"
    ]
  },
  {
    "id": 64,
    "db_id": "bike_1",
    "question": "What are the ids of all stations that have a latitude above 37.4 and have never had less than 7 bikes available?",
    "sql": "SELECT id FROM station WHERE lat  >  37.4 EXCEPT SELECT station_id FROM status GROUP BY station_id HAVING min(bikes_available)  <  7",
    "table_names": [
      "station",
      "status"
    ]
  },
  {
    "id": 65,
    "db_id": "bike_1",
    "question": "What are names of stations that have average bike availability above 10 and are not located in San Jose city?",
    "sql": "SELECT T1.name FROM station AS T1 JOIN status AS T2 ON T1.id  =  T2.station_id GROUP BY T2.station_id HAVING avg(bikes_available)  >  10 EXCEPT SELECT name FROM station WHERE city  =  \"San Jose\"",
    "table_names": [
      "station",
      "status"
    ]
  },
  {
    "id": 66,
    "db_id": "bike_1",
    "question": "What are the names of all stations that have more than 10 bikes available and are not located in San Jose?",
    "sql": "SELECT T1.name FROM station AS T1 JOIN status AS T2 ON T1.id  =  T2.station_id GROUP BY T2.station_id HAVING avg(bikes_available)  >  10 EXCEPT SELECT name FROM station WHERE city  =  \"San Jose\"",
    "table_names": [
      "station",
      "status"
    ]
  },
  {
    "id": 67,
    "db_id": "bike_1",
    "question": "For each station, return its longitude and the average duration of trips that started from the station.",
    "sql": "SELECT T1.name ,  T1.long ,  avg(T2.duration) FROM station AS T1 JOIN trip AS T2 ON T1.id  =  T2.start_station_id GROUP BY T2.start_station_id",
    "table_names": [
      "station",
      "trip"
    ]
  },
  {
    "id": 68,
    "db_id": "bike_1",
    "question": "For each start station id, what is its name, longitude and average duration of trips started there?",
    "sql": "SELECT T1.name ,  T1.long ,  avg(T2.duration) FROM station AS T1 JOIN trip AS T2 ON T1.id  =  T2.start_station_id GROUP BY T2.start_station_id",
    "table_names": [
      "station",
      "trip"
    ]
  },
  {
    "id": 69,
    "db_id": "bike_1",
    "question": "For each station, find its latitude and the minimum duration of trips that ended at the station.",
    "sql": "SELECT T1.name ,  T1.lat ,  min(T2.duration) FROM station AS T1 JOIN trip AS T2 ON T1.id  =  T2.end_station_id GROUP BY T2.end_station_id",
    "table_names": [
      "station",
      "trip"
    ]
  },
  {
    "id": 70,
    "db_id": "bike_1",
    "question": "For each end station id, what is its name, latitude, and minimum duration for trips ended there?",
    "sql": "SELECT T1.name ,  T1.lat ,  min(T2.duration) FROM station AS T1 JOIN trip AS T2 ON T1.id  =  T2.end_station_id GROUP BY T2.end_station_id",
    "table_names": [
      "station",
      "trip"
    ]
  },
  {
    "id": 71,
    "db_id": "bike_1",
    "question": "What are the id and name of the stations that have ever had more than 12 bikes available?",
    "sql": "SELECT DISTINCT T1.id ,  T1.name FROM station AS T1 JOIN status AS T2 ON T1.id  =  T2.station_id WHERE T2.bikes_available  >  12",
    "table_names": [
      "station",
      "status"
    ]
  },
  {
    "id": 72,
    "db_id": "bike_1",
    "question": "What are the different ids and names of the stations that have had more than 12 bikes available?",
    "sql": "SELECT DISTINCT T1.id ,  T1.name FROM station AS T1 JOIN status AS T2 ON T1.id  =  T2.station_id WHERE T2.bikes_available  >  12",
    "table_names": [
      "station",
      "status"
    ]
  },
  {
    "id": 73,
    "db_id": "bike_1",
    "question": "Give me the zip code where the average mean humidity is below 70 and at least 100 trips took place.",
    "sql": "SELECT zip_code FROM weather GROUP BY zip_code HAVING avg(mean_humidity)  <  70 INTERSECT SELECT zip_code FROM trip GROUP BY zip_code HAVING count(*)  >=  100",
    "table_names": [
      "trip",
      "weather"
    ]
  },
  {
    "id": 74,
    "db_id": "bike_1",
    "question": "What are the zip codes that have an average mean humidity below 70 and had at least 100 trips come through there?",
    "sql": "SELECT zip_code FROM weather GROUP BY zip_code HAVING avg(mean_humidity)  <  70 INTERSECT SELECT zip_code FROM trip GROUP BY zip_code HAVING count(*)  >=  100",
    "table_names": [
      "trip",
      "weather"
    ]
  },
  {
    "id": 75,
    "db_id": "bike_1",
    "question": "What are the names of stations that are located in Palo Alto city but have never been the ending point of trips more than 100 times?",
    "sql": "SELECT name FROM station WHERE city  =  \"Palo Alto\" EXCEPT SELECT end_station_name FROM trip GROUP BY end_station_name HAVING count(*)  >  100",
    "table_names": [
      "station",
      "trip"
    ]
  },
  {
    "id": 76,
    "db_id": "bike_1",
    "question": "What are the names of the stations that are located in Palo Alto but have never been the ending point of the trips",
    "sql": "SELECT name FROM station WHERE city  =  \"Palo Alto\" EXCEPT SELECT end_station_name FROM trip GROUP BY end_station_name HAVING count(*)  >  100",
    "table_names": [
      "station",
      "trip"
    ]
  },
  {
    "id": 77,
    "db_id": "bike_1",
    "question": "How many trips started from Mountain View city and ended at Palo Alto city?",
    "sql": "SELECT count(*) FROM station AS T1 JOIN trip AS T2 JOIN station AS T3 JOIN trip AS T4 ON T1.id  =  T2.start_station_id AND T2.id  =  T4.id AND T3.id  =  T4.end_station_id WHERE T1.city  =  \"Mountain View\" AND T3.city  =  \"Palo Alto\"",
    "table_names": [
      "station",
      "trip"
    ]
  },
  {
    "id": 78,
    "db_id": "bike_1",
    "question": "How many trips stated from  a station in Mountain View and ended at one in Palo Alto?",
    "sql": "SELECT count(*) FROM station AS T1 JOIN trip AS T2 JOIN station AS T3 JOIN trip AS T4 ON T1.id  =  T2.start_station_id AND T2.id  =  T4.id AND T3.id  =  T4.end_station_id WHERE T1.city  =  \"Mountain View\" AND T3.city  =  \"Palo Alto\"",
    "table_names": [
      "station",
      "trip"
    ]
  },
  {
    "id": 79,
    "db_id": "bike_1",
    "question": "What is the average latitude and longitude of the starting points of all trips?",
    "sql": "SELECT avg(T1.lat) ,  avg(T1.long) FROM station AS T1 JOIN trip AS T2 ON T1.id  =  T2.start_station_id",
    "table_names": [
      "station",
      "trip"
    ]
  },
  {
    "id": 80,
    "db_id": "bike_1",
    "question": "What is the average latitude and longitude of all starting stations for the trips?",
    "sql": "SELECT avg(T1.lat) ,  avg(T1.long) FROM station AS T1 JOIN trip AS T2 ON T1.id  =  T2.start_station_id",
    "table_names": [
      "station",
      "trip"
    ]
  },
  {
    "id": 154,
    "db_id": "store_1",
    "question": "List the top 5 genres by number of tracks. List genres name and total tracks.",
    "sql": "SELECT T1.name ,  COUNT(*) FROM genres AS T1 JOIN tracks AS T2 ON T2.genre_id  =  T1.id GROUP BY T1.id ORDER BY count(*) DESC LIMIT 5;",
    "table_names": [
      "genres",
      "tracks"
    ]
  },
  {
    "id": 155,
    "db_id": "store_1",
    "question": "How many tracks does each genre have and what are the names of the top 5?",
    "sql": "SELECT T1.name ,  COUNT(*) FROM genres AS T1 JOIN tracks AS T2 ON T2.genre_id  =  T1.id GROUP BY T1.id ORDER BY count(*) DESC LIMIT 5;",
    "table_names": [
      "genres",
      "tracks"
    ]
  },
  {
    "id": 172,
    "db_id": "store_1",
    "question": "What is the name of tracks whose genre is Rock?",
    "sql": "SELECT T2.name FROM genres AS T1 JOIN tracks AS T2 ON T1.id = T2.genre_id WHERE T1.name = \"Rock\";",
    "table_names": [
      "genres",
      "tracks"
    ]
  },
  {
    "id": 173,
    "db_id": "store_1",
    "question": "What is the name of all tracks in the Rock genre?",
    "sql": "SELECT T2.name FROM genres AS T1 JOIN tracks AS T2 ON T1.id = T2.genre_id WHERE T1.name = \"Rock\";",
    "table_names": [
      "genres",
      "tracks"
    ]
  },
  {
    "id": 174,
    "db_id": "store_1",
    "question": "What is title of album which track Balls to the Wall belongs to?",
    "sql": "SELECT T1.title FROM albums AS T1 JOIN tracks AS T2 ON T1.id = T2.genre_id WHERE T2.name = \"Balls to the Wall\";",
    "table_names": [
      "albums",
      "tracks"
    ]
  },
  {
    "id": 175,
    "db_id": "store_1",
    "question": "What is the name of the album that has the track Ball to the Wall?",
    "sql": "SELECT T1.title FROM albums AS T1 JOIN tracks AS T2 ON T1.id = T2.genre_id WHERE T2.name = \"Balls to the Wall\";",
    "table_names": [
      "albums",
      "tracks"
    ]
  },
  {
    "id": 176,
    "db_id": "store_1",
    "question": "List name of all tracks in Balls to the Wall.",
    "sql": "SELECT T2.name FROM albums AS T1 JOIN tracks AS T2 ON T1.id = T2.genre_id WHERE T1.title = \"Balls to the Wall\";",
    "table_names": [
      "albums",
      "tracks"
    ]
  },
  {
    "id": 177,
    "db_id": "store_1",
    "question": "What is the name of all tracks in the album named Balls to the Wall?",
    "sql": "SELECT T2.name FROM albums AS T1 JOIN tracks AS T2 ON T1.id = T2.genre_id WHERE T1.title = \"Balls to the Wall\";",
    "table_names": [
      "albums",
      "tracks"
    ]
  },
  {
    "id": 178,
    "db_id": "store_1",
    "question": "List title of albums have the number of tracks greater than 10.",
    "sql": "SELECT T1.title FROM albums AS T1 JOIN tracks AS T2 ON T1.id = T2.album_id GROUP BY T1.id HAVING count(T1.id)  >  10;",
    "table_names": [
      "albums",
      "tracks"
    ]
  },
  {
    "id": 179,
    "db_id": "store_1",
    "question": "What are the names of the albums that have more than 10 tracks?",
    "sql": "SELECT T1.title FROM albums AS T1 JOIN tracks AS T2 ON T1.id = T2.album_id GROUP BY T1.id HAVING count(T1.id)  >  10;",
    "table_names": [
      "albums",
      "tracks"
    ]
  },
  {
    "id": 180,
    "db_id": "store_1",
    "question": "List the name of tracks belongs to genre Rock or genre Jazz.",
    "sql": "SELECT T2.name FROM genres AS T1 JOIN tracks AS T2 ON T1.id = T2.genre_id WHERE T1.name = \"Rock\" OR T1.name = \"Jazz\"",
    "table_names": [
      "genres",
      "tracks"
    ]
  },
  {
    "id": 181,
    "db_id": "store_1",
    "question": "What are the names of the tracks that are Rock or Jazz songs?",
    "sql": "SELECT T2.name FROM genres AS T1 JOIN tracks AS T2 ON T1.id = T2.genre_id WHERE T1.name = \"Rock\" OR T1.name = \"Jazz\"",
    "table_names": [
      "genres",
      "tracks"
    ]
  },
  {
    "id": 182,
    "db_id": "store_1",
    "question": "List the name of playlist which has number of tracks greater than 100.",
    "sql": "SELECT T2.name FROM playlist_tracks AS T1 JOIN playlists AS T2 ON T2.id = T1.playlist_id GROUP BY T1.playlist_id HAVING count(T1.track_id)  >  100;",
    "table_names": [
      "playlists",
      "playlist_tracks"
    ]
  },
  {
    "id": 184,
    "db_id": "store_1",
    "question": "Find number of tracks in each genre?",
    "sql": "SELECT count(*) ,  T1.name FROM genres AS T1 JOIN tracks AS T2 ON T1.id = T2.genre_id GROUP BY T1.name;",
    "table_names": [
      "genres",
      "tracks"
    ]
  },
  {
    "id": 185,
    "db_id": "store_1",
    "question": "How many tracks are in each genre?",
    "sql": "SELECT count(*) ,  T1.name FROM genres AS T1 JOIN tracks AS T2 ON T1.id = T2.genre_id GROUP BY T1.name;",
    "table_names": [
      "genres",
      "tracks"
    ]
  },
  {
    "id": 239,
    "db_id": "chinook_1",
    "question": "Show the album names, ids and the number of tracks for each album.",
    "sql": "SELECT T1.Title ,  T2.AlbumID ,  COUNT(*) FROM ALBUM AS T1 JOIN TRACK AS T2 ON T1.AlbumId  =  T2.AlbumId GROUP BY T2.AlbumID",
    "table_names": [
      "Album",
      "Track"
    ]
  },
  {
    "id": 240,
    "db_id": "chinook_1",
    "question": "What are the names and ids of the different albums, and how many tracks are on each?",
    "sql": "SELECT T1.Title ,  T2.AlbumID ,  COUNT(*) FROM ALBUM AS T1 JOIN TRACK AS T2 ON T1.AlbumId  =  T2.AlbumId GROUP BY T2.AlbumID",
    "table_names": [
      "Album",
      "Track"
    ]
  },
  {
    "id": 241,
    "db_id": "chinook_1",
    "question": "What is the name of the most common genre in all tracks?",
    "sql": "SELECT T1.Name FROM GENRE AS T1 JOIN TRACK AS T2 ON T1.GenreId  =  T2.GenreId GROUP BY T2.GenreId ORDER BY COUNT(*) DESC LIMIT 1",
    "table_names": [
      "Genre",
      "Track"
    ]
  },
  {
    "id": 242,
    "db_id": "chinook_1",
    "question": "Find the name of the genre that is most frequent across all tracks.",
    "sql": "SELECT T1.Name FROM GENRE AS T1 JOIN TRACK AS T2 ON T1.GenreId  =  T2.GenreId GROUP BY T2.GenreId ORDER BY COUNT(*) DESC LIMIT 1",
    "table_names": [
      "Genre",
      "Track"
    ]
  },
  {
    "id": 243,
    "db_id": "chinook_1",
    "question": "What is the least common media type in all tracks?",
    "sql": "SELECT T1.Name FROM MEDIATYPE AS T1 JOIN TRACK AS T2 ON T1.MediaTypeId  =  T2.MediaTypeId GROUP BY T2.MediaTypeId ORDER BY COUNT(*) ASC LIMIT 1",
    "table_names": [
      "MediaType",
      "Track"
    ]
  },
  {
    "id": 244,
    "db_id": "chinook_1",
    "question": "What is the name of the media type that is least common across all tracks?",
    "sql": "SELECT T1.Name FROM MEDIATYPE AS T1 JOIN TRACK AS T2 ON T1.MediaTypeId  =  T2.MediaTypeId GROUP BY T2.MediaTypeId ORDER BY COUNT(*) ASC LIMIT 1",
    "table_names": [
      "MediaType",
      "Track"
    ]
  },
  {
    "id": 245,
    "db_id": "chinook_1",
    "question": "Show the album names and ids for albums that contain tracks with unit price bigger than 1.",
    "sql": "SELECT T1.Title ,  T2.AlbumID FROM ALBUM AS T1 JOIN TRACK AS T2 ON T1.AlbumId  =  T2.AlbumId WHERE T2.UnitPrice  >  1 GROUP BY T2.AlbumID",
    "table_names": [
      "Album",
      "Track"
    ]
  },
  {
    "id": 246,
    "db_id": "chinook_1",
    "question": "What are the titles and ids for albums containing tracks with unit price greater than 1?",
    "sql": "SELECT T1.Title ,  T2.AlbumID FROM ALBUM AS T1 JOIN TRACK AS T2 ON T1.AlbumId  =  T2.AlbumId WHERE T2.UnitPrice  >  1 GROUP BY T2.AlbumID",
    "table_names": [
      "Album",
      "Track"
    ]
  },
  {
    "id": 247,
    "db_id": "chinook_1",
    "question": "How many tracks belong to rock genre?",
    "sql": "SELECT COUNT(*) FROM GENRE AS T1 JOIN TRACK AS T2 ON T1.GenreId  =  T2.GenreId WHERE T1.Name  =  \"Rock\"",
    "table_names": [
      "Genre",
      "Track"
    ]
  },
  {
    "id": 248,
    "db_id": "chinook_1",
    "question": "Count the number of tracks that are part of the rock genre.",
    "sql": "SELECT COUNT(*) FROM GENRE AS T1 JOIN TRACK AS T2 ON T1.GenreId  =  T2.GenreId WHERE T1.Name  =  \"Rock\"",
    "table_names": [
      "Genre",
      "Track"
    ]
  },
  {
    "id": 249,
    "db_id": "chinook_1",
    "question": "What is the average unit price of tracks that belong to Jazz genre?",
    "sql": "SELECT AVG(UnitPrice) FROM GENRE AS T1 JOIN TRACK AS T2 ON T1.GenreId  =  T2.GenreId WHERE T1.Name  =  \"Jazz\"",
    "table_names": [
      "Genre",
      "Track"
    ]
  },
  {
    "id": 250,
    "db_id": "chinook_1",
    "question": "Find the average unit price of jazz tracks.",
    "sql": "SELECT AVG(UnitPrice) FROM GENRE AS T1 JOIN TRACK AS T2 ON T1.GenreId  =  T2.GenreId WHERE T1.Name  =  \"Jazz\"",
    "table_names": [
      "Genre",
      "Track"
    ]
  },
  {
    "id": 258,
    "db_id": "chinook_1",
    "question": "What are the last names of customers without invoice totals exceeding 20?",
    "sql": "SELECT LastName FROM CUSTOMER EXCEPT SELECT T1.LastName FROM CUSTOMER AS T1 JOIN Invoice AS T2 ON T1.CustomerId  =  T2.CustomerId WHERE T2.total  >  20",
    "table_names": [
      "Customer",
      "Invoice"
    ]
  },
  {
    "id": 259,
    "db_id": "chinook_1",
    "question": "Find the first names of all customers that live in Brazil and have an invoice.",
    "sql": "SELECT DISTINCT T1.FirstName FROM CUSTOMER AS T1 JOIN INVOICE AS T2 ON T1.CustomerId  =  T2.CustomerId WHERE T1.country  =  \"Brazil\"",
    "table_names": [
      "Customer",
      "Invoice"
    ]
  },
  {
    "id": 260,
    "db_id": "chinook_1",
    "question": "What are the different first names for customers from Brazil who have also had an invoice?",
    "sql": "SELECT DISTINCT T1.FirstName FROM CUSTOMER AS T1 JOIN INVOICE AS T2 ON T1.CustomerId  =  T2.CustomerId WHERE T1.country  =  \"Brazil\"",
    "table_names": [
      "Customer",
      "Invoice"
    ]
  },
  {
    "id": 261,
    "db_id": "chinook_1",
    "question": "Find the address of all customers that live in Germany and have invoice.",
    "sql": "SELECT DISTINCT T1.Address FROM CUSTOMER AS T1 JOIN INVOICE AS T2 ON T1.CustomerId  =  T2.CustomerId WHERE T1.country  =  \"Germany\"",
    "table_names": [
      "Customer",
      "Invoice"
    ]
  },
  {
    "id": 262,
    "db_id": "chinook_1",
    "question": "What are the addresses of customers living in Germany who have had an invoice?",
    "sql": "SELECT DISTINCT T1.Address FROM CUSTOMER AS T1 JOIN INVOICE AS T2 ON T1.CustomerId  =  T2.CustomerId WHERE T1.country  =  \"Germany\"",
    "table_names": [
      "Customer",
      "Invoice"
    ]
  },
  {
    "id": 263,
    "db_id": "chinook_1",
    "question": "How many tracks are in the AAC audio file media type?",
    "sql": "SELECT COUNT(*) FROM MEDIATYPE AS T1 JOIN TRACK AS T2 ON T1.MediaTypeId  =  T2.MediaTypeId WHERE T1.Name  =  \"AAC audio file\"",
    "table_names": [
      "MediaType",
      "Track"
    ]
  },
  {
    "id": 264,
    "db_id": "chinook_1",
    "question": "Count the number of tracks that are of the media type \"AAC audio file\".",
    "sql": "SELECT COUNT(*) FROM MEDIATYPE AS T1 JOIN TRACK AS T2 ON T1.MediaTypeId  =  T2.MediaTypeId WHERE T1.Name  =  \"AAC audio file\"",
    "table_names": [
      "MediaType",
      "Track"
    ]
  },
  {
    "id": 265,
    "db_id": "chinook_1",
    "question": "What is the average duration in milliseconds of tracks that belong to Latin or Pop genre?",
    "sql": "SELECT AVG(Milliseconds) FROM GENRE AS T1 JOIN TRACK AS T2 ON T1.GenreId  =  T2.GenreId WHERE T1.Name  =  \"Latin\" OR T1.Name  =  \"Pop\"",
    "table_names": [
      "Genre",
      "Track"
    ]
  },
  {
    "id": 266,
    "db_id": "chinook_1",
    "question": "Find the average millisecond length of Latin and Pop tracks.",
    "sql": "SELECT AVG(Milliseconds) FROM GENRE AS T1 JOIN TRACK AS T2 ON T1.GenreId  =  T2.GenreId WHERE T1.Name  =  \"Latin\" OR T1.Name  =  \"Pop\"",
    "table_names": [
      "Genre",
      "Track"
    ]
  },
  {
    "id": 267,
    "db_id": "chinook_1",
    "question": "Please show the employee first names and ids of employees who serve at least 10 customers.",
    "sql": "SELECT T1.FirstName ,  T1.SupportRepId FROM CUSTOMER AS T1 JOIN EMPLOYEE AS T2 ON T1.SupportRepId  =  T2.EmployeeId GROUP BY T1.SupportRepId HAVING COUNT(*)  >=  10",
    "table_names": [
      "Customer",
      "Employee"
    ]
  },
  {
    "id": 268,
    "db_id": "chinook_1",
    "question": "What are the first names and support rep ids for employees serving 10 or more customers?",
    "sql": "SELECT T1.FirstName ,  T1.SupportRepId FROM CUSTOMER AS T1 JOIN EMPLOYEE AS T2 ON T1.SupportRepId  =  T2.EmployeeId GROUP BY T1.SupportRepId HAVING COUNT(*)  >=  10",
    "table_names": [
      "Customer",
      "Employee"
    ]
  },
  {
    "id": 269,
    "db_id": "chinook_1",
    "question": "Please show the employee last names that serves no more than 20 customers.",
    "sql": "SELECT T1.LastName FROM CUSTOMER AS T1 JOIN EMPLOYEE AS T2 ON T1.SupportRepId  =  T2.EmployeeId GROUP BY T1.SupportRepId HAVING COUNT(*)  <=  20",
    "table_names": [
      "Customer",
      "Employee"
    ]
  },
  {
    "id": 270,
    "db_id": "chinook_1",
    "question": "What are the last names of employees who serve at most 20 customers?",
    "sql": "SELECT T1.LastName FROM CUSTOMER AS T1 JOIN EMPLOYEE AS T2 ON T1.SupportRepId  =  T2.EmployeeId GROUP BY T1.SupportRepId HAVING COUNT(*)  <=  20",
    "table_names": [
      "Customer",
      "Employee"
    ]
  },
  {
    "id": 271,
    "db_id": "chinook_1",
    "question": "Please list the name and id of all artists that have at least 3 albums in alphabetical order.",
    "sql": "SELECT T2.Name ,  T1.ArtistId FROM ALBUM AS T1 JOIN ARTIST AS T2 ON T1.ArtistId  =  T2.ArtistID GROUP BY T1.ArtistId HAVING COUNT(*)  >=  3 ORDER BY T2.Name",
    "table_names": [
      "Album",
      "Artist"
    ]
  },
  {
    "id": 272,
    "db_id": "chinook_1",
    "question": "What are the names and ids of artists with 3 or more albums, listed in alphabetical order?",
    "sql": "SELECT T2.Name ,  T1.ArtistId FROM ALBUM AS T1 JOIN ARTIST AS T2 ON T1.ArtistId  =  T2.ArtistID GROUP BY T1.ArtistId HAVING COUNT(*)  >=  3 ORDER BY T2.Name",
    "table_names": [
      "Album",
      "Artist"
    ]
  },
  {
    "id": 273,
    "db_id": "chinook_1",
    "question": "Find the names of artists that do not have any albums.",
    "sql": "SELECT Name FROM ARTIST EXCEPT SELECT T2.Name FROM ALBUM AS T1 JOIN ARTIST AS T2 ON T1.ArtistId  =  T2.ArtistId",
    "table_names": [
      "Album",
      "Artist"
    ]
  },
  {
    "id": 274,
    "db_id": "chinook_1",
    "question": "What are the names of artists who have not released any albums?",
    "sql": "SELECT Name FROM ARTIST EXCEPT SELECT T2.Name FROM ALBUM AS T1 JOIN ARTIST AS T2 ON T1.ArtistId  =  T2.ArtistId",
    "table_names": [
      "Album",
      "Artist"
    ]
  },
  {
    "id": 275,
    "db_id": "chinook_1",
    "question": "What is the average unit price of rock tracks?",
    "sql": "SELECT AVG(T2.UnitPrice) FROM GENRE AS T1 JOIN TRACK AS T2 ON T1.GenreId  =  T2.GenreId WHERE T1.Name  =  \"Rock\"",
    "table_names": [
      "Genre",
      "Track"
    ]
  },
  {
    "id": 276,
    "db_id": "chinook_1",
    "question": "Find the average unit price of tracks from the Rock genre.",
    "sql": "SELECT AVG(T2.UnitPrice) FROM GENRE AS T1 JOIN TRACK AS T2 ON T1.GenreId  =  T2.GenreId WHERE T1.Name  =  \"Rock\"",
    "table_names": [
      "Genre",
      "Track"
    ]
  },
  {
    "id": 277,
    "db_id": "chinook_1",
    "question": "What are the duration of the longest and shortest pop tracks in milliseconds?",
    "sql": "SELECT max(Milliseconds) ,  min(Milliseconds) FROM GENRE AS T1 JOIN TRACK AS T2 ON T1.GenreId  =  T2.GenreId WHERE T1.Name  =  \"Pop\"",
    "table_names": [
      "Genre",
      "Track"
    ]
  },
  {
    "id": 278,
    "db_id": "chinook_1",
    "question": "Find the maximum and minimum millisecond lengths of pop tracks.",
    "sql": "SELECT max(Milliseconds) ,  min(Milliseconds) FROM GENRE AS T1 JOIN TRACK AS T2 ON T1.GenreId  =  T2.GenreId WHERE T1.Name  =  \"Pop\"",
    "table_names": [
      "Genre",
      "Track"
    ]
  },
  {
    "id": 279,
    "db_id": "chinook_1",
    "question": "How many artists do not have any album?",
    "sql": "SELECT count(*) FROM ARTIST WHERE artistid NOT IN(SELECT artistid FROM ALBUM)",
    "table_names": [
      "Album",
      "Artist"
    ]
  },
  {
    "id": 280,
    "db_id": "chinook_1",
    "question": "Cound the number of artists who have not released an album.",
    "sql": "SELECT count(*) FROM ARTIST WHERE artistid NOT IN(SELECT artistid FROM ALBUM)",
    "table_names": [
      "Album",
      "Artist"
    ]
  },
  {
    "id": 323,
    "db_id": "phone_1",
    "question": "List the hardware model name for the phones that were produced by \"Nokia Corporation\" or whose screen mode type is \"Graphics.\"",
    "sql": "SELECT DISTINCT T2.Hardware_Model_name FROM screen_mode AS T1 JOIN phone AS T2 ON T1.Graphics_mode = T2.screen_mode WHERE T1.Type  =  \"Graphics\" OR t2.Company_name  =  \"Nokia Corporation\"",
    "table_names": [
      "screen_mode",
      "phone"
    ]
  },
  {
    "id": 422,
    "db_id": "apartment_rentals",
    "question": "Which apartments have unit status availability of both 0 and 1? Return their apartment numbers.",
    "sql": "SELECT T1.apt_number FROM Apartments AS T1 JOIN View_Unit_Status AS T2 ON T1.apt_id  =  T2.apt_id WHERE T2.available_yn  =  0 INTERSECT SELECT T1.apt_number FROM Apartments AS T1 JOIN View_Unit_Status AS T2 ON T1.apt_id  =  T2.apt_id WHERE T2.available_yn  =  1",
    "table_names": [
      "Apartments",
      "View_Unit_Status"
    ]
  },
  {
    "id": 423,
    "db_id": "game_injury",
    "question": "What is the season of the game which causes the player 'Walter Samuel' to get injured?",
    "sql": "SELECT T1.season FROM game AS T1 JOIN injury_accident AS T2 ON T1.id  =  T2.game_id WHERE T2.player  =  'Walter Samuel'",
    "table_names": [
      "game",
      "injury_accident"
    ]
  },
  {
    "id": 424,
    "db_id": "game_injury",
    "question": "What are the ids, scores, and dates of the games which caused at least two injury accidents?",
    "sql": "SELECT T1.id ,  T1.score ,  T1.date FROM game AS T1 JOIN injury_accident AS T2 ON T2.game_id  =  T1.id GROUP BY T1.id HAVING count(*)  >=  2",
    "table_names": [
      "game",
      "injury_accident"
    ]
  },
  {
    "id": 425,
    "db_id": "game_injury",
    "question": "How many games are free of injury accidents?",
    "sql": "SELECT count(*) FROM game WHERE id NOT IN ( SELECT game_id FROM injury_accident )",
    "table_names": [
      "game",
      "injury_accident"
    ]
  },
  {
    "id": 426,
    "db_id": "game_injury",
    "question": "How many distinct kinds of injuries happened after season 2010?",
    "sql": "SELECT count(DISTINCT T1.injury) FROM injury_accident AS T1 JOIN game AS T2 ON T1.game_id  =  T2.id WHERE T2.season  >  2010",
    "table_names": [
      "game",
      "injury_accident"
    ]
  },
  {
    "id": 427,
    "db_id": "game_injury",
    "question": "How many games has each stadium held?",
    "sql": "SELECT T1.id ,  count(*) FROM stadium AS T1 JOIN game AS T2 ON T1.id  =  T2.stadium_id GROUP BY T1.id",
    "table_names": [
      "stadium",
      "game"
    ]
  },
  {
    "id": 428,
    "db_id": "game_injury",
    "question": "For each injury accident, find the date of the game and the name of the injured player in the game, and sort the results in descending order of game season.",
    "sql": "SELECT T1.date ,  T2.player FROM game AS T1 JOIN injury_accident AS T2 ON T1.id  =  T2.game_id ORDER BY T1.season DESC",
    "table_names": [
      "game",
      "injury_accident"
    ]
  },
  {
    "id": 431,
    "db_id": "soccer_1",
    "question": "List all player names who have an overall rating higher than the average.",
    "sql": "SELECT DISTINCT T1.player_name FROM Player AS T1 JOIN Player_Attributes AS T2 ON T1.player_api_id = T2.player_api_id WHERE T2.overall_rating  >  ( SELECT avg(overall_rating) FROM Player_Attributes )",
    "table_names": [
      "Player_Attributes",
      "Player"
    ]
  },
  {
    "id": 432,
    "db_id": "soccer_1",
    "question": "What are the names of players who have the best dribbling?",
    "sql": "SELECT DISTINCT T1.player_name FROM Player AS T1 JOIN Player_Attributes AS T2 ON T1.player_api_id = T2.player_api_id WHERE T2.dribbling  =  ( SELECT max(overall_rating) FROM Player_Attributes)",
    "table_names": [
      "Player_Attributes",
      "Player"
    ]
  },
  {
    "id": 433,
    "db_id": "soccer_1",
    "question": "List the names of all players who have a crossing score higher than 90 and prefer their right foot.",
    "sql": "SELECT DISTINCT T1.player_name FROM Player AS T1 JOIN Player_Attributes AS T2 ON T1.player_api_id = T2.player_api_id WHERE T2.crossing  >  90 AND T2.preferred_foot  =  \"right\"",
    "table_names": [
      "Player_Attributes",
      "Player"
    ]
  },
  {
    "id": 434,
    "db_id": "soccer_1",
    "question": "List the names of all left-footed players who have overall rating between 85 and 90.",
    "sql": "SELECT DISTINCT T1.player_name FROM Player AS T1 JOIN Player_Attributes AS T2 ON T1.player_api_id = T2.player_api_id WHERE T2.preferred_foot  =  \"left\" AND T2.overall_rating  >=  85 AND T2.overall_rating  <=  90",
    "table_names": [
      "Player_Attributes",
      "Player"
    ]
  },
  {
    "id": 435,
    "db_id": "soccer_1",
    "question": "List all of the player ids with a height of at least 180cm and an overall rating higher than 85.",
    "sql": "SELECT player_api_id FROM Player WHERE height  >=  180 INTERSECT SELECT player_api_id FROM Player_Attributes WHERE overall_rating  >  85",
    "table_names": [
      "Player_Attributes",
      "Player"
    ]
  },
  {
    "id": 436,
    "db_id": "soccer_1",
    "question": "List all of the ids for left-footed players with a height between 180cm and 190cm.",
    "sql": "SELECT player_api_id FROM Player WHERE height  >=  180 AND height  <=  190 INTERSECT SELECT player_api_id FROM Player_Attributes WHERE preferred_foot  =  \"left\"",
    "table_names": [
      "Player_Attributes",
      "Player"
    ]
  },
  {
    "id": 437,
    "db_id": "soccer_1",
    "question": "Who are the top 3 players in terms of overall rating?",
    "sql": "SELECT DISTINCT T1.player_name FROM Player AS T1 JOIN Player_Attributes AS T2 ON T1.player_api_id  =  T2.player_api_id ORDER BY overall_rating DESC LIMIT 3",
    "table_names": [
      "Player_Attributes",
      "Player"
    ]
  },
  {
    "id": 438,
    "db_id": "soccer_1",
    "question": "List the names and birthdays of the top five players in terms of potential.",
    "sql": "SELECT DISTINCT T1.player_name ,  T1.birthday FROM Player AS T1 JOIN Player_Attributes AS T2 ON T1.player_api_id  =  T2.player_api_id ORDER BY potential DESC LIMIT 5",
    "table_names": [
      "Player_Attributes",
      "Player"
    ]
  },
  {
    "id": 440,
    "db_id": "college_2",
    "question": "Find the title of courses that have two prerequisites?",
    "sql": "SELECT T1.title FROM course AS T1 JOIN prereq AS T2 ON T1.course_id  =  T2.course_id GROUP BY T2.course_id HAVING count(*)  =  2",
    "table_names": [
      "course",
      "prereq"
    ]
  },
  {
    "id": 441,
    "db_id": "college_2",
    "question": "What are the titles for courses with two prerequisites?",
    "sql": "SELECT T1.title FROM course AS T1 JOIN prereq AS T2 ON T1.course_id  =  T2.course_id GROUP BY T2.course_id HAVING count(*)  =  2",
    "table_names": [
      "course",
      "prereq"
    ]
  },
  {
    "id": 442,
    "db_id": "college_2",
    "question": "Find the title, credit, and department name of courses that have more than one prerequisites?",
    "sql": "SELECT T1.title ,  T1.credits , T1.dept_name FROM course AS T1 JOIN prereq AS T2 ON T1.course_id  =  T2.course_id GROUP BY T2.course_id HAVING count(*)  >  1",
    "table_names": [
      "course",
      "prereq"
    ]
  },
  {
    "id": 443,
    "db_id": "college_2",
    "question": "What is the title, credit value, and department name for courses with more than one prerequisite?",
    "sql": "SELECT T1.title ,  T1.credits , T1.dept_name FROM course AS T1 JOIN prereq AS T2 ON T1.course_id  =  T2.course_id GROUP BY T2.course_id HAVING count(*)  >  1",
    "table_names": [
      "course",
      "prereq"
    ]
  },
  {
    "id": 444,
    "db_id": "college_2",
    "question": "How many courses that do not have prerequisite?",
    "sql": "SELECT count(*) FROM course WHERE course_id NOT IN (SELECT course_id FROM prereq)",
    "table_names": [
      "course",
      "prereq"
    ]
  },
  {
    "id": 445,
    "db_id": "college_2",
    "question": "Count the number of courses without prerequisites.",
    "sql": "SELECT count(*) FROM course WHERE course_id NOT IN (SELECT course_id FROM prereq)",
    "table_names": [
      "course",
      "prereq"
    ]
  },
  {
    "id": 446,
    "db_id": "college_2",
    "question": "Find the name of the courses that do not have any prerequisite?",
    "sql": "SELECT title FROM course WHERE course_id NOT IN (SELECT course_id FROM prereq)",
    "table_names": [
      "course",
      "prereq"
    ]
  },
  {
    "id": 447,
    "db_id": "college_2",
    "question": "What are the titles of courses without prerequisites?",
    "sql": "SELECT title FROM course WHERE course_id NOT IN (SELECT course_id FROM prereq)",
    "table_names": [
      "course",
      "prereq"
    ]
  },
  {
    "id": 448,
    "db_id": "college_2",
    "question": "Find the name of students who took any class in the years of 2009 and 2010.",
    "sql": "SELECT DISTINCT T1.name FROM student AS T1 JOIN takes AS T2 ON T1.id  =  T2.id WHERE YEAR  =  2009 OR YEAR  =  2010",
    "table_names": [
      "student",
      "takes"
    ]
  },
  {
    "id": 449,
    "db_id": "college_2",
    "question": "What are the names of the students who took classes in 2009 or 2010?",
    "sql": "SELECT DISTINCT T1.name FROM student AS T1 JOIN takes AS T2 ON T1.id  =  T2.id WHERE YEAR  =  2009 OR YEAR  =  2010",
    "table_names": [
      "student",
      "takes"
    ]
  },
  {
    "id": 450,
    "db_id": "college_2",
    "question": "Find the name of instructors who are advising more than one student.",
    "sql": "SELECT T1.name FROM instructor AS T1 JOIN advisor AS T2 ON T1.id  =  T2.i_id GROUP BY T2.i_id HAVING count(*)  >  1",
    "table_names": [
      "instructor",
      "advisor"
    ]
  },
  {
    "id": 451,
    "db_id": "college_2",
    "question": "What are the names of instructors who advise more than one student?",
    "sql": "SELECT T1.name FROM instructor AS T1 JOIN advisor AS T2 ON T1.id  =  T2.i_id GROUP BY T2.i_id HAVING count(*)  >  1",
    "table_names": [
      "instructor",
      "advisor"
    ]
  },
  {
    "id": 452,
    "db_id": "college_2",
    "question": "What is the id of the instructor who advises of all students from History department?",
    "sql": "SELECT i_id FROM advisor AS T1 JOIN student AS T2 ON T1.s_id  =  T2.id WHERE T2.dept_name  =  'History'",
    "table_names": [
      "student",
      "advisor"
    ]
  },
  {
    "id": 453,
    "db_id": "college_2",
    "question": "Give id of the instructor who advises students in the History department.",
    "sql": "SELECT i_id FROM advisor AS T1 JOIN student AS T2 ON T1.s_id  =  T2.id WHERE T2.dept_name  =  'History'",
    "table_names": [
      "student",
      "advisor"
    ]
  },
  {
    "id": 454,
    "db_id": "college_2",
    "question": "Find the id of the courses that do not have any prerequisite?",
    "sql": "SELECT course_id FROM course EXCEPT SELECT course_id FROM prereq",
    "table_names": [
      "course",
      "prereq"
    ]
  },
  {
    "id": 455,
    "db_id": "college_2",
    "question": "What are the ids of courses without prerequisites?",
    "sql": "SELECT course_id FROM course EXCEPT SELECT course_id FROM prereq",
    "table_names": [
      "course",
      "prereq"
    ]
  },
  {
    "id": 456,
    "db_id": "college_2",
    "question": "Find the name of the courses that do not have any prerequisite?",
    "sql": "SELECT title FROM course WHERE course_id NOT IN (SELECT course_id FROM prereq)",
    "table_names": [
      "course",
      "prereq"
    ]
  },
  {
    "id": 457,
    "db_id": "college_2",
    "question": "What are the names of courses without prerequisites?",
    "sql": "SELECT title FROM course WHERE course_id NOT IN (SELECT course_id FROM prereq)",
    "table_names": [
      "course",
      "prereq"
    ]
  },
  {
    "id": 458,
    "db_id": "college_2",
    "question": "What is the title of the prerequisite class of International Finance course?",
    "sql": "SELECT title FROM course WHERE course_id IN (SELECT T1.prereq_id FROM prereq AS T1 JOIN course AS T2 ON T1.course_id  =  T2.course_id WHERE T2.title  =  'International Finance')",
    "table_names": [
      "course",
      "prereq"
    ]
  },
  {
    "id": 459,
    "db_id": "college_2",
    "question": "Give the title of the prerequisite to the course International Finance.",
    "sql": "SELECT title FROM course WHERE course_id IN (SELECT T1.prereq_id FROM prereq AS T1 JOIN course AS T2 ON T1.course_id  =  T2.course_id WHERE T2.title  =  'International Finance')",
    "table_names": [
      "course",
      "prereq"
    ]
  },
  {
    "id": 460,
    "db_id": "college_2",
    "question": "Find the title of course whose prerequisite is course Differential Geometry.",
    "sql": "SELECT title FROM course WHERE course_id IN (SELECT T1.course_id FROM prereq AS T1 JOIN course AS T2 ON T1.prereq_id  =  T2.course_id WHERE T2.title  =  'Differential Geometry')",
    "table_names": [
      "course",
      "prereq"
    ]
  },
  {
    "id": 461,
    "db_id": "college_2",
    "question": "What is the title of the course with Differential Geometry as a prerequisite?",
    "sql": "SELECT title FROM course WHERE course_id IN (SELECT T1.course_id FROM prereq AS T1 JOIN course AS T2 ON T1.prereq_id  =  T2.course_id WHERE T2.title  =  'Differential Geometry')",
    "table_names": [
      "course",
      "prereq"
    ]
  },
  {
    "id": 462,
    "db_id": "college_2",
    "question": "Find the names of students who have taken any course in the fall semester of year 2003.",
    "sql": "SELECT name FROM student WHERE id IN (SELECT id FROM takes WHERE semester  =  'Fall' AND YEAR  =  2003)",
    "table_names": [
      "student",
      "takes"
    ]
  },
  {
    "id": 463,
    "db_id": "college_2",
    "question": "What are the names of students who took a course in the Fall of 2003?",
    "sql": "SELECT name FROM student WHERE id IN (SELECT id FROM takes WHERE semester  =  'Fall' AND YEAR  =  2003)",
    "table_names": [
      "student",
      "takes"
    ]
  },
  {
    "id": 464,
    "db_id": "college_2",
    "question": "What is the title of the course that was offered at building Chandler during the fall semester in the year of 2010?",
    "sql": "SELECT T1.title FROM course AS T1 JOIN SECTION AS T2 ON T1.course_id  =  T2.course_id WHERE building  =  'Chandler' AND semester  =  'Fall' AND YEAR  =  2010",
    "table_names": [
      "course",
      "section"
    ]
  },
  {
    "id": 465,
    "db_id": "college_2",
    "question": "Give the title of the course offered in Chandler during the Fall of 2010.",
    "sql": "SELECT T1.title FROM course AS T1 JOIN SECTION AS T2 ON T1.course_id  =  T2.course_id WHERE building  =  'Chandler' AND semester  =  'Fall' AND YEAR  =  2010",
    "table_names": [
      "course",
      "section"
    ]
  },
  {
    "id": 466,
    "db_id": "college_2",
    "question": "What is the course title of the prerequisite of course Mobile Computing?",
    "sql": "SELECT title FROM course WHERE course_id IN (SELECT T1.prereq_id FROM prereq AS T1 JOIN course AS T2 ON T1.course_id  =  T2.course_id WHERE T2.title  =  'Mobile Computing')",
    "table_names": [
      "course",
      "prereq"
    ]
  },
  {
    "id": 467,
    "db_id": "college_2",
    "question": "What is the title of the course that is a prerequisite for Mobile Computing?",
    "sql": "SELECT title FROM course WHERE course_id IN (SELECT T1.prereq_id FROM prereq AS T1 JOIN course AS T2 ON T1.course_id  =  T2.course_id WHERE T2.title  =  'Mobile Computing')",
    "table_names": [
      "course",
      "prereq"
    ]
  },
  {
    "id": 468,
    "db_id": "college_2",
    "question": "Find the name of instructors who didn't teach any courses?",
    "sql": "SELECT name FROM instructor WHERE id NOT IN (SELECT id FROM teaches)",
    "table_names": [
      "instructor",
      "teaches"
    ]
  },
  {
    "id": 469,
    "db_id": "college_2",
    "question": "What are the names of instructors who didn't teach?",
    "sql": "SELECT name FROM instructor WHERE id NOT IN (SELECT id FROM teaches)",
    "table_names": [
      "instructor",
      "teaches"
    ]
  },
  {
    "id": 470,
    "db_id": "college_2",
    "question": "Find the id of instructors who didn't teach any courses?",
    "sql": "SELECT id FROM instructor EXCEPT SELECT id FROM teaches",
    "table_names": [
      "instructor",
      "teaches"
    ]
  },
  {
    "id": 471,
    "db_id": "college_2",
    "question": "What are the ids of instructors who didnt' teach?",
    "sql": "SELECT id FROM instructor EXCEPT SELECT id FROM teaches",
    "table_names": [
      "instructor",
      "teaches"
    ]
  },
  {
    "id": 472,
    "db_id": "college_2",
    "question": "Find the names of instructors who didn't each any courses in any Spring semester.",
    "sql": "SELECT name FROM instructor WHERE id NOT IN (SELECT id FROM teaches WHERE semester  =  'Spring')",
    "table_names": [
      "instructor",
      "teaches"
    ]
  },
  {
    "id": 473,
    "db_id": "college_2",
    "question": "What are the names of instructors who didn't teach courses in the Spring?",
    "sql": "SELECT name FROM instructor WHERE id NOT IN (SELECT id FROM teaches WHERE semester  =  'Spring')",
    "table_names": [
      "instructor",
      "teaches"
    ]
  },
  {
    "id": 474,
    "db_id": "college_2",
    "question": "Find the number and averaged salary of all instructors who are in the department with the highest budget.",
    "sql": "SELECT avg(T1.salary) ,  count(*) FROM instructor AS T1 JOIN department AS T2 ON T1.dept_name  =  T2.dept_name ORDER BY T2.budget DESC LIMIT 1",
    "table_names": [
      "department",
      "instructor"
    ]
  },
  {
    "id": 475,
    "db_id": "college_2",
    "question": "How many instructors are in the department with the highest budget, and what is their average salary?",
    "sql": "SELECT avg(T1.salary) ,  count(*) FROM instructor AS T1 JOIN department AS T2 ON T1.dept_name  =  T2.dept_name ORDER BY T2.budget DESC LIMIT 1",
    "table_names": [
      "department",
      "instructor"
    ]
  },
  {
    "id": 476,
    "db_id": "college_2",
    "question": "Find the building, room number, semester and year of all courses offered by Psychology department sorted by course titles.",
    "sql": "SELECT T2.building ,  T2.room_number ,  T2.semester ,  T2.year FROM course AS T1 JOIN SECTION AS T2 ON T1.course_id  =  T2.course_id WHERE T1.dept_name  =  'Psychology' ORDER BY T1.title",
    "table_names": [
      "course",
      "section"
    ]
  },
  {
    "id": 477,
    "db_id": "college_2",
    "question": "What are the building, room number, semester and year of courses in the Psychology department, sorted using course title?",
    "sql": "SELECT T2.building ,  T2.room_number ,  T2.semester ,  T2.year FROM course AS T1 JOIN SECTION AS T2 ON T1.course_id  =  T2.course_id WHERE T1.dept_name  =  'Psychology' ORDER BY T1.title",
    "table_names": [
      "course",
      "section"
    ]
  },
  {
    "id": 478,
    "db_id": "college_2",
    "question": "Find the names of all instructors who have taught some course and the course_id.",
    "sql": "SELECT name ,  course_id FROM instructor AS T1 JOIN teaches AS T2 ON T1.ID  =  T2.ID",
    "table_names": [
      "instructor",
      "teaches"
    ]
  },
  {
    "id": 479,
    "db_id": "college_2",
    "question": "What are the names of all instructors who have taught a course, as well as the corresponding course id?",
    "sql": "SELECT name ,  course_id FROM instructor AS T1 JOIN teaches AS T2 ON T1.ID  =  T2.ID",
    "table_names": [
      "instructor",
      "teaches"
    ]
  },
  {
    "id": 704,
    "db_id": "formula_1",
    "question": "How many drivers participated in the race Australian Grand Prix held in 2009?",
    "sql": "SELECT count(*) FROM results AS T1 JOIN races AS T2 ON T1.raceid = T2.raceid WHERE T2.name = \"Australian Grand Prix\" AND YEAR = 2009",
    "table_names": [
      "races",
      "results"
    ]
  },
  {
    "id": 705,
    "db_id": "formula_1",
    "question": "How many drivers were in the Australian Grand Prix held in 2009?",
    "sql": "SELECT count(*) FROM results AS T1 JOIN races AS T2 ON T1.raceid = T2.raceid WHERE T2.name = \"Australian Grand Prix\" AND YEAR = 2009",
    "table_names": [
      "races",
      "results"
    ]
  },
  {
    "id": 706,
    "db_id": "formula_1",
    "question": "How many drivers did not participate in the races held in 2009?",
    "sql": "SELECT count(DISTINCT driverId) FROM results WHERE raceId NOT IN( SELECT raceId FROM races WHERE YEAR != 2009 )",
    "table_names": [
      "races",
      "results"
    ]
  },
  {
    "id": 707,
    "db_id": "formula_1",
    "question": "How many drivers did not race in 2009?",
    "sql": "SELECT count(DISTINCT driverId) FROM results WHERE raceId NOT IN( SELECT raceId FROM races WHERE YEAR != 2009 )",
    "table_names": [
      "races",
      "results"
    ]
  },
  {
    "id": 708,
    "db_id": "formula_1",
    "question": "Find all the forenames of distinct drivers who was in position 1 as standing and won?",
    "sql": "SELECT DISTINCT T1.forename FROM drivers AS T1 JOIN driverstandings AS T2 ON T1.driverid = T2.driverid WHERE T2.position = 1 AND T2.wins = 1",
    "table_names": [
      "drivers",
      "driverStandings"
    ]
  },
  {
    "id": 709,
    "db_id": "formula_1",
    "question": "What are all the different first names of the drivers who are in position as standing and won?",
    "sql": "SELECT DISTINCT T1.forename FROM drivers AS T1 JOIN driverstandings AS T2 ON T1.driverid = T2.driverid WHERE T2.position = 1 AND T2.wins = 1",
    "table_names": [
      "drivers",
      "driverStandings"
    ]
  },
  {
    "id": 710,
    "db_id": "formula_1",
    "question": "Find all the forenames of distinct drivers who won in position 1 as driver standing and had more than 20 points?",
    "sql": "SELECT DISTINCT T1.forename FROM drivers AS T1 JOIN driverstandings AS T2 ON T1.driverid = T2.driverid WHERE T2.position = 1 AND T2.wins = 1 AND T2.points > 20",
    "table_names": [
      "drivers",
      "driverStandings"
    ]
  },
  {
    "id": 711,
    "db_id": "formula_1",
    "question": "What are the first names of the different drivers who won in position 1 as driver standing and had more than 20 points?",
    "sql": "SELECT DISTINCT T1.forename FROM drivers AS T1 JOIN driverstandings AS T2 ON T1.driverid = T2.driverid WHERE T2.position = 1 AND T2.wins = 1 AND T2.points > 20",
    "table_names": [
      "drivers",
      "driverStandings"
    ]
  },
  {
    "id": 712,
    "db_id": "formula_1",
    "question": "What are the names of races that were held after 2017 and the circuits were in the country of Spain?",
    "sql": "SELECT T1.name FROM races AS T1 JOIN circuits AS T2 ON T1.circuitid = T2.circuitid WHERE T2.country = \"Spain\" AND T1.year > 2017",
    "table_names": [
      "circuits",
      "races"
    ]
  },
  {
    "id": 713,
    "db_id": "formula_1",
    "question": "What are the names of the races held after 2017 in Spain?",
    "sql": "SELECT T1.name FROM races AS T1 JOIN circuits AS T2 ON T1.circuitid = T2.circuitid WHERE T2.country = \"Spain\" AND T1.year > 2017",
    "table_names": [
      "circuits",
      "races"
    ]
  },
  {
    "id": 714,
    "db_id": "formula_1",
    "question": "What are the unique names of races that held after 2000 and the circuits were in Spain?",
    "sql": "SELECT DISTINCT T1.name FROM races AS T1 JOIN circuits AS T2 ON T1.circuitid = T2.circuitid WHERE T2.country = \"Spain\" AND T1.year > 2000",
    "table_names": [
      "circuits",
      "races"
    ]
  },
  {
    "id": 715,
    "db_id": "formula_1",
    "question": "What are the names of all races held after 2000 in Spain?",
    "sql": "SELECT DISTINCT T1.name FROM races AS T1 JOIN circuits AS T2 ON T1.circuitid = T2.circuitid WHERE T2.country = \"Spain\" AND T1.year > 2000",
    "table_names": [
      "circuits",
      "races"
    ]
  },
  {
    "id": 716,
    "db_id": "formula_1",
    "question": "What are the drivers' first, last names and id who had more than 8 pit stops or participated in more than 5 race results?",
    "sql": "SELECT T1.forename ,  T1.surname ,  T1.driverid FROM drivers AS T1 JOIN pitstops AS T2 ON T1.driverid  =  T2.driverid GROUP BY T1.driverid HAVING count(*)  >  8 UNION SELECT T1.forename ,  T1.surname ,  T1.driverid FROM drivers AS T1 JOIN results AS T2 ON T1.driverid  =  T2.driverid GROUP BY T1.driverid HAVING count(*)  >  5",
    "table_names": [
      "drivers",
      "results"
    ]
  },
  {
    "id": 717,
    "db_id": "formula_1",
    "question": "What are the drivers' first names,last names, and ids for all those that had more than 8 stops or participated in more than 5 races?",
    "sql": "SELECT T1.forename ,  T1.surname ,  T1.driverid FROM drivers AS T1 JOIN pitstops AS T2 ON T1.driverid  =  T2.driverid GROUP BY T1.driverid HAVING count(*)  >  8 UNION SELECT T1.forename ,  T1.surname ,  T1.driverid FROM drivers AS T1 JOIN results AS T2 ON T1.driverid  =  T2.driverid GROUP BY T1.driverid HAVING count(*)  >  5",
    "table_names": [
      "drivers",
      "results"
    ]
  },
  {
    "id": 718,
    "db_id": "formula_1",
    "question": "Find the names of Japanese constructors that have once earned more than 5 points?",
    "sql": "SELECT T1.name FROM constructors AS T1 JOIN constructorstandings AS T2 ON T1.constructorid = T2.constructorid WHERE T1.nationality = \"Japanese\" AND T2.points > 5",
    "table_names": [
      "constructors",
      "constructorStandings"
    ]
  },
  {
    "id": 719,
    "db_id": "formula_1",
    "question": "What are the names of all the Japanese constructors that have earned more than 5 points?",
    "sql": "SELECT T1.name FROM constructors AS T1 JOIN constructorstandings AS T2 ON T1.constructorid = T2.constructorid WHERE T1.nationality = \"Japanese\" AND T2.points > 5",
    "table_names": [
      "constructors",
      "constructorStandings"
    ]
  },
  {
    "id": 720,
    "db_id": "formula_1",
    "question": "What is the average fastest lap speed in race named 'Monaco Grand Prix' in 2008 ?",
    "sql": "SELECT avg(T2.fastestlapspeed) FROM races AS T1 JOIN results AS T2 ON T1.raceid = T2.raceid WHERE T1.year = 2008 AND T1.name = \"Monaco Grand Prix\"",
    "table_names": [
      "races",
      "results"
    ]
  },
  {
    "id": 721,
    "db_id": "formula_1",
    "question": "What is the average fastest lap speed for the Monaco Grand Prix in 2008?",
    "sql": "SELECT avg(T2.fastestlapspeed) FROM races AS T1 JOIN results AS T2 ON T1.raceid = T2.raceid WHERE T1.year = 2008 AND T1.name = \"Monaco Grand Prix\"",
    "table_names": [
      "races",
      "results"
    ]
  },
  {
    "id": 722,
    "db_id": "formula_1",
    "question": "What is the maximum fastest lap speed in race named 'Monaco Grand Prix' in 2008 ?",
    "sql": "SELECT max(T2.fastestlapspeed) FROM races AS T1 JOIN results AS T2 ON T1.raceid = T2.raceid WHERE T1.year = 2008 AND T1.name = \"Monaco Grand Prix\"",
    "table_names": [
      "races",
      "results"
    ]
  },
  {
    "id": 723,
    "db_id": "formula_1",
    "question": "What is the maximum fastest lap speed in the Monaco Grand Prix in 2008?",
    "sql": "SELECT max(T2.fastestlapspeed) FROM races AS T1 JOIN results AS T2 ON T1.raceid = T2.raceid WHERE T1.year = 2008 AND T1.name = \"Monaco Grand Prix\"",
    "table_names": [
      "races",
      "results"
    ]
  },
  {
    "id": 724,
    "db_id": "formula_1",
    "question": "What are the maximum fastest lap speed in races held after 2004 grouped by race name and ordered by year?",
    "sql": "SELECT max(T2.fastestlapspeed) ,  T1.name ,  T1.year FROM races AS T1 JOIN results AS T2 ON T1.raceid = T2.raceid WHERE T1.year > 2014 GROUP BY T1.name ORDER BY T1.year",
    "table_names": [
      "races",
      "results"
    ]
  },
  {
    "id": 725,
    "db_id": "formula_1",
    "question": "For each race name, What is the maximum fastest lap speed for races after 2004 ordered by year?",
    "sql": "SELECT max(T2.fastestlapspeed) ,  T1.name ,  T1.year FROM races AS T1 JOIN results AS T2 ON T1.raceid = T2.raceid WHERE T1.year > 2014 GROUP BY T1.name ORDER BY T1.year",
    "table_names": [
      "races",
      "results"
    ]
  },
  {
    "id": 726,
    "db_id": "formula_1",
    "question": "What are the average fastest lap speed in races held after 2004 grouped by race name and ordered by year?",
    "sql": "SELECT avg(T2.fastestlapspeed) ,  T1.name ,  T1.year FROM races AS T1 JOIN results AS T2 ON T1.raceid = T2.raceid WHERE T1.year > 2014 GROUP BY T1.name ORDER BY T1.year",
    "table_names": [
      "races",
      "results"
    ]
  },
  {
    "id": 727,
    "db_id": "formula_1",
    "question": "What is the average fastest lap speed for races held after 2004, for each race, ordered by year?",
    "sql": "SELECT avg(T2.fastestlapspeed) ,  T1.name ,  T1.year FROM races AS T1 JOIN results AS T2 ON T1.raceid = T2.raceid WHERE T1.year > 2014 GROUP BY T1.name ORDER BY T1.year",
    "table_names": [
      "races",
      "results"
    ]
  },
  {
    "id": 759,
    "db_id": "csu_1",
    "question": "What is the campus fee of \"San Jose State University\" in year 1996?",
    "sql": "SELECT campusfee FROM campuses AS T1 JOIN csu_fees AS T2 ON T1.id  =  t2.campus WHERE t1.campus  =  \"San Jose State University\" AND T2.year  =  1996",
    "table_names": [
      "Campuses",
      "csu_fees"
    ]
  },
  {
    "id": 760,
    "db_id": "csu_1",
    "question": "What is the campus fee for San Jose State University in 1996?",
    "sql": "SELECT campusfee FROM campuses AS T1 JOIN csu_fees AS T2 ON T1.id  =  t2.campus WHERE t1.campus  =  \"San Jose State University\" AND T2.year  =  1996",
    "table_names": [
      "Campuses",
      "csu_fees"
    ]
  },
  {
    "id": 761,
    "db_id": "csu_1",
    "question": "What is the campus fee of \"San Francisco State University\" in year 1996?",
    "sql": "SELECT campusfee FROM campuses AS T1 JOIN csu_fees AS T2 ON T1.id  =  t2.campus WHERE t1.campus  =  \"San Francisco State University\" AND T2.year  =  1996",
    "table_names": [
      "Campuses",
      "csu_fees"
    ]
  },
  {
    "id": 762,
    "db_id": "csu_1",
    "question": "What is the campus fee for San Francisco State University in 1996?",
    "sql": "SELECT campusfee FROM campuses AS T1 JOIN csu_fees AS T2 ON T1.id  =  t2.campus WHERE t1.campus  =  \"San Francisco State University\" AND T2.year  =  1996",
    "table_names": [
      "Campuses",
      "csu_fees"
    ]
  },
  {
    "id": 763,
    "db_id": "csu_1",
    "question": "Which campus has the most faculties in year 2003?",
    "sql": "SELECT T1.campus FROM campuses AS T1 JOIN faculty AS T2 ON T1.id  =  T2.campus WHERE T2.year  =  2003 ORDER BY T2.faculty DESC LIMIT 1",
    "table_names": [
      "Campuses",
      "faculty"
    ]
  },
  {
    "id": 764,
    "db_id": "csu_1",
    "question": "What campus has the most faculties in 2003?",
    "sql": "SELECT T1.campus FROM campuses AS T1 JOIN faculty AS T2 ON T1.id  =  T2.campus WHERE T2.year  =  2003 ORDER BY T2.faculty DESC LIMIT 1",
    "table_names": [
      "Campuses",
      "faculty"
    ]
  },
  {
    "id": 765,
    "db_id": "csu_1",
    "question": "report the total number of degrees granted between 1998 and 2002.",
    "sql": "SELECT T1.campus ,  sum(T2.degrees) FROM campuses AS T1 JOIN degrees AS T2 ON T1.id  =  T2.campus WHERE T2.year  >=  1998 AND T2.year  <=  2002 GROUP BY T1.campus",
    "table_names": [
      "Campuses",
      "degrees"
    ]
  },
  {
    "id": 766,
    "db_id": "csu_1",
    "question": "how many degrees were conferred between 1998 and 2002?",
    "sql": "SELECT T1.campus ,  sum(T2.degrees) FROM campuses AS T1 JOIN degrees AS T2 ON T1.id  =  T2.campus WHERE T2.year  >=  1998 AND T2.year  <=  2002 GROUP BY T1.campus",
    "table_names": [
      "Campuses",
      "degrees"
    ]
  },
  {
    "id": 767,
    "db_id": "csu_1",
    "question": "For each Orange county campus, report the number of degrees granted after 2000.",
    "sql": "SELECT T1.campus ,  sum(T2.degrees) FROM campuses AS T1 JOIN degrees AS T2 ON T1.id  =  T2.campus WHERE T1.county  =  \"Orange\" AND T2.year  >=  2000 GROUP BY T1.campus",
    "table_names": [
      "Campuses",
      "degrees"
    ]
  },
  {
    "id": 768,
    "db_id": "csu_1",
    "question": "What is the total number of degrees granted after 2000 for each Orange county campus?",
    "sql": "SELECT T1.campus ,  sum(T2.degrees) FROM campuses AS T1 JOIN degrees AS T2 ON T1.id  =  T2.campus WHERE T1.county  =  \"Orange\" AND T2.year  >=  2000 GROUP BY T1.campus",
    "table_names": [
      "Campuses",
      "degrees"
    ]
  },
  {
    "id": 769,
    "db_id": "csu_1",
    "question": "Find the names of the campus which has more faculties in 2002 than every campus in Orange county.",
    "sql": "SELECT T1.campus FROM campuses AS T1 JOIN faculty AS T2 ON T1.id  =  T2.campus WHERE T2.year  =  2002 AND faculty  >  (SELECT max(faculty) FROM campuses AS T1 JOIN faculty AS T2 ON T1.id  =  T2.campus WHERE T2.year  =  2002 AND T1.county  =  \"Orange\")",
    "table_names": [
      "Campuses",
      "faculty"
    ]
  },
  {
    "id": 770,
    "db_id": "csu_1",
    "question": "What are the names of the campus that have more faculties in 2002 than the maximum number in Orange county?",
    "sql": "SELECT T1.campus FROM campuses AS T1 JOIN faculty AS T2 ON T1.id  =  T2.campus WHERE T2.year  =  2002 AND faculty  >  (SELECT max(faculty) FROM campuses AS T1 JOIN faculty AS T2 ON T1.id  =  T2.campus WHERE T2.year  =  2002 AND T1.county  =  \"Orange\")",
    "table_names": [
      "Campuses",
      "faculty"
    ]
  },
  {
    "id": 771,
    "db_id": "csu_1",
    "question": "What campus had more than 400 total enrollment but more than 200 full time enrollment in year 1956?",
    "sql": "SELECT T1.campus FROM campuses AS t1 JOIN enrollments AS t2 ON t1.id  =  t2.campus WHERE t2.year  =  1956 AND totalenrollment_ay  >  400 AND FTE_AY  >  200",
    "table_names": [
      "Campuses",
      "enrollments"
    ]
  },
  {
    "id": 772,
    "db_id": "csu_1",
    "question": "What campus started in year 1956, has more than 200 full time students, and more than 400 students enrolled?",
    "sql": "SELECT T1.campus FROM campuses AS t1 JOIN enrollments AS t2 ON t1.id  =  t2.campus WHERE t2.year  =  1956 AND totalenrollment_ay  >  400 AND FTE_AY  >  200",
    "table_names": [
      "Campuses",
      "enrollments"
    ]
  },
  {
    "id": 773,
    "db_id": "csu_1",
    "question": "How many degrees were conferred in \"San Jose State University\" in 2000?",
    "sql": "SELECT degrees FROM campuses AS T1 JOIN degrees AS T2 ON t1.id  =  t2.campus WHERE t1.campus  =  \"San Jose State University\" AND t2.year  =  2000",
    "table_names": [
      "Campuses",
      "degrees"
    ]
  },
  {
    "id": 774,
    "db_id": "csu_1",
    "question": "How many degrees were conferred at San Jose State University in 2000?",
    "sql": "SELECT degrees FROM campuses AS T1 JOIN degrees AS T2 ON t1.id  =  t2.campus WHERE t1.campus  =  \"San Jose State University\" AND t2.year  =  2000",
    "table_names": [
      "Campuses",
      "degrees"
    ]
  },
  {
    "id": 775,
    "db_id": "csu_1",
    "question": "What are the degrees conferred in \"San Francisco State University\" in 2001.",
    "sql": "SELECT degrees FROM campuses AS T1 JOIN degrees AS T2 ON t1.id  =  t2.campus WHERE t1.campus  =  \"San Francisco State University\" AND t2.year  =  2001",
    "table_names": [
      "Campuses",
      "degrees"
    ]
  },
  {
    "id": 776,
    "db_id": "csu_1",
    "question": "What degrees were conferred in San Francisco State University in the year 2001?",
    "sql": "SELECT degrees FROM campuses AS T1 JOIN degrees AS T2 ON t1.id  =  t2.campus WHERE t1.campus  =  \"San Francisco State University\" AND t2.year  =  2001",
    "table_names": [
      "Campuses",
      "degrees"
    ]
  },
  {
    "id": 777,
    "db_id": "csu_1",
    "question": "What is the number of faculty lines in campus \"Long Beach State University\" in 2002?",
    "sql": "SELECT faculty FROM faculty AS T1 JOIN campuses AS T2 ON T1.campus  =  T2.id WHERE T1.year  =  2002 AND T2.campus  =  \"Long Beach State University\"",
    "table_names": [
      "Campuses",
      "faculty"
    ]
  },
  {
    "id": 778,
    "db_id": "csu_1",
    "question": "What is the number of faculty at Long Beach State University in 2002?",
    "sql": "SELECT faculty FROM faculty AS T1 JOIN campuses AS T2 ON T1.campus  =  T2.id WHERE T1.year  =  2002 AND T2.campus  =  \"Long Beach State University\"",
    "table_names": [
      "Campuses",
      "faculty"
    ]
  },
  {
    "id": 779,
    "db_id": "csu_1",
    "question": "How many faculty lines are there in \"San Francisco State University\" in year 2004?",
    "sql": "SELECT faculty FROM faculty AS T1 JOIN campuses AS T2 ON T1.campus  =  T2.id WHERE T1.year  =  2004 AND T2.campus  =  \"San Francisco State University\"",
    "table_names": [
      "Campuses",
      "faculty"
    ]
  },
  {
    "id": 780,
    "db_id": "csu_1",
    "question": "How many faculty lines are there at San Francisco State University in 2004?",
    "sql": "SELECT faculty FROM faculty AS T1 JOIN campuses AS T2 ON T1.campus  =  T2.id WHERE T1.year  =  2004 AND T2.campus  =  \"San Francisco State University\"",
    "table_names": [
      "Campuses",
      "faculty"
    ]
  },
  {
    "id": 781,
    "db_id": "csu_1",
    "question": "How many undergraduates are there in \"San Jose State University\" in year 2004?",
    "sql": "SELECT sum(t1.undergraduate) FROM discipline_enrollments AS t1 JOIN campuses AS t2 ON t1.campus  =  t2.id WHERE t1.year  =  2004 AND t2.campus  =  \"San Jose State University\"",
    "table_names": [
      "Campuses",
      "discipline_enrollments"
    ]
  },
  {
    "id": 782,
    "db_id": "csu_1",
    "question": "How many undergraduates are there at San Jose State",
    "sql": "SELECT sum(t1.undergraduate) FROM discipline_enrollments AS t1 JOIN campuses AS t2 ON t1.campus  =  t2.id WHERE t1.year  =  2004 AND t2.campus  =  \"San Jose State University\"",
    "table_names": [
      "Campuses",
      "discipline_enrollments"
    ]
  },
  {
    "id": 783,
    "db_id": "csu_1",
    "question": "What is the number of graduates in \"San Francisco State University\" in year 2004?",
    "sql": "SELECT sum(t1.graduate) FROM discipline_enrollments AS t1 JOIN campuses AS t2 ON t1.campus  =  t2.id WHERE t1.year  =  2004 AND t2.campus  =  \"San Francisco State University\"",
    "table_names": [
      "Campuses",
      "discipline_enrollments"
    ]
  },
  {
    "id": 784,
    "db_id": "csu_1",
    "question": "How many people graduated from San Francisco State University in 2004?",
    "sql": "SELECT sum(t1.graduate) FROM discipline_enrollments AS t1 JOIN campuses AS t2 ON t1.campus  =  t2.id WHERE t1.year  =  2004 AND t2.campus  =  \"San Francisco State University\"",
    "table_names": [
      "Campuses",
      "discipline_enrollments"
    ]
  },
  {
    "id": 855,
    "db_id": "inn_1",
    "question": "Find the most popular room in the hotel. The most popular room is the room that had seen the largest number of reservations.",
    "sql": "SELECT T2.roomName FROM Reservations AS T1 JOIN Rooms AS T2 ON T1.Room  =  T2.RoomId GROUP BY T1.Room ORDER BY count(*) DESC LIMIT 1;",
    "table_names": [
      "Rooms",
      "Reservations"
    ]
  },
  {
    "id": 856,
    "db_id": "inn_1",
    "question": "Which room has the largest number of reservations?",
    "sql": "SELECT T2.roomName FROM Reservations AS T1 JOIN Rooms AS T2 ON T1.Room  =  T2.RoomId GROUP BY T1.Room ORDER BY count(*) DESC LIMIT 1;",
    "table_names": [
      "Rooms",
      "Reservations"
    ]
  },
  {
    "id": 857,
    "db_id": "inn_1",
    "question": "Which room has the highest rate? List the room's full name, rate, check in and check out date.",
    "sql": "SELECT T2.roomName ,  T1.Rate ,  T1.CheckIn ,  T1.CheckOut FROM Reservations AS T1 JOIN Rooms AS T2 ON T1.Room  =  T2.RoomId GROUP BY T1.Room ORDER BY T1.Rate DESC LIMIT 1;",
    "table_names": [
      "Rooms",
      "Reservations"
    ]
  },
  {
    "id": 858,
    "db_id": "inn_1",
    "question": "Return the name, rate, check in and check out date for the room with the highest rate.",
    "sql": "SELECT T2.roomName ,  T1.Rate ,  T1.CheckIn ,  T1.CheckOut FROM Reservations AS T1 JOIN Rooms AS T2 ON T1.Room  =  T2.RoomId GROUP BY T1.Room ORDER BY T1.Rate DESC LIMIT 1;",
    "table_names": [
      "Rooms",
      "Reservations"
    ]
  },
  {
    "id": 859,
    "db_id": "inn_1",
    "question": "What kind of decor has the least number of reservations?",
    "sql": "SELECT T2.decor FROM Reservations AS T1 JOIN Rooms AS T2 ON T1.Room  =  T2.RoomId GROUP BY T2.decor ORDER BY count(T2.decor) ASC LIMIT 1;",
    "table_names": [
      "Rooms",
      "Reservations"
    ]
  },
  {
    "id": 860,
    "db_id": "inn_1",
    "question": "What is the least popular kind of decor?",
    "sql": "SELECT T2.decor FROM Reservations AS T1 JOIN Rooms AS T2 ON T1.Room  =  T2.RoomId GROUP BY T2.decor ORDER BY count(T2.decor) ASC LIMIT 1;",
    "table_names": [
      "Rooms",
      "Reservations"
    ]
  },
  {
    "id": 861,
    "db_id": "inn_1",
    "question": "List how many times the number of people in the room reached the maximum occupancy of the room. The number of people include adults and kids.",
    "sql": "SELECT count(*) FROM Reservations AS T1 JOIN Rooms AS T2 ON T1.Room  =  T2.RoomId WHERE T2.maxOccupancy  =  T1.Adults + T1.Kids;",
    "table_names": [
      "Rooms",
      "Reservations"
    ]
  },
  {
    "id": 862,
    "db_id": "inn_1",
    "question": "How many times the number of adults and kids staying in a room reached the maximum capacity of the room?",
    "sql": "SELECT count(*) FROM Reservations AS T1 JOIN Rooms AS T2 ON T1.Room  =  T2.RoomId WHERE T2.maxOccupancy  =  T1.Adults + T1.Kids;",
    "table_names": [
      "Rooms",
      "Reservations"
    ]
  },
  {
    "id": 863,
    "db_id": "inn_1",
    "question": "Find the first and last names of people who payed more than the rooms' base prices.",
    "sql": "SELECT T1.firstname ,  T1.lastname FROM Reservations AS T1 JOIN Rooms AS T2 ON T1.Room  =  T2.RoomId WHERE T1.Rate - T2.basePrice  >  0",
    "table_names": [
      "Rooms",
      "Reservations"
    ]
  },
  {
    "id": 864,
    "db_id": "inn_1",
    "question": "What are the first and last names of people who payed more than the rooms' base prices?",
    "sql": "SELECT T1.firstname ,  T1.lastname FROM Reservations AS T1 JOIN Rooms AS T2 ON T1.Room  =  T2.RoomId WHERE T1.Rate - T2.basePrice  >  0",
    "table_names": [
      "Rooms",
      "Reservations"
    ]
  },
  {
    "id": 865,
    "db_id": "inn_1",
    "question": "Find the number of rooms that do not have any reservation.",
    "sql": "SELECT count(*) FROM rooms WHERE roomid NOT IN (SELECT DISTINCT room FROM reservations)",
    "table_names": [
      "Rooms",
      "Reservations"
    ]
  },
  {
    "id": 866,
    "db_id": "inn_1",
    "question": "How many rooms have not had any reservation yet?",
    "sql": "SELECT count(*) FROM rooms WHERE roomid NOT IN (SELECT DISTINCT room FROM reservations)",
    "table_names": [
      "Rooms",
      "Reservations"
    ]
  },
  {
    "id": 867,
    "db_id": "inn_1",
    "question": "Return the name and number of reservations made for each of the rooms.",
    "sql": "SELECT T2.roomName ,  count(*) ,  T1.Room FROM Reservations AS T1 JOIN Rooms AS T2 ON T1.Room  =  T2.RoomId GROUP BY T1.Room",
    "table_names": [
      "Rooms",
      "Reservations"
    ]
  },
  {
    "id": 868,
    "db_id": "inn_1",
    "question": "For each room, find its name and the number of times reservations were made for it.",
    "sql": "SELECT T2.roomName ,  count(*) ,  T1.Room FROM Reservations AS T1 JOIN Rooms AS T2 ON T1.Room  =  T2.RoomId GROUP BY T1.Room",
    "table_names": [
      "Rooms",
      "Reservations"
    ]
  },
  {
    "id": 869,
    "db_id": "inn_1",
    "question": "Find the names of rooms that have been reserved for more than 60 times.",
    "sql": "SELECT T2.roomName FROM Reservations AS T1 JOIN Rooms AS T2 ON T1.Room  =  T2.RoomId GROUP BY T1.Room HAVING count(*)  >  60",
    "table_names": [
      "Rooms",
      "Reservations"
    ]
  },
  {
    "id": 870,
    "db_id": "inn_1",
    "question": "What are the names of rooms whose reservation frequency exceeds 60 times?",
    "sql": "SELECT T2.roomName FROM Reservations AS T1 JOIN Rooms AS T2 ON T1.Room  =  T2.RoomId GROUP BY T1.Room HAVING count(*)  >  60",
    "table_names": [
      "Rooms",
      "Reservations"
    ]
  },
  {
    "id": 871,
    "db_id": "inn_1",
    "question": "Find the name of rooms booked by some customers whose first name contains ROY.",
    "sql": "SELECT T2.roomName FROM Reservations AS T1 JOIN Rooms AS T2 ON T1.Room  =  T2.RoomId WHERE firstname LIKE '%ROY%'",
    "table_names": [
      "Rooms",
      "Reservations"
    ]
  },
  {
    "id": 872,
    "db_id": "inn_1",
    "question": "What are the name of rooms booked by customers whose first name has \"ROY\" in part?",
    "sql": "SELECT T2.roomName FROM Reservations AS T1 JOIN Rooms AS T2 ON T1.Room  =  T2.RoomId WHERE firstname LIKE '%ROY%'",
    "table_names": [
      "Rooms",
      "Reservations"
    ]
  },
  {
    "id": 873,
    "db_id": "local_govt_mdm",
    "question": "what are the details of the cmi masters that have the cross reference code 'Tax'?",
    "sql": "SELECT T1.cmi_details FROM Customer_Master_Index AS T1 JOIN CMI_Cross_References AS T2 ON T1.master_customer_id  =  T2.master_customer_id WHERE T2.source_system_code  =  'Tax'",
    "table_names": [
      "Customer_Master_Index",
      "CMI_Cross_References"
    ]
  },
  {
    "id": 874,
    "db_id": "local_govt_mdm",
    "question": "What is the cmi cross reference id that is related to at least one council tax entry? List the cross reference id and source system code.",
    "sql": "SELECT T1.cmi_cross_ref_id ,  T1.source_system_code FROM CMI_Cross_References AS T1 JOIN Council_Tax AS T2 ON T1.cmi_cross_ref_id  =  T2.cmi_cross_ref_id GROUP BY T1.cmi_cross_ref_id HAVING count(*)  >=  1",
    "table_names": [
      "CMI_Cross_References",
      "Council_Tax"
    ]
  },
  {
    "id": 875,
    "db_id": "local_govt_mdm",
    "question": "How many business rates are related to each cmi cross reference? List cross reference id, master customer id and the n",
    "sql": "SELECT T2.cmi_cross_ref_id ,  T2.master_customer_id ,  count(*) FROM Business_Rates AS T1 JOIN CMI_Cross_References AS T2 ON T1.cmi_cross_ref_id  =  T2.cmi_cross_ref_id GROUP BY T2.cmi_cross_ref_id",
    "table_names": [
      "CMI_Cross_References",
      "Business_Rates"
    ]
  },
  {
    "id": 876,
    "db_id": "local_govt_mdm",
    "question": "What is the tax source system code related to the benefits and overpayments? List the code and the benifit id, order by benifit id.",
    "sql": "SELECT T1.source_system_code ,  T2.council_tax_id FROM CMI_Cross_References AS T1 JOIN Benefits_Overpayments AS T2 ON T1.cmi_cross_ref_id  =  T2.cmi_cross_ref_id ORDER BY T2.council_tax_id",
    "table_names": [
      "CMI_Cross_References",
      "Benefits_Overpayments"
    ]
  },
  {
    "id": 877,
    "db_id": "local_govt_mdm",
    "question": "Wat is the tax source system code and master customer id of the taxes related to each parking fine id?",
    "sql": "SELECT T1.source_system_code ,  T1.master_customer_id ,  T2.council_tax_id FROM CMI_Cross_References AS T1 JOIN Parking_Fines AS T2 ON T1.cmi_cross_ref_id  =  T2.cmi_cross_ref_id",
    "table_names": [
      "CMI_Cross_References",
      "Parking_Fines"
    ]
  },
  {
    "id": 878,
    "db_id": "local_govt_mdm",
    "question": "What are the register ids of electoral registries that have the cross reference source system code 'Electoral' or 'Tax'?",
    "sql": "SELECT T1.electoral_register_id FROM Electoral_Register AS T1 JOIN CMI_Cross_References AS T2 ON T1.cmi_cross_ref_id  =  T2.cmi_cross_ref_id WHERE T2.source_system_code  =  'Electoral' OR T2.source_system_code  =  'Tax'",
    "table_names": [
      "CMI_Cross_References",
      "Electoral_Register"
    ]
  },
  {
    "id": 879,
    "db_id": "local_govt_mdm",
    "question": "Which cmi cross reference id is not related to any parking taxes?",
    "sql": "SELECT cmi_cross_ref_id FROM cmi_cross_references EXCEPT SELECT cmi_cross_ref_id FROM parking_fines",
    "table_names": [
      "CMI_Cross_References",
      "Parking_Fines"
    ]
  },
  {
    "id": 930,
    "db_id": "restaurant_1",
    "question": "How long does student Linda Smith spend on the restaurant in total?",
    "sql": "SELECT sum(Spent) FROM Student JOIN Visits_Restaurant ON Student.StuID = Visits_Restaurant.StuID WHERE Student.Fname = \"Linda\" AND Student.Lname = \"Smith\";",
    "table_names": [
      "Student",
      "Visits_Restaurant"
    ]
  },
  {
    "id": 932,
    "db_id": "restaurant_1",
    "question": "Which student visited restaurant most often? List student's first name and last name.",
    "sql": "SELECT Student.Fname , Student.Lname FROM Student JOIN Visits_Restaurant ON Student.StuID = Visits_Restaurant.StuID GROUP BY Student.StuID ORDER BY count(*) DESC LIMIT 1;",
    "table_names": [
      "Student",
      "Visits_Restaurant"
    ]
  },
  {
    "id": 939,
    "db_id": "sakila_1",
    "question": "Which city has the most addresses? List the city name, number of addresses, and city id.",
    "sql": "SELECT T2.city ,  count(*) ,  T1.city_id FROM address AS T1 JOIN city AS T2 ON T1.city_id  =  T2.city_id GROUP BY T1.city_id ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "address",
      "city"
    ]
  },
  {
    "id": 940,
    "db_id": "sakila_1",
    "question": "What are the city name, id, and number of addresses corresponding to the city with the most addressed?",
    "sql": "SELECT T2.city ,  count(*) ,  T1.city_id FROM address AS T1 JOIN city AS T2 ON T1.city_id  =  T2.city_id GROUP BY T1.city_id ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "address",
      "city"
    ]
  },
  {
    "id": 941,
    "db_id": "sakila_1",
    "question": "Which film is rented at a fee of 0.99 and has less than 3 in the inventory? List the film title and id.",
    "sql": "SELECT title ,  film_id FROM film WHERE rental_rate  =  0.99 INTERSECT SELECT T1.title ,  T1.film_id FROM film AS T1 JOIN inventory AS T2 ON T1.film_id  =  T2.film_id GROUP BY T1.film_id HAVING count(*)  <  3",
    "table_names": [
      "film",
      "inventory"
    ]
  },
  {
    "id": 942,
    "db_id": "sakila_1",
    "question": "What are the title and id of the film which has a rental rate of 0.99 and an inventory of below 3?",
    "sql": "SELECT title ,  film_id FROM film WHERE rental_rate  =  0.99 INTERSECT SELECT T1.title ,  T1.film_id FROM film AS T1 JOIN inventory AS T2 ON T1.film_id  =  T2.film_id GROUP BY T1.film_id HAVING count(*)  <  3",
    "table_names": [
      "film",
      "inventory"
    ]
  },
  {
    "id": 943,
    "db_id": "world_1",
    "question": "How many cities are in Australia?",
    "sql": "SELECT count(*) FROM city AS T1 JOIN country AS T2 ON T1.country_id  =  T2.country_id WHERE T2.country  =  'Australia'",
    "table_names": [
      "city",
      "country"
    ]
  },
  {
    "id": 944,
    "db_id": "world_1",
    "question": "Count the number of cities in Australia.",
    "sql": "SELECT count(*) FROM city AS T1 JOIN country AS T2 ON T1.country_id  =  T2.country_id WHERE T2.country  =  'Australia'",
    "table_names": [
      "city",
      "country"
    ]
  },
  {
    "id": 945,
    "db_id": "world_1",
    "question": "Which countries have at least 3 cities?",
    "sql": "SELECT T2.country FROM city AS T1 JOIN country AS T2 ON T1.country_id  =  T2.country_id GROUP BY T2.country_id HAVING count(*)  >=  3",
    "table_names": [
      "city",
      "country"
    ]
  },
  {
    "id": 946,
    "db_id": "world_1",
    "question": "What are the countries that contain 3 or more cities?",
    "sql": "SELECT T2.country FROM city AS T1 JOIN country AS T2 ON T1.country_id  =  T2.country_id GROUP BY T2.country_id HAVING count(*)  >=  3",
    "table_names": [
      "city",
      "country"
    ]
  },
  {
    "id": 947,
    "db_id": "sakila_1",
    "question": "Which film has the most number of actors or actresses? List the film name, film id and description.",
    "sql": "SELECT T2.title ,  T2.film_id ,  T2.description FROM film_actor AS T1 JOIN film AS T2 ON T1.film_id  =  T2.film_id GROUP BY T2.film_id ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "film",
      "film_actor"
    ]
  },
  {
    "id": 948,
    "db_id": "sakila_1",
    "question": "What are the title, id, and description of the movie with the greatest number of actors?",
    "sql": "SELECT T2.title ,  T2.film_id ,  T2.description FROM film_actor AS T1 JOIN film AS T2 ON T1.film_id  =  T2.film_id GROUP BY T2.film_id ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "film",
      "film_actor"
    ]
  },
  {
    "id": 949,
    "db_id": "sakila_1",
    "question": "Which film actor (actress) starred the most films? List his or her first name, last name and actor id.",
    "sql": "SELECT T2.first_name ,  T2.last_name ,  T2.actor_id FROM film_actor AS T1 JOIN actor AS T2 ON T1.actor_id  =  T2.actor_id GROUP BY T2.actor_id ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "actor",
      "film_actor"
    ]
  },
  {
    "id": 950,
    "db_id": "sakila_1",
    "question": "Return the full name and id of the actor or actress who starred in the greatest number of films.",
    "sql": "SELECT T2.first_name ,  T2.last_name ,  T2.actor_id FROM film_actor AS T1 JOIN actor AS T2 ON T1.actor_id  =  T2.actor_id GROUP BY T2.actor_id ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "actor",
      "film_actor"
    ]
  },
  {
    "id": 951,
    "db_id": "sakila_1",
    "question": "Which film actors (actresses) played a role in more than 30 films? List his or her first name and last name.",
    "sql": "SELECT T2.first_name ,  T2.last_name FROM film_actor AS T1 JOIN actor AS T2 ON T1.actor_id  =  T2.actor_id GROUP BY T2.actor_id HAVING count(*)  >  30",
    "table_names": [
      "actor",
      "film_actor"
    ]
  },
  {
    "id": 952,
    "db_id": "sakila_1",
    "question": "What are the full names of actors who had roles in more than 30 films?",
    "sql": "SELECT T2.first_name ,  T2.last_name FROM film_actor AS T1 JOIN actor AS T2 ON T1.actor_id  =  T2.actor_id GROUP BY T2.actor_id HAVING count(*)  >  30",
    "table_names": [
      "actor",
      "film_actor"
    ]
  },
  {
    "id": 953,
    "db_id": "sakila_1",
    "question": "Which customer, who has made at least one payment, has spent the least money? List his or her first name, last name, and the id.",
    "sql": "SELECT T1.first_name ,  T1.last_name ,  T1.customer_id FROM customer AS T1 JOIN payment AS T2 ON T1.customer_id  =  T2.customer_id GROUP BY T1.customer_id ORDER BY sum(amount) ASC LIMIT 1",
    "table_names": [
      "customer",
      "payment"
    ]
  },
  {
    "id": 954,
    "db_id": "sakila_1",
    "question": "What is the full name and id of the customer who has the lowest total amount of payment?",
    "sql": "SELECT T1.first_name ,  T1.last_name ,  T1.customer_id FROM customer AS T1 JOIN payment AS T2 ON T1.customer_id  =  T2.customer_id GROUP BY T1.customer_id ORDER BY sum(amount) ASC LIMIT 1",
    "table_names": [
      "customer",
      "payment"
    ]
  },
  {
    "id": 955,
    "db_id": "sakila_1",
    "question": "How many films are there in each category? List the genre name, genre id and the count.",
    "sql": "SELECT T2.name ,  T1.category_id ,  count(*) FROM film_category AS T1 JOIN category AS T2 ON T1.category_id  =  T2.category_id GROUP BY T1.category_id",
    "table_names": [
      "category",
      "film_category"
    ]
  },
  {
    "id": 956,
    "db_id": "sakila_1",
    "question": "What are the names and ids of the different categories, and how many films are in each?",
    "sql": "SELECT T2.name ,  T1.category_id ,  count(*) FROM film_category AS T1 JOIN category AS T2 ON T1.category_id  =  T2.category_id GROUP BY T1.category_id",
    "table_names": [
      "category",
      "film_category"
    ]
  },
  {
    "id": 957,
    "db_id": "sakila_1",
    "question": "Which film has the most copies in the inventory? List both title and id.",
    "sql": "SELECT T1.title ,  T1.film_id FROM film AS T1 JOIN inventory AS T2 ON T1.film_id  =  T2.film_id GROUP BY T1.film_id ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "film",
      "inventory"
    ]
  },
  {
    "id": 958,
    "db_id": "sakila_1",
    "question": "What is the title and id of the film that has the greatest number of copies in inventory?",
    "sql": "SELECT T1.title ,  T1.film_id FROM film AS T1 JOIN inventory AS T2 ON T1.film_id  =  T2.film_id GROUP BY T1.film_id ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "film",
      "inventory"
    ]
  },
  {
    "id": 959,
    "db_id": "sakila_1",
    "question": "Where does the customer with the first name Linda live? And what is her email?",
    "sql": "SELECT T2.address ,  T1.email FROM customer AS T1 JOIN address AS T2 ON T2.address_id  =  T1.address_id WHERE T1.first_name  =  'LINDA'",
    "table_names": [
      "address",
      "customer"
    ]
  },
  {
    "id": 960,
    "db_id": "sakila_1",
    "question": "Return the address and email of the customer with the first name Linda.",
    "sql": "SELECT T2.address ,  T1.email FROM customer AS T1 JOIN address AS T2 ON T2.address_id  =  T1.address_id WHERE T1.first_name  =  'LINDA'",
    "table_names": [
      "address",
      "customer"
    ]
  },
  {
    "id": 961,
    "db_id": "sakila_1",
    "question": "What is the first name and the last name of the customer who made the earliest rental?",
    "sql": "SELECT T1.first_name ,  T1.last_name FROM customer AS T1 JOIN rental AS T2 ON T1.customer_id  =  T2.customer_id ORDER BY T2.rental_date ASC LIMIT 1",
    "table_names": [
      "customer",
      "rental"
    ]
  },
  {
    "id": 962,
    "db_id": "sakila_1",
    "question": "Return the full name of the customer who made the first rental.",
    "sql": "SELECT T1.first_name ,  T1.last_name FROM customer AS T1 JOIN rental AS T2 ON T1.customer_id  =  T2.customer_id ORDER BY T2.rental_date ASC LIMIT 1",
    "table_names": [
      "customer",
      "rental"
    ]
  },
  {
    "id": 963,
    "db_id": "sakila_1",
    "question": "What are the first names of customers who have not rented any films after '2005-08-23 02:06:01'?",
    "sql": "SELECT first_name FROM customer WHERE customer_id NOT IN( SELECT customer_id FROM rental WHERE rental_date  >  '2005-08-23 02:06:01' )",
    "table_names": [
      "customer",
      "rental"
    ]
  },
  {
    "id": 964,
    "db_id": "sakila_1",
    "question": "Return the first names of customers who did not rented a film after the date '2005-08-23 02:06:01'.",
    "sql": "SELECT first_name FROM customer WHERE customer_id NOT IN( SELECT customer_id FROM rental WHERE rental_date  >  '2005-08-23 02:06:01' )",
    "table_names": [
      "customer",
      "rental"
    ]
  },
  {
    "id": 999,
    "db_id": "behavior_monitoring",
    "question": "What are the id and first name of the student whose addresses have the highest average monthly rental?",
    "sql": "SELECT T1.student_id ,  T2.first_name FROM Student_Addresses AS T1 JOIN Students AS T2 ON T1.student_id  =  T2.student_id GROUP BY T1.student_id ORDER BY AVG(monthly_rental) DESC LIMIT 1",
    "table_names": [
      "Students",
      "Student_Addresses"
    ]
  },
  {
    "id": 1000,
    "db_id": "behavior_monitoring",
    "question": "Find the id and city of the student address with the highest average monthly rental.",
    "sql": "SELECT T2.address_id ,  T1.city FROM Addresses AS T1 JOIN Student_Addresses AS T2 ON T1.address_id  =  T2.address_id GROUP BY T2.address_id ORDER BY AVG(monthly_rental) DESC LIMIT 1",
    "table_names": [
      "Addresses",
      "Student_Addresses"
    ]
  },
  {
    "id": 1007,
    "db_id": "behavior_monitoring",
    "question": "What are the id and zip code of the address with the highest monthly rental?",
    "sql": "SELECT T2.address_id ,  T1.zip_postcode FROM Addresses AS T1 JOIN Student_Addresses AS T2 ON T1.address_id  =  T2.address_id ORDER BY monthly_rental DESC LIMIT 1",
    "table_names": [
      "Addresses",
      "Student_Addresses"
    ]
  },
  {
    "id": 1008,
    "db_id": "behavior_monitoring",
    "question": "What is the cell phone number of the student whose address has the lowest monthly rental?",
    "sql": "SELECT T2.cell_mobile_number FROM Student_Addresses AS T1 JOIN Students AS T2 ON T1.student_id  =  T2.student_id ORDER BY T1.monthly_rental ASC LIMIT 1",
    "table_names": [
      "Students",
      "Student_Addresses"
    ]
  },
  {
    "id": 1009,
    "db_id": "behavior_monitoring",
    "question": "What are the monthly rentals of student addresses in Texas state?",
    "sql": "SELECT T2.monthly_rental FROM Addresses AS T1 JOIN Student_Addresses AS T2 ON T1.address_id  =  T2.address_id WHERE T1.state_province_county  =  \"Texas\"",
    "table_names": [
      "Addresses",
      "Student_Addresses"
    ]
  },
  {
    "id": 1010,
    "db_id": "student_assessment",
    "question": "What are the first names and last names of students with address in Wisconsin state?",
    "sql": "SELECT T2.first_name ,  T2.last_name FROM Addresses AS T1 JOIN Students AS T2 ON T1.address_id  =  T2.address_id WHERE T1.state_province_county  =  \"Wisconsin\"",
    "table_names": [
      "Addresses",
      "Students"
    ]
  },
  {
    "id": 1011,
    "db_id": "behavior_monitoring",
    "question": "What are the line 1 and average monthly rentals of all student addresses?",
    "sql": "SELECT T1.line_1 ,  avg(T2.monthly_rental) FROM Addresses AS T1 JOIN Student_Addresses AS T2 ON T1.address_id  =  T2.address_id GROUP BY T2.address_id",
    "table_names": [
      "Addresses",
      "Student_Addresses"
    ]
  },
  {
    "id": 1012,
    "db_id": "behavior_monitoring",
    "question": "What is the zip code of the address where the teacher with first name \"Lyla\" lives?",
    "sql": "SELECT T1.zip_postcode FROM Addresses AS T1 JOIN Teachers AS T2 ON T1.address_id  =  T2.address_id WHERE T2.first_name  =  \"Lyla\"",
    "table_names": [
      "Addresses",
      "Teachers"
    ]
  },
  {
    "id": 1013,
    "db_id": "behavior_monitoring",
    "question": "What are the email addresses of teachers whose address has zip code \"918\"?",
    "sql": "SELECT T2.email_address FROM Addresses AS T1 JOIN Teachers AS T2 ON T1.address_id  =  T2.address_id WHERE T1.zip_postcode  =  \"918\"",
    "table_names": [
      "Addresses",
      "Teachers"
    ]
  },
  {
    "id": 1036,
    "db_id": "college_1",
    "question": "Find the number of professors in accounting department.",
    "sql": "SELECT count(*) FROM professor AS T1 JOIN department AS T2 ON T1.dept_code  =  T2.dept_code WHERE DEPT_NAME  =  \"Accounting\"",
    "table_names": [
      "DEPARTMENT",
      "PROFESSOR"
    ]
  },
  {
    "id": 1037,
    "db_id": "college_1",
    "question": "How many professors are in the accounting dept?",
    "sql": "SELECT count(*) FROM professor AS T1 JOIN department AS T2 ON T1.dept_code  =  T2.dept_code WHERE DEPT_NAME  =  \"Accounting\"",
    "table_names": [
      "DEPARTMENT",
      "PROFESSOR"
    ]
  },
  {
    "id": 1038,
    "db_id": "college_1",
    "question": "What are the first names and date of birth of professors teaching course ACCT-211?",
    "sql": "SELECT DISTINCT T1.EMP_FNAME ,  T1.EMP_DOB FROM employee AS T1 JOIN CLASS AS T2 ON T1.EMP_NUM  =  T2.PROF_NUM WHERE CRS_CODE  =  \"ACCT-211\"",
    "table_names": [
      "CLASS",
      "EMPLOYEE"
    ]
  },
  {
    "id": 1039,
    "db_id": "college_1",
    "question": "What are the first names and birthdates of the professors in charge of ACCT-211?",
    "sql": "SELECT DISTINCT T1.EMP_FNAME ,  T1.EMP_DOB FROM employee AS T1 JOIN CLASS AS T2 ON T1.EMP_NUM  =  T2.PROF_NUM WHERE CRS_CODE  =  \"ACCT-211\"",
    "table_names": [
      "CLASS",
      "EMPLOYEE"
    ]
  },
  {
    "id": 1040,
    "db_id": "college_1",
    "question": "How many classes are professor whose last name is Graztevski has?",
    "sql": "SELECT count(*) FROM employee AS T1 JOIN CLASS AS T2 ON T1.EMP_NUM  =  T2.PROF_NUM WHERE T1.EMP_LNAME  =  'Graztevski'",
    "table_names": [
      "CLASS",
      "EMPLOYEE"
    ]
  },
  {
    "id": 1041,
    "db_id": "college_1",
    "question": "How many classes does the professor whose last name is Graztevski teach?",
    "sql": "SELECT count(*) FROM employee AS T1 JOIN CLASS AS T2 ON T1.EMP_NUM  =  T2.PROF_NUM WHERE T1.EMP_LNAME  =  'Graztevski'",
    "table_names": [
      "CLASS",
      "EMPLOYEE"
    ]
  },
  {
    "id": 1044,
    "db_id": "college_1",
    "question": "What is the number of professors for different school?",
    "sql": "SELECT count(*) ,  T1.school_code FROM department AS T1 JOIN professor AS T2 ON T1.dept_code  =  T2.dept_code GROUP BY T1.school_code",
    "table_names": [
      "DEPARTMENT",
      "PROFESSOR"
    ]
  },
  {
    "id": 1045,
    "db_id": "college_1",
    "question": "How many different professors are there for the different schools?",
    "sql": "SELECT count(*) ,  T1.school_code FROM department AS T1 JOIN professor AS T2 ON T1.dept_code  =  T2.dept_code GROUP BY T1.school_code",
    "table_names": [
      "DEPARTMENT",
      "PROFESSOR"
    ]
  },
  {
    "id": 1046,
    "db_id": "college_1",
    "question": "Which school has the smallest amount of professors?",
    "sql": "SELECT T1.school_code FROM department AS T1 JOIN professor AS T2 ON T1.dept_code  =  T2.dept_code GROUP BY T1.school_code ORDER BY count(*) LIMIT 1",
    "table_names": [
      "DEPARTMENT",
      "PROFESSOR"
    ]
  },
  {
    "id": 1047,
    "db_id": "college_1",
    "question": "Which school has the fewest professors?",
    "sql": "SELECT T1.school_code FROM department AS T1 JOIN professor AS T2 ON T1.dept_code  =  T2.dept_code GROUP BY T1.school_code ORDER BY count(*) LIMIT 1",
    "table_names": [
      "DEPARTMENT",
      "PROFESSOR"
    ]
  },
  {
    "id": 1056,
    "db_id": "college_1",
    "question": "Find the first names and offices of all professors sorted by alphabetical order of their first name.",
    "sql": "SELECT T2.emp_fname ,  T1.prof_office FROM professor AS T1 JOIN employee AS T2 ON T1.emp_num  =  T2.emp_num ORDER BY T2.emp_fname",
    "table_names": [
      "EMPLOYEE",
      "PROFESSOR"
    ]
  },
  {
    "id": 1057,
    "db_id": "college_1",
    "question": "What are the first names and office locations for all professors sorted alphabetically by first name?",
    "sql": "SELECT T2.emp_fname ,  T1.prof_office FROM professor AS T1 JOIN employee AS T2 ON T1.emp_num  =  T2.emp_num ORDER BY T2.emp_fname",
    "table_names": [
      "EMPLOYEE",
      "PROFESSOR"
    ]
  },
  {
    "id": 1060,
    "db_id": "college_1",
    "question": "What is the name of department where has the smallest number of professors?",
    "sql": "SELECT T2.dept_name FROM professor AS T1 JOIN department AS T2 ON T1.dept_code  =  T2.dept_code GROUP BY T1.dept_code ORDER BY count(*) LIMIT 1",
    "table_names": [
      "DEPARTMENT",
      "PROFESSOR"
    ]
  },
  {
    "id": 1061,
    "db_id": "college_1",
    "question": "What is the name of the department with the fewest professors?",
    "sql": "SELECT T2.dept_name FROM professor AS T1 JOIN department AS T2 ON T1.dept_code  =  T2.dept_code GROUP BY T1.dept_code ORDER BY count(*) LIMIT 1",
    "table_names": [
      "DEPARTMENT",
      "PROFESSOR"
    ]
  },
  {
    "id": 1062,
    "db_id": "college_1",
    "question": "What is the name of department where has the largest number of professors with a Ph.D. degree?",
    "sql": "SELECT T2.dept_name ,  T1.dept_code FROM professor AS T1 JOIN department AS T2 ON T1.dept_code  =  T2.dept_code WHERE T1.prof_high_degree  =  'Ph.D.' GROUP BY T1.dept_code ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "DEPARTMENT",
      "PROFESSOR"
    ]
  },
  {
    "id": 1063,
    "db_id": "college_1",
    "question": "Which department has the most professors with a Ph.D.?",
    "sql": "SELECT T2.dept_name ,  T1.dept_code FROM professor AS T1 JOIN department AS T2 ON T1.dept_code  =  T2.dept_code WHERE T1.prof_high_degree  =  'Ph.D.' GROUP BY T1.dept_code ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "DEPARTMENT",
      "PROFESSOR"
    ]
  },
  {
    "id": 1064,
    "db_id": "college_1",
    "question": "What are the first names of the professors who do not teach a class.",
    "sql": "SELECT emp_fname FROM employee WHERE emp_jobcode  =  'PROF' EXCEPT SELECT T1.emp_fname FROM employee AS T1 JOIN CLASS AS T2 ON T1.emp_num  =  T2.prof_num",
    "table_names": [
      "CLASS",
      "EMPLOYEE"
    ]
  },
  {
    "id": 1065,
    "db_id": "college_1",
    "question": "What are the first names of all professors not teaching any classes?",
    "sql": "SELECT emp_fname FROM employee WHERE emp_jobcode  =  'PROF' EXCEPT SELECT T1.emp_fname FROM employee AS T1 JOIN CLASS AS T2 ON T1.emp_num  =  T2.prof_num",
    "table_names": [
      "CLASS",
      "EMPLOYEE"
    ]
  },
  {
    "id": 1066,
    "db_id": "college_1",
    "question": "Find the last name and hire date of the professor who is in office DRE 102.",
    "sql": "SELECT T1.emp_lname ,  T1.emp_hiredate FROM employee AS T1 JOIN professor AS T2 ON T1.emp_num  =  T2.emp_num WHERE T2.prof_office  =  'DRE 102'",
    "table_names": [
      "EMPLOYEE",
      "PROFESSOR"
    ]
  },
  {
    "id": 1067,
    "db_id": "college_1",
    "question": "What is the last name of the professor whose office is located in DRE 102, and when were they hired?",
    "sql": "SELECT T1.emp_lname ,  T1.emp_hiredate FROM employee AS T1 JOIN professor AS T2 ON T1.emp_num  =  T2.emp_num WHERE T2.prof_office  =  'DRE 102'",
    "table_names": [
      "EMPLOYEE",
      "PROFESSOR"
    ]
  },
  {
    "id": 1068,
    "db_id": "college_1",
    "question": "How many professors who are from either Accounting or Biology department?",
    "sql": "SELECT count(*) FROM professor AS T1 JOIN department AS T2 ON T1.dept_code  =  T2.dept_code WHERE T2.dept_name  =  'Accounting' OR T2.dept_name  =  'Biology'",
    "table_names": [
      "DEPARTMENT",
      "PROFESSOR"
    ]
  },
  {
    "id": 1069,
    "db_id": "college_1",
    "question": "What is the number of professors who are in the Accounting or Biology departments?",
    "sql": "SELECT count(*) FROM professor AS T1 JOIN department AS T2 ON T1.dept_code  =  T2.dept_code WHERE T2.dept_name  =  'Accounting' OR T2.dept_name  =  'Biology'",
    "table_names": [
      "DEPARTMENT",
      "PROFESSOR"
    ]
  },
  {
    "id": 1070,
    "db_id": "college_1",
    "question": "Find the first name of the professor who is teaching two courses with code CIS-220 and QM-261.",
    "sql": "SELECT T1.emp_fname FROM employee AS T1 JOIN CLASS AS T2 ON T1.emp_num  =  T2.prof_num WHERE crs_code  =  'CIS-220' INTERSECT SELECT T1.emp_fname FROM employee AS T1 JOIN CLASS AS T2 ON T1.emp_num  =  T2.prof_num WHERE crs_code  =  'QM-261'",
    "table_names": [
      "CLASS",
      "EMPLOYEE"
    ]
  },
  {
    "id": 1071,
    "db_id": "college_1",
    "question": "What is the first name of the professor who is teaching CIS-220 and QM-261?",
    "sql": "SELECT T1.emp_fname FROM employee AS T1 JOIN CLASS AS T2 ON T1.emp_num  =  T2.prof_num WHERE crs_code  =  'CIS-220' INTERSECT SELECT T1.emp_fname FROM employee AS T1 JOIN CLASS AS T2 ON T1.emp_num  =  T2.prof_num WHERE crs_code  =  'QM-261'",
    "table_names": [
      "CLASS",
      "EMPLOYEE"
    ]
  },
  {
    "id": 1078,
    "db_id": "college_1",
    "question": "Find the first names of all instructors who have taught some course and the course code.",
    "sql": "SELECT T2.emp_fname ,  T1.crs_code FROM CLASS AS T1 JOIN employee AS T2 ON T1.prof_num  =  T2.emp_num",
    "table_names": [
      "CLASS",
      "EMPLOYEE"
    ]
  },
  {
    "id": 1079,
    "db_id": "college_1",
    "question": "What are the first names of all teachers who have taught a course and the corresponding course codes?",
    "sql": "SELECT T2.emp_fname ,  T1.crs_code FROM CLASS AS T1 JOIN employee AS T2 ON T1.prof_num  =  T2.emp_num",
    "table_names": [
      "CLASS",
      "EMPLOYEE"
    ]
  },
  {
    "id": 1084,
    "db_id": "college_1",
    "question": "Find the first names of professors who are teaching more than one class.",
    "sql": "SELECT T2.emp_fname FROM CLASS AS T1 JOIN employee AS T2 ON T1.prof_num  =  T2.emp_num GROUP BY T1.prof_num HAVING count(*)  >  1",
    "table_names": [
      "CLASS",
      "EMPLOYEE"
    ]
  },
  {
    "id": 1085,
    "db_id": "college_1",
    "question": "What are the first names of all professors who teach more than one class?",
    "sql": "SELECT T2.emp_fname FROM CLASS AS T1 JOIN employee AS T2 ON T1.prof_num  =  T2.emp_num GROUP BY T1.prof_num HAVING count(*)  >  1",
    "table_names": [
      "CLASS",
      "EMPLOYEE"
    ]
  },
  {
    "id": 1101,
    "db_id": "hr_1",
    "question": "Display the first name and department name for each employee.",
    "sql": "SELECT T1.first_name ,  T2.department_name FROM employees AS T1 JOIN departments AS T2 ON T1.department_id  =  T2.department_id",
    "table_names": [
      "departments",
      "employees"
    ]
  },
  {
    "id": 1102,
    "db_id": "hr_1",
    "question": "What are the first name and department name of all employees?",
    "sql": "SELECT T1.first_name ,  T2.department_name FROM employees AS T1 JOIN departments AS T2 ON T1.department_id  =  T2.department_id",
    "table_names": [
      "departments",
      "employees"
    ]
  },
  {
    "id": 1103,
    "db_id": "hr_1",
    "question": "display the department name and number of employees in each of the department.",
    "sql": "SELECT T2.department_name ,  COUNT(*) FROM employees AS T1 JOIN departments AS T2 ON T1.department_id  =  T2.department_id GROUP BY T2.department_name",
    "table_names": [
      "departments",
      "employees"
    ]
  },
  {
    "id": 1104,
    "db_id": "hr_1",
    "question": "Give the name of each department and the number of employees in each.",
    "sql": "SELECT T2.department_name ,  COUNT(*) FROM employees AS T1 JOIN departments AS T2 ON T1.department_id  =  T2.department_id GROUP BY T2.department_name",
    "table_names": [
      "departments",
      "employees"
    ]
  },
  {
    "id": 1105,
    "db_id": "hr_1",
    "question": "Can you return all detailed info of jobs which was done by any of the employees who is presently earning a salary on and above 12000?",
    "sql": "SELECT * FROM  job_history AS T1 JOIN employees AS T2 ON T1.employee_id  =  T2.employee_id WHERE T2.salary  >=  12000",
    "table_names": [
      "employees",
      "job_history"
    ]
  },
  {
    "id": 1106,
    "db_id": "hr_1",
    "question": "What is all the job history info done by employees earning a salary greater than or equal to 12000?",
    "sql": "SELECT * FROM  job_history AS T1 JOIN employees AS T2 ON T1.employee_id  =  T2.employee_id WHERE T2.salary  >=  12000",
    "table_names": [
      "employees",
      "job_history"
    ]
  },
  {
    "id": 1107,
    "db_id": "hr_1",
    "question": "display job title and average salary of employees.",
    "sql": "SELECT job_title ,  AVG(salary) FROM employees AS T1 JOIN jobs AS T2 ON T1.job_id  =  T2.job_id GROUP BY T2.job_title",
    "table_names": [
      "jobs",
      "employees"
    ]
  },
  {
    "id": 1108,
    "db_id": "hr_1",
    "question": "What is the average salary for each job title?",
    "sql": "SELECT job_title ,  AVG(salary) FROM employees AS T1 JOIN jobs AS T2 ON T1.job_id  =  T2.job_id GROUP BY T2.job_title",
    "table_names": [
      "jobs",
      "employees"
    ]
  },
  {
    "id": 1109,
    "db_id": "hr_1",
    "question": "find the name of all departments that do actually have one or more employees assigned to them.",
    "sql": "SELECT DISTINCT T2.department_name FROM employees AS T1 JOIN departments AS T2 ON T1.department_id  =  T2.department_id",
    "table_names": [
      "departments",
      "employees"
    ]
  },
  {
    "id": 1110,
    "db_id": "hr_1",
    "question": "What are the names of departments that have at least one employee.",
    "sql": "SELECT DISTINCT T2.department_name FROM employees AS T1 JOIN departments AS T2 ON T1.department_id  =  T2.department_id",
    "table_names": [
      "departments",
      "employees"
    ]
  },
  {
    "id": 1111,
    "db_id": "hr_1",
    "question": "get the details of employees who manage a department.",
    "sql": "SELECT DISTINCT * FROM employees AS T1 JOIN departments AS T2 ON T1.department_id  =  T2.department_id WHERE T1.employee_id  =  T2.manager_id",
    "table_names": [
      "departments",
      "employees"
    ]
  },
  {
    "id": 1112,
    "db_id": "hr_1",
    "question": "What is all the information regarding employees who are managers?",
    "sql": "SELECT DISTINCT * FROM employees AS T1 JOIN departments AS T2 ON T1.department_id  =  T2.department_id WHERE T1.employee_id  =  T2.manager_id",
    "table_names": [
      "departments",
      "employees"
    ]
  },
  {
    "id": 1113,
    "db_id": "hr_1",
    "question": "display the employee ID and job name for all those jobs in department 80.",
    "sql": "SELECT T1.employee_id ,  T2.job_title FROM employees AS T1 JOIN jobs AS T2 ON T1.job_id  =  T2.job_id WHERE T1.department_id = 80",
    "table_names": [
      "jobs",
      "employees"
    ]
  },
  {
    "id": 1114,
    "db_id": "hr_1",
    "question": "what are the employee ids and job titles for employees in department 80?",
    "sql": "SELECT T1.employee_id ,  T2.job_title FROM employees AS T1 JOIN jobs AS T2 ON T1.job_id  =  T2.job_id WHERE T1.department_id = 80",
    "table_names": [
      "jobs",
      "employees"
    ]
  },
  {
    "id": 1115,
    "db_id": "hr_1",
    "question": "What is the first name and job id for all employees in the Finance department?",
    "sql": "SELECT T1.first_name ,  T1.job_id FROM employees AS T1 JOIN departments AS T2 ON T1.department_id  =  T2.department_id WHERE T2.department_name  =  'Finance'",
    "table_names": [
      "departments",
      "employees"
    ]
  },
  {
    "id": 1116,
    "db_id": "hr_1",
    "question": "Give the first name and job id for all employees in the Finance department.",
    "sql": "SELECT T1.first_name ,  T1.job_id FROM employees AS T1 JOIN departments AS T2 ON T1.department_id  =  T2.department_id WHERE T2.department_name  =  'Finance'",
    "table_names": [
      "departments",
      "employees"
    ]
  },
  {
    "id": 1117,
    "db_id": "hr_1",
    "question": "Find the ids of the employees who does not work in those departments where some employees works whose manager id within the range 100 and 200.",
    "sql": "SELECT * FROM employees WHERE department_id NOT IN (SELECT department_id FROM departments WHERE manager_id BETWEEN 100 AND 200)",
    "table_names": [
      "departments",
      "employees"
    ]
  },
  {
    "id": 1118,
    "db_id": "hr_1",
    "question": "What are the ids for employees who do not work in departments with managers that have ids between 100 and 200?",
    "sql": "SELECT * FROM employees WHERE department_id NOT IN (SELECT department_id FROM departments WHERE manager_id BETWEEN 100 AND 200)",
    "table_names": [
      "departments",
      "employees"
    ]
  },
  {
    "id": 1119,
    "db_id": "hr_1",
    "question": "display all the information of those employees who did not have any job in the past.",
    "sql": "SELECT * FROM employees WHERE employee_id NOT IN (SELECT employee_id FROM job_history)",
    "table_names": [
      "employees",
      "job_history"
    ]
  },
  {
    "id": 1120,
    "db_id": "hr_1",
    "question": "What is all the information about employees who have never had a job in the past?",
    "sql": "SELECT * FROM employees WHERE employee_id NOT IN (SELECT employee_id FROM job_history)",
    "table_names": [
      "employees",
      "job_history"
    ]
  },
  {
    "id": 1121,
    "db_id": "hr_1",
    "question": "display the department name, city, and state province for each department.",
    "sql": "SELECT T1.department_name ,  T2.city ,  T2.state_province FROM departments AS T1 JOIN locations AS T2 ON T2.location_id  =  T1.location_id",
    "table_names": [
      "departments",
      "locations"
    ]
  },
  {
    "id": 1122,
    "db_id": "hr_1",
    "question": "What are the department names, cities, and state provinces for each department?",
    "sql": "SELECT T1.department_name ,  T2.city ,  T2.state_province FROM departments AS T1 JOIN locations AS T2 ON T2.location_id  =  T1.location_id",
    "table_names": [
      "departments",
      "locations"
    ]
  },
  {
    "id": 1123,
    "db_id": "hr_1",
    "question": "display the department name and number of employees in each of the department.",
    "sql": "SELECT department_name ,  COUNT(*) FROM employees AS T1 JOIN departments AS T2 ON T1.department_id  =  T2.department_id GROUP BY department_name",
    "table_names": [
      "departments",
      "employees"
    ]
  },
  {
    "id": 1124,
    "db_id": "hr_1",
    "question": "What are the department names and how many employees work in each of them?",
    "sql": "SELECT department_name ,  COUNT(*) FROM employees AS T1 JOIN departments AS T2 ON T1.department_id  =  T2.department_id GROUP BY department_name",
    "table_names": [
      "departments",
      "employees"
    ]
  },
  {
    "id": 1177,
    "db_id": "baseball_1",
    "question": "what is the full name and id of the college with the largest number of baseball players?",
    "sql": "SELECT T1.name_full ,  T1.college_id FROM college AS T1 JOIN player_college AS T2 ON T1.college_id  =  T2.college_id GROUP BY T1.college_id ORDER BY count(*) DESC LIMIT 1;",
    "table_names": [
      "player_college",
      "college"
    ]
  },
  {
    "id": 1178,
    "db_id": "baseball_1",
    "question": "Find the full name and id of the college that has the most baseball players.",
    "sql": "SELECT T1.name_full ,  T1.college_id FROM college AS T1 JOIN player_college AS T2 ON T1.college_id  =  T2.college_id GROUP BY T1.college_id ORDER BY count(*) DESC LIMIT 1;",
    "table_names": [
      "player_college",
      "college"
    ]
  },
  {
    "id": 1179,
    "db_id": "baseball_1",
    "question": "What is average salary of the players in the team named 'Boston Red Stockings' ?",
    "sql": "SELECT avg(T1.salary) FROM salary AS T1 JOIN team AS T2 ON T1.team_id  =  T2.team_id_br WHERE T2.name  = 'Boston Red Stockings'",
    "table_names": [
      "salary",
      "team"
    ]
  },
  {
    "id": 1180,
    "db_id": "baseball_1",
    "question": "Compute the average salary of the players in the team called 'Boston Red Stockings'.",
    "sql": "SELECT avg(T1.salary) FROM salary AS T1 JOIN team AS T2 ON T1.team_id  =  T2.team_id_br WHERE T2.name  = 'Boston Red Stockings'",
    "table_names": [
      "salary",
      "team"
    ]
  },
  {
    "id": 1181,
    "db_id": "baseball_1",
    "question": "What are first and last names of players participating in all star game in 1998?",
    "sql": "SELECT name_first ,  name_last FROM player AS T1 JOIN all_star AS T2 ON T1.player_id  =  T2.player_id WHERE YEAR  =  1998",
    "table_names": [
      "all_star",
      "player"
    ]
  },
  {
    "id": 1182,
    "db_id": "baseball_1",
    "question": "List the first and last name for players who participated in all star game in 1998.",
    "sql": "SELECT name_first ,  name_last FROM player AS T1 JOIN all_star AS T2 ON T1.player_id  =  T2.player_id WHERE YEAR  =  1998",
    "table_names": [
      "all_star",
      "player"
    ]
  },
  {
    "id": 1183,
    "db_id": "baseball_1",
    "question": "What are the first name, last name and id of the player with the most all star game experiences? Also list the count.",
    "sql": "SELECT T1.name_first , T1.name_last ,  T1.player_id ,   count(*) FROM player AS T1 JOIN all_star AS T2 ON T1.player_id  =  T2.player_id GROUP BY T1.player_id ORDER BY count(*) DESC LIMIT 1;",
    "table_names": [
      "all_star",
      "player"
    ]
  },
  {
    "id": 1184,
    "db_id": "baseball_1",
    "question": "Which player has the most all star game experiences? Give me the first name, last name and id of the player, as well as the number of times the player participated in all star game.",
    "sql": "SELECT T1.name_first , T1.name_last ,  T1.player_id ,   count(*) FROM player AS T1 JOIN all_star AS T2 ON T1.player_id  =  T2.player_id GROUP BY T1.player_id ORDER BY count(*) DESC LIMIT 1;",
    "table_names": [
      "all_star",
      "player"
    ]
  },
  {
    "id": 1185,
    "db_id": "baseball_1",
    "question": "In 2014, what are the id and rank of the team that has the largest average number of attendance?",
    "sql": "SELECT T2.team_id ,  T2.rank FROM home_game AS T1 JOIN team AS T2 ON T1.team_id  =  T2.team_id WHERE T1.year  =  2014 GROUP BY T1.team_id ORDER BY avg(T1.attendance) DESC LIMIT 1;",
    "table_names": [
      "home_game",
      "team"
    ]
  },
  {
    "id": 1186,
    "db_id": "baseball_1",
    "question": "Find the id and rank of the team that has the highest average attendance rate in 2014.",
    "sql": "SELECT T2.team_id ,  T2.rank FROM home_game AS T1 JOIN team AS T2 ON T1.team_id  =  T2.team_id WHERE T1.year  =  2014 GROUP BY T1.team_id ORDER BY avg(T1.attendance) DESC LIMIT 1;",
    "table_names": [
      "home_game",
      "team"
    ]
  },
  {
    "id": 1187,
    "db_id": "baseball_1",
    "question": "What are the manager's first name, last name and id who won the most manager award?",
    "sql": "SELECT T1.name_first ,  T1.name_last ,  T2.player_id FROM player AS T1 JOIN manager_award AS T2 ON T1.player_id  =  T2.player_id GROUP BY T2.player_id ORDER BY count(*) DESC LIMIT 1;",
    "table_names": [
      "manager_award",
      "player"
    ]
  },
  {
    "id": 1188,
    "db_id": "baseball_1",
    "question": "Which manager won the most manager award? Give me the manager's first name, last name and id.",
    "sql": "SELECT T1.name_first ,  T1.name_last ,  T2.player_id FROM player AS T1 JOIN manager_award AS T2 ON T1.player_id  =  T2.player_id GROUP BY T2.player_id ORDER BY count(*) DESC LIMIT 1;",
    "table_names": [
      "manager_award",
      "player"
    ]
  },
  {
    "id": 1189,
    "db_id": "baseball_1",
    "question": "Which 3 players won the most player awards? List their full name and id.",
    "sql": "SELECT T1.name_first ,  T1.name_last ,  T1.player_id FROM player AS T1 JOIN player_award AS T2 ON T1.player_id  =  T2.player_id GROUP BY T1.player_id ORDER BY count(*) DESC LIMIT 3;",
    "table_names": [
      "player_award",
      "player"
    ]
  },
  {
    "id": 1190,
    "db_id": "baseball_1",
    "question": "Find the first name, last name and id for the top three players won the most player awards.",
    "sql": "SELECT T1.name_first ,  T1.name_last ,  T1.player_id FROM player AS T1 JOIN player_award AS T2 ON T1.player_id  =  T2.player_id GROUP BY T1.player_id ORDER BY count(*) DESC LIMIT 3;",
    "table_names": [
      "player_award",
      "player"
    ]
  },
  {
    "id": 1191,
    "db_id": "baseball_1",
    "question": "What is the highest salary among each team? List the team name, id and maximum salary.",
    "sql": "SELECT T1.name ,  T1.team_id ,  max(T2.salary) FROM team AS T1 JOIN salary AS T2 ON T1.team_id  =  T2.team_id GROUP BY T1.team_id;",
    "table_names": [
      "salary",
      "team"
    ]
  },
  {
    "id": 1192,
    "db_id": "baseball_1",
    "question": "For each team, return the team name, id and the maximum salary among the team.",
    "sql": "SELECT T1.name ,  T1.team_id ,  max(T2.salary) FROM team AS T1 JOIN salary AS T2 ON T1.team_id  =  T2.team_id GROUP BY T1.team_id;",
    "table_names": [
      "salary",
      "team"
    ]
  },
  {
    "id": 1193,
    "db_id": "baseball_1",
    "question": "What are the name and id of the team offering the lowest average salary?",
    "sql": "SELECT T1.name ,  T1.team_id FROM team AS T1 JOIN salary AS T2 ON T1.team_id = T2.team_id GROUP BY T1.team_id ORDER BY avg(T2.salary) ASC LIMIT 1;",
    "table_names": [
      "salary",
      "team"
    ]
  },
  {
    "id": 1194,
    "db_id": "baseball_1",
    "question": "Which team offers the lowest average salary? Give me the name and id of the team.",
    "sql": "SELECT T1.name ,  T1.team_id FROM team AS T1 JOIN salary AS T2 ON T1.team_id = T2.team_id GROUP BY T1.team_id ORDER BY avg(T2.salary) ASC LIMIT 1;",
    "table_names": [
      "salary",
      "team"
    ]
  },
  {
    "id": 1195,
    "db_id": "baseball_1",
    "question": "Find the players' first name and last name who won award both in 1960 and in 1961.",
    "sql": "SELECT T1.name_first , T1.name_last FROM player AS T1 JOIN player_award AS T2 WHERE T2.year  =  1960 INTERSECT SELECT T1.name_first , T1.name_last FROM player AS T1 JOIN player_award AS T2 WHERE T2.year  =  1961",
    "table_names": [
      "player_award",
      "player"
    ]
  },
  {
    "id": 1196,
    "db_id": "baseball_1",
    "question": "Which players won awards in both 1960 and 1961? Return their first names and last names.",
    "sql": "SELECT T1.name_first , T1.name_last FROM player AS T1 JOIN player_award AS T2 WHERE T2.year  =  1960 INTERSECT SELECT T1.name_first , T1.name_last FROM player AS T1 JOIN player_award AS T2 WHERE T2.year  =  1961",
    "table_names": [
      "player_award",
      "player"
    ]
  },
  {
    "id": 1197,
    "db_id": "baseball_1",
    "question": "List the maximum scores of the team Boston Red Stockings when the team won in postseason?",
    "sql": "SELECT max(T1.wins) FROM postseason AS T1 JOIN team AS T2 ON T1.team_id_winner  =  T2.team_id_br WHERE T2.name  =  'Boston Red Stockings';",
    "table_names": [
      "postseason",
      "team"
    ]
  },
  {
    "id": 1198,
    "db_id": "baseball_1",
    "question": "What are the maximum scores the team Boston Red Stockings got when the team won in postseason?",
    "sql": "SELECT max(T1.wins) FROM postseason AS T1 JOIN team AS T2 ON T1.team_id_winner  =  T2.team_id_br WHERE T2.name  =  'Boston Red Stockings';",
    "table_names": [
      "postseason",
      "team"
    ]
  },
  {
    "id": 1199,
    "db_id": "baseball_1",
    "question": "How many times did Boston Red Stockings lose in 2009 postseason?",
    "sql": "SELECT count(*) FROM postseason AS T1 JOIN team AS T2 ON T1.team_id_loser  =  T2.team_id_br WHERE T2.name  =  'Boston Red Stockings' AND T1.year = 2009;",
    "table_names": [
      "postseason",
      "team"
    ]
  },
  {
    "id": 1200,
    "db_id": "baseball_1",
    "question": "Count the number of times the team \"Boston Red Stockings\" lost in 2009 postseason.",
    "sql": "SELECT count(*) FROM postseason AS T1 JOIN team AS T2 ON T1.team_id_loser  =  T2.team_id_br WHERE T2.name  =  'Boston Red Stockings' AND T1.year = 2009;",
    "table_names": [
      "postseason",
      "team"
    ]
  },
  {
    "id": 1201,
    "db_id": "baseball_1",
    "question": "What are the name and id of the team with the most victories in 2008 postseason?",
    "sql": "SELECT T2.name ,  T1.team_id_winner FROM postseason AS T1 JOIN team AS T2 ON T1.team_id_winner  =  T2.team_id_br WHERE T1.year  =  2008 GROUP BY T1.team_id_winner ORDER BY count(*) DESC LIMIT 1;",
    "table_names": [
      "postseason",
      "team"
    ]
  },
  {
    "id": 1202,
    "db_id": "baseball_1",
    "question": "Find the name and id of the team that won the most times in 2008 postseason.",
    "sql": "SELECT T2.name ,  T1.team_id_winner FROM postseason AS T1 JOIN team AS T2 ON T1.team_id_winner  =  T2.team_id_br WHERE T1.year  =  2008 GROUP BY T1.team_id_winner ORDER BY count(*) DESC LIMIT 1;",
    "table_names": [
      "postseason",
      "team"
    ]
  },
  {
    "id": 1203,
    "db_id": "baseball_1",
    "question": "What is the number of wins the team Boston Red Stockings got in the postseasons each year in history?",
    "sql": "SELECT count(*) ,  T1.year FROM postseason AS T1 JOIN team AS T2 ON T1.team_id_winner  =  T2.team_id_br WHERE T2.name  =  'Boston Red Stockings' GROUP BY T1.year",
    "table_names": [
      "postseason",
      "team"
    ]
  },
  {
    "id": 1204,
    "db_id": "baseball_1",
    "question": "For each year, return the year and the number of times the team Boston Red Stockings won in the postseasons.",
    "sql": "SELECT count(*) ,  T1.year FROM postseason AS T1 JOIN team AS T2 ON T1.team_id_winner  =  T2.team_id_br WHERE T2.name  =  'Boston Red Stockings' GROUP BY T1.year",
    "table_names": [
      "postseason",
      "team"
    ]
  },
  {
    "id": 1205,
    "db_id": "baseball_1",
    "question": "What is the total number of postseason games that team Boston Red Stockings participated in?",
    "sql": "SELECT count(*) FROM ( SELECT * FROM postseason AS T1 JOIN team AS T2 ON T1.team_id_winner  =  T2.team_id_br WHERE T2.name  =  'Boston Red Stockings' UNION SELECT * FROM postseason AS T1 JOIN team AS T2 ON T1.team_id_loser  =  T2.team_id_br WHERE T2.name  =  'Boston Red Stockings' );",
    "table_names": [
      "postseason",
      "team"
    ]
  },
  {
    "id": 1206,
    "db_id": "baseball_1",
    "question": "How many times in total did the team Boston Red Stockings participate in postseason games?",
    "sql": "SELECT count(*) FROM ( SELECT * FROM postseason AS T1 JOIN team AS T2 ON T1.team_id_winner  =  T2.team_id_br WHERE T2.name  =  'Boston Red Stockings' UNION SELECT * FROM postseason AS T1 JOIN team AS T2 ON T1.team_id_loser  =  T2.team_id_br WHERE T2.name  =  'Boston Red Stockings' );",
    "table_names": [
      "postseason",
      "team"
    ]
  },
  {
    "id": 1207,
    "db_id": "baseball_1",
    "question": "What is the total salary paid by team Boston Red Stockings in 2010?",
    "sql": "SELECT sum(T1.salary) FROM salary AS T1 JOIN team AS T2 ON T1.team_id  =  T2.team_id_br WHERE T2.name  = 'Boston Red Stockings' AND T1.year  =  2010",
    "table_names": [
      "salary",
      "team"
    ]
  },
  {
    "id": 1208,
    "db_id": "baseball_1",
    "question": "What is the total salary expenses of team Boston Red Stockings in 2010?",
    "sql": "SELECT sum(T1.salary) FROM salary AS T1 JOIN team AS T2 ON T1.team_id  =  T2.team_id_br WHERE T2.name  = 'Boston Red Stockings' AND T1.year  =  2010",
    "table_names": [
      "salary",
      "team"
    ]
  },
  {
    "id": 1209,
    "db_id": "baseball_1",
    "question": "How many players were in the team Boston Red Stockings in 2000?",
    "sql": "SELECT count(*) FROM salary AS T1 JOIN team AS T2 ON T1.team_id  =  T2.team_id_br WHERE T2.name  = 'Boston Red Stockings' AND T1.year  =  2000",
    "table_names": [
      "salary",
      "team"
    ]
  },
  {
    "id": 1210,
    "db_id": "baseball_1",
    "question": "How many players did Boston Red Stockings have in 2000?",
    "sql": "SELECT count(*) FROM salary AS T1 JOIN team AS T2 ON T1.team_id  =  T2.team_id_br WHERE T2.name  = 'Boston Red Stockings' AND T1.year  =  2000",
    "table_names": [
      "salary",
      "team"
    ]
  },
  {
    "id": 1211,
    "db_id": "baseball_1",
    "question": "How many games were played in park \"Columbia Park\" in 1907?",
    "sql": "SELECT count(*) FROM home_game AS T1 JOIN park AS T2 ON T1.park_id  =  T2.park_id WHERE T1.year = 1907 AND T2.park_name = 'Columbia Park';",
    "table_names": [
      "home_game",
      "park"
    ]
  },
  {
    "id": 1212,
    "db_id": "baseball_1",
    "question": "Count the number of games taken place in park \"Columbia Park\" in 1907.",
    "sql": "SELECT count(*) FROM home_game AS T1 JOIN park AS T2 ON T1.park_id  =  T2.park_id WHERE T1.year = 1907 AND T2.park_name = 'Columbia Park';",
    "table_names": [
      "home_game",
      "park"
    ]
  },
  {
    "id": 1213,
    "db_id": "baseball_1",
    "question": "How many games were played in city Atlanta in 2000?",
    "sql": "SELECT count(*) FROM home_game AS T1 JOIN park AS T2 ON T1.park_id  =  T2.park_id WHERE T1.year  =  2000 AND T2.city  =  'Atlanta';",
    "table_names": [
      "home_game",
      "park"
    ]
  },
  {
    "id": 1214,
    "db_id": "baseball_1",
    "question": "Find the number of games taken place in city Atlanta in 2000.",
    "sql": "SELECT count(*) FROM home_game AS T1 JOIN park AS T2 ON T1.park_id  =  T2.park_id WHERE T1.year  =  2000 AND T2.city  =  'Atlanta';",
    "table_names": [
      "home_game",
      "park"
    ]
  },
  {
    "id": 1215,
    "db_id": "baseball_1",
    "question": "What is the total home game attendance of team Boston Red Stockings from 2000 to 2010?",
    "sql": "SELECT sum(T1.attendance) FROM home_game AS T1 JOIN team AS T2 ON T1.team_id  =  T2.team_id_br WHERE T2.name  =  'Boston Red Stockings' AND T1.year BETWEEN 2000 AND 2010;",
    "table_names": [
      "home_game",
      "team"
    ]
  },
  {
    "id": 1216,
    "db_id": "baseball_1",
    "question": "How many games in total did team Boston Red Stockings attend from 2000 to 2010?",
    "sql": "SELECT sum(T1.attendance) FROM home_game AS T1 JOIN team AS T2 ON T1.team_id  =  T2.team_id_br WHERE T2.name  =  'Boston Red Stockings' AND T1.year BETWEEN 2000 AND 2010;",
    "table_names": [
      "home_game",
      "team"
    ]
  },
  {
    "id": 1217,
    "db_id": "baseball_1",
    "question": "How much did the the player with first name Len and last name Barker earn between 1985 to 1990 in total?",
    "sql": "SELECT sum(T1.salary) FROM salary AS T1 JOIN player AS T2 ON T1.player_id = T2.player_id WHERE T2.name_first  =  'Len' AND T2.name_last = 'Barker' AND T1.year BETWEEN 1985 AND 1990;",
    "table_names": [
      "player",
      "salary"
    ]
  },
  {
    "id": 1218,
    "db_id": "baseball_1",
    "question": "Compute the total salary that the player with first name Len and last name Barker received between 1985 to 1990.",
    "sql": "SELECT sum(T1.salary) FROM salary AS T1 JOIN player AS T2 ON T1.player_id = T2.player_id WHERE T2.name_first  =  'Len' AND T2.name_last = 'Barker' AND T1.year BETWEEN 1985 AND 1990;",
    "table_names": [
      "player",
      "salary"
    ]
  },
  {
    "id": 1219,
    "db_id": "baseball_1",
    "question": "How many home games did the team Boston Red Stockings play from 1990 to 2000 in total?",
    "sql": "SELECT sum(T1.games) FROM home_game AS T1 JOIN team AS T2 ON T1.team_id = T2.team_id_br WHERE T2.name = 'Boston Red Stockings' AND T1.year BETWEEN 1990 AND 2000;",
    "table_names": [
      "home_game",
      "team"
    ]
  },
  {
    "id": 1220,
    "db_id": "baseball_1",
    "question": "Count the total number of games the team Boston Red Stockings attended from 1990 to 2000.",
    "sql": "SELECT sum(T1.games) FROM home_game AS T1 JOIN team AS T2 ON T1.team_id = T2.team_id_br WHERE T2.name = 'Boston Red Stockings' AND T1.year BETWEEN 1990 AND 2000;",
    "table_names": [
      "home_game",
      "team"
    ]
  },
  {
    "id": 1221,
    "db_id": "baseball_1",
    "question": "Which team had the least number of attendances in home games in 1980?",
    "sql": "SELECT T2.name FROM home_game AS T1 JOIN team AS T2 ON T1.team_id = T2.team_id_br WHERE T1.year = 1980 ORDER BY T1.attendance ASC LIMIT 1;",
    "table_names": [
      "home_game",
      "team"
    ]
  },
  {
    "id": 1222,
    "db_id": "baseball_1",
    "question": "Find the team that attended the least number of home games in 1980.",
    "sql": "SELECT T2.name FROM home_game AS T1 JOIN team AS T2 ON T1.team_id = T2.team_id_br WHERE T1.year = 1980 ORDER BY T1.attendance ASC LIMIT 1;",
    "table_names": [
      "home_game",
      "team"
    ]
  },
  {
    "id": 1223,
    "db_id": "baseball_1",
    "question": "Which park had most attendances in 2008?",
    "sql": "SELECT T2.park_name FROM home_game AS T1 JOIN park AS T2 ON T1.park_id  =  T2.park_id WHERE T1.year = 2008 ORDER BY T1.attendance DESC LIMIT 1;",
    "table_names": [
      "home_game",
      "park"
    ]
  },
  {
    "id": 1224,
    "db_id": "baseball_1",
    "question": "Which park did the most people attend in 2008?",
    "sql": "SELECT T2.park_name FROM home_game AS T1 JOIN park AS T2 ON T1.park_id  =  T2.park_id WHERE T1.year = 2008 ORDER BY T1.attendance DESC LIMIT 1;",
    "table_names": [
      "home_game",
      "park"
    ]
  },
  {
    "id": 1225,
    "db_id": "mountain_photos",
    "question": "What are the id and name of the photos for mountains?",
    "sql": "SELECT T1.id ,  T1.name FROM mountain AS T1 JOIN photos AS T2 ON T1.id  =  T2.mountain_id WHERE T1.height  >  4000",
    "table_names": [
      "mountain",
      "photos"
    ]
  },
  {
    "id": 1226,
    "db_id": "mountain_photos",
    "question": "What are the id and name of the mountains that have at least 2 photos?",
    "sql": "SELECT T1.id ,  T1.name FROM mountain AS T1 JOIN photos AS T2 ON T1.id  =  T2.mountain_id GROUP BY T1.id HAVING count(*)  >=  2",
    "table_names": [
      "mountain",
      "photos"
    ]
  },
  {
    "id": 1230,
    "db_id": "mountain_photos",
    "question": "How many distinct kinds of camera lenses are used to take photos of mountains in the country 'Ethiopia'?",
    "sql": "SELECT count(DISTINCT T2.camera_lens_id) FROM mountain AS T1 JOIN photos AS T2 ON T1.id  =  T2.mountain_id WHERE T1.country  =  'Ethiopia'",
    "table_names": [
      "mountain",
      "photos"
    ]
  },
  {
    "id": 1258,
    "db_id": "e_learning",
    "question": "What is the date of enrollment of the course named \"Spanish\"?",
    "sql": "SELECT T2.date_of_enrolment FROM Courses AS T1 JOIN Student_Course_Enrolment AS T2 ON T1.course_id  =  T2.course_id WHERE T1.course_name  =  \"Spanish\"",
    "table_names": [
      "Courses",
      "Student_Course_Enrolment"
    ]
  },
  {
    "id": 1259,
    "db_id": "e_learning",
    "question": "Find the the date of enrollment of the \"Spanish\" course.",
    "sql": "SELECT T2.date_of_enrolment FROM Courses AS T1 JOIN Student_Course_Enrolment AS T2 ON T1.course_id  =  T2.course_id WHERE T1.course_name  =  \"Spanish\"",
    "table_names": [
      "Courses",
      "Student_Course_Enrolment"
    ]
  },
  {
    "id": 1260,
    "db_id": "e_learning",
    "question": "What is the name of the course that has the most student enrollment?",
    "sql": "SELECT T1.course_name FROM Courses AS T1 JOIN Student_Course_Enrolment AS T2 ON T1.course_id  =  T2.course_id GROUP BY T1.course_name ORDER BY COUNT(*) DESC LIMIT 1",
    "table_names": [
      "Courses",
      "Student_Course_Enrolment"
    ]
  },
  {
    "id": 1261,
    "db_id": "e_learning",
    "question": "Which course is enrolled in by the most students? Give me the course name.",
    "sql": "SELECT T1.course_name FROM Courses AS T1 JOIN Student_Course_Enrolment AS T2 ON T1.course_id  =  T2.course_id GROUP BY T1.course_name ORDER BY COUNT(*) DESC LIMIT 1",
    "table_names": [
      "Courses",
      "Student_Course_Enrolment"
    ]
  },
  {
    "id": 1262,
    "db_id": "e_learning",
    "question": "What are the names of the courses that have exactly 1 student enrollment?",
    "sql": "SELECT T1.course_name FROM Courses AS T1 JOIN Student_Course_Enrolment AS T2 ON T1.course_id  =  T2.course_id GROUP BY T1.course_name HAVING COUNT(*)  =  1",
    "table_names": [
      "Courses",
      "Student_Course_Enrolment"
    ]
  },
  {
    "id": 1263,
    "db_id": "e_learning",
    "question": "Find the names of the courses that have just one student enrollment.",
    "sql": "SELECT T1.course_name FROM Courses AS T1 JOIN Student_Course_Enrolment AS T2 ON T1.course_id  =  T2.course_id GROUP BY T1.course_name HAVING COUNT(*)  =  1",
    "table_names": [
      "Courses",
      "Student_Course_Enrolment"
    ]
  },
  {
    "id": 1264,
    "db_id": "e_learning",
    "question": "What are the descriptions and names of the courses that have student enrollment bigger than 2?",
    "sql": "SELECT T1.course_description ,  T1.course_name FROM Courses AS T1 JOIN Student_Course_Enrolment AS T2 ON T1.course_id  =  T2.course_id GROUP BY T1.course_name HAVING COUNT(*)  >  2",
    "table_names": [
      "Courses",
      "Student_Course_Enrolment"
    ]
  },
  {
    "id": 1265,
    "db_id": "e_learning",
    "question": "Return the descriptions and names of the courses that have more than two students enrolled in.",
    "sql": "SELECT T1.course_description ,  T1.course_name FROM Courses AS T1 JOIN Student_Course_Enrolment AS T2 ON T1.course_id  =  T2.course_id GROUP BY T1.course_name HAVING COUNT(*)  >  2",
    "table_names": [
      "Courses",
      "Student_Course_Enrolment"
    ]
  },
  {
    "id": 1266,
    "db_id": "e_learning",
    "question": "What is the name of each course and the corresponding number of student enrollment?",
    "sql": "SELECT T1.course_name ,  COUNT(*) FROM Courses AS T1 JOIN Student_Course_Enrolment AS T2 ON T1.course_id  =  T2.course_id GROUP BY T1.course_name",
    "table_names": [
      "Courses",
      "Student_Course_Enrolment"
    ]
  },
  {
    "id": 1267,
    "db_id": "e_learning",
    "question": "List the name and the number of enrolled student for each course.",
    "sql": "SELECT T1.course_name ,  COUNT(*) FROM Courses AS T1 JOIN Student_Course_Enrolment AS T2 ON T1.course_id  =  T2.course_id GROUP BY T1.course_name",
    "table_names": [
      "Courses",
      "Student_Course_Enrolment"
    ]
  },
  {
    "id": 1268,
    "db_id": "e_learning",
    "question": "What are the enrollment dates of all the tests that have result \"Pass\"?",
    "sql": "SELECT T1.date_of_enrolment FROM Student_Course_Enrolment AS T1 JOIN Student_Tests_Taken AS T2 ON T1.registration_id  =  T2.registration_id WHERE T2.test_result  =  \"Pass\"",
    "table_names": [
      "Student_Course_Enrolment",
      "Student_Tests_Taken"
    ]
  },
  {
    "id": 1269,
    "db_id": "e_learning",
    "question": "Find the enrollment date for all the tests that have \"Pass\" result.",
    "sql": "SELECT T1.date_of_enrolment FROM Student_Course_Enrolment AS T1 JOIN Student_Tests_Taken AS T2 ON T1.registration_id  =  T2.registration_id WHERE T2.test_result  =  \"Pass\"",
    "table_names": [
      "Student_Course_Enrolment",
      "Student_Tests_Taken"
    ]
  },
  {
    "id": 1270,
    "db_id": "e_learning",
    "question": "What are the completion dates of all the tests that have result \"Fail\"?",
    "sql": "SELECT T1.date_of_completion FROM Student_Course_Enrolment AS T1 JOIN Student_Tests_Taken AS T2 ON T1.registration_id  =  T2.registration_id WHERE T2.test_result  =  \"Fail\"",
    "table_names": [
      "Student_Course_Enrolment",
      "Student_Tests_Taken"
    ]
  },
  {
    "id": 1271,
    "db_id": "e_learning",
    "question": "Return the completion date for all the tests that have \"Fail\" result.",
    "sql": "SELECT T1.date_of_completion FROM Student_Course_Enrolment AS T1 JOIN Student_Tests_Taken AS T2 ON T1.registration_id  =  T2.registration_id WHERE T2.test_result  =  \"Fail\"",
    "table_names": [
      "Student_Course_Enrolment",
      "Student_Tests_Taken"
    ]
  },
  {
    "id": 1272,
    "db_id": "e_learning",
    "question": "List the dates of enrollment and completion of the student with personal name \"Karson\".",
    "sql": "SELECT T1.date_of_enrolment ,  T1.date_of_completion FROM Student_Course_Enrolment AS T1 JOIN Students AS T2 ON T1.student_id  =  T2.student_id WHERE T2.personal_name  =  \"Karson\"",
    "table_names": [
      "Students",
      "Student_Course_Enrolment"
    ]
  },
  {
    "id": 1273,
    "db_id": "e_learning",
    "question": "On what dates did the student whose personal name is \"Karson\" enroll in and complete the courses?",
    "sql": "SELECT T1.date_of_enrolment ,  T1.date_of_completion FROM Student_Course_Enrolment AS T1 JOIN Students AS T2 ON T1.student_id  =  T2.student_id WHERE T2.personal_name  =  \"Karson\"",
    "table_names": [
      "Students",
      "Student_Course_Enrolment"
    ]
  },
  {
    "id": 1274,
    "db_id": "e_learning",
    "question": "List the dates of enrollment and completion of the student with family name \"Zieme\" and personal name \"Bernie\".",
    "sql": "SELECT T1.date_of_enrolment ,  T1.date_of_completion FROM Student_Course_Enrolment AS T1 JOIN Students AS T2 ON T1.student_id  =  T2.student_id WHERE T2.family_name  =  \"Zieme\" AND T2.personal_name  =  \"Bernie\"",
    "table_names": [
      "Students",
      "Student_Course_Enrolment"
    ]
  },
  {
    "id": 1275,
    "db_id": "e_learning",
    "question": "On what dates did the student with family name \"Zieme\" and personal name \"Bernie\" enroll in and complete the courses?",
    "sql": "SELECT T1.date_of_enrolment ,  T1.date_of_completion FROM Student_Course_Enrolment AS T1 JOIN Students AS T2 ON T1.student_id  =  T2.student_id WHERE T2.family_name  =  \"Zieme\" AND T2.personal_name  =  \"Bernie\"",
    "table_names": [
      "Students",
      "Student_Course_Enrolment"
    ]
  },
  {
    "id": 1276,
    "db_id": "e_learning",
    "question": "Find the student ID and login name of the student with the most course enrollments",
    "sql": "SELECT T1.student_id ,  T2.login_name FROM Student_Course_Enrolment AS T1 JOIN Students AS T2 ON T1.student_id  =  T2.student_id GROUP BY T1.student_id ORDER BY COUNT(*) DESC LIMIT 1",
    "table_names": [
      "Students",
      "Student_Course_Enrolment"
    ]
  },
  {
    "id": 1277,
    "db_id": "e_learning",
    "question": "What are the student ID and login name of the student who are enrolled in the most courses?",
    "sql": "SELECT T1.student_id ,  T2.login_name FROM Student_Course_Enrolment AS T1 JOIN Students AS T2 ON T1.student_id  =  T2.student_id GROUP BY T1.student_id ORDER BY COUNT(*) DESC LIMIT 1",
    "table_names": [
      "Students",
      "Student_Course_Enrolment"
    ]
  },
  {
    "id": 1278,
    "db_id": "e_learning",
    "question": "Find the student ID and personal name of the student with at least two enrollments.",
    "sql": "SELECT T1.student_id ,  T2.personal_name FROM Student_Course_Enrolment AS T1 JOIN Students AS T2 ON T1.student_id  =  T2.student_id GROUP BY T1.student_id HAVING COUNT(*)  >=  2",
    "table_names": [
      "Students",
      "Student_Course_Enrolment"
    ]
  },
  {
    "id": 1279,
    "db_id": "e_learning",
    "question": "Which student are enrolled in at least two courses? Give me the student ID and personal name.",
    "sql": "SELECT T1.student_id ,  T2.personal_name FROM Student_Course_Enrolment AS T1 JOIN Students AS T2 ON T1.student_id  =  T2.student_id GROUP BY T1.student_id HAVING COUNT(*)  >=  2",
    "table_names": [
      "Students",
      "Student_Course_Enrolment"
    ]
  },
  {
    "id": 1280,
    "db_id": "e_learning",
    "question": "Find the student ID and middle name for all the students with at most two enrollments.",
    "sql": "SELECT T1.student_id ,  T2.middle_name FROM Student_Course_Enrolment AS T1 JOIN Students AS T2 ON T1.student_id  =  T2.student_id GROUP BY T1.student_id HAVING COUNT(*)  <=  2",
    "table_names": [
      "Students",
      "Student_Course_Enrolment"
    ]
  },
  {
    "id": 1281,
    "db_id": "e_learning",
    "question": "What are the student IDs and middle names of the students enrolled in at most two courses?",
    "sql": "SELECT T1.student_id ,  T2.middle_name FROM Student_Course_Enrolment AS T1 JOIN Students AS T2 ON T1.student_id  =  T2.student_id GROUP BY T1.student_id HAVING COUNT(*)  <=  2",
    "table_names": [
      "Students",
      "Student_Course_Enrolment"
    ]
  },
  {
    "id": 1282,
    "db_id": "e_learning",
    "question": "Find the personal names of students not enrolled in any course.",
    "sql": "SELECT personal_name FROM Students EXCEPT SELECT T1.personal_name FROM Students AS T1 JOIN Student_Course_Enrolment AS T2 ON T1.student_id  =  T2.student_id",
    "table_names": [
      "Students",
      "Student_Course_Enrolment"
    ]
  },
  {
    "id": 1283,
    "db_id": "e_learning",
    "question": "Which students not enrolled in any course? Find their personal names.",
    "sql": "SELECT personal_name FROM Students EXCEPT SELECT T1.personal_name FROM Students AS T1 JOIN Student_Course_Enrolment AS T2 ON T1.student_id  =  T2.student_id",
    "table_names": [
      "Students",
      "Student_Course_Enrolment"
    ]
  },
  {
    "id": 1284,
    "db_id": "e_learning",
    "question": "How many students did not have any course enrollment?",
    "sql": "SELECT count(*) FROM Students WHERE student_id NOT IN (SELECT student_id FROM Student_Course_Enrolment)",
    "table_names": [
      "Students",
      "Student_Course_Enrolment"
    ]
  },
  {
    "id": 1285,
    "db_id": "e_learning",
    "question": "Count the number of students who did not enroll in any course.",
    "sql": "SELECT count(*) FROM Students WHERE student_id NOT IN (SELECT student_id FROM Student_Course_Enrolment)",
    "table_names": [
      "Students",
      "Student_Course_Enrolment"
    ]
  },
  {
    "id": 1312,
    "db_id": "hospital_1",
    "question": "How many patients stay in room 112?",
    "sql": "SELECT count(patient) FROM stay WHERE room  =  112",
    "table_names": [
      "Room",
      "Stay"
    ]
  },
  {
    "id": 1313,
    "db_id": "hospital_1",
    "question": "Count the number of patients who stayed in room 112.",
    "sql": "SELECT count(patient) FROM stay WHERE room  =  112",
    "table_names": [
      "Room",
      "Stay"
    ]
  },
  {
    "id": 1320,
    "db_id": "hospital_1",
    "question": "Find the number of rooms located on each block floor.",
    "sql": "SELECT count(*) ,  T1.blockfloor FROM BLOCK AS T1 JOIN room AS T2 ON T1.blockfloor  =  T2.blockfloor AND T1.blockcode  =  T2.blockcode GROUP BY T1.blockfloor",
    "table_names": [
      "Block",
      "Room"
    ]
  },
  {
    "id": 1321,
    "db_id": "hospital_1",
    "question": "How many rooms does each block floor have?",
    "sql": "SELECT count(*) ,  T1.blockfloor FROM BLOCK AS T1 JOIN room AS T2 ON T1.blockfloor  =  T2.blockfloor AND T1.blockcode  =  T2.blockcode GROUP BY T1.blockfloor",
    "table_names": [
      "Block",
      "Room"
    ]
  },
  {
    "id": 1322,
    "db_id": "hospital_1",
    "question": "Find the number of rooms for different block code?",
    "sql": "SELECT count(*) ,  T1.blockcode FROM BLOCK AS T1 JOIN room AS T2 ON T1.blockfloor  =  T2.blockfloor AND T1.blockcode  =  T2.blockcode GROUP BY T1.blockcode",
    "table_names": [
      "Block",
      "Room"
    ]
  },
  {
    "id": 1323,
    "db_id": "hospital_1",
    "question": "How many rooms are located for each block code?",
    "sql": "SELECT count(*) ,  T1.blockcode FROM BLOCK AS T1 JOIN room AS T2 ON T1.blockfloor  =  T2.blockfloor AND T1.blockcode  =  T2.blockcode GROUP BY T1.blockcode",
    "table_names": [
      "Block",
      "Room"
    ]
  },
  {
    "id": 1346,
    "db_id": "student_1",
    "question": "Find the last names of the teachers that teach fifth grade.",
    "sql": "SELECT DISTINCT T2.lastname FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom WHERE grade  =  5",
    "table_names": [
      "list",
      "teachers"
    ]
  },
  {
    "id": 1347,
    "db_id": "student_1",
    "question": "what are the last names of the teachers who teach grade 5?",
    "sql": "SELECT DISTINCT T2.lastname FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom WHERE grade  =  5",
    "table_names": [
      "list",
      "teachers"
    ]
  },
  {
    "id": 1348,
    "db_id": "student_1",
    "question": "Find the first names of the teachers that teach first grade.",
    "sql": "SELECT DISTINCT T2.firstname FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom WHERE grade  =  1",
    "table_names": [
      "list",
      "teachers"
    ]
  },
  {
    "id": 1349,
    "db_id": "student_1",
    "question": "What are the first names of the teachers who teach grade 1?",
    "sql": "SELECT DISTINCT T2.firstname FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom WHERE grade  =  1",
    "table_names": [
      "list",
      "teachers"
    ]
  },
  {
    "id": 1350,
    "db_id": "student_1",
    "question": "How many students does LORIA ONDERSMA teaches?",
    "sql": "SELECT count(*) FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom WHERE T2.firstname  =  \"LORIA\" AND T2.lastname  =  \"ONDERSMA\"",
    "table_names": [
      "list",
      "teachers"
    ]
  },
  {
    "id": 1351,
    "db_id": "student_1",
    "question": "Count the number of students the teacher LORIA ONDERSMA teaches.",
    "sql": "SELECT count(*) FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom WHERE T2.firstname  =  \"LORIA\" AND T2.lastname  =  \"ONDERSMA\"",
    "table_names": [
      "list",
      "teachers"
    ]
  },
  {
    "id": 1352,
    "db_id": "student_1",
    "question": "How many students does KAWA GORDON teaches?",
    "sql": "SELECT count(*) FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom WHERE T2.firstname  =  \"KAWA\" AND T2.lastname  =  \"GORDON\"",
    "table_names": [
      "list",
      "teachers"
    ]
  },
  {
    "id": 1353,
    "db_id": "student_1",
    "question": "Find the number of students taught by the teacher KAWA GORDON.",
    "sql": "SELECT count(*) FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom WHERE T2.firstname  =  \"KAWA\" AND T2.lastname  =  \"GORDON\"",
    "table_names": [
      "list",
      "teachers"
    ]
  },
  {
    "id": 1354,
    "db_id": "student_1",
    "question": "Find the number of students taught by TARRING LEIA.",
    "sql": "SELECT count(*) FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom WHERE T2.firstname  =  \"TARRING\" AND T2.lastname  =  \"LEIA\"",
    "table_names": [
      "list",
      "teachers"
    ]
  },
  {
    "id": 1355,
    "db_id": "student_1",
    "question": "How many students are taught by teacher TARRING LEIA?",
    "sql": "SELECT count(*) FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom WHERE T2.firstname  =  \"TARRING\" AND T2.lastname  =  \"LEIA\"",
    "table_names": [
      "list",
      "teachers"
    ]
  },
  {
    "id": 1356,
    "db_id": "student_1",
    "question": "How many teachers does the student named CHRISSY NABOZNY have?",
    "sql": "SELECT count(*) FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom WHERE T1.firstname  =  \"CHRISSY\" AND T1.lastname  =  \"NABOZNY\"",
    "table_names": [
      "list",
      "teachers"
    ]
  },
  {
    "id": 1357,
    "db_id": "student_1",
    "question": "Find the number of teachers who teach the student called CHRISSY NABOZNY.",
    "sql": "SELECT count(*) FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom WHERE T1.firstname  =  \"CHRISSY\" AND T1.lastname  =  \"NABOZNY\"",
    "table_names": [
      "list",
      "teachers"
    ]
  },
  {
    "id": 1358,
    "db_id": "student_1",
    "question": "How many teachers does the student named MADLOCK RAY have?",
    "sql": "SELECT count(*) FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom WHERE T1.firstname  =  \"MADLOCK\" AND T1.lastname  =  \"RAY\"",
    "table_names": [
      "list",
      "teachers"
    ]
  },
  {
    "id": 1359,
    "db_id": "student_1",
    "question": "Find the number of teachers who teach the student called MADLOCK RAY.",
    "sql": "SELECT count(*) FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom WHERE T1.firstname  =  \"MADLOCK\" AND T1.lastname  =  \"RAY\"",
    "table_names": [
      "list",
      "teachers"
    ]
  },
  {
    "id": 1360,
    "db_id": "student_1",
    "question": "Find all first-grade students who are NOT taught by OTHA MOYER. Report their first and last names.",
    "sql": "SELECT DISTINCT T1.firstname ,  T1.lastname FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom WHERE T1.grade  =  1 EXCEPT SELECT T1.firstname ,  T1.lastname FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom WHERE T2.firstname  =  \"OTHA\" AND T2.lastname  =  \"MOYER\"",
    "table_names": [
      "list",
      "teachers"
    ]
  },
  {
    "id": 1361,
    "db_id": "student_1",
    "question": "What are the first and last names of the first-grade students who are NOT taught by teacher OTHA MOYER?",
    "sql": "SELECT DISTINCT T1.firstname ,  T1.lastname FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom WHERE T1.grade  =  1 EXCEPT SELECT T1.firstname ,  T1.lastname FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom WHERE T2.firstname  =  \"OTHA\" AND T2.lastname  =  \"MOYER\"",
    "table_names": [
      "list",
      "teachers"
    ]
  },
  {
    "id": 1362,
    "db_id": "student_1",
    "question": "Find the last names of the students in third grade that are not taught by COVIN JEROME.",
    "sql": "SELECT DISTINCT T1.lastname FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom WHERE T1.grade  =  3 AND T2.firstname != \"COVIN\" AND T2.lastname != \"JEROME\"",
    "table_names": [
      "list",
      "teachers"
    ]
  },
  {
    "id": 1363,
    "db_id": "student_1",
    "question": "Which students in third grade are not taught by teacher COVIN JEROME? Give me the last names of the students.",
    "sql": "SELECT DISTINCT T1.lastname FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom WHERE T1.grade  =  3 AND T2.firstname != \"COVIN\" AND T2.lastname != \"JEROME\"",
    "table_names": [
      "list",
      "teachers"
    ]
  },
  {
    "id": 1364,
    "db_id": "student_1",
    "question": "Find the name of the teacher who teaches the largest number of students.",
    "sql": "SELECT T2.firstname ,  T2.lastname FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom GROUP BY T2.firstname ,  T2.lastname ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "list",
      "teachers"
    ]
  },
  {
    "id": 1365,
    "db_id": "student_1",
    "question": "Which teacher teaches the most students? Give me the first name and last name of the teacher.",
    "sql": "SELECT T2.firstname ,  T2.lastname FROM list AS T1 JOIN teachers AS T2 ON T1.classroom  =  T2.classroom GROUP BY T2.firstname ,  T2.lastname ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "list",
      "teachers"
    ]
  },
  {
    "id": 1401,
    "db_id": "club_1",
    "question": "Where is the club \"Hopkins Student Enterprises\" located?",
    "sql": "SELECT clublocation FROM club WHERE clubname  =  \"Hopkins Student Enterprises\"",
    "table_names": [
      "Student",
      "Club"
    ]
  },
  {
    "id": 1402,
    "db_id": "club_1",
    "question": "Tell me the location of the club \"Hopkins Student Enterprises\".",
    "sql": "SELECT clublocation FROM club WHERE clubname  =  \"Hopkins Student Enterprises\"",
    "table_names": [
      "Student",
      "Club"
    ]
  },
  {
    "id": 1499,
    "db_id": "college_3",
    "question": "Find the name of the department that has the biggest number of students minored in?",
    "sql": "SELECT T1.DName FROM DEPARTMENT AS T1 JOIN MINOR_IN AS T2 ON T1.DNO  =  T2.DNO GROUP BY T2.DNO ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "Department",
      "Minor_in"
    ]
  },
  {
    "id": 1500,
    "db_id": "college_3",
    "question": "What is the name of the department with the most students minoring in it?",
    "sql": "SELECT T1.DName FROM DEPARTMENT AS T1 JOIN MINOR_IN AS T2 ON T1.DNO  =  T2.DNO GROUP BY T2.DNO ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "Department",
      "Minor_in"
    ]
  },
  {
    "id": 1501,
    "db_id": "college_3",
    "question": "Find the name of the department that has no students minored in?",
    "sql": "SELECT DName FROM DEPARTMENT EXCEPT SELECT T1.DName FROM DEPARTMENT AS T1 JOIN MINOR_IN AS T2 ON T1.DNO  =  T2.DNO",
    "table_names": [
      "Department",
      "Minor_in"
    ]
  },
  {
    "id": 1502,
    "db_id": "college_3",
    "question": "What is the name of the department htat has no students minoring in it?",
    "sql": "SELECT DName FROM DEPARTMENT EXCEPT SELECT T1.DName FROM DEPARTMENT AS T1 JOIN MINOR_IN AS T2 ON T1.DNO  =  T2.DNO",
    "table_names": [
      "Department",
      "Minor_in"
    ]
  },
  {
    "id": 1503,
    "db_id": "college_3",
    "question": "Find the name of the department that has the fewest members.",
    "sql": "SELECT T1.DName FROM DEPARTMENT AS T1 JOIN MEMBER_OF AS T2 ON T1.DNO  =  T2.DNO GROUP BY T2.DNO ORDER BY count(*) ASC LIMIT 1",
    "table_names": [
      "Department",
      "Member_of"
    ]
  },
  {
    "id": 1504,
    "db_id": "college_3",
    "question": "What is the name of the department with the fewest members?",
    "sql": "SELECT T1.DName FROM DEPARTMENT AS T1 JOIN MEMBER_OF AS T2 ON T1.DNO  =  T2.DNO GROUP BY T2.DNO ORDER BY count(*) ASC LIMIT 1",
    "table_names": [
      "Department",
      "Member_of"
    ]
  },
  {
    "id": 1505,
    "db_id": "college_3",
    "question": "What are the first and last names of the instructors who teach the top 3 number of courses?",
    "sql": "SELECT T2.Fname ,  T2.Lname FROM COURSE AS T1 JOIN FACULTY AS T2 ON T1.Instructor  =  T2.FacID GROUP BY T1.Instructor ORDER BY count(*) DESC LIMIT 3",
    "table_names": [
      "Faculty",
      "Course"
    ]
  },
  {
    "id": 1506,
    "db_id": "college_3",
    "question": "What are the full names of the 3 instructors who teach the most courses?",
    "sql": "SELECT T2.Fname ,  T2.Lname FROM COURSE AS T1 JOIN FACULTY AS T2 ON T1.Instructor  =  T2.FacID GROUP BY T1.Instructor ORDER BY count(*) DESC LIMIT 3",
    "table_names": [
      "Faculty",
      "Course"
    ]
  },
  {
    "id": 1507,
    "db_id": "college_3",
    "question": "Which building does the instructor who teaches the most number of courses live in?",
    "sql": "SELECT T2.Building FROM COURSE AS T1 JOIN FACULTY AS T2 ON T1.Instructor  =  T2.FacID GROUP BY T1.Instructor ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "Faculty",
      "Course"
    ]
  },
  {
    "id": 1508,
    "db_id": "college_3",
    "question": "Give the building that the instructor who teaches the greatest number of courses lives in.",
    "sql": "SELECT T2.Building FROM COURSE AS T1 JOIN FACULTY AS T2 ON T1.Instructor  =  T2.FacID GROUP BY T1.Instructor ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "Faculty",
      "Course"
    ]
  },
  {
    "id": 1509,
    "db_id": "college_3",
    "question": "What are the name of courses that have at least five enrollments?",
    "sql": "SELECT T1.CName FROM COURSE AS T1 JOIN ENROLLED_IN AS T2 ON T1.CID  =  T2.CID GROUP BY T2.CID HAVING COUNT(*)  >=  5",
    "table_names": [
      "Course",
      "Enrolled_in"
    ]
  },
  {
    "id": 1510,
    "db_id": "college_3",
    "question": "Give the names of the courses with at least five enrollments.",
    "sql": "SELECT T1.CName FROM COURSE AS T1 JOIN ENROLLED_IN AS T2 ON T1.CID  =  T2.CID GROUP BY T2.CID HAVING COUNT(*)  >=  5",
    "table_names": [
      "Course",
      "Enrolled_in"
    ]
  },
  {
    "id": 1511,
    "db_id": "college_3",
    "question": "Find the first name and last name of the instructor of course that has course name",
    "sql": "SELECT T2.Fname ,  T2.Lname FROM COURSE AS T1 JOIN FACULTY AS T2 ON T1.Instructor  =  T2.FacID WHERE T1.CName  =  \"COMPUTER LITERACY\"",
    "table_names": [
      "Faculty",
      "Course"
    ]
  },
  {
    "id": 1512,
    "db_id": "college_3",
    "question": "What is the full name of the instructor who has a course named COMPUTER LITERACY?",
    "sql": "SELECT T2.Fname ,  T2.Lname FROM COURSE AS T1 JOIN FACULTY AS T2 ON T1.Instructor  =  T2.FacID WHERE T1.CName  =  \"COMPUTER LITERACY\"",
    "table_names": [
      "Faculty",
      "Course"
    ]
  },
  {
    "id": 1513,
    "db_id": "college_1",
    "question": "Find the department name and room of the course INTRODUCTION TO COMPUTER SCIENCE.",
    "sql": "SELECT T2.Dname ,  T2.Room FROM COURSE AS T1 JOIN DEPARTMENT AS T2 ON T1.DNO  =  T2.DNO WHERE T1.CName  =  \"INTRODUCTION TO COMPUTER SCIENCE\"",
    "table_names": [
      "Department",
      "Course"
    ]
  },
  {
    "id": 1514,
    "db_id": "college_1",
    "question": "What are the department name and room for the course INTRODUCTION TO COMPUTER SCIENCE?",
    "sql": "SELECT T2.Dname ,  T2.Room FROM COURSE AS T1 JOIN DEPARTMENT AS T2 ON T1.DNO  =  T2.DNO WHERE T1.CName  =  \"INTRODUCTION TO COMPUTER SCIENCE\"",
    "table_names": [
      "Department",
      "Course"
    ]
  },
  {
    "id": 1515,
    "db_id": "college_3",
    "question": "Find the full names of faculties who are members of department with department number 520.",
    "sql": "SELECT T1.Fname ,  T1.Lname FROM FACULTY AS T1 JOIN MEMBER_OF AS T2 ON T1.FacID  =  T2.FacID WHERE T2.DNO  =  520",
    "table_names": [
      "Faculty",
      "Member_of"
    ]
  },
  {
    "id": 1516,
    "db_id": "college_3",
    "question": "What are the full names of faculty members who are a part of department 520?",
    "sql": "SELECT T1.Fname ,  T1.Lname FROM FACULTY AS T1 JOIN MEMBER_OF AS T2 ON T1.FacID  =  T2.FacID WHERE T2.DNO  =  520",
    "table_names": [
      "Faculty",
      "Member_of"
    ]
  },
  {
    "id": 1517,
    "db_id": "college_3",
    "question": "What are the first names and last names of the students that minor in the department with DNO 140.",
    "sql": "SELECT T2.Fname ,  T2.Lname FROM MINOR_IN AS T1 JOIN STUDENT AS T2 ON T1.StuID  =  T2.StuID WHERE T1.DNO  =  140",
    "table_names": [
      "Student",
      "Minor_in"
    ]
  },
  {
    "id": 1518,
    "db_id": "college_3",
    "question": "What are the full names of students minoring in department 140?",
    "sql": "SELECT T2.Fname ,  T2.Lname FROM MINOR_IN AS T1 JOIN STUDENT AS T2 ON T1.StuID  =  T2.StuID WHERE T1.DNO  =  140",
    "table_names": [
      "Student",
      "Minor_in"
    ]
  },
  {
    "id": 1578,
    "db_id": "school_player",
    "question": "For each player, show the team and the location of school they belong to.",
    "sql": "SELECT T1.Team ,  T2.Location FROM player AS T1 JOIN school AS T2 ON T1.School_ID  =  T2.School_ID",
    "table_names": [
      "school",
      "player"
    ]
  },
  {
    "id": 1579,
    "db_id": "school_player",
    "question": "What are the team and the location of school each player belongs to?",
    "sql": "SELECT T1.Team ,  T2.Location FROM player AS T1 JOIN school AS T2 ON T1.School_ID  =  T2.School_ID",
    "table_names": [
      "school",
      "player"
    ]
  },
  {
    "id": 1580,
    "db_id": "school_player",
    "question": "Show the locations of schools that have more than 1 player.",
    "sql": "SELECT T2.Location FROM player AS T1 JOIN school AS T2 ON T1.School_ID  =  T2.School_ID GROUP BY T1.School_ID HAVING COUNT(*)  >  1",
    "table_names": [
      "school",
      "player"
    ]
  },
  {
    "id": 1581,
    "db_id": "school_player",
    "question": "Which schools have more than 1 player? Give me the school locations.",
    "sql": "SELECT T2.Location FROM player AS T1 JOIN school AS T2 ON T1.School_ID  =  T2.School_ID GROUP BY T1.School_ID HAVING COUNT(*)  >  1",
    "table_names": [
      "school",
      "player"
    ]
  },
  {
    "id": 1582,
    "db_id": "school_player",
    "question": "Show the denomination of the school that has the most players.",
    "sql": "SELECT T2.Denomination FROM player AS T1 JOIN school AS T2 ON T1.School_ID  =  T2.School_ID GROUP BY T1.School_ID ORDER BY COUNT(*) DESC LIMIT 1",
    "table_names": [
      "school",
      "player"
    ]
  },
  {
    "id": 1583,
    "db_id": "school_player",
    "question": "What is the denomination of the school the most players belong to?",
    "sql": "SELECT T2.Denomination FROM player AS T1 JOIN school AS T2 ON T1.School_ID  =  T2.School_ID GROUP BY T1.School_ID ORDER BY COUNT(*) DESC LIMIT 1",
    "table_names": [
      "school",
      "player"
    ]
  },
  {
    "id": 1632,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "Which city is the address of the store named \"FJA Filming\" located in?",
    "sql": "SELECT T1.City_Town FROM Addresses AS T1 JOIN Stores AS T2 ON T1.Address_ID  =  T2.Address_ID WHERE T2.Store_Name  =  \"FJA Filming\"",
    "table_names": [
      "Addresses",
      "Stores"
    ]
  },
  {
    "id": 1633,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "Find the city the store named \"FJA Filming\" is in.",
    "sql": "SELECT T1.City_Town FROM Addresses AS T1 JOIN Stores AS T2 ON T1.Address_ID  =  T2.Address_ID WHERE T2.Store_Name  =  \"FJA Filming\"",
    "table_names": [
      "Addresses",
      "Stores"
    ]
  },
  {
    "id": 1634,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "What are the states or counties of the address of the stores with marketing region code \"CA\"?",
    "sql": "SELECT T1.State_County FROM Addresses AS T1 JOIN Stores AS T2 ON T1.Address_ID  =  T2.Address_ID WHERE T2.Marketing_Region_Code  =  \"CA\"",
    "table_names": [
      "Addresses",
      "Stores"
    ]
  },
  {
    "id": 1635,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "Find the states or counties where the stores with marketing region code \"CA\" are located.",
    "sql": "SELECT T1.State_County FROM Addresses AS T1 JOIN Stores AS T2 ON T1.Address_ID  =  T2.Address_ID WHERE T2.Marketing_Region_Code  =  \"CA\"",
    "table_names": [
      "Addresses",
      "Stores"
    ]
  },
  {
    "id": 1654,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "What are the names of the drama workshop groups with address in Feliciaberg city?",
    "sql": "SELECT T2.Store_Name FROM Addresses AS T1 JOIN Drama_Workshop_Groups AS T2 ON T1.Address_ID  =  T2.Address_ID WHERE T1.City_Town  =  \"Feliciaberg\"",
    "table_names": [
      "Addresses",
      "Drama_Workshop_Groups"
    ]
  },
  {
    "id": 1655,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "Return the the names of the drama workshop groups that are located in Feliciaberg city.",
    "sql": "SELECT T2.Store_Name FROM Addresses AS T1 JOIN Drama_Workshop_Groups AS T2 ON T1.Address_ID  =  T2.Address_ID WHERE T1.City_Town  =  \"Feliciaberg\"",
    "table_names": [
      "Addresses",
      "Drama_Workshop_Groups"
    ]
  },
  {
    "id": 1656,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "What are the email addresses of the drama workshop groups with address in Alaska state?",
    "sql": "SELECT T2.Store_Email_Address FROM Addresses AS T1 JOIN Drama_Workshop_Groups AS T2 ON T1.Address_ID  =  T2.Address_ID WHERE T1.State_County  =  \"Alaska\"",
    "table_names": [
      "Addresses",
      "Drama_Workshop_Groups"
    ]
  },
  {
    "id": 1657,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "List the email addresses of the drama workshop groups located in Alaska state.",
    "sql": "SELECT T2.Store_Email_Address FROM Addresses AS T1 JOIN Drama_Workshop_Groups AS T2 ON T1.Address_ID  =  T2.Address_ID WHERE T1.State_County  =  \"Alaska\"",
    "table_names": [
      "Addresses",
      "Drama_Workshop_Groups"
    ]
  },
  {
    "id": 1658,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "Show all cities along with the number of drama workshop groups in each city.",
    "sql": "SELECT T1.City_Town ,  count(*) FROM Addresses AS T1 JOIN Drama_Workshop_Groups AS T2 ON T1.Address_ID  =  T2.Address_ID GROUP BY T1.City_Town",
    "table_names": [
      "Addresses",
      "Drama_Workshop_Groups"
    ]
  },
  {
    "id": 1659,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "How many drama workshop groups are there in each city? Return both the city and the count.",
    "sql": "SELECT T1.City_Town ,  count(*) FROM Addresses AS T1 JOIN Drama_Workshop_Groups AS T2 ON T1.Address_ID  =  T2.Address_ID GROUP BY T1.City_Town",
    "table_names": [
      "Addresses",
      "Drama_Workshop_Groups"
    ]
  },
  {
    "id": 1662,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "Show the names of all the clients with no booking.",
    "sql": "SELECT Customer_Name FROM Clients EXCEPT SELECT T2.Customer_Name FROM Bookings AS T1 JOIN Clients AS T2 ON T1.Customer_ID  =  T2.Client_ID",
    "table_names": [
      "Clients",
      "Bookings"
    ]
  },
  {
    "id": 1663,
    "db_id": "cre_Drama_Workshop_Groups",
    "question": "What are the names of the clients who do not have any booking?",
    "sql": "SELECT Customer_Name FROM Clients EXCEPT SELECT T2.Customer_Name FROM Bookings AS T1 JOIN Clients AS T2 ON T1.Customer_ID  =  T2.Client_ID",
    "table_names": [
      "Clients",
      "Bookings"
    ]
  },
  {
    "id": 1724,
    "db_id": "voter_2",
    "question": "Find the distinct last names of the students who have class president votes.",
    "sql": "SELECT DISTINCT T1.LName FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  T2.CLASS_President_VOTE",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 1725,
    "db_id": "voter_2",
    "question": "What are the distinct last names of the students who have class president votes?",
    "sql": "SELECT DISTINCT T1.LName FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  T2.CLASS_President_VOTE",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 1726,
    "db_id": "voter_2",
    "question": "Find the distinct first names of the students who have class senator votes.",
    "sql": "SELECT DISTINCT T1.Fname FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  T2.CLASS_Senator_VOTE",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 1727,
    "db_id": "voter_2",
    "question": "What are the distinct first names of the students who have class president votes?",
    "sql": "SELECT DISTINCT T1.Fname FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  T2.CLASS_Senator_VOTE",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 1728,
    "db_id": "voter_2",
    "question": "Find the distinct ages of students who have secretary votes in the fall election cycle.",
    "sql": "SELECT DISTINCT T1.Age FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  T2.Secretary_Vote WHERE T2.Election_Cycle  =  \"Fall\"",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 1729,
    "db_id": "voter_2",
    "question": "What are the distinct ages of students who have secretary votes in the fall election cycle?",
    "sql": "SELECT DISTINCT T1.Age FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  T2.Secretary_Vote WHERE T2.Election_Cycle  =  \"Fall\"",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 1730,
    "db_id": "voter_2",
    "question": "Find the distinct Advisor of students who have treasurer votes in the spring election cycle.",
    "sql": "SELECT DISTINCT T1.Advisor FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  T2.Treasurer_Vote WHERE T2.Election_Cycle  =  \"Spring\"",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 1731,
    "db_id": "voter_2",
    "question": "Who served as an advisor for students who have treasurer votes in the spring election cycle?",
    "sql": "SELECT DISTINCT T1.Advisor FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  T2.Treasurer_Vote WHERE T2.Election_Cycle  =  \"Spring\"",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 1732,
    "db_id": "voter_2",
    "question": "Find the distinct majors of students who have treasurer votes.",
    "sql": "SELECT DISTINCT T1.Major FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  T2.Treasurer_Vote",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 1733,
    "db_id": "voter_2",
    "question": "What are the distinct majors that students with treasurer votes are studying?",
    "sql": "SELECT DISTINCT T1.Major FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  T2.Treasurer_Vote",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 1734,
    "db_id": "voter_2",
    "question": "Find the first and last names of all the female (sex is F) students who have president votes.",
    "sql": "SELECT DISTINCT T1.Fname ,  T1.LName FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  T2.President_VOTE WHERE T1.sex  =  \"F\"",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 1735,
    "db_id": "voter_2",
    "question": "What are the first and last names of all the female students who have president votes?",
    "sql": "SELECT DISTINCT T1.Fname ,  T1.LName FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  T2.President_VOTE WHERE T1.sex  =  \"F\"",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 1736,
    "db_id": "voter_2",
    "question": "Find the first and last name of all the students of age 18 who have vice president votes.",
    "sql": "SELECT DISTINCT T1.Fname ,  T1.LName FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  T2.VICE_President_VOTE WHERE T1.age  =  18",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 1737,
    "db_id": "voter_2",
    "question": "What are the first names and last names of the students who are 18 years old and have vice president votes.",
    "sql": "SELECT DISTINCT T1.Fname ,  T1.LName FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  T2.VICE_President_VOTE WHERE T1.age  =  18",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 1738,
    "db_id": "voter_2",
    "question": "How many male (sex is M) students have class senator votes in the fall election cycle?",
    "sql": "SELECT count(*) FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  Class_Senator_Vote WHERE T1.Sex  =  \"M\" AND T2.Election_Cycle  =  \"Fall\"",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 1739,
    "db_id": "voter_2",
    "question": "Count the number of male students who had class senator votes in the fall election cycle.",
    "sql": "SELECT count(*) FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  Class_Senator_Vote WHERE T1.Sex  =  \"M\" AND T2.Election_Cycle  =  \"Fall\"",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 1740,
    "db_id": "voter_2",
    "question": "Find the number of students whose city code is NYC and who have class senator votes in the spring election cycle.",
    "sql": "SELECT count(*) FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  Class_Senator_Vote WHERE T1.city_code  =  \"NYC\" AND T2.Election_Cycle  =  \"Spring\"",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 1741,
    "db_id": "voter_2",
    "question": "Which students live in the city with code \"NYC\" and have class senator votes in the spring election cycle? Count the numbers.",
    "sql": "SELECT count(*) FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  Class_Senator_Vote WHERE T1.city_code  =  \"NYC\" AND T2.Election_Cycle  =  \"Spring\"",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 1742,
    "db_id": "voter_2",
    "question": "Find the average age of students who live in the city with code \"NYC\" and have secretary votes in the spring election cycle.",
    "sql": "SELECT avg(T1.Age) FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  SECRETARY_Vote WHERE T1.city_code  =  \"NYC\" AND T2.Election_Cycle  =  \"Spring\"",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 1743,
    "db_id": "voter_2",
    "question": "What is the average age of students who have city code \"NYC\" and have secretary votes for the spring election cycle?",
    "sql": "SELECT avg(T1.Age) FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  SECRETARY_Vote WHERE T1.city_code  =  \"NYC\" AND T2.Election_Cycle  =  \"Spring\"",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 1744,
    "db_id": "voter_2",
    "question": "Find the average age of female (sex is F) students who have secretary votes in the spring election cycle.",
    "sql": "SELECT avg(T1.Age) FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  SECRETARY_Vote WHERE T1.Sex  =  \"F\" AND T2.Election_Cycle  =  \"Spring\"",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 1745,
    "db_id": "voter_2",
    "question": "What is the average age of the female students with secretary votes in the spring election cycle?",
    "sql": "SELECT avg(T1.Age) FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  SECRETARY_Vote WHERE T1.Sex  =  \"F\" AND T2.Election_Cycle  =  \"Spring\"",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 1746,
    "db_id": "voter_2",
    "question": "Find the distinct first names of all the students who have vice president votes and whose city code is not PIT.",
    "sql": "SELECT DISTINCT T1.Fname FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  T2.VICE_PRESIDENT_Vote EXCEPT SELECT DISTINCT Fname FROM STUDENT WHERE city_code  =  \"PIT\"",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 1747,
    "db_id": "voter_2",
    "question": "What are the distinct first names of the students who have vice president votes and reside in a city whose city code is not PIT?",
    "sql": "SELECT DISTINCT T1.Fname FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  T2.VICE_PRESIDENT_Vote EXCEPT SELECT DISTINCT Fname FROM STUDENT WHERE city_code  =  \"PIT\"",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 1748,
    "db_id": "voter_2",
    "question": "Find the distinct last names of all the students who have president votes and whose advisor is not 2192.",
    "sql": "SELECT DISTINCT T1.LName FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  PRESIDENT_Vote EXCEPT SELECT DISTINCT LName FROM STUDENT WHERE Advisor  =  \"2192\"",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 1749,
    "db_id": "voter_2",
    "question": "What are the distinct last names of the students who have president votes but do not have 2192 as the advisor?",
    "sql": "SELECT DISTINCT T1.LName FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  PRESIDENT_Vote EXCEPT SELECT DISTINCT LName FROM STUDENT WHERE Advisor  =  \"2192\"",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 1750,
    "db_id": "voter_2",
    "question": "Find the distinct last names of all the students who have president votes and whose advisor is 8741.",
    "sql": "SELECT DISTINCT T1.LName FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  PRESIDENT_Vote INTERSECT SELECT DISTINCT LName FROM STUDENT WHERE Advisor  =  \"8741\"",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 1751,
    "db_id": "voter_2",
    "question": "What are the distinct last names of the students who have president votes and have 8741 as the advisor?",
    "sql": "SELECT DISTINCT T1.LName FROM STUDENT AS T1 JOIN VOTING_RECORD AS T2 ON T1.StuID  =  PRESIDENT_Vote INTERSECT SELECT DISTINCT LName FROM STUDENT WHERE Advisor  =  \"8741\"",
    "table_names": [
      "Student",
      "Voting_record"
    ]
  },
  {
    "id": 1794,
    "db_id": "customers_and_products_contacts",
    "question": "Show names and phones of customers who do not have address information.",
    "sql": "SELECT customer_name ,  customer_phone FROM customers WHERE customer_id NOT IN (SELECT customer_id FROM customer_address_history)",
    "table_names": [
      "Customers",
      "Customer_Address_History"
    ]
  },
  {
    "id": 1799,
    "db_id": "dorm_1",
    "question": "Find the number of amenities for each of the dorms that can accommodate more than 100 students.",
    "sql": "SELECT count(*) ,  T1.dormid FROM dorm AS T1 JOIN has_amenity AS T2 ON T1.dormid  =  T2.dormid WHERE T1.student_capacity  >  100 GROUP BY T1.dormid",
    "table_names": [
      "Dorm",
      "Has_amenity"
    ]
  },
  {
    "id": 1800,
    "db_id": "dorm_1",
    "question": "For each dorm, how many amenities does it have?",
    "sql": "SELECT count(*) ,  T1.dormid FROM dorm AS T1 JOIN has_amenity AS T2 ON T1.dormid  =  T2.dormid WHERE T1.student_capacity  >  100 GROUP BY T1.dormid",
    "table_names": [
      "Dorm",
      "Has_amenity"
    ]
  },
  {
    "id": 1801,
    "db_id": "dorm_1",
    "question": "Find the name of amenity that is most common in all dorms.",
    "sql": "SELECT T1.amenity_name FROM dorm_amenity AS T1 JOIN has_amenity AS T2 ON T1.amenid  =  T2.amenid GROUP BY T2.amenid ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "Dorm_amenity",
      "Has_amenity"
    ]
  },
  {
    "id": 1802,
    "db_id": "dorm_1",
    "question": "What is the most common amenity in the dorms?",
    "sql": "SELECT T1.amenity_name FROM dorm_amenity AS T1 JOIN has_amenity AS T2 ON T1.amenid  =  T2.amenid GROUP BY T2.amenid ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "Dorm_amenity",
      "Has_amenity"
    ]
  },
  {
    "id": 1828,
    "db_id": "tracking_share_transactions",
    "question": "Show details of all investors if they make any transaction with share count greater than 100.",
    "sql": "SELECT T1.Investor_details FROM  INVESTORS AS T1 JOIN TRANSACTIONS AS T2 ON T1.investor_id  =  T2.investor_id WHERE T2.share_count  >  100",
    "table_names": [
      "Investors",
      "Transactions"
    ]
  },
  {
    "id": 1829,
    "db_id": "tracking_share_transactions",
    "question": "Return the lot details of lots that belong to investors with details \"l\"?",
    "sql": "SELECT T2.lot_details FROM INVESTORS AS T1 JOIN LOTS AS T2 ON  T1.investor_id  =  T2.investor_id WHERE T1.Investor_details  =  \"l\"",
    "table_names": [
      "Investors",
      "Lots"
    ]
  },
  {
    "id": 1835,
    "db_id": "tracking_share_transactions",
    "question": "Show the id and details of the investor that has the largest number of transactions.",
    "sql": "SELECT T2.investor_id ,  T1.Investor_details FROM INVESTORS AS T1 JOIN TRANSACTIONS AS T2 ON T1.investor_id  =  T2.investor_id GROUP BY T2.investor_id ORDER BY COUNT(*) DESC LIMIT 1",
    "table_names": [
      "Investors",
      "Transactions"
    ]
  },
  {
    "id": 1836,
    "db_id": "tracking_share_transactions",
    "question": "Show the id and details for the investors who have the top 3 number of transactions.",
    "sql": "SELECT T2.investor_id ,  T1.Investor_details FROM INVESTORS AS T1 JOIN TRANSACTIONS AS T2 ON T1.investor_id  =  T2.investor_id GROUP BY T2.investor_id ORDER BY COUNT(*) DESC LIMIT 3",
    "table_names": [
      "Investors",
      "Transactions"
    ]
  },
  {
    "id": 1837,
    "db_id": "tracking_share_transactions",
    "question": "Show the ids of the investors who have at least two transactions.",
    "sql": "SELECT T2.investor_id FROM INVESTORS AS T1 JOIN TRANSACTIONS AS T2 ON T1.investor_id  =  T2.investor_id GROUP BY T2.investor_id HAVING COUNT(*)  >=  2",
    "table_names": [
      "Investors",
      "Transactions"
    ]
  },
  {
    "id": 1838,
    "db_id": "tracking_share_transactions",
    "question": "Show the ids and details of the investors who have at least two transactions with type code \"SALE\".",
    "sql": "SELECT T2.investor_id ,  T1.Investor_details FROM INVESTORS AS T1 JOIN TRANSACTIONS AS T2 ON T1.investor_id  =  T2.investor_id WHERE T2.transaction_type_code  =  \"SALE\" GROUP BY T2.investor_id HAVING COUNT(*)  >=  2",
    "table_names": [
      "Investors",
      "Transactions"
    ]
  },
  {
    "id": 1841,
    "db_id": "cre_Theme_park",
    "question": "What are the star rating descriptions of the hotels with price above 10000?",
    "sql": "SELECT T2.star_rating_description FROM HOTELS AS T1 JOIN Ref_Hotel_Star_Ratings AS T2 ON T1.star_rating_code  =  T2.star_rating_code WHERE T1.price_range  >  10000",
    "table_names": [
      "Ref_Hotel_Star_Ratings",
      "Hotels"
    ]
  },
  {
    "id": 1842,
    "db_id": "cre_Theme_park",
    "question": "Give me the star rating descriptions of the hotels that cost more than 10000.",
    "sql": "SELECT T2.star_rating_description FROM HOTELS AS T1 JOIN Ref_Hotel_Star_Ratings AS T2 ON T1.star_rating_code  =  T2.star_rating_code WHERE T1.price_range  >  10000",
    "table_names": [
      "Ref_Hotel_Star_Ratings",
      "Hotels"
    ]
  },
  {
    "id": 1853,
    "db_id": "cre_Theme_park",
    "question": "What is the name of the staff that is in charge of the attraction named \"US museum\"?",
    "sql": "SELECT T1.Name FROM STAFF AS T1 JOIN TOURIST_ATTRACTIONS AS T2 ON T1.Tourist_Attraction_ID  =  T2.Tourist_Attraction_ID WHERE T2.Name  =  \"US museum\"",
    "table_names": [
      "Tourist_Attractions",
      "Staff"
    ]
  },
  {
    "id": 1854,
    "db_id": "cre_Theme_park",
    "question": "Tell me the name of the staff in charge of the attraction called \"US museum\".",
    "sql": "SELECT T1.Name FROM STAFF AS T1 JOIN TOURIST_ATTRACTIONS AS T2 ON T1.Tourist_Attraction_ID  =  T2.Tourist_Attraction_ID WHERE T2.Name  =  \"US museum\"",
    "table_names": [
      "Tourist_Attractions",
      "Staff"
    ]
  },
  {
    "id": 1857,
    "db_id": "cre_Theme_park",
    "question": "What are the visit date and details of the visitor whose detail is 'Vincent'?",
    "sql": "SELECT T2.Visit_Date ,  T2.Visit_Details FROM VISITORS AS T1 JOIN VISITS AS T2 ON T1.Tourist_ID  =  T2.Tourist_ID WHERE T1.Tourist_Details  =  \"Vincent\"",
    "table_names": [
      "Visitors",
      "Visits"
    ]
  },
  {
    "id": 1858,
    "db_id": "cre_Theme_park",
    "question": "Find the visit date and details of the tourist whose detail is 'Vincent'",
    "sql": "SELECT T2.Visit_Date ,  T2.Visit_Details FROM VISITORS AS T1 JOIN VISITS AS T2 ON T1.Tourist_ID  =  T2.Tourist_ID WHERE T1.Tourist_Details  =  \"Vincent\"",
    "table_names": [
      "Visitors",
      "Visits"
    ]
  },
  {
    "id": 1861,
    "db_id": "cre_Theme_park",
    "question": "Show different tourist attractions' names, ids, and the corresponding number of visits.",
    "sql": "SELECT T1.Name ,  T2.Tourist_Attraction_ID ,   COUNT(*) FROM Tourist_Attractions AS T1 JOIN VISITS AS T2 ON T1.Tourist_Attraction_ID  =  T2.Tourist_Attraction_ID GROUP BY T2.Tourist_Attraction_ID",
    "table_names": [
      "Tourist_Attractions",
      "Visits"
    ]
  },
  {
    "id": 1862,
    "db_id": "cre_Theme_park",
    "question": "What are the name, id and the corresponding number of visits for each  tourist attraction?",
    "sql": "SELECT T1.Name ,  T2.Tourist_Attraction_ID ,   COUNT(*) FROM Tourist_Attractions AS T1 JOIN VISITS AS T2 ON T1.Tourist_Attraction_ID  =  T2.Tourist_Attraction_ID GROUP BY T2.Tourist_Attraction_ID",
    "table_names": [
      "Tourist_Attractions",
      "Visits"
    ]
  },
  {
    "id": 1863,
    "db_id": "cre_Theme_park",
    "question": "Show the names and ids of tourist attractions that are visited at least two times.",
    "sql": "SELECT T1.Name ,  T2.Tourist_Attraction_ID FROM Tourist_Attractions AS T1 JOIN VISITS AS T2 ON T1.Tourist_Attraction_ID  =  T2.Tourist_Attraction_ID GROUP BY T2.Tourist_Attraction_ID HAVING count(*)  >=  2",
    "table_names": [
      "Tourist_Attractions",
      "Visits"
    ]
  },
  {
    "id": 1864,
    "db_id": "cre_Theme_park",
    "question": "Which tourist attractions are visited at least twice? Give me their names and ids.",
    "sql": "SELECT T1.Name ,  T2.Tourist_Attraction_ID FROM Tourist_Attractions AS T1 JOIN VISITS AS T2 ON T1.Tourist_Attraction_ID  =  T2.Tourist_Attraction_ID GROUP BY T2.Tourist_Attraction_ID HAVING count(*)  >=  2",
    "table_names": [
      "Tourist_Attractions",
      "Visits"
    ]
  },
  {
    "id": 1865,
    "db_id": "cre_Theme_park",
    "question": "Show the names and ids of tourist attractions that are visited at most once.",
    "sql": "SELECT T1.Name ,  T1.Tourist_Attraction_ID FROM Tourist_Attractions AS T1 JOIN VISITS AS T2 ON T1.Tourist_Attraction_ID  =  T2.Tourist_Attraction_ID GROUP BY T2.Tourist_Attraction_ID HAVING count(*)  <=  1",
    "table_names": [
      "Tourist_Attractions",
      "Visits"
    ]
  },
  {
    "id": 1866,
    "db_id": "cre_Theme_park",
    "question": "What are the names and ids of the tourist attractions that are visited at most once?",
    "sql": "SELECT T1.Name ,  T1.Tourist_Attraction_ID FROM Tourist_Attractions AS T1 JOIN VISITS AS T2 ON T1.Tourist_Attraction_ID  =  T2.Tourist_Attraction_ID GROUP BY T2.Tourist_Attraction_ID HAVING count(*)  <=  1",
    "table_names": [
      "Tourist_Attractions",
      "Visits"
    ]
  },
  {
    "id": 1871,
    "db_id": "cre_Theme_park",
    "question": "How many tourists did not make any visit?",
    "sql": "SELECT count(*) FROM Visitors WHERE Tourist_ID NOT IN ( SELECT Tourist_ID FROM Visits )",
    "table_names": [
      "Visitors",
      "Visits"
    ]
  },
  {
    "id": 1872,
    "db_id": "cre_Theme_park",
    "question": "Count the number of tourists who did not visit any place.",
    "sql": "SELECT count(*) FROM Visitors WHERE Tourist_ID NOT IN ( SELECT Tourist_ID FROM Visits )",
    "table_names": [
      "Visitors",
      "Visits"
    ]
  },
  {
    "id": 1873,
    "db_id": "game_1",
    "question": "Show last names for all student who are on scholarship.",
    "sql": "SELECT T2.Lname FROM Sportsinfo AS T1 JOIN Student AS T2 ON T1.StuID  =  T2.StuID WHERE T1.onscholarship  =  'Y'",
    "table_names": [
      "Student",
      "SportsInfo"
    ]
  },
  {
    "id": 1874,
    "db_id": "game_1",
    "question": "What are the last names for all scholarship students?",
    "sql": "SELECT T2.Lname FROM Sportsinfo AS T1 JOIN Student AS T2 ON T1.StuID  =  T2.StuID WHERE T1.onscholarship  =  'Y'",
    "table_names": [
      "Student",
      "SportsInfo"
    ]
  },
  {
    "id": 1875,
    "db_id": "game_1",
    "question": "What is the first name and last name of the student who have most number of sports?",
    "sql": "SELECT T2.Fname ,  T2.Lname FROM Sportsinfo AS T1 JOIN Student AS T2 ON T1.StuID  =  T2.StuID GROUP BY T1.StuID ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "Student",
      "SportsInfo"
    ]
  },
  {
    "id": 1876,
    "db_id": "game_1",
    "question": "What is the first and last name of the student who played the most sports?",
    "sql": "SELECT T2.Fname ,  T2.Lname FROM Sportsinfo AS T1 JOIN Student AS T2 ON T1.StuID  =  T2.StuID GROUP BY T1.StuID ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "Student",
      "SportsInfo"
    ]
  },
  {
    "id": 1877,
    "db_id": "game_1",
    "question": "Show student ids who don't have any sports.",
    "sql": "SELECT StuID FROM Student EXCEPT SELECT StuID FROM Sportsinfo",
    "table_names": [
      "Student",
      "SportsInfo"
    ]
  },
  {
    "id": 1878,
    "db_id": "game_1",
    "question": "What are the ids of all students who don't play sports?",
    "sql": "SELECT StuID FROM Student EXCEPT SELECT StuID FROM Sportsinfo",
    "table_names": [
      "Student",
      "SportsInfo"
    ]
  },
  {
    "id": 1879,
    "db_id": "game_1",
    "question": "Show student ids who are on scholarship and have major 600.",
    "sql": "SELECT StuID FROM Student WHERE major  =  600 INTERSECT SELECT StuID FROM Sportsinfo WHERE onscholarship  =  'Y'",
    "table_names": [
      "Student",
      "SportsInfo"
    ]
  },
  {
    "id": 1880,
    "db_id": "game_1",
    "question": "What are the student ids for those on scholarship in major number 600?",
    "sql": "SELECT StuID FROM Student WHERE major  =  600 INTERSECT SELECT StuID FROM Sportsinfo WHERE onscholarship  =  'Y'",
    "table_names": [
      "Student",
      "SportsInfo"
    ]
  },
  {
    "id": 1881,
    "db_id": "game_1",
    "question": "Show student ids who are female and play football.",
    "sql": "SELECT StuID FROM Student WHERE sex  =  'F' INTERSECT SELECT StuID FROM Sportsinfo WHERE sportname  =  \"Football\"",
    "table_names": [
      "Student",
      "SportsInfo"
    ]
  },
  {
    "id": 1882,
    "db_id": "game_1",
    "question": "What are the ids of all female students who play football?",
    "sql": "SELECT StuID FROM Student WHERE sex  =  'F' INTERSECT SELECT StuID FROM Sportsinfo WHERE sportname  =  \"Football\"",
    "table_names": [
      "Student",
      "SportsInfo"
    ]
  },
  {
    "id": 1883,
    "db_id": "game_1",
    "question": "Show all male student ids who don't play football.",
    "sql": "SELECT StuID FROM Student WHERE sex  =  'M' EXCEPT SELECT StuID FROM Sportsinfo WHERE sportname  =  \"Football\"",
    "table_names": [
      "Student",
      "SportsInfo"
    ]
  },
  {
    "id": 1884,
    "db_id": "game_1",
    "question": "What are the ids of all male students who do not play football?",
    "sql": "SELECT StuID FROM Student WHERE sex  =  'M' EXCEPT SELECT StuID FROM Sportsinfo WHERE sportname  =  \"Football\"",
    "table_names": [
      "Student",
      "SportsInfo"
    ]
  },
  {
    "id": 1885,
    "db_id": "game_1",
    "question": "Show total hours per week and number of games played for student David Shieber.",
    "sql": "SELECT sum(hoursperweek) ,  sum(gamesplayed) FROM Sportsinfo AS T1 JOIN Student AS T2 ON T1.StuID  =  T2.StuID WHERE T2.Fname  =  \"David\" AND T2.Lname  =  \"Shieber\"",
    "table_names": [
      "Student",
      "SportsInfo"
    ]
  },
  {
    "id": 1886,
    "db_id": "game_1",
    "question": "What is the total number of hours per work and number of games played by David Shieber?",
    "sql": "SELECT sum(hoursperweek) ,  sum(gamesplayed) FROM Sportsinfo AS T1 JOIN Student AS T2 ON T1.StuID  =  T2.StuID WHERE T2.Fname  =  \"David\" AND T2.Lname  =  \"Shieber\"",
    "table_names": [
      "Student",
      "SportsInfo"
    ]
  },
  {
    "id": 1887,
    "db_id": "game_1",
    "question": "Show total hours per week and number of games played for students under 20.",
    "sql": "SELECT sum(hoursperweek) ,  sum(gamesplayed) FROM Sportsinfo AS T1 JOIN Student AS T2 ON T1.StuID  =  T2.StuID WHERE T2.age  <  20",
    "table_names": [
      "Student",
      "SportsInfo"
    ]
  },
  {
    "id": 1888,
    "db_id": "game_1",
    "question": "What is the total number of hours per week and number of games played by students under 20?",
    "sql": "SELECT sum(hoursperweek) ,  sum(gamesplayed) FROM Sportsinfo AS T1 JOIN Student AS T2 ON T1.StuID  =  T2.StuID WHERE T2.age  <  20",
    "table_names": [
      "Student",
      "SportsInfo"
    ]
  },
  {
    "id": 1889,
    "db_id": "game_1",
    "question": "Show ids of students who don't play video game.",
    "sql": "SELECT StuID FROM Student EXCEPT SELECT StuID FROM Plays_games",
    "table_names": [
      "Student",
      "Plays_Games"
    ]
  },
  {
    "id": 1890,
    "db_id": "game_1",
    "question": "What are the ids of all students who are not video game players?",
    "sql": "SELECT StuID FROM Student EXCEPT SELECT StuID FROM Plays_games",
    "table_names": [
      "Student",
      "Plays_Games"
    ]
  },
  {
    "id": 1897,
    "db_id": "game_1",
    "question": "Find the last and first name of students who are playing Football or Lacrosse.",
    "sql": "SELECT T2.lname ,  T2.fname FROM SportsInfo AS T1 JOIN Student AS T2 ON T1.StuID  =  T2.StuID WHERE T1.SportName  =  \"Football\" OR T1.SportName  =  \"Lacrosse\"",
    "table_names": [
      "Student",
      "SportsInfo"
    ]
  },
  {
    "id": 1898,
    "db_id": "game_1",
    "question": "What is the first and last name of all students who play Football or Lacrosse?",
    "sql": "SELECT T2.lname ,  T2.fname FROM SportsInfo AS T1 JOIN Student AS T2 ON T1.StuID  =  T2.StuID WHERE T1.SportName  =  \"Football\" OR T1.SportName  =  \"Lacrosse\"",
    "table_names": [
      "Student",
      "SportsInfo"
    ]
  },
  {
    "id": 1899,
    "db_id": "customers_and_addresses",
    "question": "Which contact channel has been used by the customer with name \"Tillman Ernser\"?",
    "sql": "SELECT DISTINCT channel_code FROM customers AS t1 JOIN customer_contact_channels AS t2 ON t1.customer_id  =  t2.customer_id WHERE t1.customer_name  =  \"Tillman Ernser\"",
    "table_names": [
      "Customers",
      "Customer_Contact_Channels"
    ]
  },
  {
    "id": 1900,
    "db_id": "customers_and_addresses",
    "question": "Find the contact channel code that was used by the customer named \"Tillman Ernser\".",
    "sql": "SELECT DISTINCT channel_code FROM customers AS t1 JOIN customer_contact_channels AS t2 ON t1.customer_id  =  t2.customer_id WHERE t1.customer_name  =  \"Tillman Ernser\"",
    "table_names": [
      "Customers",
      "Customer_Contact_Channels"
    ]
  },
  {
    "id": 1901,
    "db_id": "customers_and_addresses",
    "question": "What is the \"active to date\" of the latest contact channel used by \"Tillman Ernser\"?",
    "sql": "SELECT max(t2.active_to_date) FROM customers AS t1 JOIN customer_contact_channels AS t2 ON t1.customer_id  =  t2.customer_id WHERE t1.customer_name  =  \"Tillman Ernser\"",
    "table_names": [
      "Customers",
      "Customer_Contact_Channels"
    ]
  },
  {
    "id": 1902,
    "db_id": "customers_and_addresses",
    "question": "Return the the \"active to date\" of the latest contact channel used by the customer named \"Tillman Ernser\".",
    "sql": "SELECT max(t2.active_to_date) FROM customers AS t1 JOIN customer_contact_channels AS t2 ON t1.customer_id  =  t2.customer_id WHERE t1.customer_name  =  \"Tillman Ernser\"",
    "table_names": [
      "Customers",
      "Customer_Contact_Channels"
    ]
  },
  {
    "id": 1903,
    "db_id": "customers_and_addresses",
    "question": "Find the name and active date of the customer that use email as the contact channel.",
    "sql": "SELECT t1.customer_name ,  t2.active_from_date FROM customers AS t1 JOIN customer_contact_channels AS t2 ON t1.customer_id  =  t2.customer_id WHERE t2.channel_code  =  'Email'",
    "table_names": [
      "Customers",
      "Customer_Contact_Channels"
    ]
  },
  {
    "id": 1904,
    "db_id": "customers_and_addresses",
    "question": "What are the name and active date of the customers whose contact channel code is email?",
    "sql": "SELECT t1.customer_name ,  t2.active_from_date FROM customers AS t1 JOIN customer_contact_channels AS t2 ON t1.customer_id  =  t2.customer_id WHERE t2.channel_code  =  'Email'",
    "table_names": [
      "Customers",
      "Customer_Contact_Channels"
    ]
  },
  {
    "id": 2032,
    "db_id": "wine_1",
    "question": "List the names of all distinct wines that are made of red color grape.",
    "sql": "SELECT DISTINCT T2.Name FROM GRAPES AS T1 JOIN WINE AS T2 ON T1.Grape  =  T2.Grape WHERE T1.Color  =  \"Red\"",
    "table_names": [
      "grapes",
      "wine"
    ]
  },
  {
    "id": 2033,
    "db_id": "wine_1",
    "question": "What are the names of wines made from red grapes?",
    "sql": "SELECT DISTINCT T2.Name FROM GRAPES AS T1 JOIN WINE AS T2 ON T1.Grape  =  T2.Grape WHERE T1.Color  =  \"Red\"",
    "table_names": [
      "grapes",
      "wine"
    ]
  },
  {
    "id": 2034,
    "db_id": "wine_1",
    "question": "Find the names of all distinct wines that have appellations in North Coast area.",
    "sql": "SELECT DISTINCT T2.Name FROM APPELLATIONs AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation WHERE T1.Area  =  \"North Coast\"",
    "table_names": [
      "appellations",
      "wine"
    ]
  },
  {
    "id": 2035,
    "db_id": "wine_1",
    "question": "What are the distinct names of wines that have appellations in the North Coast area?",
    "sql": "SELECT DISTINCT T2.Name FROM APPELLATIONs AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation WHERE T1.Area  =  \"North Coast\"",
    "table_names": [
      "appellations",
      "wine"
    ]
  },
  {
    "id": 2036,
    "db_id": "wine_1",
    "question": "Give me the average prices of wines that are produced by appelations in Sonoma County.",
    "sql": "SELECT AVG(T2.Price) FROM APPELLATIONS AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation WHERE T1.County  =  \"Sonoma\"",
    "table_names": [
      "appellations",
      "wine"
    ]
  },
  {
    "id": 2037,
    "db_id": "wine_1",
    "question": "What is the average price of wines produced in appelations in Sonoma County?",
    "sql": "SELECT AVG(T2.Price) FROM APPELLATIONS AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation WHERE T1.County  =  \"Sonoma\"",
    "table_names": [
      "appellations",
      "wine"
    ]
  },
  {
    "id": 2038,
    "db_id": "wine_1",
    "question": "What are the names and scores of wines that are made of white color grapes?",
    "sql": "SELECT T2.Name ,   T2.Score FROM GRAPES AS T1 JOIN WINE AS T2 ON T1.Grape  =  T2.Grape WHERE T1.Color  =  \"White\"",
    "table_names": [
      "grapes",
      "wine"
    ]
  },
  {
    "id": 2039,
    "db_id": "wine_1",
    "question": "Give the names and scores of wines made from white grapes.",
    "sql": "SELECT T2.Name ,   T2.Score FROM GRAPES AS T1 JOIN WINE AS T2 ON T1.Grape  =  T2.Grape WHERE T1.Color  =  \"White\"",
    "table_names": [
      "grapes",
      "wine"
    ]
  },
  {
    "id": 2040,
    "db_id": "wine_1",
    "question": "Find the maximum price of wins from the appelations in Central Coast area and produced before the year of 2005.",
    "sql": "SELECT max(T2.Price) FROM APPELLATIONS AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation WHERE T1.Area  =  \"Central Coast\" AND T2.year  <  2005",
    "table_names": [
      "appellations",
      "wine"
    ]
  },
  {
    "id": 2041,
    "db_id": "wine_1",
    "question": "What is the maximum price of wines from the appelation in the Central Coast area, which was produced before 2005?",
    "sql": "SELECT max(T2.Price) FROM APPELLATIONS AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation WHERE T1.Area  =  \"Central Coast\" AND T2.year  <  2005",
    "table_names": [
      "appellations",
      "wine"
    ]
  },
  {
    "id": 2042,
    "db_id": "wine_1",
    "question": "Find the the grape whose white color grapes are used to produce wines with scores higher than 90.",
    "sql": "SELECT DISTINCT T1.Grape FROM GRAPES AS T1 JOIN WINE AS T2 ON T1.Grape  =  T2.Grape WHERE T1.Color  =  \"White\" AND T2.score  >  90",
    "table_names": [
      "grapes",
      "wine"
    ]
  },
  {
    "id": 2043,
    "db_id": "wine_1",
    "question": "Find the white grape used to produce wines with scores above 90.",
    "sql": "SELECT DISTINCT T1.Grape FROM GRAPES AS T1 JOIN WINE AS T2 ON T1.Grape  =  T2.Grape WHERE T1.Color  =  \"White\" AND T2.score  >  90",
    "table_names": [
      "grapes",
      "wine"
    ]
  },
  {
    "id": 2044,
    "db_id": "wine_1",
    "question": "What are the wines that have prices higher than 50 and made of Red color grapes?",
    "sql": "SELECT T2.Name FROM Grapes AS T1 JOIN WINE AS T2 ON T1.Grape  =  T2.Grape WHERE T1.Color  =  \"Red\" AND T2.price  >  50",
    "table_names": [
      "grapes",
      "wine"
    ]
  },
  {
    "id": 2045,
    "db_id": "wine_1",
    "question": "What are the names of wines made from red grapes and with prices above 50?",
    "sql": "SELECT T2.Name FROM Grapes AS T1 JOIN WINE AS T2 ON T1.Grape  =  T2.Grape WHERE T1.Color  =  \"Red\" AND T2.price  >  50",
    "table_names": [
      "grapes",
      "wine"
    ]
  },
  {
    "id": 2046,
    "db_id": "wine_1",
    "question": "What are the wines that have prices lower than 50 and have appelations in Monterey county?",
    "sql": "SELECT T2.Name FROM APPELLATIONS AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation WHERE T1.County  =  \"Monterey\" AND T2.price  <  50",
    "table_names": [
      "appellations",
      "wine"
    ]
  },
  {
    "id": 2047,
    "db_id": "wine_1",
    "question": "Give the neames of wines with prices below 50 and with appelations in Monterey county.",
    "sql": "SELECT T2.Name FROM APPELLATIONS AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation WHERE T1.County  =  \"Monterey\" AND T2.price  <  50",
    "table_names": [
      "appellations",
      "wine"
    ]
  },
  {
    "id": 2048,
    "db_id": "wine_1",
    "question": "What is the area of the appelation that produces the highest number of wines before the year of 2010?",
    "sql": "SELECT T1.Area FROM APPELLATIONS AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation GROUP BY T2.Appelation HAVING T2.year  <  2010 ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "appellations",
      "wine"
    ]
  },
  {
    "id": 2049,
    "db_id": "wine_1",
    "question": "What is the area for the appelation which produced the most wines prior to 2010?",
    "sql": "SELECT T1.Area FROM APPELLATIONS AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation GROUP BY T2.Appelation HAVING T2.year  <  2010 ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "appellations",
      "wine"
    ]
  },
  {
    "id": 2050,
    "db_id": "wine_1",
    "question": "What is the color of the grape whose wine products has the highest average price?",
    "sql": "SELECT T1.Color FROM GRAPES AS T1 JOIN WINE AS T2 ON T1.Grape  =  T2.Grape GROUP BY T2.Grape ORDER BY AVG(Price) DESC LIMIT 1",
    "table_names": [
      "grapes",
      "wine"
    ]
  },
  {
    "id": 2051,
    "db_id": "wine_1",
    "question": "Give the color of the grape whose wine products have the highest average price?",
    "sql": "SELECT T1.Color FROM GRAPES AS T1 JOIN WINE AS T2 ON T1.Grape  =  T2.Grape GROUP BY T2.Grape ORDER BY AVG(Price) DESC LIMIT 1",
    "table_names": [
      "grapes",
      "wine"
    ]
  },
  {
    "id": 2052,
    "db_id": "wine_1",
    "question": "Find the country of all appelations who have at most three wines.",
    "sql": "SELECT T1.County FROM APPELLATIONS AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation GROUP BY T2.Appelation HAVING count(*)  <=  3",
    "table_names": [
      "appellations",
      "wine"
    ]
  },
  {
    "id": 2053,
    "db_id": "wine_1",
    "question": "What are the countries for appelations with at most 3 wines?",
    "sql": "SELECT T1.County FROM APPELLATIONS AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation GROUP BY T2.Appelation HAVING count(*)  <=  3",
    "table_names": [
      "appellations",
      "wine"
    ]
  },
  {
    "id": 2054,
    "db_id": "wine_1",
    "question": "Find the top 3 wineries with the greatest number of wines made of white color grapes.",
    "sql": "SELECT T2.Winery FROM GRAPES AS T1 JOIN WINE AS T2 ON T1.GRAPE  =  T2.GRAPE WHERE T1.Color  =  \"White\" GROUP BY T2.Winery ORDER BY count(*) DESC LIMIT 3",
    "table_names": [
      "grapes",
      "wine"
    ]
  },
  {
    "id": 2055,
    "db_id": "wine_1",
    "question": "Which 3 wineries produce the most wines made from white grapes?",
    "sql": "SELECT T2.Winery FROM GRAPES AS T1 JOIN WINE AS T2 ON T1.GRAPE  =  T2.GRAPE WHERE T1.Color  =  \"White\" GROUP BY T2.Winery ORDER BY count(*) DESC LIMIT 3",
    "table_names": [
      "grapes",
      "wine"
    ]
  },
  {
    "id": 2056,
    "db_id": "wine_1",
    "question": "Find the appelations that produce wines after the year of 2008 but not in Central Coast area.",
    "sql": "SELECT Appelation FROM WINE WHERE YEAR  >  2008 EXCEPT SELECT Appelation FROM APPELLATIONS WHERE Area  =  \"Central Coast\"",
    "table_names": [
      "appellations",
      "wine"
    ]
  },
  {
    "id": 2057,
    "db_id": "wine_1",
    "question": "What are the appelations for wines produced after 2008 but not in the Central Coast area?",
    "sql": "SELECT Appelation FROM WINE WHERE YEAR  >  2008 EXCEPT SELECT Appelation FROM APPELLATIONS WHERE Area  =  \"Central Coast\"",
    "table_names": [
      "appellations",
      "wine"
    ]
  },
  {
    "id": 2058,
    "db_id": "wine_1",
    "question": "Find the average price of wines that are not produced from Sonoma county.",
    "sql": "SELECT avg(price) FROM wine WHERE Appelation NOT IN (SELECT T1.Appelation FROM APPELLATIONS AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation WHERE T1.County  =  'Sonoma')",
    "table_names": [
      "appellations",
      "wine"
    ]
  },
  {
    "id": 2059,
    "db_id": "wine_1",
    "question": "What is the average price for wines not produced in Sonoma county?",
    "sql": "SELECT avg(price) FROM wine WHERE Appelation NOT IN (SELECT T1.Appelation FROM APPELLATIONS AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation WHERE T1.County  =  'Sonoma')",
    "table_names": [
      "appellations",
      "wine"
    ]
  },
  {
    "id": 2060,
    "db_id": "wine_1",
    "question": "Find the county where produces the most number of wines with score higher than 90.",
    "sql": "SELECT T1.County FROM APPELLATIONS AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation WHERE T2.Score  >  90 GROUP BY T1.County ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "appellations",
      "wine"
    ]
  },
  {
    "id": 2061,
    "db_id": "wine_1",
    "question": "What is the county that produces the most wines scoring higher than 90?",
    "sql": "SELECT T1.County FROM APPELLATIONS AS T1 JOIN WINE AS T2 ON T1.Appelation  =  T2.Appelation WHERE T2.Score  >  90 GROUP BY T1.County ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "appellations",
      "wine"
    ]
  },
  {
    "id": 2111,
    "db_id": "activity_1",
    "question": "What are the first name and last name of Linda Smith's advisor?",
    "sql": "SELECT T1.fname ,  T1.lname FROM Faculty AS T1 JOIN Student AS T2 ON T1.FacID  =  T2.advisor WHERE T2.fname  =  \"Linda\" AND T2.lname  =  \"Smith\"",
    "table_names": [
      "Student",
      "Faculty"
    ]
  },
  {
    "id": 2112,
    "db_id": "activity_1",
    "question": "Who is the advisor of Linda Smith? Give me the first name and last name.",
    "sql": "SELECT T1.fname ,  T1.lname FROM Faculty AS T1 JOIN Student AS T2 ON T1.FacID  =  T2.advisor WHERE T2.fname  =  \"Linda\" AND T2.lname  =  \"Smith\"",
    "table_names": [
      "Student",
      "Faculty"
    ]
  },
  {
    "id": 2113,
    "db_id": "activity_1",
    "question": "Show the ids of students whose advisors are professors.",
    "sql": "SELECT T2.StuID FROM Faculty AS T1 JOIN Student AS T2 ON T1.FacID  =  T2.advisor WHERE T1.rank  =  \"Professor\"",
    "table_names": [
      "Student",
      "Faculty"
    ]
  },
  {
    "id": 2114,
    "db_id": "activity_1",
    "question": "Which students have professors as their advisors? Find their student ids.",
    "sql": "SELECT T2.StuID FROM Faculty AS T1 JOIN Student AS T2 ON T1.FacID  =  T2.advisor WHERE T1.rank  =  \"Professor\"",
    "table_names": [
      "Student",
      "Faculty"
    ]
  },
  {
    "id": 2115,
    "db_id": "activity_1",
    "question": "Show first name and last name for all the students advised by Michael Goodrich.",
    "sql": "SELECT T2.fname ,  T2.lname FROM Faculty AS T1 JOIN Student AS T2 ON T1.FacID  =  T2.advisor WHERE T1.fname  =  \"Michael\" AND T1.lname  =  \"Goodrich\"",
    "table_names": [
      "Student",
      "Faculty"
    ]
  },
  {
    "id": 2116,
    "db_id": "activity_1",
    "question": "Which students are advised by Michael Goodrich? Give me their first and last names.",
    "sql": "SELECT T2.fname ,  T2.lname FROM Faculty AS T1 JOIN Student AS T2 ON T1.FacID  =  T2.advisor WHERE T1.fname  =  \"Michael\" AND T1.lname  =  \"Goodrich\"",
    "table_names": [
      "Student",
      "Faculty"
    ]
  },
  {
    "id": 2117,
    "db_id": "activity_1",
    "question": "Show the faculty id of each faculty member, along with the number of students he or she advises.",
    "sql": "SELECT T1.FacID ,  count(*) FROM Faculty AS T1 JOIN Student AS T2 ON T1.FacID  =  T2.advisor GROUP BY T1.FacID",
    "table_names": [
      "Student",
      "Faculty"
    ]
  },
  {
    "id": 2118,
    "db_id": "activity_1",
    "question": "What are the faculty id and the number of students each faculty has?",
    "sql": "SELECT T1.FacID ,  count(*) FROM Faculty AS T1 JOIN Student AS T2 ON T1.FacID  =  T2.advisor GROUP BY T1.FacID",
    "table_names": [
      "Student",
      "Faculty"
    ]
  },
  {
    "id": 2119,
    "db_id": "activity_1",
    "question": "Show all the faculty ranks and the number of students advised by each rank.",
    "sql": "SELECT T1.rank ,  count(*) FROM Faculty AS T1 JOIN Student AS T2 ON T1.FacID  =  T2.advisor GROUP BY T1.rank",
    "table_names": [
      "Student",
      "Faculty"
    ]
  },
  {
    "id": 2120,
    "db_id": "activity_1",
    "question": "How many students are advised by each rank of faculty? List the rank and the number of students.",
    "sql": "SELECT T1.rank ,  count(*) FROM Faculty AS T1 JOIN Student AS T2 ON T1.FacID  =  T2.advisor GROUP BY T1.rank",
    "table_names": [
      "Student",
      "Faculty"
    ]
  },
  {
    "id": 2121,
    "db_id": "activity_1",
    "question": "What are the first and last name of the faculty who has the most students?",
    "sql": "SELECT T1.fname ,  T1.lname FROM Faculty AS T1 JOIN Student AS T2 ON T1.FacID  =  T2.advisor GROUP BY T1.FacID ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "Student",
      "Faculty"
    ]
  },
  {
    "id": 2122,
    "db_id": "activity_1",
    "question": "Give me the the first and last name of the faculty who advises the most students.",
    "sql": "SELECT T1.fname ,  T1.lname FROM Faculty AS T1 JOIN Student AS T2 ON T1.FacID  =  T2.advisor GROUP BY T1.FacID ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "Student",
      "Faculty"
    ]
  },
  {
    "id": 2123,
    "db_id": "activity_1",
    "question": "Show the ids for all the faculty members who have at least 2 students.",
    "sql": "SELECT T1.FacID FROM Faculty AS T1 JOIN Student AS T2 ON T1.FacID  =  T2.advisor GROUP BY T1.FacID HAVING count(*)  >=  2",
    "table_names": [
      "Student",
      "Faculty"
    ]
  },
  {
    "id": 2124,
    "db_id": "activity_1",
    "question": "Which faculty members advise two ore more students? Give me their faculty ids.",
    "sql": "SELECT T1.FacID FROM Faculty AS T1 JOIN Student AS T2 ON T1.FacID  =  T2.advisor GROUP BY T1.FacID HAVING count(*)  >=  2",
    "table_names": [
      "Student",
      "Faculty"
    ]
  },
  {
    "id": 2125,
    "db_id": "activity_1",
    "question": "Show ids for the faculty members who don't advise any student.",
    "sql": "SELECT FacID FROM Faculty EXCEPT SELECT advisor FROM Student",
    "table_names": [
      "Student",
      "Faculty"
    ]
  },
  {
    "id": 2126,
    "db_id": "activity_1",
    "question": "What are the ids of the faculty members who do not advise any student.",
    "sql": "SELECT FacID FROM Faculty EXCEPT SELECT advisor FROM Student",
    "table_names": [
      "Student",
      "Faculty"
    ]
  },
  {
    "id": 2127,
    "db_id": "activity_1",
    "question": "Show the ids of the faculty who don't participate in any activity.",
    "sql": "SELECT FacID FROM Faculty EXCEPT SELECT FacID FROM Faculty_participates_in",
    "table_names": [
      "Faculty_Participates_in",
      "Faculty"
    ]
  },
  {
    "id": 2128,
    "db_id": "activity_1",
    "question": "Which faculty do not participate in any activity? Find their faculty ids.",
    "sql": "SELECT FacID FROM Faculty EXCEPT SELECT FacID FROM Faculty_participates_in",
    "table_names": [
      "Faculty_Participates_in",
      "Faculty"
    ]
  },
  {
    "id": 2129,
    "db_id": "activity_1",
    "question": "Show the ids of all the faculty members who participate in an activity and advise a student.",
    "sql": "SELECT FacID FROM Faculty_participates_in INTERSECT SELECT advisor FROM Student",
    "table_names": [
      "Faculty_Participates_in",
      "Student"
    ]
  },
  {
    "id": 2130,
    "db_id": "activity_1",
    "question": "What are ids of the faculty members who not only participate in an activity but also advise a student.",
    "sql": "SELECT FacID FROM Faculty_participates_in INTERSECT SELECT advisor FROM Student",
    "table_names": [
      "Faculty_Participates_in",
      "Student"
    ]
  },
  {
    "id": 2131,
    "db_id": "activity_1",
    "question": "How many activities does Mark Giuliano participate in?",
    "sql": "SELECT count(*) FROM Faculty AS T1 JOIN Faculty_participates_in AS T2 ON T1.facID  =  T2.facID WHERE T1.fname  =  \"Mark\" AND T1.lname  =  \"Giuliano\"",
    "table_names": [
      "Faculty_Participates_in",
      "Faculty"
    ]
  },
  {
    "id": 2132,
    "db_id": "activity_1",
    "question": "Find the number of activities Mark Giuliano is involved in.",
    "sql": "SELECT count(*) FROM Faculty AS T1 JOIN Faculty_participates_in AS T2 ON T1.facID  =  T2.facID WHERE T1.fname  =  \"Mark\" AND T1.lname  =  \"Giuliano\"",
    "table_names": [
      "Faculty_Participates_in",
      "Faculty"
    ]
  },
  {
    "id": 2133,
    "db_id": "activity_1",
    "question": "Show the first and last name of all the faculty members who participated in some activity, together with the number of activities they participated in.",
    "sql": "SELECT  T1.fname ,  T1.lname ,  count(*) ,  T1.FacID FROM Faculty AS T1 JOIN Faculty_participates_in AS T2 ON T1.facID  =  T2.facID GROUP BY T1.FacID",
    "table_names": [
      "Faculty_Participates_in",
      "Faculty"
    ]
  },
  {
    "id": 2134,
    "db_id": "activity_1",
    "question": "What is the first and last name of the faculty members who participated in at least one activity? For each of them, also show the number of activities they participated in.",
    "sql": "SELECT  T1.fname ,  T1.lname ,  count(*) ,  T1.FacID FROM Faculty AS T1 JOIN Faculty_participates_in AS T2 ON T1.facID  =  T2.facID GROUP BY T1.FacID",
    "table_names": [
      "Faculty_Participates_in",
      "Faculty"
    ]
  },
  {
    "id": 2135,
    "db_id": "activity_1",
    "question": "Show all the activity names and the number of faculty involved in each activity.",
    "sql": "SELECT T1.activity_name ,  count(*) FROM Activity AS T1 JOIN Faculty_participates_in AS T2 ON T1.actID  =  T2.actID GROUP BY T1.actID",
    "table_names": [
      "Activity",
      "Faculty_Participates_in"
    ]
  },
  {
    "id": 2136,
    "db_id": "activity_1",
    "question": "How many faculty members participate in each activity? Return the activity names and the number of faculty members.",
    "sql": "SELECT T1.activity_name ,  count(*) FROM Activity AS T1 JOIN Faculty_participates_in AS T2 ON T1.actID  =  T2.actID GROUP BY T1.actID",
    "table_names": [
      "Activity",
      "Faculty_Participates_in"
    ]
  },
  {
    "id": 2137,
    "db_id": "activity_1",
    "question": "What is the first and last name of the faculty participating in the most activities?",
    "sql": "SELECT  T1.fname ,  T1.lname FROM Faculty AS T1 JOIN Faculty_participates_in AS T2 ON T1.facID  =  T2.facID GROUP BY T1.FacID ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "Faculty_Participates_in",
      "Faculty"
    ]
  },
  {
    "id": 2138,
    "db_id": "activity_1",
    "question": "Find the first and last name of the faculty who is involved in the largest number of activities.",
    "sql": "SELECT  T1.fname ,  T1.lname FROM Faculty AS T1 JOIN Faculty_participates_in AS T2 ON T1.facID  =  T2.facID GROUP BY T1.FacID ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "Faculty_Participates_in",
      "Faculty"
    ]
  },
  {
    "id": 2139,
    "db_id": "activity_1",
    "question": "What is the name of the activity that has the most faculty members involved in?",
    "sql": "SELECT T1.activity_name FROM Activity AS T1 JOIN Faculty_participates_in AS T2 ON T1.actID  =  T2.actID GROUP BY T1.actID ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "Activity",
      "Faculty_Participates_in"
    ]
  },
  {
    "id": 2140,
    "db_id": "activity_1",
    "question": "Which activity has the most faculty members participating in? Find the activity name.",
    "sql": "SELECT T1.activity_name FROM Activity AS T1 JOIN Faculty_participates_in AS T2 ON T1.actID  =  T2.actID GROUP BY T1.actID ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "Activity",
      "Faculty_Participates_in"
    ]
  },
  {
    "id": 2141,
    "db_id": "activity_1",
    "question": "Show the ids of the students who don't participate in any activity.",
    "sql": "SELECT StuID FROM Student EXCEPT SELECT StuID FROM Participates_in",
    "table_names": [
      "Participates_in",
      "Student"
    ]
  },
  {
    "id": 2142,
    "db_id": "activity_1",
    "question": "What are the ids of the students who are not involved in any activity",
    "sql": "SELECT StuID FROM Student EXCEPT SELECT StuID FROM Participates_in",
    "table_names": [
      "Participates_in",
      "Student"
    ]
  },
  {
    "id": 2143,
    "db_id": "activity_1",
    "question": "Show the ids for all the students who participate in an activity and are under 20.",
    "sql": "SELECT StuID FROM Participates_in INTERSECT SELECT StuID FROM Student WHERE age  <  20",
    "table_names": [
      "Participates_in",
      "Student"
    ]
  },
  {
    "id": 2144,
    "db_id": "activity_1",
    "question": "What are the ids of the students who are under 20 years old and are involved in at least one activity.",
    "sql": "SELECT StuID FROM Participates_in INTERSECT SELECT StuID FROM Student WHERE age  <  20",
    "table_names": [
      "Participates_in",
      "Student"
    ]
  },
  {
    "id": 2145,
    "db_id": "activity_1",
    "question": "What is the first and last name of the student participating in the most activities?",
    "sql": "SELECT T1.fname ,  T1.lname FROM Student AS T1 JOIN Participates_in AS T2 ON T1.StuID  =  T2.StuID GROUP BY T1.StuID ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "Participates_in",
      "Student"
    ]
  },
  {
    "id": 2146,
    "db_id": "activity_1",
    "question": "Tell me the first and last name of the student who has the most activities.",
    "sql": "SELECT T1.fname ,  T1.lname FROM Student AS T1 JOIN Participates_in AS T2 ON T1.StuID  =  T2.StuID GROUP BY T1.StuID ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "Participates_in",
      "Student"
    ]
  },
  {
    "id": 2147,
    "db_id": "activity_1",
    "question": "What is the name of the activity with the most students?",
    "sql": "SELECT T1.activity_name FROM Activity AS T1 JOIN Participates_in AS T2 ON T1.actID  =  T2.actID GROUP BY T1.actID ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "Activity",
      "Participates_in"
    ]
  },
  {
    "id": 2148,
    "db_id": "activity_1",
    "question": "Find the name of the activity that has the largest number of student participants.",
    "sql": "SELECT T1.activity_name FROM Activity AS T1 JOIN Participates_in AS T2 ON T1.actID  =  T2.actID GROUP BY T1.actID ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "Activity",
      "Participates_in"
    ]
  },
  {
    "id": 2149,
    "db_id": "activity_1",
    "question": "Find the ids of the students who participate in Canoeing and Kayaking.",
    "sql": "SELECT T1.stuid FROM participates_in AS T1 JOIN activity AS T2 ON T2.actid  =  T2.actid WHERE T2.activity_name  =  'Canoeing' INTERSECT SELECT T1.stuid FROM participates_in AS T1 JOIN activity AS T2 ON T2.actid  =  T2.actid WHERE T2.activity_name  =  'Kayaking'",
    "table_names": [
      "Activity",
      "Participates_in"
    ]
  },
  {
    "id": 2150,
    "db_id": "activity_1",
    "question": "Which students participate in both Canoeing and Kayaking as their activities? Tell me their student ids.",
    "sql": "SELECT T1.stuid FROM participates_in AS T1 JOIN activity AS T2 ON T2.actid  =  T2.actid WHERE T2.activity_name  =  'Canoeing' INTERSECT SELECT T1.stuid FROM participates_in AS T1 JOIN activity AS T2 ON T2.actid  =  T2.actid WHERE T2.activity_name  =  'Kayaking'",
    "table_names": [
      "Activity",
      "Participates_in"
    ]
  },
  {
    "id": 2151,
    "db_id": "flight_4",
    "question": "Find the number of routes operated by American Airlines.",
    "sql": "SELECT count(*) FROM airlines AS T1 JOIN routes AS T2 ON T1.alid  =  T2.alid WHERE T1.name  =  'American Airlines'",
    "table_names": [
      "routes",
      "airlines"
    ]
  },
  {
    "id": 2152,
    "db_id": "flight_4",
    "question": "How many routes does American Airlines operate?",
    "sql": "SELECT count(*) FROM airlines AS T1 JOIN routes AS T2 ON T1.alid  =  T2.alid WHERE T1.name  =  'American Airlines'",
    "table_names": [
      "routes",
      "airlines"
    ]
  },
  {
    "id": 2153,
    "db_id": "flight_4",
    "question": "Find the number of routes whose destination airports are in Canada.",
    "sql": "SELECT count(*) FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.dst_apid WHERE country  =  'Canada'",
    "table_names": [
      "routes",
      "airports"
    ]
  },
  {
    "id": 2154,
    "db_id": "flight_4",
    "question": "How many routes end in a Canadian airport?",
    "sql": "SELECT count(*) FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.dst_apid WHERE country  =  'Canada'",
    "table_names": [
      "routes",
      "airports"
    ]
  },
  {
    "id": 2155,
    "db_id": "flight_4",
    "question": "Find the name and city of the airport which is the destination of the most number of routes.",
    "sql": "SELECT T1.name ,  T1.city ,  T2.dst_apid FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.dst_apid GROUP BY T2.dst_apid ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "routes",
      "airports"
    ]
  },
  {
    "id": 2156,
    "db_id": "flight_4",
    "question": "What is the name and city of the airport that the most routes end at?",
    "sql": "SELECT T1.name ,  T1.city ,  T2.dst_apid FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.dst_apid GROUP BY T2.dst_apid ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "routes",
      "airports"
    ]
  },
  {
    "id": 2157,
    "db_id": "flight_4",
    "question": "Find the names of the top 10 airlines that operate the most number of routes.",
    "sql": "SELECT T1.name ,  T2.alid FROM airlines AS T1 JOIN routes AS T2 ON T1.alid  =  T2.alid GROUP BY T2.alid ORDER BY count(*) DESC LIMIT 10",
    "table_names": [
      "routes",
      "airlines"
    ]
  },
  {
    "id": 2158,
    "db_id": "flight_4",
    "question": "For the airline ids with the top 10 most routes operated, what are their names?",
    "sql": "SELECT T1.name ,  T2.alid FROM airlines AS T1 JOIN routes AS T2 ON T1.alid  =  T2.alid GROUP BY T2.alid ORDER BY count(*) DESC LIMIT 10",
    "table_names": [
      "routes",
      "airlines"
    ]
  },
  {
    "id": 2159,
    "db_id": "flight_4",
    "question": "Find the name and city of the airport which is the source for the most number of flight routes.",
    "sql": "SELECT T1.name ,  T1.city ,  T2.src_apid FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.src_apid GROUP BY T2.src_apid ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "routes",
      "airports"
    ]
  },
  {
    "id": 2160,
    "db_id": "flight_4",
    "question": "What is the name and city of the airport from most of the routes start?",
    "sql": "SELECT T1.name ,  T1.city ,  T2.src_apid FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.src_apid GROUP BY T2.src_apid ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "routes",
      "airports"
    ]
  },
  {
    "id": 2161,
    "db_id": "flight_4",
    "question": "Find the number of different airports which are the destinations of the American Airlines.",
    "sql": "SELECT count(DISTINCT dst_apid) FROM airlines AS T1 JOIN routes AS T2 ON T1.alid  =  T2.alid WHERE T1.name  =  'American Airlines'",
    "table_names": [
      "routes",
      "airlines"
    ]
  },
  {
    "id": 2162,
    "db_id": "flight_4",
    "question": "What is the number of different different airports that are destinations for American Airlines?",
    "sql": "SELECT count(DISTINCT dst_apid) FROM airlines AS T1 JOIN routes AS T2 ON T1.alid  =  T2.alid WHERE T1.name  =  'American Airlines'",
    "table_names": [
      "routes",
      "airlines"
    ]
  },
  {
    "id": 2163,
    "db_id": "flight_4",
    "question": "Find the number of routes for each source airport and the airport name.",
    "sql": "SELECT count(*) ,  T1.name FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.src_apid GROUP BY T1.name",
    "table_names": [
      "routes",
      "airports"
    ]
  },
  {
    "id": 2164,
    "db_id": "flight_4",
    "question": "For each airport name, how many routes start at that airport?",
    "sql": "SELECT count(*) ,  T1.name FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.src_apid GROUP BY T1.name",
    "table_names": [
      "routes",
      "airports"
    ]
  },
  {
    "id": 2165,
    "db_id": "flight_4",
    "question": "Find the number of routes and airport name for each source airport, order the results by decreasing number of routes.",
    "sql": "SELECT count(*) ,  T1.name FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.src_apid GROUP BY T1.name ORDER BY count(*) DESC",
    "table_names": [
      "routes",
      "airports"
    ]
  },
  {
    "id": 2166,
    "db_id": "flight_4",
    "question": "For each  airport name, how many routes start at that airport, ordered from most to least?",
    "sql": "SELECT count(*) ,  T1.name FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.src_apid GROUP BY T1.name ORDER BY count(*) DESC",
    "table_names": [
      "routes",
      "airports"
    ]
  },
  {
    "id": 2167,
    "db_id": "flight_4",
    "question": "For each country and airline name, how many routes are there?",
    "sql": "SELECT T1.country ,  T1.name ,  count(*) FROM airlines AS T1 JOIN routes AS T2 ON T1.alid  =  T2.alid GROUP BY T1.country ,  T1.name",
    "table_names": [
      "routes",
      "airlines"
    ]
  },
  {
    "id": 2168,
    "db_id": "flight_4",
    "question": "What is the total number of routes for each country and airline in that country?",
    "sql": "SELECT T1.country ,  T1.name ,  count(*) FROM airlines AS T1 JOIN routes AS T2 ON T1.alid  =  T2.alid GROUP BY T1.country ,  T1.name",
    "table_names": [
      "routes",
      "airlines"
    ]
  },
  {
    "id": 2169,
    "db_id": "flight_4",
    "question": "Find the number of routes with destination airports in Italy.",
    "sql": "SELECT count(*) FROM routes AS T1 JOIN airports AS T2 ON T1.dst_apid  =  T2.apid WHERE T2.country  =  'Italy'",
    "table_names": [
      "routes",
      "airports"
    ]
  },
  {
    "id": 2170,
    "db_id": "flight_4",
    "question": "What is the number of routes whose destinations are Italian airports?",
    "sql": "SELECT count(*) FROM routes AS T1 JOIN airports AS T2 ON T1.dst_apid  =  T2.apid WHERE T2.country  =  'Italy'",
    "table_names": [
      "routes",
      "airports"
    ]
  },
  {
    "id": 2171,
    "db_id": "flight_4",
    "question": "Find the number of routes that have destination John F Kennedy International Airport.",
    "sql": "SELECT count(*) FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.dst_apid WHERE T1.name  =  'John F Kennedy International Airport'",
    "table_names": [
      "routes",
      "airports"
    ]
  },
  {
    "id": 2172,
    "db_id": "flight_4",
    "question": "What is the number of routes that end at John F Kennedy International Airport?",
    "sql": "SELECT count(*) FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.dst_apid WHERE T1.name  =  'John F Kennedy International Airport'",
    "table_names": [
      "routes",
      "airports"
    ]
  },
  {
    "id": 2173,
    "db_id": "flight_4",
    "question": "Find the number of routes from the United States to Canada.",
    "sql": "SELECT count(*) FROM routes WHERE dst_apid IN (SELECT apid FROM airports WHERE country  =  'Canada') AND src_apid IN (SELECT apid FROM airports WHERE country  =  'United States')",
    "table_names": [
      "routes",
      "airports"
    ]
  },
  {
    "id": 2174,
    "db_id": "flight_4",
    "question": "How many routes go from the United States to Canada?",
    "sql": "SELECT count(*) FROM routes WHERE dst_apid IN (SELECT apid FROM airports WHERE country  =  'Canada') AND src_apid IN (SELECT apid FROM airports WHERE country  =  'United States')",
    "table_names": [
      "routes",
      "airports"
    ]
  },
  {
    "id": 2175,
    "db_id": "flight_4",
    "question": "Find the id of routes whose source and destination airports are in the United States.",
    "sql": "SELECT rid FROM routes WHERE dst_apid IN (SELECT apid FROM airports WHERE country  =  'United States') AND src_apid IN (SELECT apid FROM airports WHERE country  =  'United States')",
    "table_names": [
      "routes",
      "airports"
    ]
  },
  {
    "id": 2176,
    "db_id": "flight_4",
    "question": "What is the id of the routes whose source and destination airports are in the United States?",
    "sql": "SELECT rid FROM routes WHERE dst_apid IN (SELECT apid FROM airports WHERE country  =  'United States') AND src_apid IN (SELECT apid FROM airports WHERE country  =  'United States')",
    "table_names": [
      "routes",
      "airports"
    ]
  },
  {
    "id": 2177,
    "db_id": "flight_4",
    "question": "Find the name of airline which runs the most number of routes.",
    "sql": "SELECT T1.name FROM airlines AS T1 JOIN routes AS T2 ON T1.alid  =  T2.alid GROUP BY T1.name ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "routes",
      "airlines"
    ]
  },
  {
    "id": 2178,
    "db_id": "flight_4",
    "question": "What is the name of the airline with the most routes?",
    "sql": "SELECT T1.name FROM airlines AS T1 JOIN routes AS T2 ON T1.alid  =  T2.alid GROUP BY T1.name ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "routes",
      "airlines"
    ]
  },
  {
    "id": 2179,
    "db_id": "flight_4",
    "question": "Find the busiest source airport that runs most number of routes in China.",
    "sql": "SELECT T1.name FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.src_apid WHERE T1.country  =  'China' GROUP BY T1.name ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "routes",
      "airports"
    ]
  },
  {
    "id": 2180,
    "db_id": "flight_4",
    "question": "What is the name of the airport with the most number of routes that start in China?",
    "sql": "SELECT T1.name FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.src_apid WHERE T1.country  =  'China' GROUP BY T1.name ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "routes",
      "airports"
    ]
  },
  {
    "id": 2181,
    "db_id": "flight_4",
    "question": "Find the busiest destination airport that runs most number of routes in China.",
    "sql": "SELECT T1.name FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.dst_apid WHERE T1.country  =  'China' GROUP BY T1.name ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "routes",
      "airports"
    ]
  },
  {
    "id": 2182,
    "db_id": "flight_4",
    "question": "What is the name of the airport that is the destination of the most number of routes that start in China?",
    "sql": "SELECT T1.name FROM airports AS T1 JOIN routes AS T2 ON T1.apid  =  T2.dst_apid WHERE T1.country  =  'China' GROUP BY T1.name ORDER BY count(*) DESC LIMIT 1",
    "table_names": [
      "routes",
      "airports"
    ]
  },
  {
    "id": 2242,
    "db_id": "pets_1",
    "question": "Find number of pets owned by students who are older than 20.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Student",
      "Has_Pet"
    ]
  },
  {
    "id": 2243,
    "db_id": "pets_1",
    "question": "How many pets are owned by students that have an age greater than 20?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Student",
      "Has_Pet"
    ]
  },
  {
    "id": 2244,
    "db_id": "pets_1",
    "question": "Find the first name and age of students who have a pet.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Student",
      "Has_Pet"
    ]
  },
  {
    "id": 2245,
    "db_id": "pets_1",
    "question": "What are the different first names and ages of the students who do have pets?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Student",
      "Has_Pet"
    ]
  },
  {
    "id": 2246,
    "db_id": "pets_1",
    "question": "Find the id of the pet owned by student whose last name is âSmithâ.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Student",
      "Has_Pet"
    ]
  },
  {
    "id": 2247,
    "db_id": "pets_1",
    "question": "What is the id of the pet owned by the student whose last name is 'Smith'?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Student",
      "Has_Pet"
    ]
  },
  {
    "id": 2248,
    "db_id": "pets_1",
    "question": "Find the number of pets for each student who has any pet and student id.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Student",
      "Has_Pet"
    ]
  },
  {
    "id": 2249,
    "db_id": "pets_1",
    "question": "For students who have pets , how many pets does each student have ? list their ids instead of names .",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Student",
      "Has_Pet"
    ]
  },
  {
    "id": 2250,
    "db_id": "pets_1",
    "question": "Find the first name and gender of student who have more than one pet.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Student",
      "Has_Pet"
    ]
  },
  {
    "id": 2251,
    "db_id": "pets_1",
    "question": "What is the first name and gender of the all the students who have more than one pet?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Student",
      "Has_Pet"
    ]
  },
  {
    "id": 2252,
    "db_id": "pets_1",
    "question": "Find the average age of students who do not have any pet .",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Student",
      "Has_Pet"
    ]
  },
  {
    "id": 2253,
    "db_id": "pets_1",
    "question": "What is the average age for all students who do not own any pets ?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Student",
      "Has_Pet"
    ]
  },
  {
    "id": 2256,
    "db_id": "car_1",
    "question": "How many models does each car maker produce? List maker full name, id and the number.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "car_makers",
      "model_list"
    ]
  },
  {
    "id": 2257,
    "db_id": "car_1",
    "question": "What is the full name of each car maker, along with its id and how many models it produces?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "car_makers",
      "model_list"
    ]
  },
  {
    "id": 2258,
    "db_id": "car_1",
    "question": "Which model of the car has the minimum horsepower?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "car_names",
      "cars_data"
    ]
  },
  {
    "id": 2259,
    "db_id": "car_1",
    "question": "What is the model of the car with the smallest amount of horsepower?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "car_names",
      "cars_data"
    ]
  },
  {
    "id": 2260,
    "db_id": "car_1",
    "question": "Find the model of the car whose weight is below the average weight.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "car_names",
      "cars_data"
    ]
  },
  {
    "id": 2261,
    "db_id": "car_1",
    "question": "What is the model for the car with a weight smaller than the average?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "car_names",
      "cars_data"
    ]
  },
  {
    "id": 2262,
    "db_id": "car_1",
    "question": "Find the make and production time of the cars that were produced in the earliest year?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "car_names",
      "cars_data"
    ]
  },
  {
    "id": 2263,
    "db_id": "car_1",
    "question": "What is the maker of the carr produced in the earliest year and what year was it?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "car_names",
      "cars_data"
    ]
  },
  {
    "id": 2264,
    "db_id": "car_1",
    "question": "Which of the countries has the most car makers? List the country name.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "countries",
      "car_makers"
    ]
  },
  {
    "id": 2265,
    "db_id": "car_1",
    "question": "What is the name of the country with the most car makers?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "countries",
      "car_makers"
    ]
  },
  {
    "id": 2266,
    "db_id": "car_1",
    "question": "How many car models are produced by each maker ? Only list the count and the maker full name .",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "car_makers",
      "model_list"
    ]
  },
  {
    "id": 2267,
    "db_id": "car_1",
    "question": "What is the number of car models that are produced by each maker and what is the id and full name of each maker?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "car_makers",
      "model_list"
    ]
  },
  {
    "id": 2268,
    "db_id": "car_1",
    "question": "What is the accelerate of the car make amc hornet sportabout (sw)?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "car_names",
      "cars_data"
    ]
  },
  {
    "id": 2269,
    "db_id": "car_1",
    "question": "How much does the car accelerate that makes amc hornet sportabout (sw)?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "car_names",
      "cars_data"
    ]
  },
  {
    "id": 2270,
    "db_id": "car_1",
    "question": "How many car makers are there in france?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "countries",
      "car_makers"
    ]
  },
  {
    "id": 2271,
    "db_id": "car_1",
    "question": "What is the number of makers of care in France?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "countries",
      "car_makers"
    ]
  },
  {
    "id": 2272,
    "db_id": "car_1",
    "question": "What are the countries having at least one car maker? List name and id.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "countries",
      "car_makers"
    ]
  },
  {
    "id": 2273,
    "db_id": "car_1",
    "question": "What are the names and ids of all countries with at least one car maker?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "countries",
      "car_makers"
    ]
  },
  {
    "id": 2274,
    "db_id": "car_1",
    "question": "What is the maximum horsepower and the make of the car models with 3 cylinders?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "car_names",
      "cars_data"
    ]
  },
  {
    "id": 2275,
    "db_id": "car_1",
    "question": "What is the largest amount of horsepower for the models with 3 cylinders and what make is it?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "car_names",
      "cars_data"
    ]
  },
  {
    "id": 2276,
    "db_id": "car_1",
    "question": "Which model saves the most gasoline? That is to say, have the maximum miles per gallon.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "car_names",
      "cars_data"
    ]
  },
  {
    "id": 2277,
    "db_id": "car_1",
    "question": "What is the car model with the highest mpg ?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "car_names",
      "cars_data"
    ]
  },
  {
    "id": 2278,
    "db_id": "car_1",
    "question": "What is the average edispl of the cars of model volvo?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "car_names",
      "cars_data"
    ]
  },
  {
    "id": 2279,
    "db_id": "car_1",
    "question": "What is the average edispl for all volvos?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "car_names",
      "cars_data"
    ]
  },
  {
    "id": 2280,
    "db_id": "car_1",
    "question": "How many car models were produced by the maker with full name American Motor Company?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "car_makers",
      "model_list"
    ]
  },
  {
    "id": 2281,
    "db_id": "car_1",
    "question": "What is the number of car models created by the car maker American Motor Company?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "car_makers",
      "model_list"
    ]
  },
  {
    "id": 2282,
    "db_id": "car_1",
    "question": "Which makers designed more than 3 car models? List full name and the id.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "car_makers",
      "model_list"
    ]
  },
  {
    "id": 2283,
    "db_id": "car_1",
    "question": "What are the names and ids of all makers with more than 3 models?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "car_makers",
      "model_list"
    ]
  },
  {
    "id": 2284,
    "db_id": "car_1",
    "question": "For model volvo, how many cylinders does the car with the least accelerate have?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "car_names",
      "cars_data"
    ]
  },
  {
    "id": 2285,
    "db_id": "car_1",
    "question": "For a volvo model, how many cylinders does the version with least accelerate have?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "car_names",
      "cars_data"
    ]
  },
  {
    "id": 2286,
    "db_id": "car_1",
    "question": "How many countries has more than 2 car makers ?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "countries",
      "car_makers"
    ]
  },
  {
    "id": 2287,
    "db_id": "car_1",
    "question": "What is the number of countries with more than 2 car makers ?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "countries",
      "car_makers"
    ]
  },
  {
    "id": 2288,
    "db_id": "car_1",
    "question": "For the cars with 4 cylinders, which model has the largest horsepower?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "car_names",
      "cars_data"
    ]
  },
  {
    "id": 2289,
    "db_id": "car_1",
    "question": "For all of the 4 cylinder cars, which model has the most horsepower?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "car_names",
      "cars_data"
    ]
  },
  {
    "id": 2290,
    "db_id": "car_1",
    "question": "Among the cars with more than lowest horsepower, which ones do not have more than 3 cylinders? List the car makeid and make name.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "car_names",
      "cars_data"
    ]
  },
  {
    "id": 2291,
    "db_id": "car_1",
    "question": "Among the cars that do not have the minimum horsepower , what are the make ids and names of all those with less than 4 cylinders ?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "car_names",
      "cars_data"
    ]
  },
  {
    "id": 2292,
    "db_id": "car_1",
    "question": "What are the name of the countries where there is not a single car maker?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "countries",
      "car_makers"
    ]
  },
  {
    "id": 2293,
    "db_id": "car_1",
    "question": "What are the names of the countries with no car makers?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "countries",
      "car_makers"
    ]
  },
  {
    "id": 2294,
    "db_id": "flight_2",
    "question": "How many flights depart from City Aberdeen?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "airports",
      "flights"
    ]
  },
  {
    "id": 2295,
    "db_id": "flight_2",
    "question": "Return the number of flights departing from Aberdeen.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "airports",
      "flights"
    ]
  },
  {
    "id": 2296,
    "db_id": "flight_2",
    "question": "How many flights arriving in Aberdeen city?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "airports",
      "flights"
    ]
  },
  {
    "id": 2297,
    "db_id": "flight_2",
    "question": "Return the number of flights arriving in Aberdeen.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "airports",
      "flights"
    ]
  },
  {
    "id": 2298,
    "db_id": "flight_2",
    "question": "How many flights depart from City 'Aberdeen' and have destination City 'Ashley'?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "airports",
      "flights"
    ]
  },
  {
    "id": 2299,
    "db_id": "flight_2",
    "question": "How many flights fly from Aberdeen to Ashley?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "airports",
      "flights"
    ]
  },
  {
    "id": 2300,
    "db_id": "flight_2",
    "question": "How many flights does airline 'JetBlue Airways' have?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "airlines",
      "flights"
    ]
  },
  {
    "id": 2301,
    "db_id": "flight_2",
    "question": "Give the number of Jetblue Airways flights.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "airlines",
      "flights"
    ]
  },
  {
    "id": 2302,
    "db_id": "flight_2",
    "question": "How many 'United Airlines' flights go to Airport 'ASY'?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "airlines",
      "flights"
    ]
  },
  {
    "id": 2303,
    "db_id": "flight_2",
    "question": "Count the number of United Airlines flights arriving in ASY Airport.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "airlines",
      "flights"
    ]
  },
  {
    "id": 2304,
    "db_id": "flight_2",
    "question": "How many 'United Airlines' flights depart from Airport 'AHD'?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "airlines",
      "flights"
    ]
  },
  {
    "id": 2305,
    "db_id": "flight_2",
    "question": "Return the number of United Airlines flights leaving from AHD Airport.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "airlines",
      "flights"
    ]
  },
  {
    "id": 2306,
    "db_id": "flight_2",
    "question": "Which airline has most number of flights?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "airlines",
      "flights"
    ]
  },
  {
    "id": 2307,
    "db_id": "flight_2",
    "question": "What airline serves the most flights?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "airlines",
      "flights"
    ]
  },
  {
    "id": 2308,
    "db_id": "flight_2",
    "question": "Find the abbreviation and country of the airline that has fewest number of flights?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "airlines",
      "flights"
    ]
  },
  {
    "id": 2309,
    "db_id": "flight_2",
    "question": "What is the abbreviation of the airilne has the fewest flights and what country is it in?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "airlines",
      "flights"
    ]
  },
  {
    "id": 2310,
    "db_id": "flight_2",
    "question": "Find all airlines that have at least 10 flights.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "airlines",
      "flights"
    ]
  },
  {
    "id": 2311,
    "db_id": "flight_2",
    "question": "Which airlines have at least 10 flights?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "airlines",
      "flights"
    ]
  },
  {
    "id": 2312,
    "db_id": "flight_2",
    "question": "Find all airlines that have fewer than 200 flights.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "airlines",
      "flights"
    ]
  },
  {
    "id": 2313,
    "db_id": "flight_2",
    "question": "Which airlines have less than 200 flights?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "airlines",
      "flights"
    ]
  },
  {
    "id": 2314,
    "db_id": "flight_2",
    "question": "What are flight numbers of Airline \"United Airlines\"?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "airlines",
      "flights"
    ]
  },
  {
    "id": 2315,
    "db_id": "flight_2",
    "question": "Which flight numbers correspond to United Airlines flights?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "airlines",
      "flights"
    ]
  },
  {
    "id": 2316,
    "db_id": "flight_2",
    "question": "Find the number of flights landing in the city of Aberdeen or Abilene.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "airports",
      "flights"
    ]
  },
  {
    "id": 2317,
    "db_id": "flight_2",
    "question": "How many flights land in Aberdeen or Abilene?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "airports",
      "flights"
    ]
  },
  {
    "id": 2318,
    "db_id": "flight_2",
    "question": "Find the name of airports which do not have any flight in and out.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "airports",
      "flights"
    ]
  },
  {
    "id": 2319,
    "db_id": "flight_2",
    "question": "Which airports do not have departing or arriving flights?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "airports",
      "flights"
    ]
  },
  {
    "id": 2332,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "How many documents are using the template with type code 'PPT'?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Templates",
      "Documents"
    ]
  },
  {
    "id": 2333,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "Count the number of documents that use the PPT template type.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Templates",
      "Documents"
    ]
  },
  {
    "id": 2334,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "What is the id and type code for the template used by the most documents?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Templates",
      "Documents"
    ]
  },
  {
    "id": 2335,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "Return the id and type code of the template that is used for the greatest number of documents.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Templates",
      "Documents"
    ]
  },
  {
    "id": 2336,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "Show ids for all templates not used by any document.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Templates",
      "Documents"
    ]
  },
  {
    "id": 2337,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "What are the ids for templates that are not used in any documents?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Templates",
      "Documents"
    ]
  },
  {
    "id": 2338,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "What is the template type code of the template used by document with the name \"Data base\"?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Templates",
      "Documents"
    ]
  },
  {
    "id": 2339,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "Return the template type code of the template that is used by a document named Data base.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Templates",
      "Documents"
    ]
  },
  {
    "id": 2340,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "Show all document names using templates with template type code BK.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Templates",
      "Documents"
    ]
  },
  {
    "id": 2341,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "What are the names of documents that use templates with the code BK?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Templates",
      "Documents"
    ]
  },
  {
    "id": 2342,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "Show all template type codes and the number of documents using each type.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Templates",
      "Documents"
    ]
  },
  {
    "id": 2343,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "What are the different template type codes, and how many documents use each type?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Templates",
      "Documents"
    ]
  },
  {
    "id": 2344,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "Which template type code is used by most number of documents?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Templates",
      "Documents"
    ]
  },
  {
    "id": 2345,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "Return the code of the template type that is most commonly used in documents.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Templates",
      "Documents"
    ]
  },
  {
    "id": 2346,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "Show all template type codes that are not used by any document.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Templates",
      "Documents"
    ]
  },
  {
    "id": 2347,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "What are the codes of template types that are not used for any document?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Templates",
      "Documents"
    ]
  },
  {
    "id": 2348,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "What are the template ids with template type description \"Presentation\".",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Ref_Template_Types",
      "Templates"
    ]
  },
  {
    "id": 2349,
    "db_id": "cre_Doc_Template_Mgt",
    "question": "Return the ids corresponding to templates with the description 'Presentation'.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Ref_Template_Types",
      "Templates"
    ]
  },
  {
    "id": 2372,
    "db_id": "wta_1",
    "question": "What are the country code and first name of the players who won in both tourney WTA Championships and Australian Open?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "players",
      "matches"
    ]
  },
  {
    "id": 2373,
    "db_id": "wta_1",
    "question": "What are the first names and country codes for players who won both the WTA Championships and the Australian Open?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "players",
      "matches"
    ]
  },
  {
    "id": 2374,
    "db_id": "wta_1",
    "question": "Find the first name and country code of the player who did the most number of tours.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "players",
      "rankings"
    ]
  },
  {
    "id": 2375,
    "db_id": "wta_1",
    "question": "What is the first name and country code of the player with the most tours?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "players",
      "rankings"
    ]
  },
  {
    "id": 2376,
    "db_id": "wta_1",
    "question": "Find the average ranking for each player and their first name.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "players",
      "rankings"
    ]
  },
  {
    "id": 2377,
    "db_id": "wta_1",
    "question": "What are the first names of all players, and their average rankings?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "players",
      "rankings"
    ]
  },
  {
    "id": 2378,
    "db_id": "wta_1",
    "question": "Find the total ranking points for each player and their first name.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "players",
      "rankings"
    ]
  },
  {
    "id": 2379,
    "db_id": "wta_1",
    "question": "What are the first names of all players, and their total ranking points?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "players",
      "rankings"
    ]
  },
  {
    "id": 2380,
    "db_id": "wta_1",
    "question": "Find the first name, country code and birth date of the winner who has the highest rank points in all matches.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "players",
      "matches"
    ]
  },
  {
    "id": 2381,
    "db_id": "wta_1",
    "question": "What is the first name, country code, and birth date of the player with the most winner rank points across all matches?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "players",
      "matches"
    ]
  },
  {
    "id": 2457,
    "db_id": "voter_1",
    "question": "What is the area code in which the most voters voted?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "AREA_CODE_STATE",
      "VOTES"
    ]
  },
  {
    "id": 2459,
    "db_id": "world_1",
    "question": "Which region is the city Kabul located in?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "city",
      "country"
    ]
  },
  {
    "id": 2460,
    "db_id": "world_1",
    "question": "What region is Kabul in?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "city",
      "country"
    ]
  },
  {
    "id": 2461,
    "db_id": "world_1",
    "question": "Which language is the most popular in Aruba?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2462,
    "db_id": "world_1",
    "question": "What language is predominantly spoken in Aruba?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2463,
    "db_id": "world_1",
    "question": "What is the total number of languages used in Aruba?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2464,
    "db_id": "world_1",
    "question": "How many languages are spoken in Aruba?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2465,
    "db_id": "world_1",
    "question": "How many official languages does Afghanistan have?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2466,
    "db_id": "world_1",
    "question": "How many official languages are spoken in Afghanistan?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2467,
    "db_id": "world_1",
    "question": "What is name of the country that speaks the largest number of languages?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2468,
    "db_id": "world_1",
    "question": "Give the name of the nation that uses the greatest amount of languages.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2469,
    "db_id": "world_1",
    "question": "Which continent has the most diverse languages?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2470,
    "db_id": "world_1",
    "question": "Which continent speaks the most languages?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2471,
    "db_id": "world_1",
    "question": "How many countries speak both English and Dutch?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2472,
    "db_id": "world_1",
    "question": "What is the number of nations that use English and Dutch?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2473,
    "db_id": "world_1",
    "question": "What are the names of nations speak both English and French?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2474,
    "db_id": "world_1",
    "question": "Give the names of nations that speak both English and French.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2475,
    "db_id": "world_1",
    "question": "What are the names of nations where both English and French are official languages?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2476,
    "db_id": "world_1",
    "question": "Give the names of countries with English and French as official languages.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2477,
    "db_id": "world_1",
    "question": "What is the number of distinct continents where Chinese is spoken?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2478,
    "db_id": "world_1",
    "question": "How many continents speak Chinese?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2479,
    "db_id": "world_1",
    "question": "What are the regions that use English or Dutch?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2480,
    "db_id": "world_1",
    "question": "Which regions speak Dutch or English?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2481,
    "db_id": "world_1",
    "question": "Which countries have either English or Dutch as an official language?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2482,
    "db_id": "world_1",
    "question": "Which language is the most popular on the Asian continent?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2483,
    "db_id": "world_1",
    "question": "What is the language that is used by the largest number of Asian nations?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2484,
    "db_id": "world_1",
    "question": "Which languages are spoken by only one country in republic governments?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2485,
    "db_id": "world_1",
    "question": "What languages are only used by a single country with a republic government?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2486,
    "db_id": "world_1",
    "question": "Find the city with the largest population that uses English.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "city",
      "countrylanguage"
    ]
  },
  {
    "id": 2487,
    "db_id": "world_1",
    "question": "What is the most populace city that speaks English?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "city",
      "countrylanguage"
    ]
  },
  {
    "id": 2488,
    "db_id": "world_1",
    "question": "What is average life expectancy in the countries where English is not the official language?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2489,
    "db_id": "world_1",
    "question": "Give the mean life expectancy of countries in which English is not the official language.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2490,
    "db_id": "world_1",
    "question": "What is the total number of people living in the nations that do not use English?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2491,
    "db_id": "world_1",
    "question": "How many people live in countries that do not speak English?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2492,
    "db_id": "world_1",
    "question": "What is the official language spoken in the country whose head of state is Beatrix?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2493,
    "db_id": "world_1",
    "question": "What is the official language used in the country the name of whose head of state is Beatrix.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2494,
    "db_id": "world_1",
    "question": "What is the total number of unique official languages spoken in the countries that are founded before 1930?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2495,
    "db_id": "world_1",
    "question": "For the countries founded before 1930, what is the total number of distinct official languages?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2496,
    "db_id": "world_1",
    "question": "What are the codes of the countries that do not speak English and whose government forms are not Republic?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2497,
    "db_id": "world_1",
    "question": "Return the codes of countries that do not speak English and do not have Republics for governments.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2498,
    "db_id": "world_1",
    "question": "Return the country name and the numbers of languages spoken for each country that speaks at least 3 languages.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2499,
    "db_id": "world_1",
    "question": "What are the names of countries that speak more than 2 languages, as well as how many languages they speak?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "country",
      "countrylanguage"
    ]
  },
  {
    "id": 2508,
    "db_id": "network_1",
    "question": "Show the names of high school students and their corresponding number of friends.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Highschooler",
      "Friend"
    ]
  },
  {
    "id": 2509,
    "db_id": "network_1",
    "question": "What are the names of the high schoolers and how many friends does each have?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Highschooler",
      "Friend"
    ]
  },
  {
    "id": 2510,
    "db_id": "network_1",
    "question": "What is the name of the high schooler who has the greatest number of friends?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Highschooler",
      "Friend"
    ]
  },
  {
    "id": 2511,
    "db_id": "network_1",
    "question": "Return the name of the high school student with the most friends.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Highschooler",
      "Friend"
    ]
  },
  {
    "id": 2512,
    "db_id": "network_1",
    "question": "Show the names of high schoolers who have at least 3 friends.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Highschooler",
      "Friend"
    ]
  },
  {
    "id": 2513,
    "db_id": "network_1",
    "question": "What are the names of high schoolers who have 3 or more friends?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Highschooler",
      "Friend"
    ]
  },
  {
    "id": 2514,
    "db_id": "network_1",
    "question": "Show the names of all of the high schooler Kyle's friends.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Highschooler",
      "Friend"
    ]
  },
  {
    "id": 2515,
    "db_id": "network_1",
    "question": "Return the names of friends of the high school student Kyle.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Highschooler",
      "Friend"
    ]
  },
  {
    "id": 2516,
    "db_id": "network_1",
    "question": "How many friends does the high school student Kyle have?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Highschooler",
      "Friend"
    ]
  },
  {
    "id": 2517,
    "db_id": "network_1",
    "question": "Count the number of friends Kyle has.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Highschooler",
      "Friend"
    ]
  },
  {
    "id": 2518,
    "db_id": "network_1",
    "question": "Show ids of all students who do not have any friends.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Highschooler",
      "Friend"
    ]
  },
  {
    "id": 2519,
    "db_id": "network_1",
    "question": "What are the ids of high school students who do not have friends?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Highschooler",
      "Friend"
    ]
  },
  {
    "id": 2520,
    "db_id": "network_1",
    "question": "Show names of all high school students who do not have any friends.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Highschooler",
      "Friend"
    ]
  },
  {
    "id": 2521,
    "db_id": "network_1",
    "question": "What are the names of students who have no friends?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Highschooler",
      "Friend"
    ]
  },
  {
    "id": 2522,
    "db_id": "network_1",
    "question": "Show the ids of high schoolers who have friends and are also liked by someone else.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Friend",
      "Likes"
    ]
  },
  {
    "id": 2523,
    "db_id": "network_1",
    "question": "What are the ids of students who both have friends and are liked?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Friend",
      "Likes"
    ]
  },
  {
    "id": 2528,
    "db_id": "network_1",
    "question": "Show the names of students who have a grade higher than 5 and have at least 2 friends.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Highschooler",
      "Friend"
    ]
  },
  {
    "id": 2529,
    "db_id": "network_1",
    "question": "What are the names of high schoolers who have a grade of over 5 and have 2 or more friends?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Highschooler",
      "Friend"
    ]
  },
  {
    "id": 2532,
    "db_id": "network_1",
    "question": "Find the average grade of all students who have some friends.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Highschooler",
      "Friend"
    ]
  },
  {
    "id": 2533,
    "db_id": "network_1",
    "question": "What is the average grade of students who have friends?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Highschooler",
      "Friend"
    ]
  },
  {
    "id": 2534,
    "db_id": "network_1",
    "question": "Find the minimum grade of students who have no friends.",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Highschooler",
      "Friend"
    ]
  },
  {
    "id": 2535,
    "db_id": "network_1",
    "question": "What is the lowest grade of students who do not have any friends?",
    "sql": "SELECT T2.company_name FROM movie AS T1 JOIN culture_company AS T2 ON T1.movie_id  =  T2.movie_id WHERE T1.year  =  1999",
    "table_names": [
      "Highschooler",
      "Friend"
    ]
  }
]